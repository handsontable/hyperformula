(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{294:function(e,t,r){},306:function(e,t,r){
/*!
 * Copyright (c) HANDSONCODE sp. z o. o.
 * 
 * HYPERFORMULA is a software distributed by HANDSONCODE sp. z o. o., a
 * Polish corporation based in Gdynia, Poland, at Aleja Zwyciestwa 96-98,
 * registered by the District Court in Gdansk under number 538651,
 * EU VAT: PL5862294002, share capital: PLN 62,800.00.
 * 
 * This software is dual-licensed, giving you the option to use it under
 * either a proprietary license or the GNU General Public License version 3
 * (GPLv3). The specific license under which you use the software is
 * determined by the license key you apply. Each licensing option comes with
 * its own terms and conditions as specified below.
 * 
 *   1. PROPRIETARY LICENSE:
 * 
 *     Your use of this software is subject to the terms included in an
 *     applicable proprietary license agreement between you and HANDSONCODE.
 *     The proprietary license can be purchased from HANDSONCODE or an
 *     authorized reseller.
 * 
 *   2. GNU GENERAL PUBLIC LICENSE v3:
 * 
 *     This software is also available under the terms of the GNU General
 *     Public License v3. You are permitted to run, modify, and distribute
 *     this software under the terms of the GPLv3, as published by the Free
 *     Software Foundation. The full text of the GPLv3 can be found at
 *     https://www.gnu.org/licenses/.
 * 
 * UNLESS EXPRESSLY AGREED OTHERWISE, HANDSONCODE PROVIDES THIS SOFTWARE ON
 * AN "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, AND IN NO
 * EVENT AND UNDER NO LEGAL THEORY, SHALL HANDSONCODE BE LIABLE TO YOU FOR
 * DAMAGES, INCLUDING ANY DIRECT, INDIRECT, SPECIAL, INCIDENTAL, OR
 * CONSEQUENTIAL DAMAGES OF ANY CHARACTER ARISING FROM USE OR INABILITY TO
 * USE THIS SOFTWARE.
 * 
 * Version: 2.7.1
 * Release date: 18/07/2024 (built at 04/09/2024 12:44:07)
 */
var n;r(97),r(89),r(91),r(307),r(308),r(310),r(314),r(317),r(320),r(323),r(326),r(329),r(332),"undefined"!=typeof self&&self,n=function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0;var n=r(1);t.ArraySize=n.ArraySize;var o=r(73);t.CellError=o.CellError,t.CellType=o.CellType,t.CellValueDetailedType=o.CellValueDetailedType,t.CellValueType=o.CellValueType,t.ErrorType=o.ErrorType;var s=r(170);t.DetailedCellError=s.DetailedCellError;var i=r(171),a=r(175);t.AlwaysDense=a.AlwaysDense,t.AlwaysSparse=a.AlwaysSparse,t.DenseSparseChooseBasedOnThreshold=a.DenseSparseChooseBasedOnThreshold;var u=r(147);t.ConfigValueTooBigError=u.ConfigValueTooBigError,t.ConfigValueTooSmallError=u.ConfigValueTooSmallError,t.EvaluationSuspendedError=u.EvaluationSuspendedError,t.ExpectedOneOfValuesError=u.ExpectedOneOfValuesError,t.ExpectedValueOfTypeError=u.ExpectedValueOfTypeError,t.FunctionPluginValidationError=u.FunctionPluginValidationError,t.InvalidAddressError=u.InvalidAddressError,t.InvalidArgumentsError=u.InvalidArgumentsError,t.LanguageAlreadyRegisteredError=u.LanguageAlreadyRegisteredError,t.LanguageNotRegisteredError=u.LanguageNotRegisteredError,t.MissingTranslationError=u.MissingTranslationError,t.NamedExpressionDoesNotExistError=u.NamedExpressionDoesNotExistError,t.NamedExpressionNameIsAlreadyTakenError=u.NamedExpressionNameIsAlreadyTakenError,t.NamedExpressionNameIsInvalidError=u.NamedExpressionNameIsInvalidError,t.NoOperationToRedoError=u.NoOperationToRedoError,t.NoOperationToUndoError=u.NoOperationToUndoError,t.NoRelativeAddressesAllowedError=u.NoRelativeAddressesAllowedError,t.NoSheetWithIdError=u.NoSheetWithIdError,t.NoSheetWithNameError=u.NoSheetWithNameError,t.NotAFormulaError=u.NotAFormulaError,t.NothingToPasteError=u.NothingToPasteError,t.ProtectedFunctionTranslationError=u.ProtectedFunctionTranslationError,t.SheetNameAlreadyTakenError=u.SheetNameAlreadyTakenError,t.SheetSizeLimitExceededError=u.SheetSizeLimitExceededError,t.SourceLocationHasArrayError=u.SourceLocationHasArrayError,t.TargetLocationHasArrayError=u.TargetLocationHasArrayError,t.UnableToParseError=u.UnableToParseError;var c=r(198);t.ExportedCellChange=c.ExportedCellChange,t.ExportedNamedExpressionChange=c.ExportedNamedExpressionChange;var l=r(180);t.HyperFormula=l.HyperFormula;var h,d=(h=r(216))&&h.__esModule?h:{default:h},p=r(166);t.FunctionPlugin=p.FunctionPlugin,t.FunctionArgumentType=p.FunctionArgumentType,t.EmptyValue=p.EmptyValue;var m=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=f(t);if(r&&r.has(e))return r.get(e);var n={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&{}.hasOwnProperty.call(e,s)){var i=o?Object.getOwnPropertyDescriptor(e,s):null;i&&(i.get||i.set)?Object.defineProperty(n,s,i):n[s]=e[s]}return n.default=e,r&&r.set(e,n),n}(r(217)),g=r(139);function f(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(f=function(e){return e?r:t})(e)}t.SimpleRangeValue=g.SimpleRangeValue;
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
class E extends l.HyperFormula{}E.HyperFormula=l.HyperFormula,E.ErrorType=o.ErrorType,E.CellError=o.CellError,E.CellType=o.CellType,E.CellValueType=o.CellValueType,E.CellValueDetailedType=o.CellValueDetailedType,E.DetailedCellError=s.DetailedCellError,E.ExportedCellChange=c.ExportedCellChange,E.ExportedNamedExpressionChange=c.ExportedNamedExpressionChange,E.ConfigValueTooBigError=u.ConfigValueTooBigError,E.ConfigValueTooSmallError=u.ConfigValueTooSmallError,E.EvaluationSuspendedError=u.EvaluationSuspendedError,E.ExpectedOneOfValuesError=u.ExpectedOneOfValuesError,E.ExpectedValueOfTypeError=u.ExpectedValueOfTypeError,E.ArraySize=n.ArraySize,E.SimpleRangeValue=g.SimpleRangeValue,E.EmptyValue=p.EmptyValue,E.FunctionPlugin=p.FunctionPlugin,E.FunctionArgumentType=p.FunctionArgumentType,E.FunctionPluginValidationError=u.FunctionPluginValidationError,E.InvalidAddressError=u.InvalidAddressError,E.InvalidArgumentsError=u.InvalidArgumentsError,E.LanguageNotRegisteredError=u.LanguageNotRegisteredError,E.LanguageAlreadyRegisteredError=u.LanguageAlreadyRegisteredError,E.MissingTranslationError=u.MissingTranslationError,E.NamedExpressionDoesNotExistError=u.NamedExpressionDoesNotExistError,E.NamedExpressionNameIsAlreadyTakenError=u.NamedExpressionNameIsAlreadyTakenError,E.NamedExpressionNameIsInvalidError=u.NamedExpressionNameIsInvalidError,E.NoOperationToRedoError=u.NoOperationToRedoError,E.NoOperationToUndoError=u.NoOperationToUndoError,E.NoRelativeAddressesAllowedError=u.NoRelativeAddressesAllowedError,E.NoSheetWithIdError=u.NoSheetWithIdError,E.NoSheetWithNameError=u.NoSheetWithNameError,E.NotAFormulaError=u.NotAFormulaError,E.NothingToPasteError=u.NothingToPasteError,E.ProtectedFunctionTranslationError=u.ProtectedFunctionTranslationError,E.SheetNameAlreadyTakenError=u.SheetNameAlreadyTakenError,E.SheetSizeLimitExceededError=u.SheetSizeLimitExceededError,E.SourceLocationHasArrayError=u.SourceLocationHasArrayError,E.TargetLocationHasArrayError=u.TargetLocationHasArrayError,E.UnableToParseError=u.UnableToParseError;const T=i.Config.defaultConfig.language;l.HyperFormula.registerLanguage(T,d.default),l.HyperFormula.languages[d.default.langCode]=d.default;for(const e of Object.getOwnPropertyNames(m))e.startsWith("_")||l.HyperFormula.registerFunctionPlugin(m[e]);t.default=E},function(e,t,r){"use strict";t.__esModule=!0,t.ArraySizePredictor=t.ArraySize=void 0,r(2);var n=r(72),o=r(165),s=r(166),i=r(77);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
class a{constructor(e,t,r=!1){this.width=e,this.height=t,this.isRef=r}static error(){return new a(1,1,!0)}static scalar(){return new a(1,1,!1)}isScalar(){return 1===this.width&&1===this.height||this.isRef}}t.ArraySize=a,t.ArraySizePredictor=class{constructor(e,t){this.config=e,this.functionRegistry=t}checkArraySize(e,t){return this.checkArraySizeForAst(e,{formulaAddress:t,arraysFlag:this.config.useArrayArithmetic})}checkArraySizeForAst(e,t){switch(e.type){case i.AstNodeType.FUNCTION_CALL:return this.checkArraySizeForFunction(e,t);case i.AstNodeType.COLUMN_RANGE:case i.AstNodeType.ROW_RANGE:case i.AstNodeType.CELL_RANGE:{const r=n.AbsoluteCellRange.fromAstOrUndef(e,t.formulaAddress);return void 0===r?a.error():new a(r.width(),r.height(),!0)}case i.AstNodeType.ARRAY:{const r=[],n=[];for(const o of e.args){const e=o.map(e=>this.checkArraySizeForAst(e,t)),s=Math.min(...e.map(e=>e.height)),i=e.reduce((e,t)=>e+t.width,0);r.push(s),n.push(i)}const o=r.reduce((e,t)=>e+t,0),s=Math.min(...n);return new a(s,o)}case i.AstNodeType.STRING:case i.AstNodeType.NUMBER:return a.scalar();case i.AstNodeType.CELL_REFERENCE:return new a(1,1,!0);case i.AstNodeType.DIV_OP:case i.AstNodeType.CONCATENATE_OP:case i.AstNodeType.EQUALS_OP:case i.AstNodeType.GREATER_THAN_OP:case i.AstNodeType.GREATER_THAN_OR_EQUAL_OP:case i.AstNodeType.LESS_THAN_OP:case i.AstNodeType.LESS_THAN_OR_EQUAL_OP:case i.AstNodeType.MINUS_OP:case i.AstNodeType.NOT_EQUAL_OP:case i.AstNodeType.PLUS_OP:case i.AstNodeType.POWER_OP:case i.AstNodeType.TIMES_OP:{const r=this.checkArraySizeForAst(e.left,t),n=this.checkArraySizeForAst(e.right,t);return!t.arraysFlag&&(r.height>1||r.width>1||n.height>1||n.width>1)?a.error():(o=r,s=n,new a(Math.max(o.width,s.width),Math.max(o.height,s.height)))}case i.AstNodeType.MINUS_UNARY_OP:case i.AstNodeType.PLUS_UNARY_OP:case i.AstNodeType.PERCENT_OP:{const n=this.checkArraySizeForAst(e.value,t);return!t.arraysFlag&&(n.height>1||n.width>1)?a.error():new a((r=n).width,r.height)}case i.AstNodeType.PARENTHESIS:return this.checkArraySizeForAst(e.expression,t);case i.AstNodeType.EMPTY:default:return a.error()}var r,o,s}checkArraySizeForFunction(e,t){const r=this.functionRegistry.getArraySizeFunction(e.procedureName);if(void 0!==r)return r(e,t);const n=this.functionRegistry.getMetadata(e.procedureName);if(void 0===n||n.expandRanges||!t.arraysFlag||n.vectorizationForbidden||void 0===n.parameters)return new a(1,1);const i=e.args.map(e=>{var r;return this.checkArraySizeForAst(e,new o.InterpreterState(t.formulaAddress,t.arraysFlag||null!==(r=null==n?void 0:n.arrayFunction)&&void 0!==r&&r))}),u=[...n.parameters];if(void 0!==n.repeatLastArgs&&u.length<i.length&&(i.length-u.length)%n.repeatLastArgs!=0)return a.error();for(;u.length<i.length;){if(void 0===n.repeatLastArgs)return a.error();u.push(...u.slice(u.length-n.repeatLastArgs))}let c=1,l=1;for(let e=0;e<i.length;e++)u[e].argumentType!==s.FunctionArgumentType.RANGE&&u[e].argumentType!==s.FunctionArgumentType.ANY&&(l=Math.max(l,i[e].height),c=Math.max(c,i[e].width));return new a(c,l)}}},function(e,t,r){"use strict";var n=r(3),o=r(40),s=r(64),i=r(69),a=r(71);n({target:"Array",proto:!0,arity:1,forced:r(8)((function(){return 4294967297!==[].push.call({length:4294967296},1)}))||!function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(e){return e instanceof TypeError}}()},{push:function(e){var t=o(this),r=s(t),n=arguments.length;a(r+n);for(var u=0;u<n;u++)t[r]=arguments[u],r++;return i(t,r),r}})},function(e,t,r){"use strict";var n=r(4),o=r(6).f,s=r(44),i=r(48),a=r(38),u=r(56),c=r(68);e.exports=function(e,t){var r,l,h,d,p,m=e.target,g=e.global,f=e.stat;if(r=g?n:f?n[m]||a(m,{}):n[m]&&n[m].prototype)for(l in t){if(d=t[l],h=e.dontCallGetSet?(p=o(r,l))&&p.value:r[l],!c(g?l:m+(f?".":"#")+l,e.forced)&&void 0!==h){if(typeof d==typeof h)continue;u(d,h)}(e.sham||h&&h.sham)&&s(d,"sham",!0),i(r,l,d,e)}}},function(e,t,r){"use strict";(function(t){var r=function(e){return e&&e.Math===Math&&e};e.exports=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof t&&t)||r("object"==typeof this&&this)||function(){return this}()||Function("return this")()}).call(this,r(5))},function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){"use strict";var n=r(7),o=r(9),s=r(11),i=r(12),a=r(13),u=r(19),c=r(39),l=r(42),h=Object.getOwnPropertyDescriptor;t.f=n?h:function(e,t){if(e=a(e),t=u(t),l)try{return h(e,t)}catch(e){}if(c(e,t))return i(!o(s.f,e,t),e[t])}},function(e,t,r){"use strict";var n=r(8);e.exports=!n((function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]}))},function(e,t,r){"use strict";e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,r){"use strict";var n=r(10),o=Function.prototype.call;e.exports=n?o.bind(o):function(){return o.apply(o,arguments)}},function(e,t,r){"use strict";var n=r(8);e.exports=!n((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")}))},function(e,t,r){"use strict";var n={}.propertyIsEnumerable,o=Object.getOwnPropertyDescriptor,s=o&&!n.call({1:2},1);t.f=s?function(e){var t=o(this,e);return!!t&&t.enumerable}:n},function(e,t,r){"use strict";e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,r){"use strict";var n=r(14),o=r(17);e.exports=function(e){return n(o(e))}},function(e,t,r){"use strict";var n=r(15),o=r(8),s=r(16),i=Object,a=n("".split);e.exports=o((function(){return!i("z").propertyIsEnumerable(0)}))?function(e){return"String"===s(e)?a(e,""):i(e)}:i},function(e,t,r){"use strict";var n=r(10),o=Function.prototype,s=o.call,i=n&&o.bind.bind(s,s);e.exports=n?i:function(e){return function(){return s.apply(e,arguments)}}},function(e,t,r){"use strict";var n=r(15),o=n({}.toString),s=n("".slice);e.exports=function(e){return s(o(e),8,-1)}},function(e,t,r){"use strict";var n=r(18),o=TypeError;e.exports=function(e){if(n(e))throw new o("Can't call method on "+e);return e}},function(e,t,r){"use strict";e.exports=function(e){return null==e}},function(e,t,r){"use strict";var n=r(20),o=r(23);e.exports=function(e){var t=n(e,"string");return o(t)?t:t+""}},function(e,t,r){"use strict";var n=r(9),o=r(21),s=r(23),i=r(30),a=r(33),u=r(34),c=TypeError,l=u("toPrimitive");e.exports=function(e,t){if(!o(e)||s(e))return e;var r,u=i(e,l);if(u){if(void 0===t&&(t="default"),r=n(u,e,t),!o(r)||s(r))return r;throw new c("Can't convert object to primitive value")}return void 0===t&&(t="number"),a(e,t)}},function(e,t,r){"use strict";var n=r(22);e.exports=function(e){return"object"==typeof e?null!==e:n(e)}},function(e,t,r){"use strict";var n="object"==typeof document&&document.all;e.exports=void 0===n&&void 0!==n?function(e){return"function"==typeof e||e===n}:function(e){return"function"==typeof e}},function(e,t,r){"use strict";var n=r(24),o=r(22),s=r(25),i=r(26),a=Object;e.exports=i?function(e){return"symbol"==typeof e}:function(e){var t=n("Symbol");return o(t)&&s(t.prototype,a(e))}},function(e,t,r){"use strict";var n=r(4),o=r(22),s=function(e){return o(e)?e:void 0};e.exports=function(e,t){return arguments.length<2?s(n[e]):n[e]&&n[e][t]}},function(e,t,r){"use strict";var n=r(15);e.exports=n({}.isPrototypeOf)},function(e,t,r){"use strict";var n=r(27);e.exports=n&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},function(e,t,r){"use strict";var n=r(28),o=r(8),s=r(4).String;e.exports=!!Object.getOwnPropertySymbols&&!o((function(){var e=Symbol("symbol detection");return!s(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&n&&n<41}))},function(e,t,r){"use strict";var n,o,s=r(4),i=r(29),a=s.process,u=s.Deno,c=a&&a.versions||u&&u.version,l=c&&c.v8;l&&(o=(n=l.split("."))[0]>0&&n[0]<4?1:+(n[0]+n[1])),!o&&i&&(!(n=i.match(/Edge\/(\d+)/))||n[1]>=74)&&(n=i.match(/Chrome\/(\d+)/))&&(o=+n[1]),e.exports=o},function(e,t,r){"use strict";e.exports="undefined"!=typeof navigator&&String(navigator.userAgent)||""},function(e,t,r){"use strict";var n=r(31),o=r(18);e.exports=function(e,t){var r=e[t];return o(r)?void 0:n(r)}},function(e,t,r){"use strict";var n=r(22),o=r(32),s=TypeError;e.exports=function(e){if(n(e))return e;throw new s(o(e)+" is not a function")}},function(e,t,r){"use strict";var n=String;e.exports=function(e){try{return n(e)}catch(e){return"Object"}}},function(e,t,r){"use strict";var n=r(9),o=r(22),s=r(21),i=TypeError;e.exports=function(e,t){var r,a;if("string"===t&&o(r=e.toString)&&!s(a=n(r,e)))return a;if(o(r=e.valueOf)&&!s(a=n(r,e)))return a;if("string"!==t&&o(r=e.toString)&&!s(a=n(r,e)))return a;throw new i("Can't convert object to primitive value")}},function(e,t,r){"use strict";var n=r(4),o=r(35),s=r(39),i=r(41),a=r(27),u=r(26),c=n.Symbol,l=o("wks"),h=u?c.for||c:c&&c.withoutSetter||i;e.exports=function(e){return s(l,e)||(l[e]=a&&s(c,e)?c[e]:h("Symbol."+e)),l[e]}},function(e,t,r){"use strict";var n=r(36);e.exports=function(e,t){return n[e]||(n[e]=t||{})}},function(e,t,r){"use strict";var n=r(37),o=r(4),s=r(38),i=e.exports=o["__core-js_shared__"]||s("__core-js_shared__",{});(i.versions||(i.versions=[])).push({version:"3.37.1",mode:n?"pure":"global",copyright:"Â© 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.37.1/LICENSE",source:"https://github.com/zloirock/core-js"})},function(e,t,r){"use strict";e.exports=!1},function(e,t,r){"use strict";var n=r(4),o=Object.defineProperty;e.exports=function(e,t){try{o(n,e,{value:t,configurable:!0,writable:!0})}catch(r){n[e]=t}return t}},function(e,t,r){"use strict";var n=r(15),o=r(40),s=n({}.hasOwnProperty);e.exports=Object.hasOwn||function(e,t){return s(o(e),t)}},function(e,t,r){"use strict";var n=r(17),o=Object;e.exports=function(e){return o(n(e))}},function(e,t,r){"use strict";var n=r(15),o=0,s=Math.random(),i=n(1..toString);e.exports=function(e){return"Symbol("+(void 0===e?"":e)+")_"+i(++o+s,36)}},function(e,t,r){"use strict";var n=r(7),o=r(8),s=r(43);e.exports=!n&&!o((function(){return 7!==Object.defineProperty(s("div"),"a",{get:function(){return 7}}).a}))},function(e,t,r){"use strict";var n=r(4),o=r(21),s=n.document,i=o(s)&&o(s.createElement);e.exports=function(e){return i?s.createElement(e):{}}},function(e,t,r){"use strict";var n=r(7),o=r(45),s=r(12);e.exports=n?function(e,t,r){return o.f(e,t,s(1,r))}:function(e,t,r){return e[t]=r,e}},function(e,t,r){"use strict";var n=r(7),o=r(42),s=r(46),i=r(47),a=r(19),u=TypeError,c=Object.defineProperty,l=Object.getOwnPropertyDescriptor;t.f=n?s?function(e,t,r){if(i(e),t=a(t),i(r),"function"==typeof e&&"prototype"===t&&"value"in r&&"writable"in r&&!r.writable){var n=l(e,t);n&&n.writable&&(e[t]=r.value,r={configurable:"configurable"in r?r.configurable:n.configurable,enumerable:"enumerable"in r?r.enumerable:n.enumerable,writable:!1})}return c(e,t,r)}:c:function(e,t,r){if(i(e),t=a(t),i(r),o)try{return c(e,t,r)}catch(e){}if("get"in r||"set"in r)throw new u("Accessors not supported");return"value"in r&&(e[t]=r.value),e}},function(e,t,r){"use strict";var n=r(7),o=r(8);e.exports=n&&o((function(){return 42!==Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},function(e,t,r){"use strict";var n=r(21),o=String,s=TypeError;e.exports=function(e){if(n(e))return e;throw new s(o(e)+" is not an object")}},function(e,t,r){"use strict";var n=r(22),o=r(45),s=r(49),i=r(38);e.exports=function(e,t,r,a){a||(a={});var u=a.enumerable,c=void 0!==a.name?a.name:t;if(n(r)&&s(r,c,a),a.global)u?e[t]=r:i(t,r);else{try{a.unsafe?e[t]&&(u=!0):delete e[t]}catch(e){}u?e[t]=r:o.f(e,t,{value:r,enumerable:!1,configurable:!a.nonConfigurable,writable:!a.nonWritable})}return e}},function(e,t,r){"use strict";var n=r(15),o=r(8),s=r(22),i=r(39),a=r(7),u=r(50).CONFIGURABLE,c=r(51),l=r(52),h=l.enforce,d=l.get,p=String,m=Object.defineProperty,g=n("".slice),f=n("".replace),E=n([].join),T=a&&!o((function(){return 8!==m((function(){}),"length",{value:8}).length})),y=String(String).split("String"),A=e.exports=function(e,t,r){"Symbol("===g(p(t),0,7)&&(t="["+f(p(t),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),r&&r.getter&&(t="get "+t),r&&r.setter&&(t="set "+t),(!i(e,"name")||u&&e.name!==t)&&(a?m(e,"name",{value:t,configurable:!0}):e.name=t),T&&r&&i(r,"arity")&&e.length!==r.arity&&m(e,"length",{value:r.arity});try{r&&i(r,"constructor")&&r.constructor?a&&m(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch(e){}var n=h(e);return i(n,"source")||(n.source=E(y,"string"==typeof t?t:"")),e};Function.prototype.toString=A((function(){return s(this)&&d(this).source||c(this)}),"toString")},function(e,t,r){"use strict";var n=r(7),o=r(39),s=Function.prototype,i=n&&Object.getOwnPropertyDescriptor,a=o(s,"name"),u=a&&"something"===function(){}.name,c=a&&(!n||n&&i(s,"name").configurable);e.exports={EXISTS:a,PROPER:u,CONFIGURABLE:c}},function(e,t,r){"use strict";var n=r(15),o=r(22),s=r(36),i=n(Function.toString);o(s.inspectSource)||(s.inspectSource=function(e){return i(e)}),e.exports=s.inspectSource},function(e,t,r){"use strict";var n,o,s,i=r(53),a=r(4),u=r(21),c=r(44),l=r(39),h=r(36),d=r(54),p=r(55),m=a.TypeError,g=a.WeakMap;if(i||h.state){var f=h.state||(h.state=new g);f.get=f.get,f.has=f.has,f.set=f.set,n=function(e,t){if(f.has(e))throw new m("Object already initialized");return t.facade=e,f.set(e,t),t},o=function(e){return f.get(e)||{}},s=function(e){return f.has(e)}}else{var E=d("state");p[E]=!0,n=function(e,t){if(l(e,E))throw new m("Object already initialized");return t.facade=e,c(e,E,t),t},o=function(e){return l(e,E)?e[E]:{}},s=function(e){return l(e,E)}}e.exports={set:n,get:o,has:s,enforce:function(e){return s(e)?o(e):n(e,{})},getterFor:function(e){return function(t){var r;if(!u(t)||(r=o(t)).type!==e)throw new m("Incompatible receiver, "+e+" required");return r}}}},function(e,t,r){"use strict";var n=r(4),o=r(22),s=n.WeakMap;e.exports=o(s)&&/native code/.test(String(s))},function(e,t,r){"use strict";var n=r(35),o=r(41),s=n("keys");e.exports=function(e){return s[e]||(s[e]=o(e))}},function(e,t,r){"use strict";e.exports={}},function(e,t,r){"use strict";var n=r(39),o=r(57),s=r(6),i=r(45);e.exports=function(e,t,r){for(var a=o(t),u=i.f,c=s.f,l=0;l<a.length;l++){var h=a[l];n(e,h)||r&&n(r,h)||u(e,h,c(t,h))}}},function(e,t,r){"use strict";var n=r(24),o=r(15),s=r(58),i=r(67),a=r(47),u=o([].concat);e.exports=n("Reflect","ownKeys")||function(e){var t=s.f(a(e)),r=i.f;return r?u(t,r(e)):t}},function(e,t,r){"use strict";var n=r(59),o=r(66).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return n(e,o)}},function(e,t,r){"use strict";var n=r(15),o=r(39),s=r(13),i=r(60).indexOf,a=r(55),u=n([].push);e.exports=function(e,t){var r,n=s(e),c=0,l=[];for(r in n)!o(a,r)&&o(n,r)&&u(l,r);for(;t.length>c;)o(n,r=t[c++])&&(~i(l,r)||u(l,r));return l}},function(e,t,r){"use strict";var n=r(13),o=r(61),s=r(64),i=function(e){return function(t,r,i){var a=n(t),u=s(a);if(0===u)return!e&&-1;var c,l=o(i,u);if(e&&r!=r){for(;u>l;)if((c=a[l++])!=c)return!0}else for(;u>l;l++)if((e||l in a)&&a[l]===r)return e||l||0;return!e&&-1}};e.exports={includes:i(!0),indexOf:i(!1)}},function(e,t,r){"use strict";var n=r(62),o=Math.max,s=Math.min;e.exports=function(e,t){var r=n(e);return r<0?o(r+t,0):s(r,t)}},function(e,t,r){"use strict";var n=r(63);e.exports=function(e){var t=+e;return t!=t||0===t?0:n(t)}},function(e,t,r){"use strict";var n=Math.ceil,o=Math.floor;e.exports=Math.trunc||function(e){var t=+e;return(t>0?o:n)(t)}},function(e,t,r){"use strict";var n=r(65);e.exports=function(e){return n(e.length)}},function(e,t,r){"use strict";var n=r(62),o=Math.min;e.exports=function(e){var t=n(e);return t>0?o(t,9007199254740991):0}},function(e,t,r){"use strict";e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},function(e,t,r){"use strict";t.f=Object.getOwnPropertySymbols},function(e,t,r){"use strict";var n=r(8),o=r(22),s=/#|\.prototype\./,i=function(e,t){var r=u[a(e)];return r===l||r!==c&&(o(t)?n(t):!!t)},a=i.normalize=function(e){return String(e).replace(s,".").toLowerCase()},u=i.data={},c=i.NATIVE="N",l=i.POLYFILL="P";e.exports=i},function(e,t,r){"use strict";var n=r(7),o=r(70),s=TypeError,i=Object.getOwnPropertyDescriptor,a=n&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(e){return e instanceof TypeError}}();e.exports=a?function(e,t){if(o(e)&&!i(e,"length").writable)throw new s("Cannot set read only .length");return e.length=t}:function(e,t){return e.length=t}},function(e,t,r){"use strict";var n=r(16);e.exports=Array.isArray||function(e){return"Array"===n(e)}},function(e,t,r){"use strict";var n=TypeError;e.exports=function(e){if(e>9007199254740991)throw n("Maximum allowed index exceeded");return e}},function(e,t,r){"use strict";t.__esModule=!0,t.WRONG_RANGE_SIZE=t.AbsoluteRowRange=t.AbsoluteColumnRange=t.AbsoluteCellRange=void 0,t.isSimpleCellRange=function(e){return!(!e||"object"!=typeof e&&"function"!=typeof e)&&"start"in e&&(0,n.isSimpleCellAddress)(e.start)&&"end"in e&&(0,n.isSimpleCellAddress)(e.end)},t.simpleCellRange=void 0,r(2);var n=r(73),o=r(147),s=r(77),i=r(141);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
const a=t.WRONG_RANGE_SIZE="AbsoluteCellRange: Wrong range size";t.simpleCellRange=(e,t)=>({start:e,end:t});class u{constructor(e,t){if(e.sheet!==t.sheet)throw new o.SheetsNotEqual(e.sheet,t.sheet);this.start=(0,n.simpleCellAddress)(e.sheet,e.col,e.row),this.end=(0,n.simpleCellAddress)(t.sheet,t.col,t.row)}get sheet(){return this.start.sheet}static fromSimpleCellAddresses(e,t){if(e.sheet!==t.sheet)throw new o.SheetsNotEqual(e.sheet,t.sheet);const r=t.col-e.col,n=t.row-e.row;return Number.isFinite(n)&&Number.isFinite(r)?new u(e,t):Number.isFinite(n)?new l(e.sheet,e.row,t.row):new c(e.sheet,e.col,t.col)}static fromAst(e,t){return e.type===s.AstNodeType.CELL_RANGE?u.fromCellRange(e,t):e.type===s.AstNodeType.COLUMN_RANGE?c.fromColumnRange(e,t):l.fromRowRangeAst(e,t)}static fromAstOrUndef(e,t){try{return u.fromAst(e,t)}catch(e){return}}static fromCellRange(e,t){return new u(e.start.toSimpleCellAddress(t),e.end.toSimpleCellAddress(t))}static spanFrom(e,t,r){const n=u.spanFromOrUndef(e,t,r);if(void 0===n)throw new Error(a);return n}static spanFromOrUndef(e,t,r){if(!Number.isFinite(t)&&Number.isFinite(r)){if(0!==e.col)return;return new l(e.sheet,e.row,e.row+r-1)}if(!Number.isFinite(r)&&Number.isFinite(t)){if(0!==e.row)return;return new c(e.sheet,e.col,e.col+t-1)}if(Number.isFinite(r)&&Number.isFinite(t))return new u(e,(0,n.simpleCellAddress)(e.sheet,e.col+t-1,e.row+r-1))}static fromCoordinates(e,t,r,o,s){return new u((0,n.simpleCellAddress)(e,t,r),(0,n.simpleCellAddress)(e,o,s))}isFinite(){return Number.isFinite(this.size())}doesOverlap(e){return!(this.start.sheet!=e.start.sheet||this.end.row<e.start.row||this.start.row>e.end.row||this.end.col<e.start.col||this.start.col>e.end.col)}addressInRange(e){return this.sheet===e.sheet&&this.start.row<=e.row&&this.end.row>=e.row&&this.start.col<=e.col&&this.end.col>=e.col}columnInRange(e){return this.sheet===e.sheet&&this.start.col<=e.col&&this.end.col>=e.col}rowInRange(e){return this.sheet===e.sheet&&this.start.row<=e.row&&this.end.row>=e.row}containsRange(e){return this.addressInRange(e.start)&&this.addressInRange(e.end)}intersectionWith(e){if(this.sheet!==e.start.sheet)return;const t=Math.max(this.start.row,e.start.row),r=Math.min(this.end.row,e.end.row),o=Math.max(this.start.col,e.start.col),s=Math.min(this.end.col,e.end.col);return t>r||o>s?void 0:new u((0,n.simpleCellAddress)(this.sheet,o,t),(0,n.simpleCellAddress)(this.sheet,s,r))}includesRow(e){return this.start.row<e&&this.end.row>=e}includesColumn(e){return this.start.col<e&&this.end.col>=e}shiftByRows(e){this.start.row+=e,this.end.row+=e}expandByRows(e){this.end.row+=e}shiftByColumns(e){this.start.col+=e,this.end.col+=e}shifted(e,t){return u.spanFrom((0,n.simpleCellAddress)(this.sheet,this.start.col+e,this.start.row+t),this.width(),this.height())}expandByColumns(e){this.end.col+=e}moveToSheet(e){this.start.sheet=e,this.end.sheet=e}removeSpan(e){e instanceof i.RowsSpan?this.removeRows(e.start,e.end):this.removeColumns(e.start,e.end)}shouldBeRemoved(){return this.width()<=0||this.height()<=0}rangeWithSameWidth(e,t){return u.spanFrom((0,n.simpleCellAddress)(this.sheet,this.start.col,e),this.width(),t)}rangeWithSameHeight(e,t){return u.spanFrom((0,n.simpleCellAddress)(this.sheet,e,this.start.row),t,this.height())}toString(){return`${this.start.sheet},${this.start.col},${this.start.row},${this.end.col},${this.end.row}`}width(){return this.end.col-this.start.col+1}height(){return this.end.row-this.start.row+1}size(){return this.height()*this.width()}arrayOfAddressesInRange(){const e=[];for(let t=0;t<this.height();++t){e[t]=[];for(let r=0;r<this.width();++r){const o=(0,n.simpleCellAddress)(this.sheet,this.start.col+r,this.start.row+t);e[t].push(o)}}return e}withStart(e){return new u(e,this.end)}sameDimensionsAs(e){return this.width()===e.width()&&this.height()===e.height()}sameAs(e){return(0,n.equalSimpleCellAddress)(this.start,e.start)&&(0,n.equalSimpleCellAddress)(this.end,e.end)}addressesArrayMap(e,t){const r=[];let o=this.start.row;for(;o<=this.effectiveEndRow(e);){let s=this.start.col;const i=[];for(;s<=this.effectiveEndColumn(e);)i.push(t((0,n.simpleCellAddress)(this.start.sheet,s,o))),s++;r.push(i),o++}return r}addresses(e){const t=[];let r=this.start.row;const o=this.effectiveEndRow(e),s=this.effectiveEndColumn(e);for(;r<=o;){let e=this.start.col;for(;e<=s;)t.push((0,n.simpleCellAddress)(this.start.sheet,e,r)),e++;r++}return t}*addressesWithDirection(e,t,r){if(e>0)if(t>0){let e=this.effectiveEndRow(r);for(;e>=this.start.row;){let t=this.effectiveEndColumn(r);for(;t>=this.start.col;)yield(0,n.simpleCellAddress)(this.start.sheet,t,e),t-=1;e-=1}}else{let e=this.start.row;for(;e<=this.effectiveEndRow(r);){let t=this.effectiveEndColumn(r);for(;t>=this.start.col;)yield(0,n.simpleCellAddress)(this.start.sheet,t,e),t-=1;e+=1}}else if(t>0){let e=this.effectiveEndRow(r);for(;e>=this.start.row;){let t=this.start.col;for(;t<=this.effectiveEndColumn(r);)yield(0,n.simpleCellAddress)(this.start.sheet,t,e),t+=1;e-=1}}else{let e=this.start.row;for(;e<=this.effectiveEndRow(r);){let t=this.start.col;for(;t<=this.effectiveEndColumn(r);)yield(0,n.simpleCellAddress)(this.start.sheet,t,e),t+=1;e+=1}}}getAddress(e,t){if(e<0||t<0||t>this.height()-1||e>this.width()-1)throw Error("Index out of bound");return(0,n.simpleCellAddress)(this.start.sheet,this.start.col+e,this.start.row+t)}exceedsSheetSizeLimits(e,t){return this.end.col>=e||this.end.row>=t}effectiveEndColumn(e){return this.end.col}effectiveEndRow(e){return this.end.row}effectiveWidth(e){return this.width()}effectiveHeight(e){return this.height()}removeRows(e,t){if(!(e>this.end.row)){if(t<this.start.row){const r=t-e+1;return this.shiftByRows(-r)}e<=this.start.row&&(this.start.row=e),this.end.row-=Math.min(t,this.end.row)-e+1}}removeColumns(e,t){if(!(e>this.end.col)){if(t<this.start.col){const r=t-e+1;return this.shiftByColumns(-r)}e<=this.start.col&&(this.start.col=e),this.end.col-=Math.min(t,this.end.col)-e+1}}}t.AbsoluteCellRange=u;class c extends u{constructor(e,t,r){super((0,n.simpleCellAddress)(e,t,0),(0,n.simpleCellAddress)(e,r,Number.POSITIVE_INFINITY))}static fromColumnRange(e,t){const r=e.start.toSimpleColumnAddress(t),n=e.end.toSimpleColumnAddress(t);if(r.sheet!==n.sheet)throw new o.SheetsNotEqual(r.sheet,n.sheet);return new c(r.sheet,r.col,n.col)}shouldBeRemoved(){return this.width()<=0}shiftByRows(e){}expandByRows(e){}shifted(e,t){return new c(this.sheet,this.start.col+e,this.end.col+e)}rangeWithSameHeight(e,t){return new c(this.sheet,e,e+t-1)}exceedsSheetSizeLimits(e,t){return this.end.col>=e}effectiveEndRow(e){return this.effectiveHeight(e)-1}effectiveHeight(e){return e.getSheetHeight(this.sheet)}removeRows(e,t){}}t.AbsoluteColumnRange=c;class l extends u{constructor(e,t,r){super((0,n.simpleCellAddress)(e,0,t),(0,n.simpleCellAddress)(e,Number.POSITIVE_INFINITY,r))}static fromRowRangeAst(e,t){const r=e.start.toSimpleRowAddress(t),n=e.end.toSimpleRowAddress(t);if(r.sheet!==n.sheet)throw new o.SheetsNotEqual(r.sheet,n.sheet);return new l(r.sheet,r.row,n.row)}shouldBeRemoved(){return this.height()<=0}shiftByColumns(e){}expandByColumns(e){}shifted(e,t){return new l(this.sheet,this.start.row+t,this.end.row+t)}rangeWithSameWidth(e,t){return new l(this.sheet,e,e+t-1)}exceedsSheetSizeLimits(e,t){return this.end.row>=t}effectiveEndColumn(e){return this.effectiveWidth(e)-1}effectiveWidth(e){return e.getSheetWidth(this.sheet)}removeColumns(e,t){}}t.AbsoluteRowRange=l},function(e,t,r){"use strict";t.__esModule=!0,t.invalidSimpleRowAddress=t.invalidSimpleColumnAddress=t.invalidSimpleCellAddress=t.getCellValueType=t.getCellValueFormat=t.getCellValueDetailedType=t.getCellType=t.equalSimpleCellAddress=t.addressKey=t.absoluteSheetReference=t.ErrorType=t.CellValueTypeOrd=t.CellValueType=t.CellValueNoNumber=t.CellValueJustNumber=t.CellValueDetailedType=t.CellType=t.CellError=void 0,t.isSimpleCellAddress=function(e){var t,r,n;return e&&("object"==typeof e||"function"==typeof e)&&"number"==typeof(null===(t=e)||void 0===t?void 0:t.sheet)&&"number"==typeof(null===(r=e)||void 0===r?void 0:r.col)&&"number"==typeof(null===(n=e)||void 0===n?void 0:n.row)},t.simpleRowAddress=t.simpleColumnAddress=t.simpleCellAddress=t.movedSimpleCellAddress=void 0;var n,o,s,i,a=r(74),u=r(131),c=r(140),l=r(139);!function(e){e.DIV_BY_ZERO="DIV_BY_ZERO",e.NAME="NAME",e.VALUE="VALUE",e.NUM="NUM",e.NA="NA",e.CYCLE="CYCLE",e.REF="REF",e.SPILL="SPILL",e.LIC="LIC",e.ERROR="ERROR"}(n||(t.ErrorType=n={})),function(e){e.FORMULA="FORMULA",e.VALUE="VALUE",e.ARRAY="ARRAY",e.EMPTY="EMPTY",e.ARRAYFORMULA="ARRAYFORMULA"}(o||(t.CellType=o={})),t.getCellType=(e,t)=>e instanceof a.ArrayVertex?e.isLeftCorner(t)?o.ARRAYFORMULA:o.ARRAY:e instanceof a.FormulaCellVertex||e instanceof a.ParsingErrorVertex?o.FORMULA:e instanceof a.ValueCellVertex?o.VALUE:o.EMPTY,function(e){e.EMPTY="EMPTY",e.NUMBER="NUMBER",e.STRING="STRING",e.BOOLEAN="BOOLEAN",e.ERROR="ERROR"}(s||(t.CellValueNoNumber=s={})),function(e){e.NUMBER="NUMBER"}(i||(t.CellValueJustNumber=i={}));const h=t.CellValueType=Object.assign(Object.assign({},s),i);t.CellValueDetailedType=Object.assign(Object.assign({},s),c.NumberType),t.CellValueTypeOrd=e=>{switch(e){case h.EMPTY:return 0;case h.NUMBER:return 1;case h.STRING:return 2;case h.BOOLEAN:return 3;case h.ERROR:return 4}throw new Error("Cell value not computed")};const d=e=>{if(e===c.EmptyValue)return h.EMPTY;if(e instanceof p||e instanceof l.SimpleRangeValue)return h.ERROR;if("string"==typeof e)return h.STRING;if((0,c.isExtendedNumber)(e))return h.NUMBER;if("boolean"==typeof e)return h.BOOLEAN;throw new Error("Cell value not computed")};t.getCellValueType=d,t.getCellValueDetailedType=e=>(0,c.isExtendedNumber)(e)?(0,c.getTypeOfExtendedNumber)(e):d(e),t.getCellValueFormat=e=>(0,c.isExtendedNumber)(e)?(0,c.getFormatOfExtendedNumber)(e):void 0;class p{constructor(e,t,r){this.type=e,this.message=t,this.root=r}static parsingError(e){return new p(n.ERROR,`${u.ErrorMessage.ParseError}${e?" "+e:""}`)}attachRootVertex(e){return void 0===this.root?new p(this.type,this.message,e):this}}t.CellError=p,t.simpleRowAddress=(e,t)=>({sheet:e,row:t}),t.invalidSimpleRowAddress=e=>e.row<0,t.simpleColumnAddress=(e,t)=>({sheet:e,col:t}),t.invalidSimpleColumnAddress=e=>e.col<0;const m=(e,t,r)=>({sheet:e,col:t,row:r});t.simpleCellAddress=m,t.invalidSimpleCellAddress=e=>e.col<0||e.row<0,t.movedSimpleCellAddress=(e,t,r,n)=>m(t,e.col+r,e.row+n),t.addressKey=e=>`${e.sheet},${e.row},${e.col}`,t.absoluteSheetReference=(e,t)=>{var r;return null!==(r=e.sheet)&&void 0!==r?r:t.sheet},t.equalSimpleCellAddress=(e,t)=>e.sheet===t.sheet&&e.col===t.col&&e.row===t.row},function(e,t,r){"use strict";t.__esModule=!0,t.ValueCellVertex=t.TopSort=t.SparseStrategy=t.SheetMapping=t.RangeVertex=t.RangeMapping=t.ParsingErrorVertex=t.Graph=t.FormulaCellVertex=t.EmptyCellVertex=t.DependencyGraph=t.DenseStrategy=t.ArrayVertex=t.ArrayMapping=t.AddressMapping=void 0;var n=r(75);t.DependencyGraph=n.DependencyGraph;var o=r(146);t.AddressMapping=o.AddressMapping;var s=r(153);t.Graph=s.Graph;var i=r(154);t.TopSort=i.TopSort;var a=r(156);t.RangeMapping=a.RangeMapping;var u=r(157);t.SheetMapping=u.SheetMapping;var c=r(148);t.ArrayMapping=c.ArrayMapping;var l=r(150);t.FormulaCellVertex=l.FormulaCellVertex,t.ArrayVertex=l.ArrayVertex;var h=r(160);t.EmptyCellVertex=h.EmptyCellVertex;var d=r(161);t.ValueCellVertex=d.ValueCellVertex;var p=r(162);t.ParsingErrorVertex=p.ParsingErrorVertex;var m=r(152);t.RangeVertex=m.RangeVertex;var g=r(163);t.SparseStrategy=g.SparseStrategy;var f=r(164);t.DenseStrategy=f.DenseStrategy},function(e,t,r){"use strict";t.__esModule=!0,t.DependencyGraph=void 0,r(2);var n=r(72),o=r(76),s=r(73),i=r(138),a=r(131),u=r(140),c=r(139),l=r(77),h=r(141),d=r(142),p=r(74),m=r(146),g=r(148),f=r(149),E=r(150),T=r(153),y=r(156),A=r(157);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
class R{constructor(e,t,r,a,u,c,h,d){this.addressMapping=e,this.rangeMapping=t,this.sheetMapping=r,this.arrayMapping=a,this.stats=u,this.lazilyTransformingAstService=c,this.functionRegistry=h,this.namedExpressions=d,this.changes=i.ContentChanges.empty(),this.dependencyQueryAddresses=e=>{if(e instanceof p.RangeVertex)return this.rangeDependencyQuery(e).map(([e,t])=>e);{const t=this.formulaDependencyQuery(e);if(void 0!==t){const[e,r]=t;return r.map(t=>t instanceof l.NamedExpressionDependency?this.namedExpressions.namedExpressionOrPlaceholder(t.name,e.sheet).address:(0,s.isSimpleCellAddress)(t)?t:(0,n.simpleCellRange)(t.start,t.end))}return[]}},this.dependencyQueryVertices=e=>{if(e instanceof p.RangeVertex)return this.rangeDependencyQuery(e);{const t=this.formulaDependencyQuery(e);if(void 0!==t){const[e,r]=t;return r.map(t=>{if(t instanceof n.AbsoluteCellRange)return[t.start,this.rangeMapping.fetchRange(t.start,t.end)];if(t instanceof l.NamedExpressionDependency){const r=this.namedExpressions.namedExpressionOrPlaceholder(t.name,e.sheet);return[r.address,this.addressMapping.fetchCell(r.address)]}return[t,this.addressMapping.fetchCell(t)]})}return[]}},this.rangeDependencyQuery=e=>{const t=[],{smallerRangeVertex:r,restRange:o}=this.rangeMapping.findSmallerRange(e.range);let s;void 0!==r&&this.graph.adjacentNodes(r).has(e)?(s=o,t.push([new n.AbsoluteCellRange(r.start,r.end),r])):s=e.range;for(const e of s.addresses(this)){const r=this.addressMapping.getCell(e);void 0!==r&&t.push([e,r])}return t},this.formulaDependencyQuery=e=>{let t,r;if(!(e instanceof E.FormulaVertex))return;r=e.getAddress(this.lazilyTransformingAstService),t=e.getFormula(this.lazilyTransformingAstService);const n=(0,l.collectDependencies)(t,this.functionRegistry);return[r,(0,o.absolutizeDependencies)(n,r)]},this.graph=new T.Graph(this.dependencyQueryVertices)}static buildEmpty(e,t,r,n,o){return new R(new m.AddressMapping(t.chooseAddressMappingPolicy),new y.RangeMapping,new A.SheetMapping(t.translationPackage),new g.ArrayMapping,o,e,r,n)}setFormulaToCell(e,t,r,n,o,s){const i=E.FormulaVertex.fromAst(t,e,n,this.lazilyTransformingAstService.version());return this.exchangeOrAddFormulaVertex(i),this.processCellDependencies(r,i),this.graph.markNodeAsDirty(i),o&&this.markAsVolatile(i),s&&this.markAsDependentOnStructureChange(i),this.correctInfiniteRangesDependency(e),this.getAndClearContentChanges()}setParsingErrorToCell(e,t){const r=this.shrinkPossibleArrayAndGetCell(e);return this.exchangeOrAddGraphNode(r,t),this.addressMapping.setCell(e,t),this.graph.markNodeAsDirty(t),this.correctInfiniteRangesDependency(e),this.getAndClearContentChanges()}setValueToCell(e,t){const r=this.shrinkPossibleArrayAndGetCell(e);if(r instanceof p.ArrayVertex&&this.arrayMapping.removeArray(r.getRange()),r instanceof p.ValueCellVertex)r.getValues().rawValue!==t.rawValue&&(r.setValues(t),this.graph.markNodeAsDirty(r));else{const n=new p.ValueCellVertex(t.parsedValue,t.rawValue);this.exchangeOrAddGraphNode(r,n),this.addressMapping.setCell(e,n),this.graph.markNodeAsDirty(n)}return this.correctInfiniteRangesDependency(e),this.getAndClearContentChanges()}setCellEmpty(e){const t=this.shrinkPossibleArrayAndGetCell(e);if(void 0===t)return i.ContentChanges.empty();if(this.graph.adjacentNodes(t).size>0){const r=new p.EmptyCellVertex;this.exchangeGraphNode(t,r),0===this.graph.adjacentNodesCount(r)?(this.removeVertex(r),this.addressMapping.removeCell(e)):(this.graph.markNodeAsDirty(r),this.addressMapping.setCell(e,r))}else this.removeVertex(t),this.addressMapping.removeCell(e);return this.getAndClearContentChanges()}clearDirtyVertices(){this.graph.clearDirtyNodes()}verticesToRecompute(){return this.graph.getDirtyAndVolatileNodes()}processCellDependencies(e,t){const r=this.graph.getNodeId(t);e.forEach(e=>{if(e instanceof n.AbsoluteCellRange){const t=e;let n=this.getRange(t.start,t.end);void 0===n&&(n=new p.RangeVertex(t),this.rangeMapping.setRange(n)),this.graph.addNodeAndReturnId(n);const o=this.graph.getNodeId(n);t.isFinite()||this.graph.markNodeAsInfiniteRange(o);const{smallerRangeVertex:s,restRange:i}=this.rangeMapping.findSmallerRange(t);if(void 0!==s){if(this.graph.addEdge(s,o),n.bruteForce){n.bruteForce=!1;for(const e of t.addresses(this))this.graph.removeEdge(this.fetchCell(e),o)}}else n.bruteForce=!0;const a=this.arrayMapping.getArray(i);if(void 0!==a)this.graph.addEdge(a,o);else for(const e of i.addresses(this)){const{vertex:t,id:r}=this.fetchCellOrCreateEmpty(e);this.graph.addEdge(null!=r?r:t,o)}this.graph.addEdge(o,r),t.isFinite()&&this.correctInfiniteRangesDependenciesByRangeVertex(n)}else if(e instanceof l.NamedExpressionDependency){const n=t.getAddress(this.lazilyTransformingAstService).sheet,{vertex:o,id:s}=this.fetchNamedExpressionVertex(e.name,n);this.graph.addEdge(null!=s?s:o,r)}else{const{vertex:t,id:n}=this.fetchCellOrCreateEmpty(e);this.graph.addEdge(null!=n?n:t,r)}})}fetchNamedExpressionVertex(e,t){const r=this.namedExpressions.namedExpressionOrPlaceholder(e,t);return this.fetchCellOrCreateEmpty(r.address)}exchangeNode(e,t){const r=this.fetchCellOrCreateEmpty(e).vertex,n=this.fetchCellOrCreateEmpty(t).vertex;this.addressMapping.removeCell(e),this.exchangeGraphNode(r,n)}fetchCellOrCreateEmpty(e){const t=this.addressMapping.getCell(e);if(void 0!==t)return{vertex:t,id:void 0};const r=new p.EmptyCellVertex,n=this.graph.addNodeAndReturnId(r);return this.addressMapping.setCell(e,r),{vertex:r,id:n}}removeRows(e){this.stats.measure(d.StatType.ADJUSTING_GRAPH,()=>{for(const[t,r]of this.addressMapping.entriesFromRowsSpan(e)){for(const e of this.graph.adjacentNodes(r))this.graph.markNodeAsDirty(e);if(r instanceof p.ArrayVertex){if(!r.isLeftCorner(t))continue;this.shrinkArrayToCorner(r),this.arrayMapping.removeArray(r.getRange())}this.removeVertex(r)}}),this.stats.measure(d.StatType.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.removeRows(e)});const t=this.stats.measure(d.StatType.ADJUSTING_RANGES,()=>{const t=this.truncateRanges(e,e=>e.row);return this.getArrayVerticesRelatedToRanges(t)});return this.stats.measure(d.StatType.ADJUSTING_ARRAY_MAPPING,()=>{this.fixArraysAfterRemovingRows(e.sheet,e.rowStart,e.numberOfRows)}),this.addStructuralNodesToChangeSet(),{affectedArrays:t,contentChanges:this.getAndClearContentChanges()}}removeSheet(e){this.clearSheet(e);for(const[t,r]of this.addressMapping.sheetEntries(e)){for(const e of this.graph.adjacentNodes(r))this.graph.markNodeAsDirty(e);this.removeVertex(r),this.addressMapping.removeCell(t)}this.stats.measure(d.StatType.ADJUSTING_RANGES,()=>{const t=this.rangeMapping.removeRangesInSheet(e);for(const e of t)this.removeVertex(e);this.stats.measure(d.StatType.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.removeSheet(e)})})}clearSheet(e){const t=new Set;for(const[r,n]of this.addressMapping.sheetEntries(e))n instanceof p.ArrayVertex?t.add(n):this.setCellEmpty(r);for(const e of t.values())this.setArrayEmpty(e);this.addStructuralNodesToChangeSet()}removeColumns(e){this.stats.measure(d.StatType.ADJUSTING_GRAPH,()=>{for(const[t,r]of this.addressMapping.entriesFromColumnsSpan(e)){for(const e of this.graph.adjacentNodes(r))this.graph.markNodeAsDirty(e);if(r instanceof p.ArrayVertex){if(!r.isLeftCorner(t))continue;this.shrinkArrayToCorner(r),this.arrayMapping.removeArray(r.getRange())}this.removeVertex(r)}}),this.stats.measure(d.StatType.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.removeColumns(e)});const t=this.stats.measure(d.StatType.ADJUSTING_RANGES,()=>{const t=this.truncateRanges(e,e=>e.col);return this.getArrayVerticesRelatedToRanges(t)});return this.stats.measure(d.StatType.ADJUSTING_ARRAY_MAPPING,()=>this.fixArraysAfterRemovingColumns(e.sheet,e.columnStart,e.numberOfColumns)),this.addStructuralNodesToChangeSet(),{affectedArrays:t,contentChanges:this.getAndClearContentChanges()}}addRows(e){this.stats.measure(d.StatType.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.addRows(e.sheet,e.rowStart,e.numberOfRows)});const t=this.stats.measure(d.StatType.ADJUSTING_RANGES,()=>{const t=this.rangeMapping.moveAllRangesInSheetAfterRowByRows(e.sheet,e.rowStart,e.numberOfRows);return this.fixRangesWhenAddingRows(e.sheet,e.rowStart,e.numberOfRows),this.getArrayVerticesRelatedToRanges(t.verticesWithChangedSize)});this.stats.measure(d.StatType.ADJUSTING_ARRAY_MAPPING,()=>{this.fixArraysAfterAddingRow(e.sheet,e.rowStart,e.numberOfRows)});for(const t of this.addressMapping.verticesFromRowsSpan(e))this.graph.markNodeAsDirty(t);return this.addStructuralNodesToChangeSet(),{affectedArrays:t}}addColumns(e){this.stats.measure(d.StatType.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.addColumns(e.sheet,e.columnStart,e.numberOfColumns)});const t=this.stats.measure(d.StatType.ADJUSTING_RANGES,()=>{const t=this.rangeMapping.moveAllRangesInSheetAfterColumnByColumns(e.sheet,e.columnStart,e.numberOfColumns);return this.fixRangesWhenAddingColumns(e.sheet,e.columnStart,e.numberOfColumns),this.getArrayVerticesRelatedToRanges(t.verticesWithChangedSize)});this.stats.measure(d.StatType.ADJUSTING_ARRAY_MAPPING,()=>this.fixArraysAfterAddingColumn(e.sheet,e.columnStart,e.numberOfColumns));for(const t of this.addressMapping.verticesFromColumnsSpan(e))this.graph.markNodeAsDirty(t);return this.addStructuralNodesToChangeSet(),{affectedArrays:t,contentChanges:this.getAndClearContentChanges()}}isThereSpaceForArray(e){const t=e.getRangeOrUndef();if(void 0===t)return!1;for(const r of t.addresses(this)){const t=this.addressMapping.getCell(r);if(void 0!==t&&!(t instanceof p.EmptyCellVertex)&&t!==e)return!1}return!0}moveCells(e,t,r,n){for(const o of e.addressesWithDirection(t,r,this)){const i=(0,s.simpleCellAddress)(n,o.col+t,o.row+r);let a=this.addressMapping.getCell(o);const u=this.addressMapping.getCell(i);if(this.addressMapping.removeCell(o),void 0!==a){this.graph.markNodeAsDirty(a),this.addressMapping.setCell(i,a);let t=void 0;for(const r of this.graph.adjacentNodes(a))r instanceof p.RangeVertex&&!e.containsRange(r.range)&&(t=null!=t?t:this.fetchCellOrCreateEmpty(o).vertex,this.graph.addEdge(t,r),this.graph.removeEdge(a,r));t&&(this.graph.markNodeAsDirty(t),this.addressMapping.setCell(o,t))}if(void 0!==u){void 0===a&&this.addressMapping.removeCell(i);for(const e of this.graph.adjacentNodes(u))a=null!=a?a:this.fetchCellOrCreateEmpty(i).vertex,this.graph.addEdge(a,e),this.graph.markNodeAsDirty(a);this.removeVertex(u)}}for(const t of this.rangeMapping.rangeVerticesContainedInRange(e))for(const r of this.graph.adjacentNodes(t))if(r instanceof p.RangeVertex&&!e.containsRange(r.range)){this.graph.removeEdge(t,r);for(const e of t.range.addresses(this)){const{vertex:t,id:n}=this.fetchCellOrCreateEmpty(e);this.graph.addEdge(null!=n?n:t,r),this.addressMapping.setCell(e,t),this.graph.markNodeAsDirty(t)}}this.rangeMapping.moveRangesInsideSourceRange(e,t,r,n)}setArrayEmpty(e){const t=n.AbsoluteCellRange.spanFrom(e.getAddress(this.lazilyTransformingAstService),e.width,e.height),r=this.graph.adjacentNodes(e);for(const e of t.addresses(this))this.addressMapping.removeCell(e);for(const t of r.values()){const r=(0,f.collectAddressesDependentToRange)(this.functionRegistry,t,e.getRange(),this.lazilyTransformingAstService,this);for(const e of r){const{vertex:r,id:n}=this.fetchCellOrCreateEmpty(e);this.graph.addEdge(null!=n?n:r,t)}r.length>0&&this.graph.markNodeAsDirty(t)}this.removeVertex(e),this.arrayMapping.removeArray(e.getRange())}addVertex(e,t){this.graph.addNodeAndReturnId(t),this.addressMapping.setCell(e,t)}addArrayVertex(e,t){this.graph.addNodeAndReturnId(t),this.setAddressMappingForArrayVertex(t,e)}*arrayFormulaNodes(){for(const e of this.graph.getNodes())e instanceof p.ArrayVertex&&(yield e)}*entriesFromRowsSpan(e){yield*this.addressMapping.entriesFromRowsSpan(e)}*entriesFromColumnsSpan(e){yield*this.addressMapping.entriesFromColumnsSpan(e)}fetchCell(e){return this.addressMapping.fetchCell(e)}getCell(e){return this.addressMapping.getCell(e)}getCellValue(e){return this.addressMapping.getCellValue(e)}getRawValue(e){return this.addressMapping.getRawValue(e)}getScalarValue(e){const t=this.addressMapping.getCellValue(e);return t instanceof c.SimpleRangeValue?new s.CellError(s.ErrorType.VALUE,a.ErrorMessage.ScalarExpected):t}existsEdge(e,t){return this.graph.existsEdge(e,t)}getSheetId(e){return this.sheetMapping.fetch(e)}getSheetHeight(e){return this.addressMapping.getHeight(e)}getSheetWidth(e){return this.addressMapping.getWidth(e)}getArray(e){return this.arrayMapping.getArray(e)}getRange(e,t){return this.rangeMapping.getRange(e,t)}topSortWithScc(){return this.graph.topSortWithScc()}markAsVolatile(e){this.graph.markNodeAsVolatile(e)}markAsDependentOnStructureChange(e){this.graph.markNodeAsChangingWithStructure(e)}forceApplyPostponedTransformations(){for(const e of this.graph.getNodes())e instanceof p.FormulaCellVertex&&e.ensureRecentData(this.lazilyTransformingAstService)}*rawValuesFromRange(e){for(const t of e.addresses(this)){const e=this.getScalarValue(t);e!==u.EmptyValue&&(yield[(0,u.getRawValue)(e),t])}}computeListOfValuesInRange(e){const t=[];for(const r of e.addresses(this)){const e=this.getScalarValue(r);t.push(e)}return t}shrinkArrayToCorner(e){this.cleanAddressMappingUnderArray(e);for(const t of this.adjacentArrayVertices(e)){let r;r=t instanceof E.FormulaVertex?this.formulaDirectDependenciesToArray(t,e):this.rangeDirectDependenciesToArray(t,e);let n=!1;for(const[o,s]of r)e.isLeftCorner(o)&&(n=!0),this.graph.addEdge(s,t),this.graph.markNodeAsDirty(s);n||this.graph.removeEdge(e,t)}this.graph.markNodeAsDirty(e)}isArrayInternalCell(e){const t=this.getCell(e);return t instanceof p.ArrayVertex&&!t.isLeftCorner(e)}getAndClearContentChanges(){const e=this.changes;return this.changes=i.ContentChanges.empty(),e}getAdjacentNodesAddresses(e){const t=this.graph.adjacentNodes(e),r=[];return t.forEach(e=>{const t=e;t instanceof p.RangeVertex?r.push((0,n.simpleCellRange)(t.start,t.end)):r.push(t.getAddress(this.lazilyTransformingAstService))}),r}exchangeGraphNode(e,t){this.graph.addNodeAndReturnId(t);const r=this.graph.adjacentNodes(e);this.removeVertex(e),r.forEach(e=>{this.graph.hasNode(e)&&this.graph.addEdge(t,e)})}setArray(e,t){this.arrayMapping.setArray(e,t)}correctInfiniteRangesDependency(e){const t=this.graph.getInfiniteRanges().filter(({node:t})=>t.range.addressInRange(e));if(t.length<=0)return;const{vertex:r,id:n}=this.fetchCellOrCreateEmpty(e),o=null!=n?n:this.graph.getNodeId(r);t.forEach(({id:e})=>{this.graph.addEdge(o,e)})}exchangeOrAddGraphNode(e,t){e?this.exchangeGraphNode(e,t):this.graph.addNodeAndReturnId(t)}getArrayVerticesRelatedToRanges(e){const t=new Set;return e.forEach(e=>{this.graph.hasNode(e)&&this.graph.adjacentNodes(e).forEach(e=>{e instanceof p.ArrayVertex&&t.add(e)})}),t}correctInfiniteRangesDependenciesByRangeVertex(e){this.graph.getInfiniteRanges().forEach(({id:t,node:r})=>{const n=e.range.intersectionWith(r.range);void 0!==n&&n.addresses(this).forEach(e=>{const{vertex:r,id:n}=this.fetchCellOrCreateEmpty(e);this.graph.addEdge(null!=n?n:r,t)})})}cleanAddressMappingUnderArray(e){const t=e.getRange();for(const r of t.addresses(this)){const t=e.getArrayCellValue(r);this.getCell(r)===e?e.isLeftCorner(r)?this.changes.addChange(new s.CellError(s.ErrorType.REF),r,t):(this.addressMapping.removeCell(r),this.changes.addChange(u.EmptyValue,r,t)):this.changes.addChange(u.EmptyValue,r,t)}}*formulaDirectDependenciesToArray(e,t){var r;const[,o]=null!==(r=this.formulaDependencyQuery(e))&&void 0!==r?r:[];if(void 0!==o)for(const e of o)if(!(e instanceof l.NamedExpressionDependency||e instanceof n.AbsoluteCellRange)&&t.getRange().addressInRange(e)){const t=this.fetchCellOrCreateEmpty(e).vertex;yield[e,t]}}*rangeDirectDependenciesToArray(e,t){const{restRange:r}=this.rangeMapping.findSmallerRange(e.range);for(const e of r.addresses(this))if(t.getRange().addressInRange(e)){const t=this.fetchCellOrCreateEmpty(e).vertex;yield[e,t]}}*adjacentArrayVertices(e){const t=this.graph.adjacentNodes(e);for(const e of t)(e instanceof E.FormulaVertex||e instanceof p.RangeVertex)&&(yield e)}addStructuralNodesToChangeSet(){this.graph.markChangingWithStructureNodesAsDirty()}fixRangesWhenAddingRows(e,t,r){const o=Array.from(this.rangeMapping.rangesInSheet(e));for(const e of o)if(e.range.includesRow(t+r))if(e.bruteForce){const n=e.range.rangeWithSameWidth(t,r);for(const t of n.addresses(this)){const{vertex:r,id:n}=this.fetchCellOrCreateEmpty(t);this.graph.addEdge(null!=n?n:r,e)}}else{let t=e,r=this.rangeMapping.findSmallerRange(t.range);if(void 0!==r.smallerRangeVertex)continue;for(;void 0===r.smallerRangeVertex;){const e=new p.RangeVertex(n.AbsoluteCellRange.spanFrom(t.range.start,t.range.width(),t.range.height()-1));this.rangeMapping.setRange(e),this.graph.addNodeAndReturnId(e);const o=new n.AbsoluteCellRange((0,s.simpleCellAddress)(t.range.start.sheet,t.range.start.col,t.range.end.row),t.range.end);this.addAllFromRange(o,t),this.graph.addEdge(e,t),t=e,r=this.rangeMapping.findSmallerRange(t.range)}this.graph.addEdge(r.smallerRangeVertex,t),this.addAllFromRange(r.restRange,t),this.graph.removeEdge(r.smallerRangeVertex,e)}}addAllFromRange(e,t){for(const r of e.addresses(this)){const{vertex:e,id:n}=this.fetchCellOrCreateEmpty(r);this.graph.addEdge(null!=n?n:e,t)}}fixRangesWhenAddingColumns(e,t,r){for(const o of this.rangeMapping.rangesInSheet(e))if(o.range.includesColumn(t+r)){let i;i=o.bruteForce?o.range.rangeWithSameHeight(t,r):n.AbsoluteCellRange.spanFrom((0,s.simpleCellAddress)(e,t,o.range.end.row),r,1);for(const e of i.addresses(this)){const{vertex:t,id:r}=this.fetchCellOrCreateEmpty(e);this.graph.addEdge(null!=r?r:t,o)}}}exchangeOrAddFormulaVertex(e){const t=e.getAddress(this.lazilyTransformingAstService),r=n.AbsoluteCellRange.spanFrom(t,e.width,e.height),o=this.shrinkPossibleArrayAndGetCell(t);if(e instanceof p.ArrayVertex&&this.setArray(r,e),this.exchangeOrAddGraphNode(o,e),this.addressMapping.setCell(t,e),e instanceof p.ArrayVertex){if(!this.isThereSpaceForArray(e))return;for(const t of r.addresses(this)){if(e.isLeftCorner(t))continue;const r=this.getCell(t);this.exchangeOrAddGraphNode(r,e)}}for(const t of r.addresses(this))this.addressMapping.setCell(t,e)}setAddressMappingForArrayVertex(e,t){if(this.addressMapping.setCell(t,e),!(e instanceof p.ArrayVertex))return;const r=n.AbsoluteCellRange.spanFromOrUndef(t,e.width,e.height);if(void 0!==r&&(this.setArray(r,e),this.isThereSpaceForArray(e)))for(const t of r.addresses(this))this.addressMapping.setCell(t,e)}truncateRanges(e,t){const{verticesToRemove:r,verticesToMerge:n,verticesWithChangedSize:o}=this.rangeMapping.truncateRanges(e,t);for(const[e,t]of n)this.mergeRangeVertices(e,t);for(const e of r)this.removeVertexAndCleanupDependencies(e);return o}fixArraysAfterAddingRow(e,t,r){if(this.arrayMapping.moveArrayVerticesAfterRowByRows(e,t,r),!(t<=0))for(const[,n]of this.arrayMapping.arraysInRows(h.RowsSpan.fromRowStartAndEnd(e,t-1,t-1))){const o=n.getRange();for(let i=o.start.col;i<=o.end.col;++i)for(let a=t;a<=o.end.row;++a){const t=(0,s.simpleCellAddress)(e,i,a),o=(0,s.simpleCellAddress)(e,i,a+r),c=n.getArrayCellValue(t);this.addressMapping.moveCell(o,t),this.changes.addChange(u.EmptyValue,o,c)}}}fixArraysAfterRemovingRows(e,t,r){if(this.arrayMapping.moveArrayVerticesAfterRowByRows(e,t,-r),!(t<=0))for(const[,r]of this.arrayMapping.arraysInRows(h.RowsSpan.fromRowStartAndEnd(e,t-1,t-1)))if(this.isThereSpaceForArray(r))for(const e of r.getRange().addresses(this))this.addressMapping.setCell(e,r);else this.setNoSpaceIfArray(r)}fixArraysAfterAddingColumn(e,t,r){if(this.arrayMapping.moveArrayVerticesAfterColumnByColumns(e,t,r),!(t<=0))for(const[,n]of this.arrayMapping.arraysInCols(h.ColumnsSpan.fromColumnStartAndEnd(e,t-1,t-1))){const o=n.getRange();for(let i=o.start.row;i<=o.end.row;++i)for(let a=t;a<=o.end.col;++a){const t=(0,s.simpleCellAddress)(e,a,i),o=(0,s.simpleCellAddress)(e,a+r,i),c=n.getArrayCellValue(t);this.addressMapping.moveCell(o,t),this.changes.addChange(u.EmptyValue,o,c)}}}fixArraysAfterRemovingColumns(e,t,r){if(this.arrayMapping.moveArrayVerticesAfterColumnByColumns(e,t,-r),!(t<=0))for(const[,r]of this.arrayMapping.arraysInCols(h.ColumnsSpan.fromColumnStartAndEnd(e,t-1,t-1)))if(this.isThereSpaceForArray(r))for(const e of r.getRange().addresses(this))this.addressMapping.setCell(e,r);else this.setNoSpaceIfArray(r)}shrinkPossibleArrayAndGetCell(e){const t=this.getCell(e);return t instanceof p.ArrayVertex?(this.setNoSpaceIfArray(t),this.getCell(e)):t}setNoSpaceIfArray(e){e instanceof p.ArrayVertex&&(this.shrinkArrayToCorner(e),e.setNoSpace())}removeVertex(e){this.removeVertexAndCleanupDependencies(e),e instanceof p.RangeVertex&&this.rangeMapping.removeRange(e)}mergeRangeVertices(e,t){const r=this.graph.adjacentNodes(t);this.removeVertexAndCleanupDependencies(t),this.graph.removeEdgeIfExists(e,t),r.forEach(t=>{this.graph.hasNode(t)&&this.graph.addEdge(e,t)})}removeVertexAndCleanupDependencies(e){const t=new Set(this.graph.removeNode(e));for(;t.size>0;){const e=t.values().next().value;t.delete(e);const[r,n]=e;this.graph.hasNode(n)&&0===this.graph.adjacentNodesCount(n)&&((n instanceof p.RangeVertex||n instanceof p.EmptyCellVertex)&&this.graph.removeNode(n).forEach(e=>t.add(e)),n instanceof p.RangeVertex?this.rangeMapping.removeRange(n):n instanceof p.EmptyCellVertex&&this.addressMapping.removeCell(r))}}}t.DependencyGraph=R},function(e,t,r){"use strict";t.__esModule=!0,t.filterDependenciesOutOfScope=t.absolutizeDependencies=void 0;var n=r(72),o=r(73),s=r(77);t.absolutizeDependencies=(e,t)=>e.map(e=>e.absolutize(t)),t.filterDependenciesOutOfScope=e=>e.filter(e=>e instanceof s.NamedExpressionDependency||(e instanceof n.AbsoluteCellRange?!((0,o.invalidSimpleCellAddress)(e.start)||(0,o.invalidSimpleCellAddress)(e.end)):!(0,o.invalidSimpleCellAddress)(e)))},function(e,t,r){"use strict";t.__esModule=!0,t.simpleCellRangeToString=t.simpleCellRangeFromString=t.simpleCellAddressToString=t.simpleCellAddressFromString=t.collectDependencies=t.cellAddressFromString=t.buildProcedureAst=t.buildParsingErrorAst=t.buildLexerConfig=t.buildCellRangeAst=t.buildCellErrorAst=t.Unparser=t.RowRangeDependency=t.ParsingErrorType=t.ParserWithCaching=t.NamedExpressionDependency=t.FormulaLexer=t.ColumnRangeDependency=t.CellRangeDependency=t.CellAddress=t.AstNodeType=t.AddressDependency=void 0;var n=r(78);t.cellAddressFromString=n.cellAddressFromString,t.simpleCellAddressFromString=n.simpleCellAddressFromString,t.simpleCellAddressToString=n.simpleCellAddressToString,t.simpleCellRangeFromString=n.simpleCellRangeFromString,t.simpleCellRangeToString=n.simpleCellRangeToString;var o=r(79);t.CellAddress=o.CellAddress;var s=r(83);t.ParserWithCaching=s.ParserWithCaching;var i=r(136);t.collectDependencies=i.collectDependencies;var a=r(132);t.buildLexerConfig=a.buildLexerConfig;var u=r(130);t.FormulaLexer=u.FormulaLexer;var c=r(127);t.AstNodeType=c.AstNodeType,t.ParsingErrorType=c.ParsingErrorType,t.buildProcedureAst=c.buildProcedureAst,t.buildCellRangeAst=c.buildCellRangeAst,t.buildParsingErrorAst=c.buildParsingErrorAst,t.buildCellErrorAst=c.buildCellErrorAst;var l=r(135);t.Unparser=l.Unparser;var h=r(137);t.AddressDependency=h.AddressDependency,t.CellRangeDependency=h.CellRangeDependency,t.ColumnRangeDependency=h.ColumnRangeDependency,t.RowRangeDependency=h.RowRangeDependency,t.NamedExpressionDependency=h.NamedExpressionDependency},function(e,t,r){"use strict";t.__esModule=!0,t.columnAddressFromString=t.cellAddressFromString=void 0,t.columnIndexToLabel=f,t.rowAddressFromString=void 0,t.sheetIndexToString=E,t.simpleCellRangeToString=t.simpleCellRangeFromString=t.simpleCellAddressToString=t.simpleCellAddressFromString=void 0;var n=r(72),o=r(73),s=r(79),i=r(80),a=r(82),u=r(81);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
const c=new RegExp(`^(${a.SHEET_NAME_PATTERN})?(\\${a.ABSOLUTE_OPERATOR}?)([A-Za-z]+)(\\${a.ABSOLUTE_OPERATOR}?)([0-9]+)$`),l=new RegExp(`^(${a.SHEET_NAME_PATTERN})?(\\${a.ABSOLUTE_OPERATOR}?)([A-Za-z]+)$`),h=new RegExp(`^(${a.SHEET_NAME_PATTERN})?(\\${a.ABSOLUTE_OPERATOR}?)([0-9]+)$`),d=new RegExp(`^${a.UNQUOTED_SHEET_NAME_PATTERN}$`);t.cellAddressFromString=(e,t,r)=>{const n=c.exec(t),o=g(n[6]);let i=T(n,e);if(void 0===i)return;null===i&&(i=void 0);const u=Number(n[8])-1;return n[5]===a.ABSOLUTE_OPERATOR&&n[7]===a.ABSOLUTE_OPERATOR?s.CellAddress.absolute(o,u,i):n[5]===a.ABSOLUTE_OPERATOR?s.CellAddress.absoluteCol(o,u-r.row,i):n[7]===a.ABSOLUTE_OPERATOR?s.CellAddress.absoluteRow(o-r.col,u,i):s.CellAddress.relative(o-r.col,u-r.row,i)},t.columnAddressFromString=(e,t,r)=>{const n=l.exec(t);let o=T(n,e);if(void 0===o)return;null===o&&(o=void 0);const s=g(n[6]);return n[5]===a.ABSOLUTE_OPERATOR?i.ColumnAddress.absolute(s,o):i.ColumnAddress.relative(s-r.col,o)},t.rowAddressFromString=(e,t,r)=>{const n=h.exec(t);let o=T(n,e);if(void 0===o)return;null===o&&(o=void 0);const s=Number(n[6])-1;return n[5]===a.ABSOLUTE_OPERATOR?u.RowAddress.absolute(s,o):u.RowAddress.relative(s-r.row,o)};const p=(e,t,r)=>{const n=c.exec(t);if(!n)return;const s=g(n[6]);let i=T(n,e);if(void 0===i)return;null===i&&(i=r);const a=Number(n[8])-1;return(0,o.simpleCellAddress)(i,s,a)};t.simpleCellAddressFromString=p,t.simpleCellRangeFromString=(e,t,r)=>{const o=t.split(a.RANGE_OPERATOR);if(2!==o.length)return;const[s,i]=o,u=p(e,s,r);if(void 0===u)return;const c=p(e,i,u.sheet);return void 0!==c&&u.sheet===c.sheet?(0,n.simpleCellRange)(u,c):void 0};const m=(e,t,r)=>{const n=f(t.col),o=E(t.sheet,e);if(void 0!==o)return r!==t.sheet?`${o}!${n}${t.row+1}`:`${n}${t.row+1}`};function g(e){return 1===e.length?e.toUpperCase().charCodeAt(0)-65:e.split("").reduce((e,t)=>26*e+(t.toUpperCase().charCodeAt(0)-64),0)-1}function f(e){let t="";for(;e>=0;)t=String.fromCharCode(e%26+97)+t,e=Math.floor(e/26)-1;return t.toUpperCase()}function E(e,t){let r=t(e);if(void 0!==r)return d.test(r)?r:(r=r.replace(/'/g,"''"),`'${r}'`)}function T(e,t){var r;let n=null!==(r=e[3])&&void 0!==r?r:e[2];return n?(n=n.replace(/''/g,"'"),t(n)):null}t.simpleCellAddressToString=m,t.simpleCellRangeToString=(e,t,r)=>{const n=m(e,t.start,r),o=m(e,t.end,t.start.sheet);return void 0===n||void 0===o?void 0:`${n}${a.RANGE_OPERATOR}${o}`}},function(e,t,r){"use strict";t.__esModule=!0,t.CellReferenceType=t.CellAddress=void 0;var n,o=r(73),s=r(78),i=r(80),a=r(81);!function(e){e.CELL_REFERENCE_RELATIVE="CELL_REFERENCE",e.CELL_REFERENCE_ABSOLUTE="CELL_REFERENCE_ABSOLUTE",e.CELL_REFERENCE_ABSOLUTE_COL="CELL_REFERENCE_ABSOLUTE_COL",e.CELL_REFERENCE_ABSOLUTE_ROW="CELL_REFERENCE_ABSOLUTE_ROW"}(n||(t.CellReferenceType=n={}));class u{constructor(e,t,r,n){this.col=e,this.row=t,this.type=r,this.sheet=n}static fromColAndRow(e,t,r){return(e.isColumnAbsolute()&&t.isRowAbsolute()?u.absolute.bind(this):e.isColumnAbsolute()?u.absoluteCol.bind(this):t.isRowAbsolute()?u.absoluteRow.bind(this):u.relative.bind(this))(e.col,t.row,r)}static relative(e,t,r){return new u(e,t,n.CELL_REFERENCE_RELATIVE,r)}static absolute(e,t,r){return new u(e,t,n.CELL_REFERENCE_ABSOLUTE,r)}static absoluteCol(e,t,r){return new u(e,t,n.CELL_REFERENCE_ABSOLUTE_COL,r)}static absoluteRow(e,t,r){return new u(e,t,n.CELL_REFERENCE_ABSOLUTE_ROW,r)}toSimpleCellAddress(e){const t=(0,o.absoluteSheetReference)(this,e);return this.type===n.CELL_REFERENCE_ABSOLUTE?(0,o.simpleCellAddress)(t,this.col,this.row):this.type===n.CELL_REFERENCE_ABSOLUTE_ROW?(0,o.simpleCellAddress)(t,e.col+this.col,this.row):this.type===n.CELL_REFERENCE_ABSOLUTE_COL?(0,o.simpleCellAddress)(t,this.col,e.row+this.row):(0,o.simpleCellAddress)(t,e.col+this.col,e.row+this.row)}toColumnAddress(){const e=this.isColumnRelative()?i.ReferenceType.RELATIVE:i.ReferenceType.ABSOLUTE;return new i.ColumnAddress(e,this.col,this.sheet)}toRowAddress(){const e=this.isRowRelative()?i.ReferenceType.RELATIVE:i.ReferenceType.ABSOLUTE;return new a.RowAddress(e,this.row,this.sheet)}toSimpleColumnAddress(e){const t=(0,o.absoluteSheetReference)(this,e);let r=this.col;return this.isColumnRelative()&&(r+=e.col),(0,o.simpleColumnAddress)(t,r)}toSimpleRowAddress(e){const t=(0,o.absoluteSheetReference)(this,e);let r=this.row;return this.isRowRelative()&&(r+=e.row),(0,o.simpleRowAddress)(t,r)}isRowAbsolute(){return this.type===n.CELL_REFERENCE_ABSOLUTE||this.type===n.CELL_REFERENCE_ABSOLUTE_ROW}isColumnAbsolute(){return this.type===n.CELL_REFERENCE_ABSOLUTE||this.type===n.CELL_REFERENCE_ABSOLUTE_COL}isColumnRelative(){return this.type===n.CELL_REFERENCE_RELATIVE||this.type===n.CELL_REFERENCE_ABSOLUTE_ROW}isRowRelative(){return this.type===n.CELL_REFERENCE_RELATIVE||this.type===n.CELL_REFERENCE_ABSOLUTE_COL}isAbsolute(){return this.type===n.CELL_REFERENCE_ABSOLUTE&&void 0!==this.sheet}shiftedByRows(e){return new u(this.col,this.row+e,this.type,this.sheet)}shiftedByColumns(e){return new u(this.col+e,this.row,this.type,this.sheet)}moved(e,t,r){const n=void 0===this.sheet?void 0:e;return new u(this.col+t,this.row+r,this.type,n)}withSheet(e){return new u(this.col,this.row,this.type,e)}isInvalid(e){return(0,o.invalidSimpleCellAddress)(this.toSimpleCellAddress(e))}shiftRelativeDimensions(e,t){const r=this.isColumnAbsolute()?this.col:this.col+e,n=this.isRowAbsolute()?this.row:this.row+t;return new u(r,n,this.type,this.sheet)}shiftAbsoluteDimensions(e,t){const r=this.isColumnRelative()?this.col:this.col+e,n=this.isRowRelative()?this.row:this.row+t;return new u(r,n,this.type,this.sheet)}hash(e){const t=e&&void 0!==this.sheet?"#"+this.sheet:"";switch(this.type){case n.CELL_REFERENCE_RELATIVE:return`${t}#${this.row}R${this.col}`;case n.CELL_REFERENCE_ABSOLUTE:return`${t}#${this.row}A${this.col}`;case n.CELL_REFERENCE_ABSOLUTE_COL:return`${t}#${this.row}AC${this.col}`;case n.CELL_REFERENCE_ABSOLUTE_ROW:return`${t}#${this.row}AR${this.col}`}}unparse(e){const t=this.toSimpleCellAddress(e);if((0,o.invalidSimpleCellAddress)(t))return;const r=(0,s.columnIndexToLabel)(t.col),i=this.type===n.CELL_REFERENCE_ABSOLUTE||this.type===n.CELL_REFERENCE_ABSOLUTE_ROW?"$":"";return`${this.type===n.CELL_REFERENCE_ABSOLUTE||this.type===n.CELL_REFERENCE_ABSOLUTE_COL?"$":""}${r}${i}${t.row+1}`}exceedsSheetSizeLimits(e,t){return this.row>=t||this.col>=e}}t.CellAddress=u},function(e,t,r){"use strict";t.__esModule=!0,t.ReferenceType=t.ColumnAddress=void 0;var n,o=r(73),s=r(78);!function(e){e.RELATIVE="RELATIVE",e.ABSOLUTE="ABSOLUTE"}(n||(t.ReferenceType=n={}));class i{constructor(e,t,r){this.type=e,this.col=t,this.sheet=r}static absolute(e,t){return new i(n.ABSOLUTE,e,t)}static relative(e,t){return new i(n.RELATIVE,e,t)}static compareByAbsoluteAddress(e){return(t,r)=>t.toSimpleColumnAddress(e).col-r.toSimpleColumnAddress(e).col}isColumnAbsolute(){return this.type===n.ABSOLUTE}isColumnRelative(){return this.type===n.RELATIVE}isAbsolute(){return this.type===n.ABSOLUTE&&void 0!==this.sheet}moved(e,t,r){const n=void 0===this.sheet?void 0:e;return new i(this.type,this.col+t,n)}shiftedByColumns(e){return new i(this.type,this.col+e,this.sheet)}toSimpleColumnAddress(e){const t=(0,o.absoluteSheetReference)(this,e);let r=this.col;return this.isColumnRelative()&&(r=e.col+this.col),(0,o.simpleColumnAddress)(t,r)}shiftRelativeDimensions(e,t){const r=this.isColumnRelative()?this.col+e:this.col;return new i(this.type,r,this.sheet)}shiftAbsoluteDimensions(e,t){const r=this.isColumnAbsolute()?this.col+e:this.col;return new i(this.type,r,this.sheet)}withSheet(e){return new i(this.type,this.col,e)}isInvalid(e){return this.toSimpleColumnAddress(e).col<0}hash(e){const t=e&&void 0!==this.sheet?"#"+this.sheet:"";switch(this.type){case n.RELATIVE:return`${t}#COLR${this.col}`;case n.ABSOLUTE:return`${t}#COLA${this.col}`}}unparse(e){const t=this.toSimpleColumnAddress(e);if((0,o.invalidSimpleColumnAddress)(t))return;const r=(0,s.columnIndexToLabel)(t.col);return`${this.type===n.ABSOLUTE?"$":""}${r}`}exceedsSheetSizeLimits(e){return this.col>=e}}t.ColumnAddress=i},function(e,t,r){"use strict";t.__esModule=!0,t.RowAddress=void 0;var n=r(73),o=r(80);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
class s{constructor(e,t,r){this.type=e,this.row=t,this.sheet=r}static absolute(e,t){return new s(o.ReferenceType.ABSOLUTE,e,t)}static relative(e,t){return new s(o.ReferenceType.RELATIVE,e,t)}static compareByAbsoluteAddress(e){return(t,r)=>t.toSimpleRowAddress(e).row-r.toSimpleRowAddress(e).row}isRowAbsolute(){return this.type===o.ReferenceType.ABSOLUTE}isRowRelative(){return this.type===o.ReferenceType.RELATIVE}isAbsolute(){return this.type===o.ReferenceType.ABSOLUTE&&void 0!==this.sheet}moved(e,t,r){const n=void 0===this.sheet?void 0:e;return new s(this.type,this.row+r,n)}shiftedByRows(e){return new s(this.type,this.row+e,this.sheet)}toSimpleRowAddress(e){const t=(0,n.absoluteSheetReference)(this,e);let r=this.row;return this.isRowRelative()&&(r=e.row+this.row),(0,n.simpleRowAddress)(t,r)}shiftRelativeDimensions(e,t){const r=this.isRowRelative()?this.row+t:this.row;return new s(this.type,r,this.sheet)}shiftAbsoluteDimensions(e,t){const r=this.isRowAbsolute()?this.row+t:this.row;return new s(this.type,r,this.sheet)}withSheet(e){return new s(this.type,this.row,e)}isInvalid(e){return this.toSimpleRowAddress(e).row<0}hash(e){const t=e&&void 0!==this.sheet?"#"+this.sheet:"";switch(this.type){case o.ReferenceType.RELATIVE:return`${t}#ROWR${this.row}`;case o.ReferenceType.ABSOLUTE:return`${t}#ROWA${this.row}`}}unparse(e){const t=this.toSimpleRowAddress(e);if(!(0,n.invalidSimpleRowAddress)(t))return`${this.type===o.ReferenceType.ABSOLUTE?"$":""}${t.row+1}`}exceedsSheetSizeLimits(e){return this.row>=e}}t.RowAddress=s},function(e,t,r){"use strict";t.__esModule=!0,t.UNQUOTED_SHEET_NAME_PATTERN=t.UNICODE_LETTER_PATTERN=t.SHEET_NAME_PATTERN=t.ROW_REFERENCE_PATTERN=t.RANGE_OPERATOR=t.R1C1_CELL_REFERENCE_PATTERN=t.QUOTED_SHEET_NAME_PATTERN=t.ODFF_WHITESPACE_PATTERN=t.NON_RESERVED_CHARACTER_PATTERN=t.NAMED_EXPRESSION_PATTERN=t.COLUMN_REFERENCE_PATTERN=t.CELL_REFERENCE_WITH_NEXT_CHARACTER_PATTERN=t.CELL_REFERENCE_PATTERN=t.ALL_WHITESPACE_PATTERN=t.ALL_UNICODE_LETTERS_ARRAY=t.ALL_DIGITS_ARRAY=t.ABSOLUTE_OPERATOR=void 0,t.RANGE_OPERATOR=":";
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
const n=t.ABSOLUTE_OPERATOR="$",o=(t.ALL_WHITESPACE_PATTERN="\\s+",t.ODFF_WHITESPACE_PATTERN="[ \\t\\n\\r]+",t.UNICODE_LETTER_PATTERN="A-Za-zÃ-Ê¯"),s=t.NON_RESERVED_CHARACTER_PATTERN=o+"0-9_.",i=t.UNQUOTED_SHEET_NAME_PATTERN=`[${o}0-9_]+`,a=t.QUOTED_SHEET_NAME_PATTERN="'(((?!').|'')*)'",u=t.SHEET_NAME_PATTERN=`(${i}|${a})!`,c=t.CELL_REFERENCE_PATTERN=`(${u})?\\${n}?[A-Za-z]+\\${n}?[0-9]+`;t.COLUMN_REFERENCE_PATTERN=`(${u})?\\${n}?[A-Za-z]+`,t.ROW_REFERENCE_PATTERN=`(${u})?\\${n}?[0-9]+`,t.R1C1_CELL_REFERENCE_PATTERN="[rR][0-9]*[cC][0-9]*",t.CELL_REFERENCE_WITH_NEXT_CHARACTER_PATTERN=`(${c})[^${s}]`,t.NAMED_EXPRESSION_PATTERN=`[${o}_][${s}]*`,t.ALL_DIGITS_ARRAY=["0","1","2","3","4","5","6","7","8","9"],t.ALL_UNICODE_LETTERS_ARRAY=[...Array.from(Array(26)).map((e,t)=>t+"A".charCodeAt(0)),...Array.from(Array(26)).map((e,t)=>t+"a".charCodeAt(0)),...Array.from(Array(496)).map((e,t)=>t+192)].map(e=>String.fromCharCode(e))},function(e,t,r){"use strict";t.__esModule=!0,t.ParserWithCaching=void 0,r(2);var n=r(84),o=r(73),s=r(77),i=r(78),a=r(127),u=r(128),c=r(129),l=r(130),h=r(132),d=r(135),p=r(80),m=r(81);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
class g{constructor(e,t,r){this.config=e,this.functionRegistry=t,this.sheetMapping=r,this.statsCacheUsed=0,this.lexerConfig=(0,h.buildLexerConfig)(e),this.lexer=new l.FormulaLexer(this.lexerConfig),this.formulaParser=new l.FormulaParser(this.lexerConfig,this.sheetMapping),this.cache=new c.Cache(this.functionRegistry)}parse(e,t){this.formulaAddress=t;const r=this.tokenizeFormula(e);if(r.errors.length>0){const e=r.errors.map(e=>({type:a.ParsingErrorType.LexingError,message:e.message}));return{ast:(0,s.buildParsingErrorAst)(),errors:e,hasVolatileFunction:!1,hasStructuralChangeFunction:!1,dependencies:[]}}const n=this.computeHashFromTokens(r.tokens,t);let o=this.cache.get(n);if(void 0!==o)++this.statsCacheUsed;else{const e=this.bindWhitespacesToTokens(r.tokens),s=this.formulaParser.parseFromTokens(e,t);if(s.errors.length>0)return Object.assign(Object.assign({},s),{hasVolatileFunction:!1,hasStructuralChangeFunction:!1,dependencies:[]});o=this.cache.set(n,s.ast)}const{ast:i,hasVolatileFunction:u,hasStructuralChangeFunction:c}=o,l=this.convertReversedRangesToRegularRanges(i);return{ast:l,errors:[],hasVolatileFunction:u,hasStructuralChangeFunction:c,dependencies:(0,s.collectDependencies)(l,this.functionRegistry)}}convertReversedRangesToRegularRanges(e){switch(e.type){case s.AstNodeType.EMPTY:case s.AstNodeType.NUMBER:case s.AstNodeType.STRING:case s.AstNodeType.ERROR:case s.AstNodeType.ERROR_WITH_RAW_INPUT:case s.AstNodeType.CELL_REFERENCE:case s.AstNodeType.NAMED_EXPRESSION:return e;case s.AstNodeType.CELL_RANGE:{const{start:t,end:r}=e,n=this.orderCellRangeEnds(t,r);return Object.assign(Object.assign({},e),{start:n.start,end:n.end})}case s.AstNodeType.COLUMN_RANGE:{const{start:t,end:r}=e,n=this.orderColumnRangeEnds(t,r);return Object.assign(Object.assign({},e),{start:n.start,end:n.end})}case s.AstNodeType.ROW_RANGE:{const{start:t,end:r}=e,n=this.orderRowRangeEnds(t,r);return Object.assign(Object.assign({},e),{start:n.start,end:n.end})}case s.AstNodeType.PERCENT_OP:case s.AstNodeType.PLUS_UNARY_OP:case s.AstNodeType.MINUS_UNARY_OP:{const t=this.convertReversedRangesToRegularRanges(e.value);return Object.assign(Object.assign({},e),{value:t})}case s.AstNodeType.CONCATENATE_OP:case s.AstNodeType.EQUALS_OP:case s.AstNodeType.NOT_EQUAL_OP:case s.AstNodeType.LESS_THAN_OP:case s.AstNodeType.GREATER_THAN_OP:case s.AstNodeType.LESS_THAN_OR_EQUAL_OP:case s.AstNodeType.GREATER_THAN_OR_EQUAL_OP:case s.AstNodeType.MINUS_OP:case s.AstNodeType.PLUS_OP:case s.AstNodeType.TIMES_OP:case s.AstNodeType.DIV_OP:case s.AstNodeType.POWER_OP:{const t=this.convertReversedRangesToRegularRanges(e.left),r=this.convertReversedRangesToRegularRanges(e.right);return Object.assign(Object.assign({},e),{left:t,right:r})}case s.AstNodeType.PARENTHESIS:{const t=this.convertReversedRangesToRegularRanges(e.expression);return Object.assign(Object.assign({},e),{expression:t})}case s.AstNodeType.FUNCTION_CALL:{const t=e.args.map(e=>this.convertReversedRangesToRegularRanges(e));return Object.assign(Object.assign({},e),{args:t})}case s.AstNodeType.ARRAY:{const t=e.args.map(e=>e.map(e=>this.convertReversedRangesToRegularRanges(e)));return Object.assign(Object.assign({},e),{args:t})}}}orderCellRangeEnds(e,t){const r=[e,t],[n,o]=r.map(e=>e.toColumnAddress()).sort(p.ColumnAddress.compareByAbsoluteAddress(this.formulaAddress)),[i,a]=r.map(e=>e.toRowAddress()).sort(m.RowAddress.compareByAbsoluteAddress(this.formulaAddress)),[u,c]=r.map(e=>e.sheet).sort(g.compareSheetIds.bind(this));return{start:s.CellAddress.fromColAndRow(n,i,u),end:s.CellAddress.fromColAndRow(o,a,c)}}orderColumnRangeEnds(e,t){const r=[e,t],[n,o]=r.sort(p.ColumnAddress.compareByAbsoluteAddress(this.formulaAddress)),[s,i]=r.map(e=>e.sheet).sort(g.compareSheetIds.bind(this));return{start:new p.ColumnAddress(n.type,n.col,s),end:new p.ColumnAddress(o.type,o.col,i)}}orderRowRangeEnds(e,t){const r=[e,t],[n,o]=r.sort(m.RowAddress.compareByAbsoluteAddress(this.formulaAddress)),[s,i]=r.map(e=>e.sheet).sort(g.compareSheetIds.bind(this));return{start:new m.RowAddress(n.type,n.row,s),end:new m.RowAddress(o.type,o.row,i)}}static compareSheetIds(e,t){return(e=null!=e?e:1/0)-(t=null!=t?t:1/0)}fetchCachedResultForAst(e){const t=this.computeHashFromAst(e);return this.fetchCachedResult(t)}fetchCachedResult(e){const t=this.cache.get(e);if(void 0===t)throw new Error("There is no AST with such key in the cache");{const{ast:e,hasVolatileFunction:r,hasStructuralChangeFunction:n,relativeDependencies:o}=t;return{ast:e,errors:[],hasVolatileFunction:r,hasStructuralChangeFunction:n,dependencies:o}}}computeHashFromTokens(e,t){var r;let o="",s=0;for(;s<e.length;){const a=e[s];if((0,n.tokenMatcher)(a,h.CellReference)){const e=(0,i.cellAddressFromString)(this.sheetMapping,a.image,t);o=void 0===e?o.concat(a.image):o.concat(e.hash(!0))}else if((0,n.tokenMatcher)(a,h.ProcedureName)){const e=a.image.toUpperCase().slice(0,-1),t=null!==(r=this.lexerConfig.functionMapping[e])&&void 0!==r?r:e;o=o.concat(t,"(")}else if((0,n.tokenMatcher)(a,h.ColumnRange)){const[e,r]=a.image.split(":"),n=(0,i.columnAddressFromString)(this.sheetMapping,e,t),s=(0,i.columnAddressFromString)(this.sheetMapping,r,t);o=void 0===n||void 0===s?o.concat("!REF"):o.concat(n.hash(!0),":",s.hash(!0))}else if((0,n.tokenMatcher)(a,h.RowRange)){const[e,r]=a.image.split(":"),n=(0,i.rowAddressFromString)(this.sheetMapping,e,t),s=(0,i.rowAddressFromString)(this.sheetMapping,r,t);o=void 0===n||void 0===s?o.concat("!REF"):o.concat(n.hash(!0),":",s.hash(!0))}else o=o.concat(a.image);s++}return o}rememberNewAst(e){const t=this.computeHashFromAst(e);return this.cache.maybeSetAndThenGet(t,e)}computeHashFromAst(e){return"="+this.computeHashOfAstNode(e)}computeHashOfAstNode(e){switch(e.type){case s.AstNodeType.EMPTY:return e.leadingWhitespace||"";case s.AstNodeType.NUMBER:return(0,a.imageWithWhitespace)((0,d.formatNumber)(e.value,this.config.decimalSeparator),e.leadingWhitespace);case s.AstNodeType.STRING:return(0,a.imageWithWhitespace)('"'+e.value+'"',e.leadingWhitespace);case s.AstNodeType.NAMED_EXPRESSION:return(0,a.imageWithWhitespace)(e.expressionName,e.leadingWhitespace);case s.AstNodeType.FUNCTION_CALL:{const t=e.args.map(e=>this.computeHashOfAstNode(e)).join(this.config.functionArgSeparator),r=e.procedureName+"("+t+(0,a.imageWithWhitespace)(")",e.internalWhitespace);return(0,a.imageWithWhitespace)(r,e.leadingWhitespace)}case s.AstNodeType.CELL_REFERENCE:return(0,a.imageWithWhitespace)(e.reference.hash(!0),e.leadingWhitespace);case s.AstNodeType.COLUMN_RANGE:case s.AstNodeType.ROW_RANGE:case s.AstNodeType.CELL_RANGE:{const t=e.start.hash(e.sheetReferenceType!==a.RangeSheetReferenceType.RELATIVE),r=e.end.hash(e.sheetReferenceType===a.RangeSheetReferenceType.BOTH_ABSOLUTE);return(0,a.imageWithWhitespace)(t+":"+r,e.leadingWhitespace)}case s.AstNodeType.MINUS_UNARY_OP:return(0,a.imageWithWhitespace)("-"+this.computeHashOfAstNode(e.value),e.leadingWhitespace);case s.AstNodeType.PLUS_UNARY_OP:return(0,a.imageWithWhitespace)("+"+this.computeHashOfAstNode(e.value),e.leadingWhitespace);case s.AstNodeType.PERCENT_OP:return this.computeHashOfAstNode(e.value)+(0,a.imageWithWhitespace)("%",e.leadingWhitespace);case s.AstNodeType.ERROR:{const t=this.config.translationPackage.getErrorTranslation(e.error?e.error.type:o.ErrorType.ERROR);return(0,a.imageWithWhitespace)(t,e.leadingWhitespace)}case s.AstNodeType.ERROR_WITH_RAW_INPUT:return(0,a.imageWithWhitespace)(e.rawInput,e.leadingWhitespace);case s.AstNodeType.ARRAY:{const t=e.args.map(e=>e.map(e=>this.computeHashOfAstNode(e)).join(",")).join(";");return(0,a.imageWithWhitespace)("{"+t+(0,a.imageWithWhitespace)("}",e.internalWhitespace),e.leadingWhitespace)}case s.AstNodeType.PARENTHESIS:{const t="("+this.computeHashOfAstNode(e.expression)+(0,a.imageWithWhitespace)(")",e.internalWhitespace);return(0,a.imageWithWhitespace)(t,e.leadingWhitespace)}default:return this.computeHashOfAstNode(e.left)+(0,a.imageWithWhitespace)(u.binaryOpTokenMap[e.type],e.leadingWhitespace)+this.computeHashOfAstNode(e.right)}}bindWhitespacesToTokens(e){const t=[],r=e[0];(0,n.tokenMatcher)(r,this.lexerConfig.WhiteSpace)||t.push(r);for(let r=1;r<e.length;++r){const o=e[r];if((0,n.tokenMatcher)(o,this.lexerConfig.WhiteSpace))continue;const s=e[r-1];(0,n.tokenMatcher)(s,this.lexerConfig.WhiteSpace)&&(o.leadingWhitespace=s),t.push(o)}return t}tokenizeFormula(e){return this.lexer.tokenizeFormula(e)}}t.ParserWithCaching=g},function(e,t,r){"use strict";r.r(t),r.d(t,"clearCache",(function(){return g}));var n=r(85);r.d(t,"VERSION",(function(){return n.VERSION}));var o=r(86);r.d(t,"Parser",(function(){return o.Parser})),r.d(t,"CstParser",(function(){return o.CstParser})),r.d(t,"EmbeddedActionsParser",(function(){return o.EmbeddedActionsParser})),r.d(t,"ParserDefinitionErrorType",(function(){return o.ParserDefinitionErrorType})),r.d(t,"EMPTY_ALT",(function(){return o.EMPTY_ALT}));var s=r(92);r.d(t,"Lexer",(function(){return s.Lexer})),r.d(t,"LexerDefinitionErrorType",(function(){return s.LexerDefinitionErrorType}));var i=r(91);r.d(t,"createToken",(function(){return i.createToken})),r.d(t,"createTokenInstance",(function(){return i.createTokenInstance})),r.d(t,"EOF",(function(){return i.EOF})),r.d(t,"tokenLabel",(function(){return i.tokenLabel})),r.d(t,"tokenMatcher",(function(){return i.tokenMatcher})),r.d(t,"tokenName",(function(){return i.tokenName}));var a=r(105);r.d(t,"defaultGrammarResolverErrorProvider",(function(){return a.defaultGrammarResolverErrorProvider})),r.d(t,"defaultGrammarValidatorErrorProvider",(function(){return a.defaultGrammarValidatorErrorProvider})),r.d(t,"defaultParserErrorProvider",(function(){return a.defaultParserErrorProvider}));var u=r(112);r.d(t,"EarlyExitException",(function(){return u.EarlyExitException})),r.d(t,"isRecognitionException",(function(){return u.isRecognitionException})),r.d(t,"MismatchedTokenException",(function(){return u.MismatchedTokenException})),r.d(t,"NotAllInputParsedException",(function(){return u.NotAllInputParsedException})),r.d(t,"NoViableAltException",(function(){return u.NoViableAltException}));var c=r(98);r.d(t,"defaultLexerErrorProvider",(function(){return c.defaultLexerErrorProvider}));var l=r(90);r.d(t,"Alternation",(function(){return l.Alternation})),r.d(t,"Flat",(function(){return l.Flat})),r.d(t,"NonTerminal",(function(){return l.NonTerminal})),r.d(t,"Option",(function(){return l.Option})),r.d(t,"Repetition",(function(){return l.Repetition})),r.d(t,"RepetitionMandatory",(function(){return l.RepetitionMandatory})),r.d(t,"RepetitionMandatoryWithSeparator",(function(){return l.RepetitionMandatoryWithSeparator})),r.d(t,"RepetitionWithSeparator",(function(){return l.RepetitionWithSeparator})),r.d(t,"Rule",(function(){return l.Rule})),r.d(t,"Terminal",(function(){return l.Terminal})),r.d(t,"serializeGrammar",(function(){return l.serializeGrammar})),r.d(t,"serializeProduction",(function(){return l.serializeProduction}));var h=r(101);r.d(t,"GAstVisitor",(function(){return h.GAstVisitor}));var d=r(109);r.d(t,"assignOccurrenceIndices",(function(){return d.assignOccurrenceIndices})),r.d(t,"resolveGrammar",(function(){return d.resolveGrammar})),r.d(t,"validateGrammar",(function(){return d.validateGrammar}));var p=r(124);r.d(t,"createSyntaxDiagramsCode",(function(){return p.createSyntaxDiagramsCode}));var m=r(125);function g(){console.warn("The clearCache function was 'soft' removed from the Chevrotain API.\n\t It performs no action other than printing this message.\n\t Please avoid using it as it will be completely removed in the future")}r.d(t,"generateParserFactory",(function(){return m.generateParserFactory})),r.d(t,"generateParserModule",(function(){return m.generateParserModule}))},function(e,t,r){"use strict";r.r(t),r.d(t,"VERSION",(function(){return n}));var n="6.5.0"},function(e,t,r){"use strict";r.r(t),r.d(t,"END_OF_FILE",(function(){return R})),r.d(t,"DEFAULT_PARSER_CONFIG",(function(){return S})),r.d(t,"DEFAULT_RULE_CONFIG",(function(){return C})),r.d(t,"ParserDefinitionErrorType",(function(){return N})),r.d(t,"EMPTY_ALT",(function(){return v})),r.d(t,"Parser",(function(){return O})),r.d(t,"CstParser",(function(){return I})),r.d(t,"EmbeddedActionsParser",(function(){return M}));var n,o=r(87),s=r(88),i=r(91),a=r(103),u=r(105),c=r(109),l=r(111),h=r(113),d=r(114),p=r(117),m=r(118),g=r(119),f=r(120),E=r(121),T=r(122),y=r(123),A=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),R=Object(i.createTokenInstance)(i.EOF,"",NaN,NaN,NaN,NaN,NaN,NaN);Object.freeze(R);var N,S=Object.freeze({recoveryEnabled:!1,maxLookahead:4,ignoredIssues:{},dynamicTokensEnabled:!1,outputCst:!0,errorMessageProvider:u.defaultParserErrorProvider,nodeLocationTracking:"none",traceInitPerf:!1,skipValidations:!1}),C=Object.freeze({recoveryValueFunc:function(){},resyncEnabled:!0});function v(e){return void 0===e&&(e=void 0),function(){return e}}!function(e){e[e.INVALID_RULE_NAME=0]="INVALID_RULE_NAME",e[e.DUPLICATE_RULE_NAME=1]="DUPLICATE_RULE_NAME",e[e.INVALID_RULE_OVERRIDE=2]="INVALID_RULE_OVERRIDE",e[e.DUPLICATE_PRODUCTIONS=3]="DUPLICATE_PRODUCTIONS",e[e.UNRESOLVED_SUBRULE_REF=4]="UNRESOLVED_SUBRULE_REF",e[e.LEFT_RECURSION=5]="LEFT_RECURSION",e[e.NONE_LAST_EMPTY_ALT=6]="NONE_LAST_EMPTY_ALT",e[e.AMBIGUOUS_ALTS=7]="AMBIGUOUS_ALTS",e[e.CONFLICT_TOKENS_RULES_NAMESPACE=8]="CONFLICT_TOKENS_RULES_NAMESPACE",e[e.INVALID_TOKEN_NAME=9]="INVALID_TOKEN_NAME",e[e.INVALID_NESTED_RULE_NAME=10]="INVALID_NESTED_RULE_NAME",e[e.DUPLICATE_NESTED_NAME=11]="DUPLICATE_NESTED_NAME",e[e.NO_NON_EMPTY_LOOKAHEAD=12]="NO_NON_EMPTY_LOOKAHEAD",e[e.AMBIGUOUS_PREFIX_ALTS=13]="AMBIGUOUS_PREFIX_ALTS",e[e.TOO_MANY_ALTS=14]="TOO_MANY_ALTS"}(N||(N={}));var O=function(){function e(e,t){void 0===t&&(t=S),this.ignoredIssues=S.ignoredIssues,this.definitionErrors=[],this.selfAnalysisDone=!1,this.initErrorHandler(t),this.initLexerAdapter(),this.initLooksAhead(t),this.initRecognizerEngine(e,t),this.initRecoverable(t),this.initTreeBuilder(t),this.initContentAssist(),this.initGastRecorder(t),this.initPerformanceTracer(t),Object(o.has)(t,"ignoredIssues")&&t.ignoredIssues!==S.ignoredIssues&&Object(o.PRINT_WARNING)("The <ignoredIssues> IParserConfig property is soft-deprecated and will be removed in future versions.\n\tPlease use the <IGNORE_AMBIGUITIES> flag on the relevant DSL method instead."),this.ignoredIssues=Object(o.has)(t,"ignoredIssues")?t.ignoredIssues:S.ignoredIssues,this.skipValidations=Object(o.has)(t,"skipValidations")?t.skipValidations:S.skipValidations}return e.performSelfAnalysis=function(e){e.performSelfAnalysis()},e.prototype.performSelfAnalysis=function(){var t=this;this.TRACE_INIT("performSelfAnalysis",(function(){var r;t.selfAnalysisDone=!0;var n=t.className;t.TRACE_INIT("toFastProps",(function(){Object(o.toFastProperties)(t)})),t.TRACE_INIT("Grammar Recording",(function(){try{t.enableRecording(),Object(o.forEach)(t.definedRulesNames,(function(e){var r=t[e].originalGrammarAction,n=void 0;t.TRACE_INIT(e+" Rule",(function(){n=t.topLevelRuleRecord(e,r)})),t.gastProductionsCache[e]=n}))}finally{t.disableRecording()}}));var i=[];if(t.TRACE_INIT("Grammar Resolving",(function(){i=Object(c.resolveGrammar)({rules:Object(o.values)(t.gastProductionsCache)}),t.definitionErrors.push.apply(t.definitionErrors,i)})),t.TRACE_INIT("Grammar Validations",(function(){if(Object(o.isEmpty)(i)&&!1===t.skipValidations){var e=Object(c.validateGrammar)({rules:Object(o.values)(t.gastProductionsCache),maxLookahead:t.maxLookahead,tokenTypes:Object(o.values)(t.tokensMap),ignoredIssues:t.ignoredIssues,errMsgProvider:u.defaultGrammarValidatorErrorProvider,grammarName:n});t.definitionErrors.push.apply(t.definitionErrors,e)}})),Object(o.isEmpty)(t.definitionErrors)&&(t.recoveryEnabled&&t.TRACE_INIT("computeAllProdsFollows",(function(){var e=Object(s.computeAllProdsFollows)(Object(o.values)(t.gastProductionsCache));t.resyncFollows=e})),t.TRACE_INIT("ComputeLookaheadFunctions",(function(){t.preComputeLookaheadFunctions(Object(o.values)(t.gastProductionsCache))}))),t.TRACE_INIT("expandAllNestedRuleNames",(function(){var e=Object(a.expandAllNestedRuleNames)(Object(o.values)(t.gastProductionsCache),t.fullRuleNameToShort);t.allRuleNames=e.allRuleNames})),!e.DEFER_DEFINITION_ERRORS_HANDLING&&!Object(o.isEmpty)(t.definitionErrors))throw r=Object(o.map)(t.definitionErrors,(function(e){return e.message})),new Error("Parser Definition Errors detected:\n "+r.join("\n-------------------------------\n"))}))},e.DEFER_DEFINITION_ERRORS_HANDLING=!1,e}();Object(o.applyMixins)(O,[l.Recoverable,h.LooksAhead,d.TreeBuilder,p.LexerAdapter,g.RecognizerEngine,m.RecognizerApi,f.ErrorHandler,E.ContentAssist,T.GastRecorder,y.PerformanceTracer]);var I=function(e){function t(t,r){void 0===r&&(r=S);var n=Object(o.cloneObj)(r);return n.outputCst=!0,e.call(this,t,n)||this}return A(t,e),t}(O),M=function(e){function t(t,r){void 0===r&&(r=S);var n=Object(o.cloneObj)(r);return n.outputCst=!1,e.call(this,t,n)||this}return A(t,e),t}(O)},function(e,t,r){"use strict";function n(e){return e&&0===e.length}function o(e){return null==e?[]:Object.keys(e)}function s(e){for(var t=[],r=Object.keys(e),n=0;n<r.length;n++)t.push(e[r[n]]);return t}function i(e,t){for(var r=[],n=o(e),s=0;s<n.length;s++){var i=n[s];r.push(t.call(null,e[i],i))}return r}function a(e,t){for(var r=[],n=0;n<e.length;n++)r.push(t.call(null,e[n],n));return r}function u(e){for(var t=[],r=0;r<e.length;r++){var n=e[r];Array.isArray(n)?t=t.concat(u(n)):t.push(n)}return t}function c(e){return n(e)?void 0:e[0]}function l(e){var t=e&&e.length;return t?e[t-1]:void 0}function h(e,t){if(Array.isArray(e))for(var r=0;r<e.length;r++)t.call(null,e[r],r);else{if(!_(e))throw Error("non exhaustive match");var n=o(e);for(r=0;r<n.length;r++){var s=n[r],i=e[s];t.call(null,i,s)}}}function d(e){return"string"==typeof e}function p(e){return void 0===e}function m(e){return e instanceof Function}function g(e,t){return void 0===t&&(t=1),e.slice(t,e.length)}function f(e,t){return void 0===t&&(t=1),e.slice(0,e.length-t)}function E(e,t){var r=[];if(Array.isArray(e))for(var n=0;n<e.length;n++){var o=e[n];t.call(null,o)&&r.push(o)}return r}function T(e,t){return E(e,(function(e){return!t(e)}))}function y(e,t){for(var r=Object.keys(e),n={},o=0;o<r.length;o++){var s=r[o],i=e[s];t(i)&&(n[s]=i)}return n}function A(e,t){return!!_(e)&&e.hasOwnProperty(t)}function R(e,t){return void 0!==C(e,(function(e){return e===t}))}function N(e){for(var t=[],r=0;r<e.length;r++)t.push(e[r]);return t}function S(e){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}function C(e,t){for(var r=0;r<e.length;r++){var n=e[r];if(t.call(null,n))return n}}function v(e,t){for(var r=[],n=0;n<e.length;n++){var o=e[n];t.call(null,o)&&r.push(o)}return r}function O(e,t,r){for(var n=Array.isArray(e),i=n?e:s(e),a=n?[]:o(e),u=r,c=0;c<i.length;c++)u=t.call(null,u,i[c],n?c:a[c]);return u}function I(e){return T(e,(function(e){return null==e}))}function M(e,t){void 0===t&&(t=function(e){return e});var r=[];return O(e,(function(e,n){var o=t(n);return R(r,o)?e:(r.push(o),e.concat(n))}),[])}function b(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=[null],o=n.concat(t);return Function.bind.apply(e,o)}function F(e){return Array.isArray(e)}function w(e){return e instanceof RegExp}function _(e){return e instanceof Object}function L(e,t){for(var r=0;r<e.length;r++)if(!t(e[r],r))return!1;return!0}function x(e,t){return T(e,(function(e){return R(t,e)}))}function P(e,t){for(var r=0;r<e.length;r++)if(t(e[r]))return!0;return!1}function U(e,t){for(var r=0;r<e.length;r++)if(e[r]===t)return r;return-1}function V(e,t){var r=N(e);return r.sort((function(e,r){return t(e)-t(r)})),r}function D(e,t){if(e.length!==t.length)throw Error("can't zipObject with different number of keys and values!");for(var r={},n=0;n<e.length;n++)r[e[n]]=t[n];return r}function B(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];for(var n=0;n<t.length;n++)for(var s=t[n],i=o(s),a=0;a<i.length;a++){var u=i[a];e[u]=s[u]}return e}function k(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];for(var n=0;n<t.length;n++){var s=t[n];if(!p(s))for(var i=o(s),a=0;a<i.length;a++){var u=i[a];A(e,u)||(e[u]=s[u])}}return e}function G(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return k.apply(null,[{}].concat(e))}function j(e,t){var r={};return h(e,(function(e){var n=t(e),o=r[n];o?o.push(e):r[n]=[e]})),r}function W(e,t){for(var r=S(e),n=o(t),s=0;s<n.length;s++){var i=n[s],a=t[i];r[i]=a}return r}function H(){}function z(e){return e}function Y(e){for(var t=[],r=0;r<e.length;r++){var n=e[r];t.push(void 0!==n?n:void 0)}return t}function X(e){console&&console.error&&console.error("Error: "+e)}function K(e){console&&console.warn&&console.warn("Warning: "+e)}function $(){return"function"==typeof Map}function q(e,t){t.forEach((function(t){var r=t.prototype;Object.getOwnPropertyNames(r).forEach((function(n){if("constructor"!==n){var o=Object.getOwnPropertyDescriptor(r,n);o&&(o.get||o.set)?Object.defineProperty(e.prototype,n,o):e.prototype[n]=t.prototype[n]}}))}))}function Q(e){function t(){}t.prototype=e;var r=new t;function n(){return typeof r.bar}return n(),n(),e}function Z(e){return e[e.length-1]}function J(e){var t=(new Date).getTime(),r=e();return{time:(new Date).getTime()-t,value:r}}r.r(t),r.d(t,"isEmpty",(function(){return n})),r.d(t,"keys",(function(){return o})),r.d(t,"values",(function(){return s})),r.d(t,"mapValues",(function(){return i})),r.d(t,"map",(function(){return a})),r.d(t,"flatten",(function(){return u})),r.d(t,"first",(function(){return c})),r.d(t,"last",(function(){return l})),r.d(t,"forEach",(function(){return h})),r.d(t,"isString",(function(){return d})),r.d(t,"isUndefined",(function(){return p})),r.d(t,"isFunction",(function(){return m})),r.d(t,"drop",(function(){return g})),r.d(t,"dropRight",(function(){return f})),r.d(t,"filter",(function(){return E})),r.d(t,"reject",(function(){return T})),r.d(t,"pick",(function(){return y})),r.d(t,"has",(function(){return A})),r.d(t,"contains",(function(){return R})),r.d(t,"cloneArr",(function(){return N})),r.d(t,"cloneObj",(function(){return S})),r.d(t,"find",(function(){return C})),r.d(t,"findAll",(function(){return v})),r.d(t,"reduce",(function(){return O})),r.d(t,"compact",(function(){return I})),r.d(t,"uniq",(function(){return M})),r.d(t,"partial",(function(){return b})),r.d(t,"isArray",(function(){return F})),r.d(t,"isRegExp",(function(){return w})),r.d(t,"isObject",(function(){return _})),r.d(t,"every",(function(){return L})),r.d(t,"difference",(function(){return x})),r.d(t,"some",(function(){return P})),r.d(t,"indexOf",(function(){return U})),r.d(t,"sortBy",(function(){return V})),r.d(t,"zipObject",(function(){return D})),r.d(t,"assign",(function(){return B})),r.d(t,"assignNoOverwrite",(function(){return k})),r.d(t,"defaults",(function(){return G})),r.d(t,"groupBy",(function(){return j})),r.d(t,"merge",(function(){return W})),r.d(t,"NOOP",(function(){return H})),r.d(t,"IDENTITY",(function(){return z})),r.d(t,"packArray",(function(){return Y})),r.d(t,"PRINT_ERROR",(function(){return X})),r.d(t,"PRINT_WARNING",(function(){return K})),r.d(t,"isES2015MapSupported",(function(){return $})),r.d(t,"applyMixins",(function(){return q})),r.d(t,"toFastProperties",(function(){return Q})),r.d(t,"peek",(function(){return Z})),r.d(t,"timer",(function(){return J}))},function(e,t,r){"use strict";r.r(t),r.d(t,"ResyncFollowsWalker",(function(){return l})),r.d(t,"computeAllProdsFollows",(function(){return h})),r.d(t,"buildBetweenProdsFollowPrefix",(function(){return d})),r.d(t,"buildInProdFollowPrefix",(function(){return p}));var n,o=r(89),s=r(99),i=r(87),a=r(102),u=r(90),c=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),l=function(e){function t(t){var r=e.call(this)||this;return r.topProd=t,r.follows={},r}return c(t,e),t.prototype.startWalking=function(){return this.walk(this.topProd),this.follows},t.prototype.walkTerminal=function(e,t,r){},t.prototype.walkProdRef=function(e,t,r){var n=d(e.referencedRule,e.idx)+this.topProd.name,o=t.concat(r),i=new u.Flat({definition:o}),a=Object(s.first)(i);this.follows[n]=a},t}(o.RestWalker);function h(e){var t={};return Object(i.forEach)(e,(function(e){var r=new l(e).startWalking();Object(i.assign)(t,r)})),t}function d(e,t){return e.name+t+a.IN}function p(e){return e.terminalType.name+e.idx+a.IN}},function(e,t,r){"use strict";r.r(t),r.d(t,"RestWalker",(function(){return s}));var n=r(87),o=r(90),s=function(){function e(){}return e.prototype.walk=function(e,t){var r=this;void 0===t&&(t=[]),Object(n.forEach)(e.definition,(function(s,i){var a=Object(n.drop)(e.definition,i+1);if(s instanceof o.NonTerminal)r.walkProdRef(s,a,t);else if(s instanceof o.Terminal)r.walkTerminal(s,a,t);else if(s instanceof o.Flat)r.walkFlat(s,a,t);else if(s instanceof o.Option)r.walkOption(s,a,t);else if(s instanceof o.RepetitionMandatory)r.walkAtLeastOne(s,a,t);else if(s instanceof o.RepetitionMandatoryWithSeparator)r.walkAtLeastOneSep(s,a,t);else if(s instanceof o.RepetitionWithSeparator)r.walkManySep(s,a,t);else if(s instanceof o.Repetition)r.walkMany(s,a,t);else{if(!(s instanceof o.Alternation))throw Error("non exhaustive match");r.walkOr(s,a,t)}}))},e.prototype.walkTerminal=function(e,t,r){},e.prototype.walkProdRef=function(e,t,r){},e.prototype.walkFlat=function(e,t,r){var n=t.concat(r);this.walk(e,n)},e.prototype.walkOption=function(e,t,r){var n=t.concat(r);this.walk(e,n)},e.prototype.walkAtLeastOne=function(e,t,r){var n=[new o.Option({definition:e.definition})].concat(t,r);this.walk(e,n)},e.prototype.walkAtLeastOneSep=function(e,t,r){var n=i(e,t,r);this.walk(e,n)},e.prototype.walkMany=function(e,t,r){var n=[new o.Option({definition:e.definition})].concat(t,r);this.walk(e,n)},e.prototype.walkManySep=function(e,t,r){var n=i(e,t,r);this.walk(e,n)},e.prototype.walkOr=function(e,t,r){var s=this,i=t.concat(r);Object(n.forEach)(e.definition,(function(e){var t=new o.Flat({definition:[e]});s.walk(t,i)}))},e}();function i(e,t,r){return[new o.Option({definition:[new o.Terminal({terminalType:e.separator})].concat(e.definition)})].concat(t,r)}},function(e,t,r){"use strict";r.r(t),r.d(t,"AbstractProduction",(function(){return a})),r.d(t,"NonTerminal",(function(){return u})),r.d(t,"Rule",(function(){return c})),r.d(t,"Flat",(function(){return l})),r.d(t,"Option",(function(){return h})),r.d(t,"RepetitionMandatory",(function(){return d})),r.d(t,"RepetitionMandatoryWithSeparator",(function(){return p})),r.d(t,"Repetition",(function(){return m})),r.d(t,"RepetitionWithSeparator",(function(){return g})),r.d(t,"Alternation",(function(){return f})),r.d(t,"Terminal",(function(){return E})),r.d(t,"serializeGrammar",(function(){return T})),r.d(t,"serializeProduction",(function(){return y}));var n,o=r(87),s=r(91),i=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),a=function(){function e(e){this.definition=e}return e.prototype.accept=function(e){e.visit(this),Object(o.forEach)(this.definition,(function(t){t.accept(e)}))},e}(),u=function(e){function t(t){var r=e.call(this,[])||this;return r.idx=1,Object(o.assign)(r,Object(o.pick)(t,(function(e){return void 0!==e}))),r}return i(t,e),Object.defineProperty(t.prototype,"definition",{get:function(){return void 0!==this.referencedRule?this.referencedRule.definition:[]},set:function(e){},enumerable:!0,configurable:!0}),t.prototype.accept=function(e){e.visit(this)},t}(a),c=function(e){function t(t){var r=e.call(this,t.definition)||this;return r.orgText="",Object(o.assign)(r,Object(o.pick)(t,(function(e){return void 0!==e}))),r}return i(t,e),t}(a),l=function(e){function t(t){var r=e.call(this,t.definition)||this;return r.ignoreAmbiguities=!1,Object(o.assign)(r,Object(o.pick)(t,(function(e){return void 0!==e}))),r}return i(t,e),t}(a),h=function(e){function t(t){var r=e.call(this,t.definition)||this;return r.idx=1,Object(o.assign)(r,Object(o.pick)(t,(function(e){return void 0!==e}))),r}return i(t,e),t}(a),d=function(e){function t(t){var r=e.call(this,t.definition)||this;return r.idx=1,Object(o.assign)(r,Object(o.pick)(t,(function(e){return void 0!==e}))),r}return i(t,e),t}(a),p=function(e){function t(t){var r=e.call(this,t.definition)||this;return r.idx=1,Object(o.assign)(r,Object(o.pick)(t,(function(e){return void 0!==e}))),r}return i(t,e),t}(a),m=function(e){function t(t){var r=e.call(this,t.definition)||this;return r.idx=1,Object(o.assign)(r,Object(o.pick)(t,(function(e){return void 0!==e}))),r}return i(t,e),t}(a),g=function(e){function t(t){var r=e.call(this,t.definition)||this;return r.idx=1,Object(o.assign)(r,Object(o.pick)(t,(function(e){return void 0!==e}))),r}return i(t,e),t}(a),f=function(e){function t(t){var r=e.call(this,t.definition)||this;return r.idx=1,r.ignoreAmbiguities=!1,r.hasPredicates=!1,Object(o.assign)(r,Object(o.pick)(t,(function(e){return void 0!==e}))),r}return i(t,e),t}(a),E=function(){function e(e){this.idx=1,Object(o.assign)(this,Object(o.pick)(e,(function(e){return void 0!==e})))}return e.prototype.accept=function(e){e.visit(this)},e}();function T(e){return Object(o.map)(e,y)}function y(e){function t(e){return Object(o.map)(e,y)}if(e instanceof u)return{type:"NonTerminal",name:e.nonTerminalName,idx:e.idx};if(e instanceof l)return{type:"Flat",definition:t(e.definition)};if(e instanceof h)return{type:"Option",idx:e.idx,definition:t(e.definition)};if(e instanceof d)return{type:"RepetitionMandatory",name:e.name,idx:e.idx,definition:t(e.definition)};if(e instanceof p)return{type:"RepetitionMandatoryWithSeparator",name:e.name,idx:e.idx,separator:y(new E({terminalType:e.separator})),definition:t(e.definition)};if(e instanceof g)return{type:"RepetitionWithSeparator",name:e.name,idx:e.idx,separator:y(new E({terminalType:e.separator})),definition:t(e.definition)};if(e instanceof m)return{type:"Repetition",name:e.name,idx:e.idx,definition:t(e.definition)};if(e instanceof f)return{type:"Alternation",name:e.name,idx:e.idx,definition:t(e.definition)};if(e instanceof E){var r={type:"Terminal",name:e.terminalType.name,label:Object(s.tokenLabel)(e.terminalType),idx:e.idx},n=e.terminalType.PATTERN;return e.terminalType.PATTERN&&(r.pattern=Object(o.isRegExp)(n)?n.source:n),r}if(e instanceof c)return{type:"Rule",name:e.name,orgText:e.orgText,definition:t(e.definition)};throw Error("non exhaustive match")}},function(e,t,r){"use strict";r.r(t),r.d(t,"tokenLabel",(function(){return i})),r.d(t,"tokenName",(function(){return a})),r.d(t,"hasTokenLabel",(function(){return u})),r.d(t,"createToken",(function(){return c})),r.d(t,"EOF",(function(){return l})),r.d(t,"createTokenInstance",(function(){return h})),r.d(t,"tokenMatcher",(function(){return d}));var n=r(87),o=r(92),s=r(97);function i(e){return u(e)?e.LABEL:e.name}function a(e){return e.name}function u(e){return Object(n.isString)(e.LABEL)&&""!==e.LABEL}function c(e){return function(e){var t=e.pattern,r={};if(r.name=e.name,Object(n.isUndefined)(t)||(r.PATTERN=t),Object(n.has)(e,"parent"))throw"The parent property is no longer supported.\nSee: https://github.com/SAP/chevrotain/issues/564#issuecomment-349062346 for details.";return Object(n.has)(e,"categories")&&(r.CATEGORIES=e.categories),Object(s.augmentTokenTypes)([r]),Object(n.has)(e,"label")&&(r.LABEL=e.label),Object(n.has)(e,"group")&&(r.GROUP=e.group),Object(n.has)(e,"pop_mode")&&(r.POP_MODE=e.pop_mode),Object(n.has)(e,"push_mode")&&(r.PUSH_MODE=e.push_mode),Object(n.has)(e,"longer_alt")&&(r.LONGER_ALT=e.longer_alt),Object(n.has)(e,"line_breaks")&&(r.LINE_BREAKS=e.line_breaks),Object(n.has)(e,"start_chars_hint")&&(r.START_CHARS_HINT=e.start_chars_hint),r}(e)}var l=c({name:"EOF",pattern:o.Lexer.NA});function h(e,t,r,n,o,s,i,a){return{image:t,startOffset:r,endOffset:n,startLine:o,endLine:s,startColumn:i,endColumn:a,tokenTypeIdx:e.tokenTypeIdx,tokenType:e}}function d(e,t){return Object(s.tokenStructuredMatcher)(e,t)}Object(s.augmentTokenTypes)([l])},function(e,t,r){"use strict";r.r(t),r.d(t,"LexerDefinitionErrorType",(function(){return n})),r.d(t,"Lexer",(function(){return l}));var n,o=r(93),s=r(87),i=r(97),a=r(98),u=r(96);!function(e){e[e.MISSING_PATTERN=0]="MISSING_PATTERN",e[e.INVALID_PATTERN=1]="INVALID_PATTERN",e[e.EOI_ANCHOR_FOUND=2]="EOI_ANCHOR_FOUND",e[e.UNSUPPORTED_FLAGS_FOUND=3]="UNSUPPORTED_FLAGS_FOUND",e[e.DUPLICATE_PATTERNS_FOUND=4]="DUPLICATE_PATTERNS_FOUND",e[e.INVALID_GROUP_TYPE_FOUND=5]="INVALID_GROUP_TYPE_FOUND",e[e.PUSH_MODE_DOES_NOT_EXIST=6]="PUSH_MODE_DOES_NOT_EXIST",e[e.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE=7]="MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE",e[e.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY=8]="MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY",e[e.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST=9]="MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST",e[e.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED=10]="LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED",e[e.SOI_ANCHOR_FOUND=11]="SOI_ANCHOR_FOUND",e[e.EMPTY_MATCH_PATTERN=12]="EMPTY_MATCH_PATTERN",e[e.NO_LINE_BREAKS_FLAGS=13]="NO_LINE_BREAKS_FLAGS",e[e.UNREACHABLE_PATTERN=14]="UNREACHABLE_PATTERN",e[e.IDENTIFY_TERMINATOR=15]="IDENTIFY_TERMINATOR",e[e.CUSTOM_LINE_BREAK=16]="CUSTOM_LINE_BREAK"}(n||(n={}));var c={deferDefinitionErrorsHandling:!1,positionTracking:"full",lineTerminatorsPattern:/\n|\r\n?/g,lineTerminatorCharacters:["\n","\r"],ensureOptimizations:!1,safeMode:!1,errorMessageProvider:a.defaultLexerErrorProvider,traceInitPerf:!1,skipValidations:!1};Object.freeze(c);var l=function(){function e(e,t){var r=this;if(void 0===t&&(t=c),this.lexerDefinition=e,this.lexerDefinitionErrors=[],this.lexerDefinitionWarning=[],this.patternIdxToConfig={},this.charCodeToPatternIdxToConfig={},this.modes=[],this.emptyGroups={},this.config=void 0,this.trackStartLines=!0,this.trackEndLines=!0,this.hasCustom=!1,this.canModeBeOptimized={},"boolean"==typeof t)throw Error("The second argument to the Lexer constructor is now an ILexerConfig Object.\na boolean 2nd argument is no longer supported");this.config=Object(s.merge)(c,t);var n=this.config.traceInitPerf;!0===n?(this.traceInitMaxIdent=1/0,this.traceInitPerf=!0):"number"==typeof n&&(this.traceInitMaxIdent=n,this.traceInitPerf=!0),this.traceInitIndent=-1,this.TRACE_INIT("Lexer Constructor",(function(){var n,a=!0;r.TRACE_INIT("Lexer Config handling",(function(){if(r.config.lineTerminatorsPattern===c.lineTerminatorsPattern)r.config.lineTerminatorsPattern=o.LineTerminatorOptimizedTester;else if(r.config.lineTerminatorCharacters===c.lineTerminatorCharacters)throw Error("Error: Missing <lineTerminatorCharacters> property on the Lexer config.\n\tFor details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#MISSING_LINE_TERM_CHARS");if(t.safeMode&&t.ensureOptimizations)throw Error('"safeMode" and "ensureOptimizations" flags are mutually exclusive.');r.trackStartLines=/full|onlyStart/i.test(r.config.positionTracking),r.trackEndLines=/full/i.test(r.config.positionTracking),Object(s.isArray)(e)?((n={modes:{}}).modes[o.DEFAULT_MODE]=Object(s.cloneArr)(e),n[o.DEFAULT_MODE]=o.DEFAULT_MODE):(a=!1,n=Object(s.cloneObj)(e))})),!1===r.config.skipValidations&&(r.TRACE_INIT("performRuntimeChecks",(function(){r.lexerDefinitionErrors=r.lexerDefinitionErrors.concat(Object(o.performRuntimeChecks)(n,r.trackStartLines,r.config.lineTerminatorCharacters))})),r.TRACE_INIT("performWarningRuntimeChecks",(function(){r.lexerDefinitionWarning=r.lexerDefinitionWarning.concat(Object(o.performWarningRuntimeChecks)(n,r.trackStartLines,r.config.lineTerminatorCharacters))}))),n.modes=n.modes?n.modes:{},Object(s.forEach)(n.modes,(function(e,t){n.modes[t]=Object(s.reject)(e,(function(e){return Object(s.isUndefined)(e)}))}));var l=Object(s.keys)(n.modes);if(Object(s.forEach)(n.modes,(function(e,n){r.TRACE_INIT("Mode: <"+n+"> processing",(function(){var a;r.modes.push(n),!1===r.config.skipValidations&&r.TRACE_INIT("validatePatterns",(function(){r.lexerDefinitionErrors=r.lexerDefinitionErrors.concat(Object(o.validatePatterns)(e,l))})),Object(s.isEmpty)(r.lexerDefinitionErrors)&&(Object(i.augmentTokenTypes)(e),r.TRACE_INIT("analyzeTokenTypes",(function(){a=Object(o.analyzeTokenTypes)(e,{lineTerminatorCharacters:r.config.lineTerminatorCharacters,positionTracking:t.positionTracking,ensureOptimizations:t.ensureOptimizations,safeMode:t.safeMode,tracer:r.TRACE_INIT.bind(r)})})),r.patternIdxToConfig[n]=a.patternIdxToConfig,r.charCodeToPatternIdxToConfig[n]=a.charCodeToPatternIdxToConfig,r.emptyGroups=Object(s.merge)(r.emptyGroups,a.emptyGroups),r.hasCustom=a.hasCustom||r.hasCustom,r.canModeBeOptimized[n]=a.canBeOptimized)}))})),r.defaultMode=n.defaultMode,!Object(s.isEmpty)(r.lexerDefinitionErrors)&&!r.config.deferDefinitionErrorsHandling){var h=Object(s.map)(r.lexerDefinitionErrors,(function(e){return e.message})).join("-----------------------\n");throw new Error("Errors detected in definition of Lexer:\n"+h)}Object(s.forEach)(r.lexerDefinitionWarning,(function(e){Object(s.PRINT_WARNING)(e.message)})),r.TRACE_INIT("Choosing sub-methods implementations",(function(){if(o.SUPPORT_STICKY?(r.chopInput=s.IDENTITY,r.match=r.matchWithTest):(r.updateLastIndex=s.NOOP,r.match=r.matchWithExec),a&&(r.handleModes=s.NOOP),!1===r.trackStartLines&&(r.computeNewColumn=s.IDENTITY),!1===r.trackEndLines&&(r.updateTokenEndLineColumnLocation=s.NOOP),/full/i.test(r.config.positionTracking))r.createTokenInstance=r.createFullToken;else if(/onlyStart/i.test(r.config.positionTracking))r.createTokenInstance=r.createStartOnlyToken;else{if(!/onlyOffset/i.test(r.config.positionTracking))throw Error('Invalid <positionTracking> config option: "'+r.config.positionTracking+'"');r.createTokenInstance=r.createOffsetOnlyToken}r.hasCustom?(r.addToken=r.addTokenUsingPush,r.handlePayload=r.handlePayloadWithCustom):(r.addToken=r.addTokenUsingMemberAccess,r.handlePayload=r.handlePayloadNoCustom)})),r.TRACE_INIT("Failed Optimization Warnings",(function(){var e=Object(s.reduce)(r.canModeBeOptimized,(function(e,t,r){return!1===t&&e.push(r),e}),[]);if(t.ensureOptimizations&&!Object(s.isEmpty)(e))throw Error("Lexer Modes: < "+e.join(", ")+' > cannot be optimized.\n\t Disable the "ensureOptimizations" lexer config flag to silently ignore this and run the lexer in an un-optimized mode.\n\t Or inspect the console log for details on how to resolve these issues.')})),r.TRACE_INIT("clearRegExpParserCache",(function(){Object(u.clearRegExpParserCache)()})),r.TRACE_INIT("toFastProperties",(function(){Object(s.toFastProperties)(r)}))}))}return e.prototype.tokenize=function(e,t){if(void 0===t&&(t=this.defaultMode),!Object(s.isEmpty)(this.lexerDefinitionErrors)){var r=Object(s.map)(this.lexerDefinitionErrors,(function(e){return e.message})).join("-----------------------\n");throw new Error("Unable to Tokenize because Errors detected in definition of Lexer:\n"+r)}return this.tokenizeInternal(e,t)},e.prototype.tokenizeInternal=function(e,t){var r,n,i,a,u,c,l,h,d,p,m,g,f,E,T=this,y=e,A=y.length,R=0,N=0,S=this.hasCustom?0:Math.floor(e.length/10),C=new Array(S),v=[],O=this.trackStartLines?1:void 0,I=this.trackStartLines?1:void 0,M=Object(o.cloneEmptyGroups)(this.emptyGroups),b=this.trackStartLines,F=this.config.lineTerminatorsPattern,w=0,_=[],L=[],x=[],P=[];Object.freeze(P);var U=void 0;function V(){return _}function D(e){var t=Object(o.charCodeToOptimizedIndex)(e),r=L[t];return void 0===r?P:r}var B,k=function(e){if(1===x.length&&void 0===e.tokenType.PUSH_MODE){var t=T.config.errorMessageProvider.buildUnableToPopLexerModeMessage(e);v.push({offset:e.startOffset,line:void 0!==e.startLine?e.startLine:void 0,column:void 0!==e.startColumn?e.startColumn:void 0,length:e.image.length,message:t})}else{x.pop();var r=Object(s.last)(x);_=T.patternIdxToConfig[r],L=T.charCodeToPatternIdxToConfig[r],w=_.length;var n=T.canModeBeOptimized[r]&&!1===T.config.safeMode;U=L&&n?D:V}};function G(e){x.push(e),L=this.charCodeToPatternIdxToConfig[e],_=this.patternIdxToConfig[e],w=_.length,w=_.length;var t=this.canModeBeOptimized[e]&&!1===this.config.safeMode;U=L&&t?D:V}for(G.call(this,t);R<A;){u=null;var j=y.charCodeAt(R),W=U(j),H=W.length;for(r=0;r<H;r++){var z=(B=W[r]).pattern;if(c=null,!1!==(te=B.short)?j===te&&(u=z):!0===B.isCustom?null!==(E=z.exec(y,R,C,M))?(u=E[0],void 0!==E.payload&&(c=E.payload)):u=null:(this.updateLastIndex(z,R),u=this.match(z,e,R)),null!==u){if(void 0!==(a=B.longerAlt)){var Y=_[a],X=Y.pattern;l=null,!0===Y.isCustom?null!==(E=X.exec(y,R,C,M))?(i=E[0],void 0!==E.payload&&(l=E.payload)):i=null:(this.updateLastIndex(X,R),i=this.match(X,e,R)),i&&i.length>u.length&&(u=i,c=l,B=Y)}break}}if(null!==u){if(h=u.length,void 0!==(d=B.group)&&(p=B.tokenTypeIdx,m=this.createTokenInstance(u,R,p,B.tokenType,O,I,h),this.handlePayload(m,c),!1===d?N=this.addToken(C,N,m):M[d].push(m)),e=this.chopInput(e,h),R+=h,I=this.computeNewColumn(I,h),!0===b&&!0===B.canLineTerminator){var K=0,$=void 0,q=void 0;F.lastIndex=0;do{!0===($=F.test(u))&&(q=F.lastIndex-1,K++)}while(!0===$);0!==K&&(O+=K,I=h-q,this.updateTokenEndLineColumnLocation(m,d,q,K,O,I,h))}this.handleModes(B,k,G,m)}else{for(var Q=R,Z=O,J=I,ee=!1;!ee&&R<A;)for(y.charCodeAt(R),e=this.chopInput(e,1),R++,n=0;n<w;n++){var te,re=_[n];if(z=re.pattern,!1!==(te=re.short)?y.charCodeAt(R)===te&&(ee=!0):!0===re.isCustom?ee=null!==z.exec(y,R,C,M):(this.updateLastIndex(z,R),ee=null!==z.exec(e)),!0===ee)break}g=R-Q,f=this.config.errorMessageProvider.buildUnexpectedCharactersMessage(y,Q,g,Z,J),v.push({offset:Q,line:Z,column:J,length:g,message:f})}}return this.hasCustom||(C.length=N),{tokens:C,groups:M,errors:v}},e.prototype.handleModes=function(e,t,r,n){if(!0===e.pop){var o=e.push;t(n),void 0!==o&&r.call(this,o)}else void 0!==e.push&&r.call(this,e.push)},e.prototype.chopInput=function(e,t){return e.substring(t)},e.prototype.updateLastIndex=function(e,t){e.lastIndex=t},e.prototype.updateTokenEndLineColumnLocation=function(e,t,r,n,o,s,i){var a,u;void 0!==t&&(u=(a=r===i-1)?-1:0,1===n&&!0===a||(e.endLine=o+u,e.endColumn=s-1-u))},e.prototype.computeNewColumn=function(e,t){return e+t},e.prototype.createTokenInstance=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return null},e.prototype.createOffsetOnlyToken=function(e,t,r,n){return{image:e,startOffset:t,tokenTypeIdx:r,tokenType:n}},e.prototype.createStartOnlyToken=function(e,t,r,n,o,s){return{image:e,startOffset:t,startLine:o,startColumn:s,tokenTypeIdx:r,tokenType:n}},e.prototype.createFullToken=function(e,t,r,n,o,s,i){return{image:e,startOffset:t,endOffset:t+i-1,startLine:o,endLine:o,startColumn:s,endColumn:s+i-1,tokenTypeIdx:r,tokenType:n}},e.prototype.addToken=function(e,t,r){return 666},e.prototype.addTokenUsingPush=function(e,t,r){return e.push(r),t},e.prototype.addTokenUsingMemberAccess=function(e,t,r){return e[t]=r,++t},e.prototype.handlePayload=function(e,t){},e.prototype.handlePayloadNoCustom=function(e,t){},e.prototype.handlePayloadWithCustom=function(e,t){null!==t&&(e.payload=t)},e.prototype.match=function(e,t,r){return null},e.prototype.matchWithTest=function(e,t,r){return!0===e.test(t)?t.substring(r,e.lastIndex):null},e.prototype.matchWithExec=function(e,t){var r=e.exec(t);return null!==r?r[0]:r},e.prototype.TRACE_INIT=function(e,t){if(!0===this.traceInitPerf){this.traceInitIndent++;var r=new Array(this.traceInitIndent+1).join("\t");this.traceInitIndent<this.traceInitMaxIdent&&console.log(r+"--\x3e <"+e+">");var n=Object(s.timer)(t),o=n.time,i=n.value,a=o>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&a(r+"<-- <"+e+"> time: "+o+"ms"),this.traceInitIndent--,i}return t()},e.SKIPPED="This marks a skipped Token pattern, this means each token identified by it willbe consumed and then thrown into oblivion, this can be used to for example to completely ignore whitespace.",e.NA=/NOT_APPLICABLE/,e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"DEFAULT_MODE",(function(){return h})),r.d(t,"MODES",(function(){return d})),r.d(t,"SUPPORT_STICKY",(function(){return p})),r.d(t,"disableSticky",(function(){return m})),r.d(t,"enableSticky",(function(){return g})),r.d(t,"analyzeTokenTypes",(function(){return f})),r.d(t,"validatePatterns",(function(){return E})),r.d(t,"findMissingPatterns",(function(){return T})),r.d(t,"findInvalidPatterns",(function(){return y})),r.d(t,"findEndOfInputAnchor",(function(){return R})),r.d(t,"findEmptyMatchRegExps",(function(){return N})),r.d(t,"findStartOfInputAnchor",(function(){return C})),r.d(t,"findUnsupportedFlags",(function(){return v})),r.d(t,"findDuplicatePatterns",(function(){return O})),r.d(t,"findInvalidGroupType",(function(){return I})),r.d(t,"findModesThatDoNotExist",(function(){return M})),r.d(t,"findUnreachablePatterns",(function(){return b})),r.d(t,"addStartOfInput",(function(){return F})),r.d(t,"addStickyFlag",(function(){return w})),r.d(t,"performRuntimeChecks",(function(){return _})),r.d(t,"performWarningRuntimeChecks",(function(){return L})),r.d(t,"cloneEmptyGroups",(function(){return x})),r.d(t,"isCustomPattern",(function(){return P})),r.d(t,"isShortPattern",(function(){return U})),r.d(t,"LineTerminatorOptimizedTester",(function(){return V})),r.d(t,"buildLineBreakIssueMessage",(function(){return B})),r.d(t,"minOptimizationVal",(function(){return j})),r.d(t,"charCodeToOptimizedIndex",(function(){return W}));var n,o=r(94),s=r(92),i=r(87),a=r(95),u=r(96),c=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),l="PATTERN",h="defaultMode",d="modes",p="boolean"==typeof new RegExp("(?:)").sticky;function m(){p=!1}function g(){p=!0}function f(e,t){var r,n=(t=Object(i.defaults)(t,{useSticky:p,debug:!1,safeMode:!1,positionTracking:"full",lineTerminatorCharacters:["\r","\n"],tracer:function(e,t){return t()}})).tracer;n("initCharCodeToOptimizedIndexMap",(function(){!function(){if(Object(i.isEmpty)(H)){H=new Array(65536);for(var e=0;e<65536;e++)H[e]=e>255?255+~~(e/255):e}}()})),n("Reject Lexer.NA",(function(){r=Object(i.reject)(e,(function(e){return e[l]===s.Lexer.NA}))}));var o,u,c,h,d,m,g,f,E,T,y,A=!1;n("Transform Patterns",(function(){A=!1,o=Object(i.map)(r,(function(e){var r=e[l];if(Object(i.isRegExp)(r)){var n=r.source;return 1===n.length&&"^"!==n&&"$"!==n&&"."!==n?n:2!==n.length||"\\"!==n[0]||Object(i.contains)(["d","D","s","S","t","r","n","t","0","c","b","B","f","v","w","W"],n[1])?t.useSticky?w(r):F(r):n[1]}if(Object(i.isFunction)(r))return A=!0,{exec:r};if(Object(i.has)(r,"exec"))return A=!0,r;if("string"==typeof r){if(1===r.length)return r;var o=r.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),s=new RegExp(o);return t.useSticky?w(s):F(s)}throw Error("non exhaustive match")}))})),n("misc mapping",(function(){u=Object(i.map)(r,(function(e){return e.tokenTypeIdx})),c=Object(i.map)(r,(function(e){var t=e.GROUP;if(t!==s.Lexer.SKIPPED){if(Object(i.isString)(t))return t;if(Object(i.isUndefined)(t))return!1;throw Error("non exhaustive match")}})),h=Object(i.map)(r,(function(e){var t=e.LONGER_ALT;if(t)return Object(i.indexOf)(r,t)})),d=Object(i.map)(r,(function(e){return e.PUSH_MODE})),m=Object(i.map)(r,(function(e){return Object(i.has)(e,"POP_MODE")}))})),n("Line Terminator Handling",(function(){var e=k(t.lineTerminatorCharacters);g=Object(i.map)(r,(function(e){return!1})),"onlyOffset"!==t.positionTracking&&(g=Object(i.map)(r,(function(t){return Object(i.has)(t,"LINE_BREAKS")?t.LINE_BREAKS:!1===D(t,e)?Object(a.canMatchCharCode)(e,t.PATTERN):void 0})))})),n("Misc Mapping #2",(function(){f=Object(i.map)(r,P),E=Object(i.map)(o,U),T=Object(i.reduce)(r,(function(e,t){var r=t.GROUP;return Object(i.isString)(r)&&r!==s.Lexer.SKIPPED&&(e[r]=[]),e}),{}),y=Object(i.map)(o,(function(e,t){return{pattern:o[t],longerAlt:h[t],canLineTerminator:g[t],isCustom:f[t],short:E[t],group:c[t],push:d[t],pop:m[t],tokenTypeIdx:u[t],tokenType:r[t]}}))}));var R=!0,N=[];return t.safeMode||n("First Char Optimization",(function(){N=Object(i.reduce)(r,(function(e,r,n){if("string"==typeof r.PATTERN){var o=W(r.PATTERN.charCodeAt(0));G(e,o,y[n])}else if(Object(i.isArray)(r.START_CHARS_HINT)){var s;Object(i.forEach)(r.START_CHARS_HINT,(function(t){var r=W("string"==typeof t?t.charCodeAt(0):t);s!==r&&(s=r,G(e,r,y[n]))}))}else if(Object(i.isRegExp)(r.PATTERN))if(r.PATTERN.unicode)R=!1,t.ensureOptimizations&&Object(i.PRINT_ERROR)(a.failedOptimizationPrefixMsg+"\tUnable to analyze < "+r.PATTERN.toString()+" > pattern.\n\tThe regexp unicode flag is not currently supported by the regexp-to-ast library.\n\tThis will disable the lexer's first char optimizations.\n\tFor details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#UNICODE_OPTIMIZE");else{var u=Object(a.getOptimizedStartCodesIndices)(r.PATTERN,t.ensureOptimizations);Object(i.isEmpty)(u)&&(R=!1),Object(i.forEach)(u,(function(t){G(e,t,y[n])}))}else t.ensureOptimizations&&Object(i.PRINT_ERROR)(a.failedOptimizationPrefixMsg+"\tTokenType: <"+r.name+"> is using a custom token pattern without providing <start_chars_hint> parameter.\n\tThis will disable the lexer's first char optimizations.\n\tFor details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#CUSTOM_OPTIMIZE"),R=!1;return e}),[])})),n("ArrayPacking",(function(){N=Object(i.packArray)(N)})),{emptyGroups:T,patternIdxToConfig:y,charCodeToPatternIdxToConfig:N,hasCustom:A,canBeOptimized:R}}function E(e,t){var r=[],n=T(e);r=r.concat(n.errors);var o=y(n.valid),s=o.valid;return r=(r=(r=(r=(r=r.concat(o.errors)).concat(function(e){var t=[],r=Object(i.filter)(e,(function(e){return Object(i.isRegExp)(e[l])}));return t=(t=(t=(t=(t=t.concat(R(r))).concat(C(r))).concat(v(r))).concat(O(r))).concat(N(r))}(s))).concat(I(s))).concat(M(s,t))).concat(b(s))}function T(e){var t=Object(i.filter)(e,(function(e){return!Object(i.has)(e,l)}));return{errors:Object(i.map)(t,(function(e){return{message:"Token Type: ->"+e.name+"<- missing static 'PATTERN' property",type:s.LexerDefinitionErrorType.MISSING_PATTERN,tokenTypes:[e]}})),valid:Object(i.difference)(e,t)}}function y(e){var t=Object(i.filter)(e,(function(e){var t=e[l];return!(Object(i.isRegExp)(t)||Object(i.isFunction)(t)||Object(i.has)(t,"exec")||Object(i.isString)(t))}));return{errors:Object(i.map)(t,(function(e){return{message:"Token Type: ->"+e.name+"<- static 'PATTERN' can only be a RegExp, a Function matching the {CustomPatternMatcherFunc} type or an Object matching the {ICustomPattern} interface.",type:s.LexerDefinitionErrorType.INVALID_PATTERN,tokenTypes:[e]}})),valid:Object(i.difference)(e,t)}}var A=/[^\\][\$]/;function R(e){var t=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.found=!1,t}return c(t,e),t.prototype.visitEndAnchor=function(e){this.found=!0},t}(o.BaseRegExpVisitor),r=Object(i.filter)(e,(function(e){var r=e[l];try{var n=Object(u.getRegExpAst)(r),o=new t;return o.visit(n),o.found}catch(e){return A.test(r.source)}}));return Object(i.map)(r,(function(e){return{message:"Unexpected RegExp Anchor Error:\n\tToken Type: ->"+e.name+"<- static 'PATTERN' cannot contain end of input anchor '$'\n\tSee sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#ANCHORS\tfor details.",type:s.LexerDefinitionErrorType.EOI_ANCHOR_FOUND,tokenTypes:[e]}}))}function N(e){var t=Object(i.filter)(e,(function(e){return e[l].test("")}));return Object(i.map)(t,(function(e){return{message:"Token Type: ->"+e.name+"<- static 'PATTERN' must not match an empty string",type:s.LexerDefinitionErrorType.EMPTY_MATCH_PATTERN,tokenTypes:[e]}}))}var S=/[^\\[][\^]|^\^/;function C(e){var t=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.found=!1,t}return c(t,e),t.prototype.visitStartAnchor=function(e){this.found=!0},t}(o.BaseRegExpVisitor),r=Object(i.filter)(e,(function(e){var r=e[l];try{var n=Object(u.getRegExpAst)(r),o=new t;return o.visit(n),o.found}catch(e){return S.test(r.source)}}));return Object(i.map)(r,(function(e){return{message:"Unexpected RegExp Anchor Error:\n\tToken Type: ->"+e.name+"<- static 'PATTERN' cannot contain start of input anchor '^'\n\tSee https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#ANCHORS\tfor details.",type:s.LexerDefinitionErrorType.SOI_ANCHOR_FOUND,tokenTypes:[e]}}))}function v(e){var t=Object(i.filter)(e,(function(e){var t=e[l];return t instanceof RegExp&&(t.multiline||t.global)}));return Object(i.map)(t,(function(e){return{message:"Token Type: ->"+e.name+"<- static 'PATTERN' may NOT contain global('g') or multiline('m')",type:s.LexerDefinitionErrorType.UNSUPPORTED_FLAGS_FOUND,tokenTypes:[e]}}))}function O(e){var t=[],r=Object(i.map)(e,(function(r){return Object(i.reduce)(e,(function(e,n){return r.PATTERN.source!==n.PATTERN.source||Object(i.contains)(t,n)||n.PATTERN===s.Lexer.NA||(t.push(n),e.push(n)),e}),[])}));r=Object(i.compact)(r);var n=Object(i.filter)(r,(function(e){return e.length>1}));return Object(i.map)(n,(function(e){var t=Object(i.map)(e,(function(e){return e.name}));return{message:"The same RegExp pattern ->"+Object(i.first)(e).PATTERN+"<-has been used in all of the following Token Types: "+t.join(", ")+" <-",type:s.LexerDefinitionErrorType.DUPLICATE_PATTERNS_FOUND,tokenTypes:e}}))}function I(e){var t=Object(i.filter)(e,(function(e){if(!Object(i.has)(e,"GROUP"))return!1;var t=e.GROUP;return t!==s.Lexer.SKIPPED&&t!==s.Lexer.NA&&!Object(i.isString)(t)}));return Object(i.map)(t,(function(e){return{message:"Token Type: ->"+e.name+"<- static 'GROUP' can only be Lexer.SKIPPED/Lexer.NA/A String",type:s.LexerDefinitionErrorType.INVALID_GROUP_TYPE_FOUND,tokenTypes:[e]}}))}function M(e,t){var r=Object(i.filter)(e,(function(e){return void 0!==e.PUSH_MODE&&!Object(i.contains)(t,e.PUSH_MODE)}));return Object(i.map)(r,(function(e){return{message:"Token Type: ->"+e.name+"<- static 'PUSH_MODE' value cannot refer to a Lexer Mode ->"+e.PUSH_MODE+"<-which does not exist",type:s.LexerDefinitionErrorType.PUSH_MODE_DOES_NOT_EXIST,tokenTypes:[e]}}))}function b(e){var t=[],r=Object(i.reduce)(e,(function(e,t,r){var n,o=t.PATTERN;return o===s.Lexer.NA||(Object(i.isString)(o)?e.push({str:o,idx:r,tokenType:t}):Object(i.isRegExp)(o)&&(n=o,void 0===Object(i.find)([".","\\","[","]","|","^","$","(",")","?","*","+","{"],(function(e){return-1!==n.source.indexOf(e)})))&&e.push({str:o.source,idx:r,tokenType:t})),e}),[]);return Object(i.forEach)(e,(function(e,n){Object(i.forEach)(r,(function(r){var o=r.str,a=r.idx,u=r.tokenType;if(n<a&&function(e,t){if(Object(i.isRegExp)(t)){var r=t.exec(e);return null!==r&&0===r.index}if(Object(i.isFunction)(t))return t(e,0,[],{});if(Object(i.has)(t,"exec"))return t.exec(e,0,[],{});if("string"==typeof t)return t===e;throw Error("non exhaustive match")}(o,e.PATTERN)){var c="Token: ->"+u.name+"<- can never be matched.\nBecause it appears AFTER the Token Type ->"+e.name+"<-in the lexer's definition.\nSee https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#UNREACHABLE";t.push({message:c,type:s.LexerDefinitionErrorType.UNREACHABLE_PATTERN,tokenTypes:[e,u]})}}))})),t}function F(e){var t=e.ignoreCase?"i":"";return new RegExp("^(?:"+e.source+")",t)}function w(e){var t=e.ignoreCase?"iy":"y";return new RegExp(""+e.source,t)}function _(e,t,r){var n=[];return Object(i.has)(e,h)||n.push({message:"A MultiMode Lexer cannot be initialized without a <"+h+"> property in its definition\n",type:s.LexerDefinitionErrorType.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE}),Object(i.has)(e,d)||n.push({message:"A MultiMode Lexer cannot be initialized without a <"+d+"> property in its definition\n",type:s.LexerDefinitionErrorType.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY}),Object(i.has)(e,d)&&Object(i.has)(e,h)&&!Object(i.has)(e.modes,e.defaultMode)&&n.push({message:"A MultiMode Lexer cannot be initialized with a "+h+": <"+e.defaultMode+">which does not exist\n",type:s.LexerDefinitionErrorType.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST}),Object(i.has)(e,d)&&Object(i.forEach)(e.modes,(function(e,t){Object(i.forEach)(e,(function(e,r){Object(i.isUndefined)(e)&&n.push({message:"A Lexer cannot be initialized using an undefined Token Type. Mode:<"+t+"> at index: <"+r+">\n",type:s.LexerDefinitionErrorType.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED})}))})),n}function L(e,t,r){var n=[],o=!1,u=Object(i.compact)(Object(i.flatten)(Object(i.mapValues)(e.modes,(function(e){return e})))),c=Object(i.reject)(u,(function(e){return e[l]===s.Lexer.NA})),h=k(r);return t&&Object(i.forEach)(c,(function(e){var t=D(e,h);if(!1!==t){var r={message:B(e,t),type:t.issue,tokenType:e};n.push(r)}else Object(i.has)(e,"LINE_BREAKS")?!0===e.LINE_BREAKS&&(o=!0):Object(a.canMatchCharCode)(h,e.PATTERN)&&(o=!0)})),t&&!o&&n.push({message:"Warning: No LINE_BREAKS Found.\n\tThis Lexer has been defined to track line and column information,\n\tBut none of the Token Types can be identified as matching a line terminator.\n\tSee https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#LINE_BREAKS \n\tfor details.",type:s.LexerDefinitionErrorType.NO_LINE_BREAKS_FLAGS}),n}function x(e){var t={},r=Object(i.keys)(e);return Object(i.forEach)(r,(function(r){var n=e[r];if(!Object(i.isArray)(n))throw Error("non exhaustive match");t[r]=[]})),t}function P(e){var t=e.PATTERN;if(Object(i.isRegExp)(t))return!1;if(Object(i.isFunction)(t))return!0;if(Object(i.has)(t,"exec"))return!0;if(Object(i.isString)(t))return!1;throw Error("non exhaustive match")}function U(e){return!(!Object(i.isString)(e)||1!==e.length)&&e.charCodeAt(0)}var V={test:function(e){for(var t=e.length,r=this.lastIndex;r<t;r++){var n=e.charCodeAt(r);if(10===n)return this.lastIndex=r+1,!0;if(13===n)return 10===e.charCodeAt(r+1)?this.lastIndex=r+2:this.lastIndex=r+1,!0}return!1},lastIndex:0};function D(e,t){if(Object(i.has)(e,"LINE_BREAKS"))return!1;if(Object(i.isRegExp)(e.PATTERN)){try{Object(a.canMatchCharCode)(t,e.PATTERN)}catch(e){return{issue:s.LexerDefinitionErrorType.IDENTIFY_TERMINATOR,errMsg:e.message}}return!1}if(Object(i.isString)(e.PATTERN))return!1;if(P(e))return{issue:s.LexerDefinitionErrorType.CUSTOM_LINE_BREAK};throw Error("non exhaustive match")}function B(e,t){if(t.issue===s.LexerDefinitionErrorType.IDENTIFY_TERMINATOR)return"Warning: unable to identify line terminator usage in pattern.\n\tThe problem is in the <"+e.name+"> Token Type\n\t Root cause: "+t.errMsg+".\n\tFor details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#IDENTIFY_TERMINATOR";if(t.issue===s.LexerDefinitionErrorType.CUSTOM_LINE_BREAK)return"Warning: A Custom Token Pattern should specify the <line_breaks> option.\n\tThe problem is in the <"+e.name+"> Token Type\n\tFor details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#CUSTOM_LINE_BREAK";throw Error("non exhaustive match")}function k(e){return Object(i.map)(e,(function(e){return Object(i.isString)(e)&&e.length>0?e.charCodeAt(0):e}))}function G(e,t,r){void 0===e[t]?e[t]=[r]:e[t].push(r)}var j=256;function W(e){return e<j?e:H[e]}var H=[]},function(e,t,r){var n,o,s;"undefined"!=typeof self&&self,o=[],void 0===(s="function"==typeof(n=function(){function e(){}e.prototype.saveState=function(){return{idx:this.idx,input:this.input,groupIdx:this.groupIdx}},e.prototype.restoreState=function(e){this.idx=e.idx,this.input=e.input,this.groupIdx=e.groupIdx},e.prototype.pattern=function(e){this.idx=0,this.input=e,this.groupIdx=0,this.consumeChar("/");var t=this.disjunction();this.consumeChar("/");for(var r={type:"Flags",global:!1,ignoreCase:!1,multiLine:!1,unicode:!1,sticky:!1};this.isRegExpFlag();)switch(this.popChar()){case"g":a(r,"global");break;case"i":a(r,"ignoreCase");break;case"m":a(r,"multiLine");break;case"u":a(r,"unicode");break;case"y":a(r,"sticky")}if(this.idx!==this.input.length)throw Error("Redundant input: "+this.input.substring(this.idx));return{type:"Pattern",flags:r,value:t}},e.prototype.disjunction=function(){var e=[];for(e.push(this.alternative());"|"===this.peekChar();)this.consumeChar("|"),e.push(this.alternative());return{type:"Disjunction",value:e}},e.prototype.alternative=function(){for(var e=[];this.isTerm();)e.push(this.term());return{type:"Alternative",value:e}},e.prototype.term=function(){return this.isAssertion()?this.assertion():this.atom()},e.prototype.assertion=function(){switch(this.popChar()){case"^":return{type:"StartAnchor"};case"$":return{type:"EndAnchor"};case"\\":switch(this.popChar()){case"b":return{type:"WordBoundary"};case"B":return{type:"NonWordBoundary"}}throw Error("Invalid Assertion Escape");case"(":var e;switch(this.consumeChar("?"),this.popChar()){case"=":e="Lookahead";break;case"!":e="NegativeLookahead"}u(e);var t=this.disjunction();return this.consumeChar(")"),{type:e,value:t}}!function(){throw Error("Internal Error - Should never get here!")}()},e.prototype.quantifier=function(e){var t;switch(this.popChar()){case"*":t={atLeast:0,atMost:1/0};break;case"+":t={atLeast:1,atMost:1/0};break;case"?":t={atLeast:0,atMost:1};break;case"{":var r=this.integerIncludingZero();switch(this.popChar()){case"}":t={atLeast:r,atMost:r};break;case",":t=this.isDigit()?{atLeast:r,atMost:this.integerIncludingZero()}:{atLeast:r,atMost:1/0},this.consumeChar("}")}if(!0===e&&void 0===t)return;u(t)}if(!0!==e||void 0!==t)return u(t),"?"===this.peekChar(0)?(this.consumeChar("?"),t.greedy=!1):t.greedy=!0,t.type="Quantifier",t},e.prototype.atom=function(){var e;switch(this.peekChar()){case".":e=this.dotAll();break;case"\\":e=this.atomEscape();break;case"[":e=this.characterClass();break;case"(":e=this.group()}return void 0===e&&this.isPatternCharacter()&&(e=this.patternCharacter()),u(e),this.isQuantifier()&&(e.quantifier=this.quantifier()),e},e.prototype.dotAll=function(){return this.consumeChar("."),{type:"Set",complement:!0,value:[s("\n"),s("\r"),s("\u2028"),s("\u2029")]}},e.prototype.atomEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return this.decimalEscapeAtom();case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},e.prototype.decimalEscapeAtom=function(){return{type:"GroupBackReference",value:this.positiveInteger()}},e.prototype.characterClassEscape=function(){var e,t=!1;switch(this.popChar()){case"d":e=c;break;case"D":e=c,t=!0;break;case"s":e=h;break;case"S":e=h,t=!0;break;case"w":e=l;break;case"W":e=l,t=!0}return u(e),{type:"Set",value:e,complement:t}},e.prototype.controlEscapeAtom=function(){var e;switch(this.popChar()){case"f":e=s("\f");break;case"n":e=s("\n");break;case"r":e=s("\r");break;case"t":e=s("\t");break;case"v":e=s("\v")}return u(e),{type:"Character",value:e}},e.prototype.controlLetterEscapeAtom=function(){this.consumeChar("c");var e=this.popChar();if(!1===/[a-zA-Z]/.test(e))throw Error("Invalid ");return{type:"Character",value:e.toUpperCase().charCodeAt(0)-64}},e.prototype.nulCharacterAtom=function(){return this.consumeChar("0"),{type:"Character",value:s("\0")}},e.prototype.hexEscapeSequenceAtom=function(){return this.consumeChar("x"),this.parseHexDigits(2)},e.prototype.regExpUnicodeEscapeSequenceAtom=function(){return this.consumeChar("u"),this.parseHexDigits(4)},e.prototype.identityEscapeAtom=function(){return{type:"Character",value:s(this.popChar())}},e.prototype.classPatternCharacterAtom=function(){switch(this.peekChar()){case"\n":case"\r":case"\u2028":case"\u2029":case"\\":case"]":throw Error("TBD");default:return{type:"Character",value:s(this.popChar())}}},e.prototype.characterClass=function(){var e=[],t=!1;for(this.consumeChar("["),"^"===this.peekChar(0)&&(this.consumeChar("^"),t=!0);this.isClassAtom();){var r=this.classAtom();if("Character"===r.type&&this.isRangeDash()){this.consumeChar("-");var n=this.classAtom();if("Character"===n.type){if(n.value<r.value)throw Error("Range out of order in character class");e.push({from:r.value,to:n.value})}else i(r.value,e),e.push(s("-")),i(n.value,e)}else i(r.value,e)}return this.consumeChar("]"),{type:"Set",complement:t,value:e}},e.prototype.classAtom=function(){switch(this.peekChar()){case"]":case"\n":case"\r":case"\u2028":case"\u2029":throw Error("TBD");case"\\":return this.classEscape();default:return this.classPatternCharacterAtom()}},e.prototype.classEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"b":return this.consumeChar("b"),{type:"Character",value:s("\b")};case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},e.prototype.group=function(){var e=!0;switch(this.consumeChar("("),this.peekChar(0)){case"?":this.consumeChar("?"),this.consumeChar(":"),e=!1;break;default:this.groupIdx++}var t=this.disjunction();this.consumeChar(")");var r={type:"Group",capturing:e,value:t};return e&&(r.idx=this.groupIdx),r},e.prototype.positiveInteger=function(){var e=this.popChar();if(!1===o.test(e))throw Error("Expecting a positive integer");for(;n.test(this.peekChar(0));)e+=this.popChar();return parseInt(e,10)},e.prototype.integerIncludingZero=function(){var e=this.popChar();if(!1===n.test(e))throw Error("Expecting an integer");for(;n.test(this.peekChar(0));)e+=this.popChar();return parseInt(e,10)},e.prototype.patternCharacter=function(){var e=this.popChar();switch(e){case"\n":case"\r":case"\u2028":case"\u2029":case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":throw Error("TBD");default:return{type:"Character",value:s(e)}}},e.prototype.isRegExpFlag=function(){switch(this.peekChar(0)){case"g":case"i":case"m":case"u":case"y":return!0;default:return!1}},e.prototype.isRangeDash=function(){return"-"===this.peekChar()&&this.isClassAtom(1)},e.prototype.isDigit=function(){return n.test(this.peekChar(0))},e.prototype.isClassAtom=function(e){switch(void 0===e&&(e=0),this.peekChar(e)){case"]":case"\n":case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},e.prototype.isTerm=function(){return this.isAtom()||this.isAssertion()},e.prototype.isAtom=function(){if(this.isPatternCharacter())return!0;switch(this.peekChar(0)){case".":case"\\":case"[":case"(":return!0;default:return!1}},e.prototype.isAssertion=function(){switch(this.peekChar(0)){case"^":case"$":return!0;case"\\":switch(this.peekChar(1)){case"b":case"B":return!0;default:return!1}case"(":return"?"===this.peekChar(1)&&("="===this.peekChar(2)||"!"===this.peekChar(2));default:return!1}},e.prototype.isQuantifier=function(){var e=this.saveState();try{return void 0!==this.quantifier(!0)}catch(e){return!1}finally{this.restoreState(e)}},e.prototype.isPatternCharacter=function(){switch(this.peekChar()){case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":case"/":case"\n":case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},e.prototype.parseHexDigits=function(e){for(var t="",n=0;n<e;n++){var o=this.popChar();if(!1===r.test(o))throw Error("Expecting a HexDecimal digits");t+=o}return{type:"Character",value:parseInt(t,16)}},e.prototype.peekChar=function(e){return void 0===e&&(e=0),this.input[this.idx+e]},e.prototype.popChar=function(){var e=this.peekChar(0);return this.consumeChar(),e},e.prototype.consumeChar=function(e){if(void 0!==e&&this.input[this.idx]!==e)throw Error("Expected: '"+e+"' but found: '"+this.input[this.idx]+"' at offset: "+this.idx);if(this.idx>=this.input.length)throw Error("Unexpected end of input");this.idx++};var t,r=/[0-9a-fA-F]/,n=/[0-9]/,o=/[1-9]/;function s(e){return e.charCodeAt(0)}function i(e,t){void 0!==e.length?e.forEach((function(e){t.push(e)})):t.push(e)}function a(e,t){if(!0===e[t])throw"duplicate flag "+t;e[t]=!0}function u(e){if(void 0===e)throw Error("Internal Error - Should never get here!")}var c=[];for(t=s("0");t<=s("9");t++)c.push(t);var l=[s("_")].concat(c);for(t=s("a");t<=s("z");t++)l.push(t);for(t=s("A");t<=s("Z");t++)l.push(t);var h=[s(" "),s("\f"),s("\n"),s("\r"),s("\t"),s("\v"),s("\t"),s("Â "),s("á"),s("â"),s("â"),s("â"),s("â"),s("â"),s("â"),s("â"),s("â"),s("â"),s("â"),s("â"),s("\u2028"),s("\u2029"),s("â¯"),s("â"),s("ã"),s("\ufeff")];function d(){}return d.prototype.visitChildren=function(e){for(var t in e){var r=e[t];e.hasOwnProperty(t)&&(void 0!==r.type?this.visit(r):Array.isArray(r)&&r.forEach((function(e){this.visit(e)}),this))}},d.prototype.visit=function(e){switch(e.type){case"Pattern":this.visitPattern(e);break;case"Flags":this.visitFlags(e);break;case"Disjunction":this.visitDisjunction(e);break;case"Alternative":this.visitAlternative(e);break;case"StartAnchor":this.visitStartAnchor(e);break;case"EndAnchor":this.visitEndAnchor(e);break;case"WordBoundary":this.visitWordBoundary(e);break;case"NonWordBoundary":this.visitNonWordBoundary(e);break;case"Lookahead":this.visitLookahead(e);break;case"NegativeLookahead":this.visitNegativeLookahead(e);break;case"Character":this.visitCharacter(e);break;case"Set":this.visitSet(e);break;case"Group":this.visitGroup(e);break;case"GroupBackReference":this.visitGroupBackReference(e);break;case"Quantifier":this.visitQuantifier(e)}this.visitChildren(e)},d.prototype.visitPattern=function(e){},d.prototype.visitFlags=function(e){},d.prototype.visitDisjunction=function(e){},d.prototype.visitAlternative=function(e){},d.prototype.visitStartAnchor=function(e){},d.prototype.visitEndAnchor=function(e){},d.prototype.visitWordBoundary=function(e){},d.prototype.visitNonWordBoundary=function(e){},d.prototype.visitLookahead=function(e){},d.prototype.visitNegativeLookahead=function(e){},d.prototype.visitCharacter=function(e){},d.prototype.visitSet=function(e){},d.prototype.visitGroup=function(e){},d.prototype.visitGroupBackReference=function(e){},d.prototype.visitQuantifier=function(e){},{RegExpParser:e,BaseRegExpVisitor:d,VERSION:"0.4.0"}})?n.apply(t,o):n)||(e.exports=s)},function(e,t,r){"use strict";r.r(t),r.d(t,"failedOptimizationPrefixMsg",(function(){return c})),r.d(t,"getOptimizedStartCodesIndices",(function(){return l})),r.d(t,"firstCharOptimizedIndices",(function(){return h})),r.d(t,"canMatchCharCode",(function(){return f}));var n,o=r(94),s=r(87),i=r(96),a=r(93),u=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),c='Unable to use "first char" lexer optimizations:\n';function l(e,t){void 0===t&&(t=!1);try{var r=Object(i.getRegExpAst)(e);return h(r.value,{},r.flags.ignoreCase)}catch(r){if("Complement Sets are not supported for first char optimization"===r.message)t&&Object(s.PRINT_WARNING)(c+"\tUnable to optimize: < "+e.toString()+" >\n\tComplement Sets cannot be automatically optimized.\n\tThis will disable the lexer's first char optimizations.\n\tSee: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#COMPLEMENT for details.");else{var n="";t&&(n="\n\tThis will disable the lexer's first char optimizations.\n\tSee: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#REGEXP_PARSING for details."),Object(s.PRINT_ERROR)(c+"\n\tFailed parsing: < "+e.toString()+" >\n\tUsing the regexp-to-ast library version: "+o.VERSION+"\n\tPlease open an issue at: https://github.com/bd82/regexp-to-ast/issues"+n)}}return[]}function h(e,t,r){switch(e.type){case"Disjunction":for(var n=0;n<e.value.length;n++)h(e.value[n],t,r);break;case"Alternative":var o=e.value;for(n=0;n<o.length;n++){var i=o[n];switch(i.type){case"EndAnchor":case"GroupBackReference":case"Lookahead":case"NegativeLookahead":case"StartAnchor":case"WordBoundary":case"NonWordBoundary":continue}var u=i;switch(u.type){case"Character":d(u.value,t,r);break;case"Set":if(!0===u.complement)throw Error("Complement Sets are not supported for first char optimization");Object(s.forEach)(u.value,(function(e){if("number"==typeof e)d(e,t,r);else{var n=e;if(!0===r)for(var o=n.from;o<=n.to;o++)d(o,t,r);else{for(o=n.from;o<=n.to&&o<a.minOptimizationVal;o++)d(o,t,r);if(n.to>=a.minOptimizationVal)for(var s=n.from>=a.minOptimizationVal?n.from:a.minOptimizationVal,i=n.to,u=Object(a.charCodeToOptimizedIndex)(s),c=Object(a.charCodeToOptimizedIndex)(i),l=u;l<=c;l++)t[l]=l}}}));break;case"Group":h(u.value,t,r);break;default:throw Error("Non Exhaustive Match")}var c=void 0!==u.quantifier&&0===u.quantifier.atLeast;if("Group"===u.type&&!1===m(u)||"Group"!==u.type&&!1===c)break}break;default:throw Error("non exhaustive match!")}return Object(s.values)(t)}function d(e,t,r){var n=Object(a.charCodeToOptimizedIndex)(e);t[n]=n,!0===r&&function(e,t){var r=String.fromCharCode(e),n=r.toUpperCase();if(n!==r){var o=Object(a.charCodeToOptimizedIndex)(n.charCodeAt(0));t[o]=o}else{var s=r.toLowerCase();s!==r&&(o=Object(a.charCodeToOptimizedIndex)(s.charCodeAt(0)),t[o]=o)}}(e,t)}function p(e,t){return Object(s.find)(e.value,(function(e){if("number"==typeof e)return Object(s.contains)(t,e);var r=e;return void 0!==Object(s.find)(t,(function(e){return r.from<=e&&e<=r.to}))}))}function m(e){return!(!e.quantifier||0!==e.quantifier.atLeast)||!!e.value&&(Object(s.isArray)(e.value)?Object(s.every)(e.value,m):m(e.value))}var g=function(e){function t(t){var r=e.call(this)||this;return r.targetCharCodes=t,r.found=!1,r}return u(t,e),t.prototype.visitChildren=function(t){if(!0!==this.found){switch(t.type){case"Lookahead":return void this.visitLookahead(t);case"NegativeLookahead":return void this.visitNegativeLookahead(t)}e.prototype.visitChildren.call(this,t)}},t.prototype.visitCharacter=function(e){Object(s.contains)(this.targetCharCodes,e.value)&&(this.found=!0)},t.prototype.visitSet=function(e){e.complement?void 0===p(e,this.targetCharCodes)&&(this.found=!0):void 0!==p(e,this.targetCharCodes)&&(this.found=!0)},t}(o.BaseRegExpVisitor);function f(e,t){if(t instanceof RegExp){var r=Object(i.getRegExpAst)(t),n=new g(e);return n.visit(r),n.found}return void 0!==Object(s.find)(t,(function(t){return Object(s.contains)(e,t.charCodeAt(0))}))}},function(e,t,r){"use strict";r.r(t),r.d(t,"getRegExpAst",(function(){return i})),r.d(t,"clearRegExpParserCache",(function(){return a}));var n=r(94),o={},s=new n.RegExpParser;function i(e){var t=e.toString();if(o.hasOwnProperty(t))return o[t];var r=s.pattern(t);return o[t]=r,r}function a(){o={}}},function(e,t,r){"use strict";r.r(t),r.d(t,"tokenStructuredMatcher",(function(){return o})),r.d(t,"tokenStructuredMatcherNoCategories",(function(){return s})),r.d(t,"tokenShortNameIdx",(function(){return i})),r.d(t,"tokenIdxToClass",(function(){return a})),r.d(t,"augmentTokenTypes",(function(){return u})),r.d(t,"expandCategories",(function(){return c})),r.d(t,"assignTokenDefaultProps",(function(){return l})),r.d(t,"assignCategoriesTokensProp",(function(){return h})),r.d(t,"assignCategoriesMapProp",(function(){return d})),r.d(t,"singleAssignCategoriesToksMap",(function(){return p})),r.d(t,"hasShortKeyProperty",(function(){return m})),r.d(t,"hasCategoriesProperty",(function(){return g})),r.d(t,"hasExtendingTokensTypesProperty",(function(){return f})),r.d(t,"hasExtendingTokensTypesMapProperty",(function(){return E})),r.d(t,"isTokenType",(function(){return T}));var n=r(87);function o(e,t){var r=e.tokenTypeIdx;return r===t.tokenTypeIdx||!0===t.isParent&&!0===t.categoryMatchesMap[r]}function s(e,t){return e.tokenTypeIdx===t.tokenTypeIdx}var i=1,a={};function u(e){var t=c(e);l(t),d(t),h(t),Object(n.forEach)(t,(function(e){e.isParent=e.categoryMatches.length>0}))}function c(e){for(var t=Object(n.cloneArr)(e),r=e,o=!0;o;){r=Object(n.compact)(Object(n.flatten)(Object(n.map)(r,(function(e){return e.CATEGORIES}))));var s=Object(n.difference)(r,t);t=t.concat(s),Object(n.isEmpty)(s)?o=!1:r=s}return t}function l(e){Object(n.forEach)(e,(function(e){m(e)||(a[i]=e,e.tokenTypeIdx=i++),g(e)&&!Object(n.isArray)(e.CATEGORIES)&&(e.CATEGORIES=[e.CATEGORIES]),g(e)||(e.CATEGORIES=[]),f(e)||(e.categoryMatches=[]),E(e)||(e.categoryMatchesMap={})}))}function h(e){Object(n.forEach)(e,(function(e){e.categoryMatches=[],Object(n.forEach)(e.categoryMatchesMap,(function(t,r){e.categoryMatches.push(a[r].tokenTypeIdx)}))}))}function d(e){Object(n.forEach)(e,(function(e){p([],e)}))}function p(e,t){Object(n.forEach)(e,(function(e){t.categoryMatchesMap[e.tokenTypeIdx]=!0})),Object(n.forEach)(t.CATEGORIES,(function(r){var o=e.concat(t);Object(n.contains)(o,r)||p(o,r)}))}function m(e){return Object(n.has)(e,"tokenTypeIdx")}function g(e){return Object(n.has)(e,"CATEGORIES")}function f(e){return Object(n.has)(e,"categoryMatches")}function E(e){return Object(n.has)(e,"categoryMatchesMap")}function T(e){return Object(n.has)(e,"tokenTypeIdx")}},function(e,t,r){"use strict";r.r(t),r.d(t,"defaultLexerErrorProvider",(function(){return n}));var n={buildUnableToPopLexerModeMessage:function(e){return"Unable to pop Lexer Mode after encountering Token ->"+e.image+"<- The Mode Stack is empty"},buildUnexpectedCharactersMessage:function(e,t,r,n,o){return"unexpected character: ->"+e.charAt(t)+"<- at offset: "+t+", skipped "+r+" characters."}}},function(e,t,r){"use strict";r.r(t),r.d(t,"first",(function(){return i})),r.d(t,"firstForSequence",(function(){return a})),r.d(t,"firstForBranching",(function(){return u})),r.d(t,"firstForTerminal",(function(){return c}));var n=r(87),o=r(90),s=r(100);function i(e){if(e instanceof o.NonTerminal)return i(e.referencedRule);if(e instanceof o.Terminal)return c(e);if(Object(s.isSequenceProd)(e))return a(e);if(Object(s.isBranchingProd)(e))return u(e);throw Error("non exhaustive match")}function a(e){for(var t,r=[],o=e.definition,a=0,u=o.length>a,c=!0;u&&c;)t=o[a],c=Object(s.isOptionalProd)(t),r=r.concat(i(t)),a+=1,u=o.length>a;return Object(n.uniq)(r)}function u(e){var t=Object(n.map)(e.definition,(function(e){return i(e)}));return Object(n.uniq)(Object(n.flatten)(t))}function c(e){return[e.terminalType]}},function(e,t,r){"use strict";r.r(t),r.d(t,"isSequenceProd",(function(){return u})),r.d(t,"isOptionalProd",(function(){return c})),r.d(t,"isBranchingProd",(function(){return l})),r.d(t,"getProductionDslName",(function(){return h})),r.d(t,"DslMethodsCollectorVisitor",(function(){return d})),r.d(t,"collectMethods",(function(){return m}));var n,o=r(87),s=r(90),i=r(101),a=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function u(e){return e instanceof s.Flat||e instanceof s.Option||e instanceof s.Repetition||e instanceof s.RepetitionMandatory||e instanceof s.RepetitionMandatoryWithSeparator||e instanceof s.RepetitionWithSeparator||e instanceof s.Terminal||e instanceof s.Rule}function c(e,t){return void 0===t&&(t=[]),!!(e instanceof s.Option||e instanceof s.Repetition||e instanceof s.RepetitionWithSeparator)||(e instanceof s.Alternation?Object(o.some)(e.definition,(function(e){return c(e,t)})):!(e instanceof s.NonTerminal&&Object(o.contains)(t,e))&&e instanceof s.AbstractProduction&&(e instanceof s.NonTerminal&&t.push(e),Object(o.every)(e.definition,(function(e){return c(e,t)}))))}function l(e){return e instanceof s.Alternation}function h(e){if(e instanceof s.NonTerminal)return"SUBRULE";if(e instanceof s.Option)return"OPTION";if(e instanceof s.Alternation)return"OR";if(e instanceof s.RepetitionMandatory)return"AT_LEAST_ONE";if(e instanceof s.RepetitionMandatoryWithSeparator)return"AT_LEAST_ONE_SEP";if(e instanceof s.RepetitionWithSeparator)return"MANY_SEP";if(e instanceof s.Repetition)return"MANY";if(e instanceof s.Terminal)return"CONSUME";throw Error("non exhaustive match")}var d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.separator="-",t.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]},t}return a(t,e),t.prototype.reset=function(){this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}},t.prototype.visitTerminal=function(e){var t=e.terminalType.name+this.separator+"Terminal";Object(o.has)(this.dslMethods,t)||(this.dslMethods[t]=[]),this.dslMethods[t].push(e)},t.prototype.visitNonTerminal=function(e){var t=e.nonTerminalName+this.separator+"Terminal";Object(o.has)(this.dslMethods,t)||(this.dslMethods[t]=[]),this.dslMethods[t].push(e)},t.prototype.visitOption=function(e){this.dslMethods.option.push(e)},t.prototype.visitRepetitionWithSeparator=function(e){this.dslMethods.repetitionWithSeparator.push(e)},t.prototype.visitRepetitionMandatory=function(e){this.dslMethods.repetitionMandatory.push(e)},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.dslMethods.repetitionMandatoryWithSeparator.push(e)},t.prototype.visitRepetition=function(e){this.dslMethods.repetition.push(e)},t.prototype.visitAlternation=function(e){this.dslMethods.alternation.push(e)},t}(i.GAstVisitor),p=new d;function m(e){p.reset(),e.accept(p);var t=p.dslMethods;return p.reset(),t}},function(e,t,r){"use strict";r.r(t),r.d(t,"GAstVisitor",(function(){return o}));var n=r(90),o=function(){function e(){}return e.prototype.visit=function(e){var t=e;switch(t.constructor){case n.NonTerminal:return this.visitNonTerminal(t);case n.Flat:return this.visitFlat(t);case n.Option:return this.visitOption(t);case n.RepetitionMandatory:return this.visitRepetitionMandatory(t);case n.RepetitionMandatoryWithSeparator:return this.visitRepetitionMandatoryWithSeparator(t);case n.RepetitionWithSeparator:return this.visitRepetitionWithSeparator(t);case n.Repetition:return this.visitRepetition(t);case n.Alternation:return this.visitAlternation(t);case n.Terminal:return this.visitTerminal(t);case n.Rule:return this.visitRule(t);default:throw Error("non exhaustive match")}},e.prototype.visitNonTerminal=function(e){},e.prototype.visitFlat=function(e){},e.prototype.visitOption=function(e){},e.prototype.visitRepetition=function(e){},e.prototype.visitRepetitionMandatory=function(e){},e.prototype.visitRepetitionMandatoryWithSeparator=function(e){},e.prototype.visitRepetitionWithSeparator=function(e){},e.prototype.visitAlternation=function(e){},e.prototype.visitTerminal=function(e){},e.prototype.visitRule=function(e){},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"IN",(function(){return n}));var n="_~IN~_"},function(e,t,r){"use strict";r.r(t),r.d(t,"setNodeLocationOnlyOffset",(function(){return c})),r.d(t,"setNodeLocationFull",(function(){return l})),r.d(t,"addTerminalToCst",(function(){return h})),r.d(t,"addNoneTerminalToCst",(function(){return d})),r.d(t,"NamedDSLMethodsCollectorVisitor",(function(){return p})),r.d(t,"expandAllNestedRuleNames",(function(){return m}));var n,o=r(87),s=r(104),i=r(90),a=r(101),u=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function c(e,t){!0===isNaN(e.startOffset)?(e.startOffset=t.startOffset,e.endOffset=t.endOffset):e.endOffset<t.endOffset==1&&(e.endOffset=t.endOffset)}function l(e,t){!0===isNaN(e.startOffset)?(e.startOffset=t.startOffset,e.startColumn=t.startColumn,e.startLine=t.startLine,e.endOffset=t.endOffset,e.endColumn=t.endColumn,e.endLine=t.endLine):e.endOffset<t.endOffset==1&&(e.endOffset=t.endOffset,e.endColumn=t.endColumn,e.endLine=t.endLine)}function h(e,t,r){void 0===e.children[r]?e.children[r]=[t]:e.children[r].push(t)}function d(e,t,r){void 0===e.children[t]?e.children[t]=[r]:e.children[t].push(r)}var p=function(e){function t(t){var r=e.call(this)||this;return r.result=[],r.ruleIdx=t,r}return u(t,e),t.prototype.collectNamedDSLMethod=function(e,t,r){if(!Object(o.isUndefined)(e.name)){var n=void 0;if(e instanceof i.Option||e instanceof i.Repetition||e instanceof i.RepetitionMandatory||e instanceof i.Alternation)n=new t({definition:e.definition,idx:e.idx});else{if(!(e instanceof i.RepetitionMandatoryWithSeparator||e instanceof i.RepetitionWithSeparator))throw Error("non exhaustive match");n=new t({definition:e.definition,idx:e.idx,separator:e.separator})}var a=[n],u=Object(s.getKeyForAutomaticLookahead)(this.ruleIdx,r,e.idx);this.result.push({def:a,key:u,name:e.name,orgProd:e})}},t.prototype.visitOption=function(e){this.collectNamedDSLMethod(e,i.Option,s.OPTION_IDX)},t.prototype.visitRepetition=function(e){this.collectNamedDSLMethod(e,i.Repetition,s.MANY_IDX)},t.prototype.visitRepetitionMandatory=function(e){this.collectNamedDSLMethod(e,i.RepetitionMandatory,s.AT_LEAST_ONE_IDX)},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.collectNamedDSLMethod(e,i.RepetitionMandatoryWithSeparator,s.AT_LEAST_ONE_SEP_IDX)},t.prototype.visitRepetitionWithSeparator=function(e){this.collectNamedDSLMethod(e,i.RepetitionWithSeparator,s.MANY_SEP_IDX)},t.prototype.visitAlternation=function(e){var t=this;this.collectNamedDSLMethod(e,i.Alternation,s.OR_IDX);var r=e.definition.length>1;Object(o.forEach)(e.definition,(function(n,a){if(!Object(o.isUndefined)(n.name)){var u=n.definition;u=r?[new i.Option({definition:n.definition})]:n.definition;var c=Object(s.getKeyForAltIndex)(t.ruleIdx,s.OR_IDX,e.idx,a);t.result.push({def:u,key:c,name:n.name,orgProd:n})}}))},t}(a.GAstVisitor);function m(e,t){var r={allRuleNames:[]};return Object(o.forEach)(e,(function(e){var n=t[e.name];r.allRuleNames.push(e.name);var s=new p(n);e.accept(s),Object(o.forEach)(s.result,(function(t){t.def,t.key;var n=t.name;r.allRuleNames.push(e.name+n)}))})),r}},function(e,t,r){"use strict";r.r(t),r.d(t,"BITS_FOR_METHOD_TYPE",(function(){return n})),r.d(t,"BITS_FOR_OCCURRENCE_IDX",(function(){return o})),r.d(t,"BITS_FOR_RULE_IDX",(function(){return s})),r.d(t,"BITS_FOR_ALT_IDX",(function(){return i})),r.d(t,"OR_IDX",(function(){return a})),r.d(t,"OPTION_IDX",(function(){return u})),r.d(t,"MANY_IDX",(function(){return c})),r.d(t,"AT_LEAST_ONE_IDX",(function(){return l})),r.d(t,"MANY_SEP_IDX",(function(){return h})),r.d(t,"AT_LEAST_ONE_SEP_IDX",(function(){return d})),r.d(t,"getKeyForAutomaticLookahead",(function(){return p})),r.d(t,"getKeyForAltIndex",(function(){return g}));var n=4,o=8,s=12,i=8,a=1<<o,u=2<<o,c=3<<o,l=4<<o,h=5<<o,d=6<<o;function p(e,t,r){return r|t|e}var m=32-i;function g(e,t,r,n){var o=n+1<<m;return p(e,t,r)|o}},function(e,t,r){"use strict";r.r(t),r.d(t,"defaultParserErrorProvider",(function(){return u})),r.d(t,"defaultGrammarResolverErrorProvider",(function(){return c})),r.d(t,"defaultGrammarValidatorErrorProvider",(function(){return l}));var n=r(91),o=r(87),s=r(90),i=r(100),a=r(106),u={buildMismatchTokenMessage:function(e){var t=e.expected,r=e.actual;return e.previous,e.ruleName,"Expecting "+(Object(n.hasTokenLabel)(t)?"--\x3e "+Object(n.tokenLabel)(t)+" <--":"token of type --\x3e "+t.name+" <--")+" but found --\x3e '"+r.image+"' <--"},buildNotAllInputParsedMessage:function(e){var t=e.firstRedundant;return e.ruleName,"Redundant input, expecting EOF but found: "+t.image},buildNoViableAltMessage:function(e){var t=e.expectedPathsPerAlt,r=e.actual,s=(e.previous,e.customUserDescription),i=(e.ruleName,"\nbut found: '"+Object(o.first)(r).image+"'");if(s)return"Expecting: "+s+i;var a=Object(o.reduce)(t,(function(e,t){return e.concat(t)}),[]),u=Object(o.map)(a,(function(e){return"["+Object(o.map)(e,(function(e){return Object(n.tokenLabel)(e)})).join(", ")+"]"}));return"Expecting: one of these possible Token sequences:\n"+Object(o.map)(u,(function(e,t){return"  "+(t+1)+". "+e})).join("\n")+i},buildEarlyExitMessage:function(e){var t=e.expectedIterationPaths,r=e.actual,s=e.customUserDescription,i=(e.ruleName,"\nbut found: '"+Object(o.first)(r).image+"'");return s?"Expecting: "+s+i:"Expecting: expecting at least one iteration which starts with one of these possible Token sequences::\n  <"+Object(o.map)(t,(function(e){return"["+Object(o.map)(e,(function(e){return Object(n.tokenLabel)(e)})).join(",")+"]"})).join(" ,")+">"+i}};Object.freeze(u);var c={buildRuleNotFoundError:function(e,t){return"Invalid grammar, reference to a rule which is not defined: ->"+t.nonTerminalName+"<-\ninside top level rule: ->"+e.name+"<-"}},l={buildDuplicateFoundError:function(e,t){var r,n=e.name,a=Object(o.first)(t),u=a.idx,c=Object(i.getProductionDslName)(a),l=(r=a)instanceof s.Terminal?r.terminalType.name:r instanceof s.NonTerminal?r.nonTerminalName:"",h="->"+c+(u>0?u:"")+"<- "+(l?"with argument: ->"+l+"<-":"")+"\n                  appears more than once ("+t.length+" times) in the top level rule: ->"+n+"<-.                  \n                  For further details see: https://sap.github.io/chevrotain/docs/FAQ.html#NUMERICAL_SUFFIXES \n                  ";return h=(h=h.replace(/[ \t]+/g," ")).replace(/\s\s+/g,"\n")},buildInvalidNestedRuleNameError:function(e,t){return"Invalid nested rule name: ->"+t.name+"<- inside rule: ->"+e.name+"<-\nit must match the pattern: ->"+a.validNestedRuleName.toString()+"<-.\nNote that this means a nested rule name must start with the '$'(dollar) sign."},buildDuplicateNestedRuleNameError:function(e,t){return"Duplicate nested rule name: ->"+Object(o.first)(t).name+"<- inside rule: ->"+e.name+"<-\nA nested name must be unique in the scope of a top level grammar rule."},buildNamespaceConflictError:function(e){return"Namespace conflict found in grammar.\nThe grammar has both a Terminal(Token) and a Non-Terminal(Rule) named: <"+e.name+">.\nTo resolve this make sure each Terminal and Non-Terminal names are unique\nThis is easy to accomplish by using the convention that Terminal names start with an uppercase letter\nand Non-Terminal names start with a lower case letter."},buildAlternationPrefixAmbiguityError:function(e){var t=Object(o.map)(e.prefixPath,(function(e){return Object(n.tokenLabel)(e)})).join(", "),r=0===e.alternation.idx?"":e.alternation.idx;return"Ambiguous alternatives: <"+e.ambiguityIndices.join(" ,")+"> due to common lookahead prefix\nin <OR"+r+"> inside <"+e.topLevelRule.name+"> Rule,\n<"+t+"> may appears as a prefix path in all these alternatives.\nSee: https://sap.github.io/chevrotain/docs/guide/resolving_grammar_errors.html#COMMON_PREFIX\nFor Further details."},buildAlternationAmbiguityError:function(e){var t=Object(o.map)(e.prefixPath,(function(e){return Object(n.tokenLabel)(e)})).join(", "),r=0===e.alternation.idx?"":e.alternation.idx,s="Ambiguous Alternatives Detected: <"+e.ambiguityIndices.join(" ,")+"> in <OR"+r+"> inside <"+e.topLevelRule.name+"> Rule,\n<"+t+"> may appears as a prefix path in all these alternatives.\n";return s+="See: https://sap.github.io/chevrotain/docs/guide/resolving_grammar_errors.html#AMBIGUOUS_ALTERNATIVES\nFor Further details."},buildEmptyRepetitionError:function(e){var t=Object(i.getProductionDslName)(e.repetition);return 0!==e.repetition.idx&&(t+=e.repetition.idx),"The repetition <"+t+"> within Rule <"+e.topLevelRule.name+"> can never consume any tokens.\nThis could lead to an infinite loop."},buildTokenNameError:function(e){return"Invalid Grammar Token name: ->"+e.tokenType.name+"<- it must match the pattern: ->"+e.expectedPattern.toString()+"<-"},buildEmptyAlternationError:function(e){return"Ambiguous empty alternative: <"+(e.emptyChoiceIdx+1)+"> in <OR"+e.alternation.idx+"> inside <"+e.topLevelRule.name+"> Rule.\nOnly the last alternative may be an empty alternative."},buildTooManyAlternativesError:function(e){return"An Alternation cannot have more than 256 alternatives:\n<OR"+e.alternation.idx+"> inside <"+e.topLevelRule.name+"> Rule.\n has "+(e.alternation.definition.length+1)+" alternatives."},buildLeftRecursionError:function(e){var t=e.topLevelRule.name;return"Left Recursion found in grammar.\nrule: <"+t+"> can be invoked from itself (directly or indirectly)\nwithout consuming any Tokens. The grammar path that causes this is: \n "+t+" --\x3e "+o.map(e.leftRecursionPath,(function(e){return e.name})).concat([t]).join(" --\x3e ")+"\n To fix this refactor your grammar to remove the left recursion.\nsee: https://en.wikipedia.org/wiki/LL_parser#Left_Factoring."},buildInvalidRuleNameError:function(e){return"Invalid grammar rule name: ->"+e.topLevelRule.name+"<- it must match the pattern: ->"+e.expectedPattern.toString()+"<-"},buildDuplicateRuleNameError:function(e){return"Duplicate definition, rule: ->"+(e.topLevelRule instanceof s.Rule?e.topLevelRule.name:e.topLevelRule)+"<- is already defined in the grammar: ->"+e.grammarName+"<-"}}},function(e,t,r){"use strict";r.r(t),r.d(t,"validateGrammar",(function(){return p})),r.d(t,"identifyProductionForDuplicates",(function(){return m})),r.d(t,"OccurrenceValidationCollector",(function(){return f})),r.d(t,"validTermsPattern",(function(){return E})),r.d(t,"validNestedRuleName",(function(){return T})),r.d(t,"validateRuleName",(function(){return y})),r.d(t,"validateNestedRuleName",(function(){return A})),r.d(t,"validateTokenName",(function(){return R})),r.d(t,"validateRuleDoesNotAlreadyExist",(function(){return N})),r.d(t,"validateRuleIsOverridden",(function(){return S})),r.d(t,"validateNoLeftRecursion",(function(){return C})),r.d(t,"getFirstNoneTerminal",(function(){return v})),r.d(t,"validateEmptyOrAlternative",(function(){return I})),r.d(t,"validateAmbiguousAlternationAlternatives",(function(){return M})),r.d(t,"RepetionCollector",(function(){return b})),r.d(t,"validateTooManyAlts",(function(){return F})),r.d(t,"validateSomeNonEmptyLookaheadPath",(function(){return w})),r.d(t,"checkPrefixAlternativesAmbiguities",(function(){return _}));var n,o=r(87),s=r(86),i=r(100),a=r(107),u=r(103),c=r(108),l=r(90),h=r(101),d=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function p(e,t,r,n,a,c){var l=o.map(e,(function(e){return function(e,t){var r=new f;e.accept(r);var n=r.allProductions,a=o.groupBy(n,m),u=o.pick(a,(function(e){return e.length>1}));return o.map(o.values(u),(function(r){var n=o.first(r),a=t.buildDuplicateFoundError(e,r),u=Object(i.getProductionDslName)(n),c={message:a,type:s.ParserDefinitionErrorType.DUPLICATE_PRODUCTIONS,ruleName:e.name,dslName:u,occurrence:n.idx},l=g(n);return l&&(c.parameter=l),c}))}(e,a)})),h=o.map(e,(function(e){return C(e,e,a)})),d=[],p=[],E=[];Object(o.every)(h,o.isEmpty)&&(d=Object(o.map)(e,(function(e){return I(e,a)})),p=Object(o.map)(e,(function(e){return M(e,t,n,a)})),E=w(e,t,a));var T=function(e,t,r){var n=[],i=Object(o.map)(t,(function(e){return e.name}));return Object(o.forEach)(e,(function(e){var t=e.name;if(Object(o.contains)(i,t)){var a=r.buildNamespaceConflictError(e);n.push({message:a,type:s.ParserDefinitionErrorType.CONFLICT_TOKENS_RULES_NAMESPACE,ruleName:t})}})),n}(e,r,a),S=o.map(r,(function(e){return R(e,a)})),v=function(e,t){var r=[];return Object(o.forEach)(e,(function(e){var n=new u.NamedDSLMethodsCollectorVisitor("");e.accept(n);var s=Object(o.map)(n.result,(function(e){return e.orgProd}));r.push(Object(o.map)(s,(function(r){return A(e,r,t)})))})),Object(o.flatten)(r)}(e,a),O=function(e,t){var r=[];return Object(o.forEach)(e,(function(e){var n=new u.NamedDSLMethodsCollectorVisitor("");e.accept(n);var i=Object(o.groupBy)(n.result,(function(e){return e.name})),a=Object(o.pick)(i,(function(e){return e.length>1}));Object(o.forEach)(Object(o.values)(a),(function(n){var i=Object(o.map)(n,(function(e){return e.orgProd})),a=t.buildDuplicateNestedRuleNameError(e,i);r.push({message:a,type:s.ParserDefinitionErrorType.DUPLICATE_NESTED_NAME,ruleName:e.name})}))})),r}(e,a),b=Object(o.map)(e,(function(e){return F(e,a)})),_=Object(o.map)(e,(function(e){return y(e,a)})),L=Object(o.map)(e,(function(t){return N(t,e,c,a)}));return o.flatten(l.concat(S,v,O,E,h,d,p,T,b,_,L))}function m(e){return Object(i.getProductionDslName)(e)+"_#_"+e.idx+"_#_"+g(e)}function g(e){return e instanceof l.Terminal?e.terminalType.name:e instanceof l.NonTerminal?e.nonTerminalName:""}var f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.allProductions=[],t}return d(t,e),t.prototype.visitNonTerminal=function(e){this.allProductions.push(e)},t.prototype.visitOption=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionWithSeparator=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionMandatory=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.allProductions.push(e)},t.prototype.visitRepetition=function(e){this.allProductions.push(e)},t.prototype.visitAlternation=function(e){this.allProductions.push(e)},t.prototype.visitTerminal=function(e){this.allProductions.push(e)},t}(h.GAstVisitor),E=/^[a-zA-Z_]\w*$/,T=new RegExp(E.source.replace("^","^\\$"));function y(e,t){var r=[],n=e.name;return n.match(E)||r.push({message:t.buildInvalidRuleNameError({topLevelRule:e,expectedPattern:E}),type:s.ParserDefinitionErrorType.INVALID_RULE_NAME,ruleName:n}),r}function A(e,t,r){var n,o=[];return t.name.match(T)||(n=r.buildInvalidNestedRuleNameError(e,t),o.push({message:n,type:s.ParserDefinitionErrorType.INVALID_NESTED_RULE_NAME,ruleName:e.name})),o}function R(e,t){var r=[];return e.name.match(E)||r.push({message:t.buildTokenNameError({tokenType:e,expectedPattern:E}),type:s.ParserDefinitionErrorType.INVALID_TOKEN_NAME}),r}function N(e,t,r,n){var i=[];if(Object(o.reduce)(t,(function(t,r){return r.name===e.name?t+1:t}),0)>1){var a=n.buildDuplicateRuleNameError({topLevelRule:e,grammarName:r});i.push({message:a,type:s.ParserDefinitionErrorType.DUPLICATE_RULE_NAME,ruleName:e.name})}return i}function S(e,t,r){var n,i=[];return o.contains(t,e)||(n="Invalid rule override, rule: ->"+e+"<- cannot be overridden in the grammar: ->"+r+"<-as it is not defined in any of the super grammars ",i.push({message:n,type:s.ParserDefinitionErrorType.INVALID_RULE_OVERRIDE,ruleName:e})),i}function C(e,t,r,n){void 0===n&&(n=[]);var i=[],a=v(t.definition);if(o.isEmpty(a))return[];var u=e.name;o.contains(a,e)&&i.push({message:r.buildLeftRecursionError({topLevelRule:e,leftRecursionPath:n}),type:s.ParserDefinitionErrorType.LEFT_RECURSION,ruleName:u});var c=o.difference(a,n.concat([e])),l=o.map(c,(function(t){var s=o.cloneArr(n);return s.push(t),C(e,t,r,s)}));return i.concat(o.flatten(l))}function v(e){var t=[];if(o.isEmpty(e))return t;var r=o.first(e);if(r instanceof l.NonTerminal)t.push(r.referencedRule);else if(r instanceof l.Flat||r instanceof l.Option||r instanceof l.RepetitionMandatory||r instanceof l.RepetitionMandatoryWithSeparator||r instanceof l.RepetitionWithSeparator||r instanceof l.Repetition)t=t.concat(v(r.definition));else if(r instanceof l.Alternation)t=o.flatten(o.map(r.definition,(function(e){return v(e.definition)})));else if(!(r instanceof l.Terminal))throw Error("non exhaustive match");var n=Object(i.isOptionalProd)(r),s=e.length>1;if(n&&s){var a=o.drop(e);return t.concat(v(a))}return t}var O=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.alternations=[],t}return d(t,e),t.prototype.visitAlternation=function(e){this.alternations.push(e)},t}(h.GAstVisitor);function I(e,t){var r=new O;e.accept(r);var n=r.alternations;return o.reduce(n,(function(r,n){var i=o.dropRight(n.definition),a=o.map(i,(function(r,i){var a=Object(c.nextPossibleTokensAfter)([r],[],null,1);return o.isEmpty(a)?{message:t.buildEmptyAlternationError({topLevelRule:e,alternation:n,emptyChoiceIdx:i}),type:s.ParserDefinitionErrorType.NONE_LAST_EMPTY_ALT,ruleName:e.name,occurrence:n.idx,alternative:i+1}:null}));return r.concat(o.compact(a))}),[])}function M(e,t,r,n){var u=new O;e.accept(u);var c=u.alternations,l=r[e.name];return l&&(c=Object(o.reject)(c,(function(e){return l[Object(i.getProductionDslName)(e)+(0===e.idx?"":e.idx)]}))),c=Object(o.reject)(c,(function(e){return!0===e.ignoreAmbiguities})),o.reduce(c,(function(r,i){var u=i.idx,c=i.maxLookahead||t,l=Object(a.getLookaheadPathsForOr)(u,e,c,i),h=function(e,t,r,n){var i=[],u=Object(o.reduce)(e,(function(r,n,s){return!0===t.definition[s].ignoreAmbiguities||Object(o.forEach)(n,(function(n){var u=[s];Object(o.forEach)(e,(function(e,r){s!==r&&Object(a.containsPath)(e,n)&&!0!==t.definition[r].ignoreAmbiguities&&u.push(r)})),u.length>1&&!Object(a.containsPath)(i,n)&&(i.push(n),r.push({alts:u,path:n}))})),r}),[]);return o.map(u,(function(e){var i=Object(o.map)(e.alts,(function(e){return e+1}));return{message:n.buildAlternationAmbiguityError({topLevelRule:r,alternation:t,ambiguityIndices:i,prefixPath:e.path}),type:s.ParserDefinitionErrorType.AMBIGUOUS_ALTS,ruleName:r.name,occurrence:t.idx,alternatives:[e.alts]}}))}(l,i,e,n),d=_(l,i,e,n);return r.concat(h,d)}),[])}var b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.allProductions=[],t}return d(t,e),t.prototype.visitRepetitionWithSeparator=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionMandatory=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.allProductions.push(e)},t.prototype.visitRepetition=function(e){this.allProductions.push(e)},t}(h.GAstVisitor);function F(e,t){var r=new O;e.accept(r);var n=r.alternations;return o.reduce(n,(function(r,n){return n.definition.length>255&&r.push({message:t.buildTooManyAlternativesError({topLevelRule:e,alternation:n}),type:s.ParserDefinitionErrorType.TOO_MANY_ALTS,ruleName:e.name,occurrence:n.idx}),r}),[])}function w(e,t,r){var n=[];return Object(o.forEach)(e,(function(e){var i=new b;e.accept(i);var u=i.allProductions;Object(o.forEach)(u,(function(i){var u=Object(a.getProdType)(i),c=i.maxLookahead||t,l=i.idx,h=Object(a.getLookaheadPathsForOptionalProd)(l,e,u,c)[0];if(Object(o.isEmpty)(Object(o.flatten)(h))){var d=r.buildEmptyRepetitionError({topLevelRule:e,repetition:i});n.push({message:d,type:s.ParserDefinitionErrorType.NO_NON_EMPTY_LOOKAHEAD,ruleName:e.name})}}))})),n}function _(e,t,r,n){var i=[],u=Object(o.reduce)(e,(function(e,t,r){var n=Object(o.map)(t,(function(e){return{idx:r,path:e}}));return e.concat(n)}),[]);return Object(o.forEach)(u,(function(e){if(!0!==t.definition[e.idx].ignoreAmbiguities){var c=e.idx,l=e.path,h=Object(o.findAll)(u,(function(e){return!0!==t.definition[e.idx].ignoreAmbiguities&&e.idx<c&&Object(a.isStrictPrefixOfPath)(e.path,l)})),d=Object(o.map)(h,(function(e){var o=[e.idx+1,c+1],i=0===t.idx?"":t.idx;return{message:n.buildAlternationPrefixAmbiguityError({topLevelRule:r,alternation:t,ambiguityIndices:o,prefixPath:e.path}),type:s.ParserDefinitionErrorType.AMBIGUOUS_PREFIX_ALTS,ruleName:r.name,occurrence:i,alternatives:o}}));i=i.concat(d)}})),i}},function(e,t,r){"use strict";r.r(t),r.d(t,"PROD_TYPE",(function(){return o})),r.d(t,"getProdType",(function(){return d})),r.d(t,"buildLookaheadFuncForOr",(function(){return p})),r.d(t,"buildLookaheadFuncForOptionalProd",(function(){return m})),r.d(t,"buildAlternativesLookAheadFunc",(function(){return g})),r.d(t,"buildSingleAlternativeLookaheadFunction",(function(){return f})),r.d(t,"lookAheadSequenceFromAlternatives",(function(){return N})),r.d(t,"getLookaheadPathsForOr",(function(){return S})),r.d(t,"getLookaheadPathsForOptionalProd",(function(){return C})),r.d(t,"containsPath",(function(){return v})),r.d(t,"isStrictPrefixOfPath",(function(){return O})),r.d(t,"areTokenCategoriesNotUsed",(function(){return I}));var n,o,s=r(87),i=r(108),a=r(89),u=r(97),c=r(90),l=r(101),h=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function d(e){if(e instanceof c.Option)return o.OPTION;if(e instanceof c.Repetition)return o.REPETITION;if(e instanceof c.RepetitionMandatory)return o.REPETITION_MANDATORY;if(e instanceof c.RepetitionMandatoryWithSeparator)return o.REPETITION_MANDATORY_WITH_SEPARATOR;if(e instanceof c.RepetitionWithSeparator)return o.REPETITION_WITH_SEPARATOR;if(e instanceof c.Alternation)return o.ALTERNATION;throw Error("non exhaustive match")}function p(e,t,r,n,o,s){var i=S(e,t,r);return s(i,n,I(i)?u.tokenStructuredMatcherNoCategories:u.tokenStructuredMatcher,o)}function m(e,t,r,n,o,s){var i=C(e,t,o,r),a=I(i)?u.tokenStructuredMatcherNoCategories:u.tokenStructuredMatcher;return s(i[0],a,n)}function g(e,t,r,n){var o=e.length,i=Object(s.every)(e,(function(e){return Object(s.every)(e,(function(e){return 1===e.length}))}));if(t)return function(t){for(var n=Object(s.map)(t,(function(e){return e.GATE})),i=0;i<o;i++){var a=e[i],u=a.length,c=n[i];if(void 0===c||!1!==c.call(this))e:for(var l=0;l<u;l++){for(var h=a[l],d=h.length,p=0;p<d;p++){var m=this.LA(p+1);if(!1===r(m,h[p]))continue e}return i}}};if(i&&!n){var a=Object(s.map)(e,(function(e){return Object(s.flatten)(e)})),u=Object(s.reduce)(a,(function(e,t,r){return Object(s.forEach)(t,(function(t){Object(s.has)(e,t.tokenTypeIdx)||(e[t.tokenTypeIdx]=r),Object(s.forEach)(t.categoryMatches,(function(t){Object(s.has)(e,t)||(e[t]=r)}))})),e}),[]);return function(){var e=this.LA(1);return u[e.tokenTypeIdx]}}return function(){for(var t=0;t<o;t++){var n=e[t],s=n.length;e:for(var i=0;i<s;i++){for(var a=n[i],u=a.length,c=0;c<u;c++){var l=this.LA(c+1);if(!1===r(l,a[c]))continue e}return t}}}}function f(e,t,r){var n=Object(s.every)(e,(function(e){return 1===e.length})),o=e.length;if(n&&!r){var i=Object(s.flatten)(e);if(1===i.length&&Object(s.isEmpty)(i[0].categoryMatches)){var a=i[0].tokenTypeIdx;return function(){return this.LA(1).tokenTypeIdx===a}}var u=Object(s.reduce)(i,(function(e,t,r){return e[t.tokenTypeIdx]=!0,Object(s.forEach)(t.categoryMatches,(function(t){e[t]=!0})),e}),[]);return function(){var e=this.LA(1);return!0===u[e.tokenTypeIdx]}}return function(){e:for(var r=0;r<o;r++){for(var n=e[r],s=n.length,i=0;i<s;i++){var a=this.LA(i+1);if(!1===t(a,n[i]))continue e}return!0}return!1}}!function(e){e[e.OPTION=0]="OPTION",e[e.REPETITION=1]="REPETITION",e[e.REPETITION_MANDATORY=2]="REPETITION_MANDATORY",e[e.REPETITION_MANDATORY_WITH_SEPARATOR=3]="REPETITION_MANDATORY_WITH_SEPARATOR",e[e.REPETITION_WITH_SEPARATOR=4]="REPETITION_WITH_SEPARATOR",e[e.ALTERNATION=5]="ALTERNATION"}(o||(o={}));var E=function(e){function t(t,r,n){var o=e.call(this)||this;return o.topProd=t,o.targetOccurrence=r,o.targetProdType=n,o}return h(t,e),t.prototype.startWalking=function(){return this.walk(this.topProd),this.restDef},t.prototype.checkIsTarget=function(e,t,r,n){return e.idx===this.targetOccurrence&&this.targetProdType===t&&(this.restDef=r.concat(n),!0)},t.prototype.walkOption=function(t,r,n){this.checkIsTarget(t,o.OPTION,r,n)||e.prototype.walkOption.call(this,t,r,n)},t.prototype.walkAtLeastOne=function(t,r,n){this.checkIsTarget(t,o.REPETITION_MANDATORY,r,n)||e.prototype.walkOption.call(this,t,r,n)},t.prototype.walkAtLeastOneSep=function(t,r,n){this.checkIsTarget(t,o.REPETITION_MANDATORY_WITH_SEPARATOR,r,n)||e.prototype.walkOption.call(this,t,r,n)},t.prototype.walkMany=function(t,r,n){this.checkIsTarget(t,o.REPETITION,r,n)||e.prototype.walkOption.call(this,t,r,n)},t.prototype.walkManySep=function(t,r,n){this.checkIsTarget(t,o.REPETITION_WITH_SEPARATOR,r,n)||e.prototype.walkOption.call(this,t,r,n)},t}(a.RestWalker),T=function(e){function t(t,r,n){var o=e.call(this)||this;return o.targetOccurrence=t,o.targetProdType=r,o.targetRef=n,o.result=[],o}return h(t,e),t.prototype.checkIsTarget=function(e,t){e.idx!==this.targetOccurrence||this.targetProdType!==t||void 0!==this.targetRef&&e!==this.targetRef||(this.result=e.definition)},t.prototype.visitOption=function(e){this.checkIsTarget(e,o.OPTION)},t.prototype.visitRepetition=function(e){this.checkIsTarget(e,o.REPETITION)},t.prototype.visitRepetitionMandatory=function(e){this.checkIsTarget(e,o.REPETITION_MANDATORY)},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.checkIsTarget(e,o.REPETITION_MANDATORY_WITH_SEPARATOR)},t.prototype.visitRepetitionWithSeparator=function(e){this.checkIsTarget(e,o.REPETITION_WITH_SEPARATOR)},t.prototype.visitAlternation=function(e){this.checkIsTarget(e,o.ALTERNATION)},t}(l.GAstVisitor);function y(e){for(var t=new Array(e),r=0;r<e;r++)t[r]=[];return t}function A(e){for(var t=[""],r=0;r<e.length;r++){for(var n=e[r],o=[],s=0;s<t.length;s++){var i=t[s];o.push(i+"_"+n.tokenTypeIdx);for(var a=0;a<n.categoryMatches.length;a++){var u="_"+n.categoryMatches[a];o.push(i+u)}}t=o}return t}function R(e,t,r){for(var n=0;n<e.length;n++)if(n!==r)for(var o=e[n],s=0;s<t.length;s++)if(!0===o[t[s]])return!1;return!0}function N(e,t){for(var r=Object(s.map)(e,(function(e){return Object(i.possiblePathsFrom)([e],1)})),n=y(r.length),o=Object(s.map)(r,(function(e){var t={};return Object(s.forEach)(e,(function(e){var r=A(e.partialPath);Object(s.forEach)(r,(function(e){t[e]=!0}))})),t})),a=r,u=1;u<=t;u++){var c=a;a=y(c.length);for(var l=function(e){for(var r=c[e],l=0;l<r.length;l++){var h=r[l].partialPath,d=r[l].suffixDef,p=A(h);if(R(o,p,e)||Object(s.isEmpty)(d)||h.length===t){var m=n[e];if(!1===v(m,h)){m.push(h);for(var g=0;g<p.length;g++){var f=p[g];o[e][f]=!0}}}else{var E=Object(i.possiblePathsFrom)(d,u+1,h);a[e]=a[e].concat(E),Object(s.forEach)(E,(function(t){var r=A(t.partialPath);Object(s.forEach)(r,(function(t){o[e][t]=!0}))}))}}},h=0;h<c.length;h++)l(h)}return n}function S(e,t,r,n){var s=new T(e,o.ALTERNATION,n);return t.accept(s),N(s.result,r)}function C(e,t,r,n){var o=new T(e,r);t.accept(o);var s=o.result,i=new E(t,e,r).startWalking();return N([new c.Flat({definition:s}),new c.Flat({definition:i})],n)}function v(e,t){e:for(var r=0;r<e.length;r++){var n=e[r];if(n.length===t.length){for(var o=0;o<n.length;o++){var s=t[o],i=n[o];if(!1==(s===i||void 0!==i.categoryMatchesMap[s.tokenTypeIdx]))continue e}return!0}}return!1}function O(e,t){return e.length<t.length&&Object(s.every)(e,(function(e,r){var n=t[r];return e===n||n.categoryMatchesMap[e.tokenTypeIdx]}))}function I(e){return Object(s.every)(e,(function(e){return Object(s.every)(e,(function(e){return Object(s.every)(e,(function(e){return Object(s.isEmpty)(e.categoryMatches)}))}))}))}},function(e,t,r){"use strict";r.r(t),r.d(t,"AbstractNextPossibleTokensWalker",(function(){return c})),r.d(t,"NextAfterTokenWalker",(function(){return l})),r.d(t,"AbstractNextTerminalAfterProductionWalker",(function(){return h})),r.d(t,"NextTerminalAfterManyWalker",(function(){return d})),r.d(t,"NextTerminalAfterManySepWalker",(function(){return p})),r.d(t,"NextTerminalAfterAtLeastOneWalker",(function(){return m})),r.d(t,"NextTerminalAfterAtLeastOneSepWalker",(function(){return g})),r.d(t,"possiblePathsFrom",(function(){return f})),r.d(t,"nextPossibleTokensAfter",(function(){return E}));var n,o=r(89),s=r(87),i=r(99),a=r(90),u=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),c=function(e){function t(t,r){var n=e.call(this)||this;return n.topProd=t,n.path=r,n.possibleTokTypes=[],n.nextProductionName="",n.nextProductionOccurrence=0,n.found=!1,n.isAtEndOfPath=!1,n}return u(t,e),t.prototype.startWalking=function(){if(this.found=!1,this.path.ruleStack[0]!==this.topProd.name)throw Error("The path does not start with the walker's top Rule!");return this.ruleStack=Object(s.cloneArr)(this.path.ruleStack).reverse(),this.occurrenceStack=Object(s.cloneArr)(this.path.occurrenceStack).reverse(),this.ruleStack.pop(),this.occurrenceStack.pop(),this.updateExpectedNext(),this.walk(this.topProd),this.possibleTokTypes},t.prototype.walk=function(t,r){void 0===r&&(r=[]),this.found||e.prototype.walk.call(this,t,r)},t.prototype.walkProdRef=function(e,t,r){if(e.referencedRule.name===this.nextProductionName&&e.idx===this.nextProductionOccurrence){var n=t.concat(r);this.updateExpectedNext(),this.walk(e.referencedRule,n)}},t.prototype.updateExpectedNext=function(){Object(s.isEmpty)(this.ruleStack)?(this.nextProductionName="",this.nextProductionOccurrence=0,this.isAtEndOfPath=!0):(this.nextProductionName=this.ruleStack.pop(),this.nextProductionOccurrence=this.occurrenceStack.pop())},t}(o.RestWalker),l=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.path=r,n.nextTerminalName="",n.nextTerminalOccurrence=0,n.nextTerminalName=n.path.lastTok.name,n.nextTerminalOccurrence=n.path.lastTokOccurrence,n}return u(t,e),t.prototype.walkTerminal=function(e,t,r){if(this.isAtEndOfPath&&e.terminalType.name===this.nextTerminalName&&e.idx===this.nextTerminalOccurrence&&!this.found){var n=t.concat(r),o=new a.Flat({definition:n});this.possibleTokTypes=Object(i.first)(o),this.found=!0}},t}(c),h=function(e){function t(t,r){var n=e.call(this)||this;return n.topRule=t,n.occurrence=r,n.result={token:void 0,occurrence:void 0,isEndOfRule:void 0},n}return u(t,e),t.prototype.startWalking=function(){return this.walk(this.topRule),this.result},t}(o.RestWalker),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return u(t,e),t.prototype.walkMany=function(t,r,n){if(t.idx===this.occurrence){var o=Object(s.first)(r.concat(n));this.result.isEndOfRule=void 0===o,o instanceof a.Terminal&&(this.result.token=o.terminalType,this.result.occurrence=o.idx)}else e.prototype.walkMany.call(this,t,r,n)},t}(h),p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return u(t,e),t.prototype.walkManySep=function(t,r,n){if(t.idx===this.occurrence){var o=Object(s.first)(r.concat(n));this.result.isEndOfRule=void 0===o,o instanceof a.Terminal&&(this.result.token=o.terminalType,this.result.occurrence=o.idx)}else e.prototype.walkManySep.call(this,t,r,n)},t}(h),m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return u(t,e),t.prototype.walkAtLeastOne=function(t,r,n){if(t.idx===this.occurrence){var o=Object(s.first)(r.concat(n));this.result.isEndOfRule=void 0===o,o instanceof a.Terminal&&(this.result.token=o.terminalType,this.result.occurrence=o.idx)}else e.prototype.walkAtLeastOne.call(this,t,r,n)},t}(h),g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return u(t,e),t.prototype.walkAtLeastOneSep=function(t,r,n){if(t.idx===this.occurrence){var o=Object(s.first)(r.concat(n));this.result.isEndOfRule=void 0===o,o instanceof a.Terminal&&(this.result.token=o.terminalType,this.result.occurrence=o.idx)}else e.prototype.walkAtLeastOneSep.call(this,t,r,n)},t}(h);function f(e,t,r){void 0===r&&(r=[]),r=Object(s.cloneArr)(r);var n=[],o=0;function i(i){var a=f(i.concat(Object(s.drop)(e,o+1)),t,r);return n.concat(a)}for(;r.length<t&&o<e.length;){var u=e[o];if(u instanceof a.Flat)return i(u.definition);if(u instanceof a.NonTerminal)return i(u.definition);if(u instanceof a.Option)n=i(u.definition);else{if(u instanceof a.RepetitionMandatory)return i(c=u.definition.concat([new a.Repetition({definition:u.definition})]));if(u instanceof a.RepetitionMandatoryWithSeparator)return i(c=[new a.Flat({definition:u.definition}),new a.Repetition({definition:[new a.Terminal({terminalType:u.separator})].concat(u.definition)})]);if(u instanceof a.RepetitionWithSeparator){var c=u.definition.concat([new a.Repetition({definition:[new a.Terminal({terminalType:u.separator})].concat(u.definition)})]);n=i(c)}else if(u instanceof a.Repetition)c=u.definition.concat([new a.Repetition({definition:u.definition})]),n=i(c);else{if(u instanceof a.Alternation)return Object(s.forEach)(u.definition,(function(e){n=i(e.definition)})),n;if(!(u instanceof a.Terminal))throw Error("non exhaustive match");r.push(u.terminalType)}}o++}return n.push({partialPath:r,suffixDef:Object(s.drop)(e,o)}),n}function E(e,t,r,n){var o=["EXIT_NONE_TERMINAL"],i=!1,u=t.length,c=u-n-1,l=[],h=[];for(h.push({idx:-1,def:e,ruleStack:[],occurrenceStack:[]});!Object(s.isEmpty)(h);){var d=h.pop();if("EXIT_ALTERNATIVE"!==d){var p=d.def,m=d.idx,g=d.ruleStack,f=d.occurrenceStack;if(!Object(s.isEmpty)(p)){var E=p[0];if("EXIT_NONE_TERMINAL"===E){var y={idx:m,def:Object(s.drop)(p),ruleStack:Object(s.dropRight)(g),occurrenceStack:Object(s.dropRight)(f)};h.push(y)}else if(E instanceof a.Terminal)if(m<u-1){var A=m+1;r(t[A],E.terminalType)&&(y={idx:A,def:Object(s.drop)(p),ruleStack:g,occurrenceStack:f},h.push(y))}else{if(m!==u-1)throw Error("non exhaustive match");l.push({nextTokenType:E.terminalType,nextTokenOccurrence:E.idx,ruleStack:g,occurrenceStack:f}),i=!0}else if(E instanceof a.NonTerminal){var R=Object(s.cloneArr)(g);R.push(E.nonTerminalName);var N=Object(s.cloneArr)(f);N.push(E.idx),y={idx:m,def:E.definition.concat(o,Object(s.drop)(p)),ruleStack:R,occurrenceStack:N},h.push(y)}else if(E instanceof a.Option){var S={idx:m,def:Object(s.drop)(p),ruleStack:g,occurrenceStack:f};h.push(S),h.push("EXIT_ALTERNATIVE");var C={idx:m,def:E.definition.concat(Object(s.drop)(p)),ruleStack:g,occurrenceStack:f};h.push(C)}else if(E instanceof a.RepetitionMandatory){var v=new a.Repetition({definition:E.definition,idx:E.idx});y={idx:m,def:E.definition.concat([v],Object(s.drop)(p)),ruleStack:g,occurrenceStack:f},h.push(y)}else if(E instanceof a.RepetitionMandatoryWithSeparator){var O=new a.Terminal({terminalType:E.separator});v=new a.Repetition({definition:[O].concat(E.definition),idx:E.idx}),y={idx:m,def:E.definition.concat([v],Object(s.drop)(p)),ruleStack:g,occurrenceStack:f},h.push(y)}else if(E instanceof a.RepetitionWithSeparator){S={idx:m,def:Object(s.drop)(p),ruleStack:g,occurrenceStack:f},h.push(S),h.push("EXIT_ALTERNATIVE"),O=new a.Terminal({terminalType:E.separator});var I=new a.Repetition({definition:[O].concat(E.definition),idx:E.idx});C={idx:m,def:E.definition.concat([I],Object(s.drop)(p)),ruleStack:g,occurrenceStack:f},h.push(C)}else if(E instanceof a.Repetition)S={idx:m,def:Object(s.drop)(p),ruleStack:g,occurrenceStack:f},h.push(S),h.push("EXIT_ALTERNATIVE"),I=new a.Repetition({definition:E.definition,idx:E.idx}),C={idx:m,def:E.definition.concat([I],Object(s.drop)(p)),ruleStack:g,occurrenceStack:f},h.push(C);else if(E instanceof a.Alternation)for(var M=E.definition.length-1;M>=0;M--){var b={idx:m,def:E.definition[M].definition.concat(Object(s.drop)(p)),ruleStack:g,occurrenceStack:f};h.push(b),h.push("EXIT_ALTERNATIVE")}else if(E instanceof a.Flat)h.push({idx:m,def:E.definition.concat(Object(s.drop)(p)),ruleStack:g,occurrenceStack:f});else{if(!(E instanceof a.Rule))throw Error("non exhaustive match");h.push(T(E,m,g,f))}}}else i&&Object(s.last)(h).idx<=c&&h.pop()}return l}function T(e,t,r,n){var o=Object(s.cloneArr)(r);o.push(e.name);var i=Object(s.cloneArr)(n);return i.push(1),{idx:t,def:e.definition,ruleStack:o,occurrenceStack:i}}},function(e,t,r){"use strict";r.r(t),r.d(t,"resolveGrammar",(function(){return u})),r.d(t,"validateGrammar",(function(){return c})),r.d(t,"assignOccurrenceIndices",(function(){return l}));var n=r(87),o=r(110),s=r(106),i=r(105),a=r(100);function u(e){e=Object(n.defaults)(e,{errMsgProvider:i.defaultGrammarResolverErrorProvider});var t={};return Object(n.forEach)(e.rules,(function(e){t[e.name]=e})),Object(o.resolveGrammar)(t,e.errMsgProvider)}function c(e){return e=Object(n.defaults)(e,{errMsgProvider:i.defaultGrammarValidatorErrorProvider,ignoredIssues:{}}),Object(s.validateGrammar)(e.rules,e.maxLookahead,e.tokenTypes,e.ignoredIssues,e.errMsgProvider,e.grammarName)}function l(e){Object(n.forEach)(e.rules,(function(e){var t=new a.DslMethodsCollectorVisitor;e.accept(t),Object(n.forEach)(t.dslMethods,(function(e){Object(n.forEach)(e,(function(e,t){e.idx=t+1}))}))}))}},function(e,t,r){"use strict";r.r(t),r.d(t,"resolveGrammar",(function(){return u})),r.d(t,"GastRefResolverVisitor",(function(){return c}));var n,o=r(86),s=r(87),i=r(101),a=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function u(e,t){var r=new c(e,t);return r.resolveRefs(),r.errors}var c=function(e){function t(t,r){var n=e.call(this)||this;return n.nameToTopRule=t,n.errMsgProvider=r,n.errors=[],n}return a(t,e),t.prototype.resolveRefs=function(){var e=this;Object(s.forEach)(Object(s.values)(this.nameToTopRule),(function(t){e.currTopLevel=t,t.accept(e)}))},t.prototype.visitNonTerminal=function(e){var t=this.nameToTopRule[e.nonTerminalName];if(t)e.referencedRule=t;else{var r=this.errMsgProvider.buildRuleNotFoundError(this.currTopLevel,e);this.errors.push({message:r,type:o.ParserDefinitionErrorType.UNRESOLVED_SUBRULE_REF,ruleName:this.currTopLevel.name,unresolvedRefName:e.nonTerminalName})}},t}(i.GAstVisitor)},function(e,t,r){"use strict";r.r(t),r.d(t,"EOF_FOLLOW_KEY",(function(){return u})),r.d(t,"IN_RULE_RECOVERY_EXCEPTION",(function(){return c})),r.d(t,"InRuleRecoveryException",(function(){return l})),r.d(t,"Recoverable",(function(){return h})),r.d(t,"attemptInRepetitionRecovery",(function(){return d}));var n=r(91),o=r(87),s=r(112),i=r(102),a=r(86),u={},c="InRuleRecoveryException";function l(e){this.name=c,this.message=e}l.prototype=Error.prototype;var h=function(){function e(){}return e.prototype.initRecoverable=function(e){this.firstAfterRepMap={},this.resyncFollows={},this.recoveryEnabled=Object(o.has)(e,"recoveryEnabled")?e.recoveryEnabled:a.DEFAULT_PARSER_CONFIG.recoveryEnabled,this.recoveryEnabled&&(this.attemptInRepetitionRecovery=d)},e.prototype.getTokenToInsert=function(e){var t=Object(n.createTokenInstance)(e,"",NaN,NaN,NaN,NaN,NaN,NaN);return t.isInsertedInRecovery=!0,t},e.prototype.canTokenTypeBeInsertedInRecovery=function(e){return!0},e.prototype.tryInRepetitionRecovery=function(e,t,r,n){for(var i=this,a=this.findReSyncTokenType(),u=this.exportLexerState(),c=[],l=!1,h=this.LA(1),d=this.LA(1),p=function(){var e=i.LA(0),t=i.errorMessageProvider.buildMismatchTokenMessage({expected:n,actual:h,previous:e,ruleName:i.getCurrRuleFullName()}),r=new s.MismatchedTokenException(t,h,i.LA(0));r.resyncedTokens=Object(o.dropRight)(c),i.SAVE_ERROR(r)};!l;){if(this.tokenMatcher(d,n))return void p();if(r.call(this))return p(),void e.apply(this,t);this.tokenMatcher(d,a)?l=!0:(d=this.SKIP_TOKEN(),this.addToResyncTokens(d,c))}this.importLexerState(u)},e.prototype.shouldInRepetitionRecoveryBeTried=function(e,t,r){return!1!==r&&void 0!==e&&void 0!==t&&!this.tokenMatcher(this.LA(1),e)&&!this.isBackTracking()&&!this.canPerformInRuleRecovery(e,this.getFollowsForInRuleRecovery(e,t))},e.prototype.getFollowsForInRuleRecovery=function(e,t){var r=this.getCurrentGrammarPath(e,t);return this.getNextPossibleTokenTypes(r)},e.prototype.tryInRuleRecovery=function(e,t){if(this.canRecoverWithSingleTokenInsertion(e,t))return this.getTokenToInsert(e);if(this.canRecoverWithSingleTokenDeletion(e)){var r=this.SKIP_TOKEN();return this.consumeToken(),r}throw new l("sad sad panda")},e.prototype.canPerformInRuleRecovery=function(e,t){return this.canRecoverWithSingleTokenInsertion(e,t)||this.canRecoverWithSingleTokenDeletion(e)},e.prototype.canRecoverWithSingleTokenInsertion=function(e,t){var r=this;if(!this.canTokenTypeBeInsertedInRecovery(e))return!1;if(Object(o.isEmpty)(t))return!1;var n=this.LA(1);return void 0!==Object(o.find)(t,(function(e){return r.tokenMatcher(n,e)}))},e.prototype.canRecoverWithSingleTokenDeletion=function(e){return this.tokenMatcher(this.LA(2),e)},e.prototype.isInCurrentRuleReSyncSet=function(e){var t=this.getCurrFollowKey(),r=this.getFollowSetFromFollowKey(t);return Object(o.contains)(r,e)},e.prototype.findReSyncTokenType=function(){for(var e=this.flattenFollowSet(),t=this.LA(1),r=2;;){var n=t.tokenType;if(Object(o.contains)(e,n))return n;t=this.LA(r),r++}},e.prototype.getCurrFollowKey=function(){if(1===this.RULE_STACK.length)return u;var e=this.getLastExplicitRuleShortName(),t=this.getLastExplicitRuleOccurrenceIndex(),r=this.getPreviousExplicitRuleShortName();return{ruleName:this.shortRuleNameToFullName(e),idxInCallingRule:t,inRule:this.shortRuleNameToFullName(r)}},e.prototype.buildFullFollowKeyStack=function(){var e=this,t=this.RULE_STACK,r=this.RULE_OCCURRENCE_STACK;return Object(o.isEmpty)(this.LAST_EXPLICIT_RULE_STACK)||(t=Object(o.map)(this.LAST_EXPLICIT_RULE_STACK,(function(t){return e.RULE_STACK[t]})),r=Object(o.map)(this.LAST_EXPLICIT_RULE_STACK,(function(t){return e.RULE_OCCURRENCE_STACK[t]}))),Object(o.map)(t,(function(n,o){return 0===o?u:{ruleName:e.shortRuleNameToFullName(n),idxInCallingRule:r[o],inRule:e.shortRuleNameToFullName(t[o-1])}}))},e.prototype.flattenFollowSet=function(){var e=this,t=Object(o.map)(this.buildFullFollowKeyStack(),(function(t){return e.getFollowSetFromFollowKey(t)}));return Object(o.flatten)(t)},e.prototype.getFollowSetFromFollowKey=function(e){if(e===u)return[n.EOF];var t=e.ruleName+e.idxInCallingRule+i.IN+e.inRule;return this.resyncFollows[t]},e.prototype.addToResyncTokens=function(e,t){return this.tokenMatcher(e,n.EOF)||t.push(e),t},e.prototype.reSyncTo=function(e){for(var t=[],r=this.LA(1);!1===this.tokenMatcher(r,e);)r=this.SKIP_TOKEN(),this.addToResyncTokens(r,t);return Object(o.dropRight)(t)},e.prototype.attemptInRepetitionRecovery=function(e,t,r,n,o,s,i){},e.prototype.getCurrentGrammarPath=function(e,t){return{ruleStack:this.getHumanReadableRuleStack(),occurrenceStack:Object(o.cloneArr)(this.RULE_OCCURRENCE_STACK),lastTok:e,lastTokOccurrence:t}},e.prototype.getHumanReadableRuleStack=function(){var e=this;return Object(o.isEmpty)(this.LAST_EXPLICIT_RULE_STACK)?Object(o.map)(this.RULE_STACK,(function(t){return e.shortRuleNameToFullName(t)})):Object(o.map)(this.LAST_EXPLICIT_RULE_STACK,(function(t){return e.shortRuleNameToFullName(e.RULE_STACK[t])}))},e}();function d(e,t,r,o,s,i,a){var u=this.getKeyForAutomaticLookahead(o,s),c=this.firstAfterRepMap[u];if(void 0===c){var l=this.getCurrRuleFullName();c=new i(this.getGAstProductions()[l],s).startWalking(),this.firstAfterRepMap[u]=c}var h=c.token,d=c.occurrence,p=c.isEndOfRule;1===this.RULE_STACK.length&&p&&void 0===h&&(h=n.EOF,d=1),this.shouldInRepetitionRecoveryBeTried(h,d,a)&&this.tryInRepetitionRecovery(e,t,r,h)}},function(e,t,r){"use strict";r.r(t),r.d(t,"isRecognitionException",(function(){return s})),r.d(t,"MismatchedTokenException",(function(){return i})),r.d(t,"NoViableAltException",(function(){return a})),r.d(t,"NotAllInputParsedException",(function(){return u})),r.d(t,"EarlyExitException",(function(){return c}));var n=r(87),o=["MismatchedTokenException","NoViableAltException","EarlyExitException","NotAllInputParsedException"];function s(e){return Object(n.contains)(o,e.name)}function i(e,t,r){this.name="MismatchedTokenException",this.message=e,this.token=t,this.previousToken=r,this.resyncedTokens=[]}function a(e,t,r){this.name="NoViableAltException",this.message=e,this.token=t,this.previousToken=r,this.resyncedTokens=[]}function u(e,t){this.name="NotAllInputParsedException",this.message=e,this.token=t,this.resyncedTokens=[]}function c(e,t,r){this.name="EarlyExitException",this.message=e,this.token=t,this.previousToken=r,this.resyncedTokens=[]}Object.freeze(o),i.prototype=Error.prototype,a.prototype=Error.prototype,u.prototype=Error.prototype,c.prototype=Error.prototype},function(e,t,r){"use strict";r.r(t),r.d(t,"LooksAhead",(function(){return u}));var n=r(107),o=r(87),s=r(86),i=r(104),a=r(100),u=function(){function e(){}return e.prototype.initLooksAhead=function(e){this.dynamicTokensEnabled=Object(o.has)(e,"dynamicTokensEnabled")?e.dynamicTokensEnabled:s.DEFAULT_PARSER_CONFIG.dynamicTokensEnabled,this.maxLookahead=Object(o.has)(e,"maxLookahead")?e.maxLookahead:s.DEFAULT_PARSER_CONFIG.maxLookahead,this.lookAheadFuncsCache=Object(o.isES2015MapSupported)()?new Map:[],Object(o.isES2015MapSupported)()?(this.getLaFuncFromCache=this.getLaFuncFromMap,this.setLaFuncCache=this.setLaFuncCacheUsingMap):(this.getLaFuncFromCache=this.getLaFuncFromObj,this.setLaFuncCache=this.setLaFuncUsingObj)},e.prototype.preComputeLookaheadFunctions=function(e){var t=this;Object(o.forEach)(e,(function(e){t.TRACE_INIT(e.name+" Rule Lookahead",(function(){var r=Object(a.collectMethods)(e),s=r.alternation,u=r.repetition,c=r.option,l=r.repetitionMandatory,h=r.repetitionMandatoryWithSeparator,d=r.repetitionWithSeparator;Object(o.forEach)(s,(function(r){var o=0===r.idx?"":r.idx;t.TRACE_INIT(""+Object(a.getProductionDslName)(r)+o,(function(){var o=Object(n.buildLookaheadFuncForOr)(r.idx,e,r.maxLookahead||t.maxLookahead,r.hasPredicates,t.dynamicTokensEnabled,t.lookAheadBuilderForAlternatives),s=Object(i.getKeyForAutomaticLookahead)(t.fullRuleNameToShort[e.name],i.OR_IDX,r.idx);t.setLaFuncCache(s,o)}))})),Object(o.forEach)(u,(function(r){t.computeLookaheadFunc(e,r.idx,i.MANY_IDX,n.PROD_TYPE.REPETITION,r.maxLookahead,Object(a.getProductionDslName)(r))})),Object(o.forEach)(c,(function(r){t.computeLookaheadFunc(e,r.idx,i.OPTION_IDX,n.PROD_TYPE.OPTION,r.maxLookahead,Object(a.getProductionDslName)(r))})),Object(o.forEach)(l,(function(r){t.computeLookaheadFunc(e,r.idx,i.AT_LEAST_ONE_IDX,n.PROD_TYPE.REPETITION_MANDATORY,r.maxLookahead,Object(a.getProductionDslName)(r))})),Object(o.forEach)(h,(function(r){t.computeLookaheadFunc(e,r.idx,i.AT_LEAST_ONE_SEP_IDX,n.PROD_TYPE.REPETITION_MANDATORY_WITH_SEPARATOR,r.maxLookahead,Object(a.getProductionDslName)(r))})),Object(o.forEach)(d,(function(r){t.computeLookaheadFunc(e,r.idx,i.MANY_SEP_IDX,n.PROD_TYPE.REPETITION_WITH_SEPARATOR,r.maxLookahead,Object(a.getProductionDslName)(r))}))}))}))},e.prototype.computeLookaheadFunc=function(e,t,r,o,s,a){var u=this;this.TRACE_INIT(""+a+(0===t?"":t),(function(){var a=Object(n.buildLookaheadFuncForOptionalProd)(t,e,s||u.maxLookahead,u.dynamicTokensEnabled,o,u.lookAheadBuilderForOptional),c=Object(i.getKeyForAutomaticLookahead)(u.fullRuleNameToShort[e.name],r,t);u.setLaFuncCache(c,a)}))},e.prototype.lookAheadBuilderForOptional=function(e,t,r){return Object(n.buildSingleAlternativeLookaheadFunction)(e,t,r)},e.prototype.lookAheadBuilderForAlternatives=function(e,t,r,o){return Object(n.buildAlternativesLookAheadFunc)(e,t,r,o)},e.prototype.getKeyForAutomaticLookahead=function(e,t){var r=this.getLastExplicitRuleShortName();return Object(i.getKeyForAutomaticLookahead)(r,e,t)},e.prototype.getLaFuncFromCache=function(e){},e.prototype.getLaFuncFromMap=function(e){return this.lookAheadFuncsCache.get(e)},e.prototype.getLaFuncFromObj=function(e){return this.lookAheadFuncsCache[e]},e.prototype.setLaFuncCache=function(e,t){},e.prototype.setLaFuncCacheUsingMap=function(e,t){this.lookAheadFuncsCache.set(e,t)},e.prototype.setLaFuncUsingObj=function(e,t){this.lookAheadFuncsCache[e]=t},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"TreeBuilder",(function(){return u}));var n=r(103),o=r(87),s=r(115),i=r(104),a=r(86),u=function(){function e(){}return e.prototype.initTreeBuilder=function(e){if(this.LAST_EXPLICIT_RULE_STACK=[],this.CST_STACK=[],this.outputCst=Object(o.has)(e,"outputCst")?e.outputCst:a.DEFAULT_PARSER_CONFIG.outputCst,this.nodeLocationTracking=Object(o.has)(e,"nodeLocationTracking")?e.nodeLocationTracking:a.DEFAULT_PARSER_CONFIG.nodeLocationTracking,this.outputCst)if(/full/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=n.setNodeLocationFull,this.setNodeLocationFromNode=n.setNodeLocationFull,this.cstPostRule=o.NOOP,this.setInitialNodeLocation=this.setInitialNodeLocationFullRecovery):(this.setNodeLocationFromToken=o.NOOP,this.setNodeLocationFromNode=o.NOOP,this.cstPostRule=this.cstPostRuleFull,this.setInitialNodeLocation=this.setInitialNodeLocationFullRegular);else if(/onlyOffset/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=n.setNodeLocationOnlyOffset,this.setNodeLocationFromNode=n.setNodeLocationOnlyOffset,this.cstPostRule=o.NOOP,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRecovery):(this.setNodeLocationFromToken=o.NOOP,this.setNodeLocationFromNode=o.NOOP,this.cstPostRule=this.cstPostRuleOnlyOffset,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRegular);else{if(!/none/i.test(this.nodeLocationTracking))throw Error('Invalid <nodeLocationTracking> config option: "'+e.nodeLocationTracking+'"');this.setNodeLocationFromToken=o.NOOP,this.setNodeLocationFromNode=o.NOOP,this.cstPostRule=o.NOOP,this.setInitialNodeLocation=o.NOOP}else this.cstInvocationStateUpdate=o.NOOP,this.cstFinallyStateUpdate=o.NOOP,this.cstPostTerminal=o.NOOP,this.cstPostNonTerminal=o.NOOP,this.cstPostRule=o.NOOP,this.getLastExplicitRuleShortName=this.getLastExplicitRuleShortNameNoCst,this.getPreviousExplicitRuleShortName=this.getPreviousExplicitRuleShortNameNoCst,this.getLastExplicitRuleOccurrenceIndex=this.getLastExplicitRuleOccurrenceIndexNoCst,this.manyInternal=this.manyInternalNoCst,this.orInternal=this.orInternalNoCst,this.optionInternal=this.optionInternalNoCst,this.atLeastOneInternal=this.atLeastOneInternalNoCst,this.manySepFirstInternal=this.manySepFirstInternalNoCst,this.atLeastOneSepFirstInternal=this.atLeastOneSepFirstInternalNoCst},e.prototype.setInitialNodeLocationOnlyOffsetRecovery=function(e){e.location={startOffset:NaN,endOffset:NaN}},e.prototype.setInitialNodeLocationOnlyOffsetRegular=function(e){e.location={startOffset:this.LA(1).startOffset,endOffset:NaN}},e.prototype.setInitialNodeLocationFullRecovery=function(e){e.location={startOffset:NaN,startLine:NaN,startColumn:NaN,endOffset:NaN,endLine:NaN,endColumn:NaN}},e.prototype.setInitialNodeLocationFullRegular=function(e){var t=this.LA(1);e.location={startOffset:t.startOffset,startLine:t.startLine,startColumn:t.startColumn,endOffset:NaN,endLine:NaN,endColumn:NaN}},e.prototype.cstNestedInvocationStateUpdate=function(e,t){var r={name:e,fullName:this.shortRuleNameToFull[this.getLastExplicitRuleShortName()]+e,children:{}};this.setInitialNodeLocation(r),this.CST_STACK.push(r)},e.prototype.cstInvocationStateUpdate=function(e,t){this.LAST_EXPLICIT_RULE_STACK.push(this.RULE_STACK.length-1);var r={name:e,children:{}};this.setInitialNodeLocation(r),this.CST_STACK.push(r)},e.prototype.cstFinallyStateUpdate=function(){this.LAST_EXPLICIT_RULE_STACK.pop(),this.CST_STACK.pop()},e.prototype.cstNestedFinallyStateUpdate=function(){var e=this.CST_STACK.pop();this.cstPostRule(e)},e.prototype.cstPostRuleFull=function(e){var t=this.LA(0),r=e.location;r.startOffset<=t.startOffset==1?(r.endOffset=t.endOffset,r.endLine=t.endLine,r.endColumn=t.endColumn):(r.startOffset=NaN,r.startLine=NaN,r.startColumn=NaN)},e.prototype.cstPostRuleOnlyOffset=function(e){var t=this.LA(0),r=e.location;r.startOffset<=t.startOffset==1?r.endOffset=t.endOffset:r.startOffset=NaN},e.prototype.cstPostTerminal=function(e,t){var r=this.CST_STACK[this.CST_STACK.length-1];Object(n.addTerminalToCst)(r,t,e),this.setNodeLocationFromToken(r.location,t)},e.prototype.cstPostNonTerminal=function(e,t){if(!0!==this.isBackTracking()){var r=this.CST_STACK[this.CST_STACK.length-1];Object(n.addNoneTerminalToCst)(r,t,e),this.setNodeLocationFromNode(r.location,e.location)}},e.prototype.getBaseCstVisitorConstructor=function(){if(Object(o.isUndefined)(this.baseCstVisitorConstructor)){var e=Object(s.createBaseSemanticVisitorConstructor)(this.className,this.allRuleNames);return this.baseCstVisitorConstructor=e,e}return this.baseCstVisitorConstructor},e.prototype.getBaseCstVisitorConstructorWithDefaults=function(){if(Object(o.isUndefined)(this.baseCstVisitorWithDefaultsConstructor)){var e=Object(s.createBaseVisitorConstructorWithDefaults)(this.className,this.allRuleNames,this.getBaseCstVisitorConstructor());return this.baseCstVisitorWithDefaultsConstructor=e,e}return this.baseCstVisitorWithDefaultsConstructor},e.prototype.nestedRuleBeforeClause=function(e,t){var r;return void 0!==e.NAME?(r=e.NAME,this.nestedRuleInvocationStateUpdate(r,t),r):void 0},e.prototype.nestedAltBeforeClause=function(e,t,r,n){var o,s=this.getLastExplicitRuleShortName(),a=Object(i.getKeyForAltIndex)(s,r,t,n);return void 0!==e.NAME?(o=e.NAME,this.nestedRuleInvocationStateUpdate(o,a),{shortName:a,nestedName:o}):void 0},e.prototype.nestedRuleFinallyClause=function(e,t){var r=this.CST_STACK,o=r[r.length-1];this.nestedRuleFinallyStateUpdate();var s=r[r.length-1];Object(n.addNoneTerminalToCst)(s,t,o),this.setNodeLocationFromNode(s.location,o.location)},e.prototype.getLastExplicitRuleShortName=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-1];return this.RULE_STACK[e]},e.prototype.getLastExplicitRuleShortNameNoCst=function(){var e=this.RULE_STACK;return e[e.length-1]},e.prototype.getPreviousExplicitRuleShortName=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-2];return this.RULE_STACK[e]},e.prototype.getPreviousExplicitRuleShortNameNoCst=function(){var e=this.RULE_STACK;return e[e.length-2]},e.prototype.getLastExplicitRuleOccurrenceIndex=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-1];return this.RULE_OCCURRENCE_STACK[e]},e.prototype.getLastExplicitRuleOccurrenceIndexNoCst=function(){var e=this.RULE_OCCURRENCE_STACK;return e[e.length-1]},e.prototype.nestedRuleInvocationStateUpdate=function(e,t){this.RULE_OCCURRENCE_STACK.push(1),this.RULE_STACK.push(t),this.cstNestedInvocationStateUpdate(e,t)},e.prototype.nestedRuleFinallyStateUpdate=function(){this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstNestedFinallyStateUpdate()},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"defaultVisit",(function(){return a})),r.d(t,"createBaseSemanticVisitorConstructor",(function(){return u})),r.d(t,"createBaseVisitorConstructorWithDefaults",(function(){return c})),r.d(t,"CstVisitorDefinitionError",(function(){return n})),r.d(t,"validateVisitor",(function(){return l})),r.d(t,"validateMissingCstMethods",(function(){return h})),r.d(t,"validateRedundantMethods",(function(){return p}));var n,o=r(87),s=r(116),i=r(106);function a(e,t){for(var r=Object(o.keys)(e),n=r.length,s=0;s<n;s++)for(var i=e[r[s]],a=i.length,u=0;u<a;u++){var c=i[u];void 0===c.tokenTypeIdx&&(void 0!==c.fullName?this[c.fullName](c.children,t):this[c.name](c.children,t))}}function u(e,t){var r=function(){};return Object(s.defineNameProp)(r,e+"BaseSemantics"),(r.prototype={visit:function(e,t){if(Object(o.isArray)(e)&&(e=e[0]),!Object(o.isUndefined)(e))return void 0!==e.fullName?this[e.fullName](e.children,t):this[e.name](e.children,t)},validateVisitor:function(){var e=l(this,t);if(!Object(o.isEmpty)(e)){var r=Object(o.map)(e,(function(e){return e.msg}));throw Error("Errors Detected in CST Visitor <"+Object(s.functionName)(this.constructor)+">:\n\t"+r.join("\n\n").replace(/\n/g,"\n\t"))}}}).constructor=r,r._RULE_NAMES=t,r}function c(e,t,r){var n=function(){};Object(s.defineNameProp)(n,e+"BaseSemanticsWithDefaults");var i=Object.create(r.prototype);return Object(o.forEach)(t,(function(e){i[e]=a})),(n.prototype=i).constructor=n,n}function l(e,t){var r=h(e,t),n=p(e,t);return r.concat(n)}function h(e,t){var r=Object(o.map)(t,(function(t){if(!Object(o.isFunction)(e[t]))return{msg:"Missing visitor method: <"+t+"> on "+Object(s.functionName)(e.constructor)+" CST Visitor.",type:n.MISSING_METHOD,methodName:t}}));return Object(o.compact)(r)}!function(e){e[e.REDUNDANT_METHOD=0]="REDUNDANT_METHOD",e[e.MISSING_METHOD=1]="MISSING_METHOD"}(n||(n={}));var d=["constructor","visit","validateVisitor"];function p(e,t){var r=[];for(var a in e)i.validTermsPattern.test(a)&&Object(o.isFunction)(e[a])&&!Object(o.contains)(d,a)&&!Object(o.contains)(t,a)&&r.push({msg:"Redundant visitor method: <"+a+"> on "+Object(s.functionName)(e.constructor)+" CST Visitor\nThere is no Grammar Rule corresponding to this method's name.\nFor utility methods on visitor classes use methods names that do not match /"+i.validTermsPattern.source+"/.",type:n.REDUNDANT_METHOD,methodName:a});return r}},function(e,t,r){"use strict";r.r(t),r.d(t,"classNameFromInstance",(function(){return o})),r.d(t,"functionName",(function(){return i})),r.d(t,"defineNameProp",(function(){return a}));var n=r(87);function o(e){return i(e.constructor)}var s=/^\s*function\s*(\S*)\s*\(/;function i(e){var t=e.name;return t||e.toString().match(s)[1]}function a(e,t){var r=Object.getOwnPropertyDescriptor(e,"name");return!(!Object(n.isUndefined)(r)&&!r.configurable||(Object.defineProperty(e,"name",{enumerable:!1,configurable:!0,writable:!1,value:t}),0))}},function(e,t,r){"use strict";r.r(t),r.d(t,"LexerAdapter",(function(){return o}));var n=r(86),o=function(){function e(){}return e.prototype.initLexerAdapter=function(){this.tokVector=[],this.tokVectorLength=0,this.currIdx=-1},Object.defineProperty(e.prototype,"input",{get:function(){return this.tokVector},set:function(e){if(!0!==this.selfAnalysisDone)throw Error("Missing <performSelfAnalysis> invocation at the end of the Parser's constructor.");this.reset(),this.tokVector=e,this.tokVectorLength=e.length},enumerable:!0,configurable:!0}),e.prototype.SKIP_TOKEN=function(){return this.currIdx<=this.tokVector.length-2?(this.consumeToken(),this.LA(1)):n.END_OF_FILE},e.prototype.LA=function(e){var t=this.currIdx+e;return t<0||this.tokVectorLength<=t?n.END_OF_FILE:this.tokVector[t]},e.prototype.consumeToken=function(){this.currIdx++},e.prototype.exportLexerState=function(){return this.currIdx},e.prototype.importLexerState=function(e){this.currIdx=e},e.prototype.resetLexerState=function(){this.currIdx=-1},e.prototype.moveToTerminatedState=function(){this.currIdx=this.tokVector.length-1},e.prototype.getLexerPosition=function(){return this.exportLexerState()},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"RecognizerApi",(function(){return c}));var n=r(87),o=r(112),s=r(86),i=r(105),a=r(106),u=r(90),c=function(){function e(){}return e.prototype.ACTION=function(e){return e.call(this)},e.prototype.consume=function(e,t,r){return this.consumeInternal(t,e,r)},e.prototype.subrule=function(e,t,r){return this.subruleInternal(t,e,r)},e.prototype.option=function(e,t){return this.optionInternal(t,e)},e.prototype.or=function(e,t){return this.orInternal(t,e)},e.prototype.many=function(e,t){return this.manyInternal(e,t)},e.prototype.atLeastOne=function(e,t){return this.atLeastOneInternal(e,t)},e.prototype.CONSUME=function(e,t){return this.consumeInternal(e,0,t)},e.prototype.CONSUME1=function(e,t){return this.consumeInternal(e,1,t)},e.prototype.CONSUME2=function(e,t){return this.consumeInternal(e,2,t)},e.prototype.CONSUME3=function(e,t){return this.consumeInternal(e,3,t)},e.prototype.CONSUME4=function(e,t){return this.consumeInternal(e,4,t)},e.prototype.CONSUME5=function(e,t){return this.consumeInternal(e,5,t)},e.prototype.CONSUME6=function(e,t){return this.consumeInternal(e,6,t)},e.prototype.CONSUME7=function(e,t){return this.consumeInternal(e,7,t)},e.prototype.CONSUME8=function(e,t){return this.consumeInternal(e,8,t)},e.prototype.CONSUME9=function(e,t){return this.consumeInternal(e,9,t)},e.prototype.SUBRULE=function(e,t){return this.subruleInternal(e,0,t)},e.prototype.SUBRULE1=function(e,t){return this.subruleInternal(e,1,t)},e.prototype.SUBRULE2=function(e,t){return this.subruleInternal(e,2,t)},e.prototype.SUBRULE3=function(e,t){return this.subruleInternal(e,3,t)},e.prototype.SUBRULE4=function(e,t){return this.subruleInternal(e,4,t)},e.prototype.SUBRULE5=function(e,t){return this.subruleInternal(e,5,t)},e.prototype.SUBRULE6=function(e,t){return this.subruleInternal(e,6,t)},e.prototype.SUBRULE7=function(e,t){return this.subruleInternal(e,7,t)},e.prototype.SUBRULE8=function(e,t){return this.subruleInternal(e,8,t)},e.prototype.SUBRULE9=function(e,t){return this.subruleInternal(e,9,t)},e.prototype.OPTION=function(e){return this.optionInternal(e,0)},e.prototype.OPTION1=function(e){return this.optionInternal(e,1)},e.prototype.OPTION2=function(e){return this.optionInternal(e,2)},e.prototype.OPTION3=function(e){return this.optionInternal(e,3)},e.prototype.OPTION4=function(e){return this.optionInternal(e,4)},e.prototype.OPTION5=function(e){return this.optionInternal(e,5)},e.prototype.OPTION6=function(e){return this.optionInternal(e,6)},e.prototype.OPTION7=function(e){return this.optionInternal(e,7)},e.prototype.OPTION8=function(e){return this.optionInternal(e,8)},e.prototype.OPTION9=function(e){return this.optionInternal(e,9)},e.prototype.OR=function(e){return this.orInternal(e,0)},e.prototype.OR1=function(e){return this.orInternal(e,1)},e.prototype.OR2=function(e){return this.orInternal(e,2)},e.prototype.OR3=function(e){return this.orInternal(e,3)},e.prototype.OR4=function(e){return this.orInternal(e,4)},e.prototype.OR5=function(e){return this.orInternal(e,5)},e.prototype.OR6=function(e){return this.orInternal(e,6)},e.prototype.OR7=function(e){return this.orInternal(e,7)},e.prototype.OR8=function(e){return this.orInternal(e,8)},e.prototype.OR9=function(e){return this.orInternal(e,9)},e.prototype.MANY=function(e){this.manyInternal(0,e)},e.prototype.MANY1=function(e){this.manyInternal(1,e)},e.prototype.MANY2=function(e){this.manyInternal(2,e)},e.prototype.MANY3=function(e){this.manyInternal(3,e)},e.prototype.MANY4=function(e){this.manyInternal(4,e)},e.prototype.MANY5=function(e){this.manyInternal(5,e)},e.prototype.MANY6=function(e){this.manyInternal(6,e)},e.prototype.MANY7=function(e){this.manyInternal(7,e)},e.prototype.MANY8=function(e){this.manyInternal(8,e)},e.prototype.MANY9=function(e){this.manyInternal(9,e)},e.prototype.MANY_SEP=function(e){this.manySepFirstInternal(0,e)},e.prototype.MANY_SEP1=function(e){this.manySepFirstInternal(1,e)},e.prototype.MANY_SEP2=function(e){this.manySepFirstInternal(2,e)},e.prototype.MANY_SEP3=function(e){this.manySepFirstInternal(3,e)},e.prototype.MANY_SEP4=function(e){this.manySepFirstInternal(4,e)},e.prototype.MANY_SEP5=function(e){this.manySepFirstInternal(5,e)},e.prototype.MANY_SEP6=function(e){this.manySepFirstInternal(6,e)},e.prototype.MANY_SEP7=function(e){this.manySepFirstInternal(7,e)},e.prototype.MANY_SEP8=function(e){this.manySepFirstInternal(8,e)},e.prototype.MANY_SEP9=function(e){this.manySepFirstInternal(9,e)},e.prototype.AT_LEAST_ONE=function(e){this.atLeastOneInternal(0,e)},e.prototype.AT_LEAST_ONE1=function(e){return this.atLeastOneInternal(1,e)},e.prototype.AT_LEAST_ONE2=function(e){this.atLeastOneInternal(2,e)},e.prototype.AT_LEAST_ONE3=function(e){this.atLeastOneInternal(3,e)},e.prototype.AT_LEAST_ONE4=function(e){this.atLeastOneInternal(4,e)},e.prototype.AT_LEAST_ONE5=function(e){this.atLeastOneInternal(5,e)},e.prototype.AT_LEAST_ONE6=function(e){this.atLeastOneInternal(6,e)},e.prototype.AT_LEAST_ONE7=function(e){this.atLeastOneInternal(7,e)},e.prototype.AT_LEAST_ONE8=function(e){this.atLeastOneInternal(8,e)},e.prototype.AT_LEAST_ONE9=function(e){this.atLeastOneInternal(9,e)},e.prototype.AT_LEAST_ONE_SEP=function(e){this.atLeastOneSepFirstInternal(0,e)},e.prototype.AT_LEAST_ONE_SEP1=function(e){this.atLeastOneSepFirstInternal(1,e)},e.prototype.AT_LEAST_ONE_SEP2=function(e){this.atLeastOneSepFirstInternal(2,e)},e.prototype.AT_LEAST_ONE_SEP3=function(e){this.atLeastOneSepFirstInternal(3,e)},e.prototype.AT_LEAST_ONE_SEP4=function(e){this.atLeastOneSepFirstInternal(4,e)},e.prototype.AT_LEAST_ONE_SEP5=function(e){this.atLeastOneSepFirstInternal(5,e)},e.prototype.AT_LEAST_ONE_SEP6=function(e){this.atLeastOneSepFirstInternal(6,e)},e.prototype.AT_LEAST_ONE_SEP7=function(e){this.atLeastOneSepFirstInternal(7,e)},e.prototype.AT_LEAST_ONE_SEP8=function(e){this.atLeastOneSepFirstInternal(8,e)},e.prototype.AT_LEAST_ONE_SEP9=function(e){this.atLeastOneSepFirstInternal(9,e)},e.prototype.RULE=function(e,t,r){if(void 0===r&&(r=s.DEFAULT_RULE_CONFIG),Object(n.contains)(this.definedRulesNames,e)){var o={message:i.defaultGrammarValidatorErrorProvider.buildDuplicateRuleNameError({topLevelRule:e,grammarName:this.className}),type:s.ParserDefinitionErrorType.DUPLICATE_RULE_NAME,ruleName:e};this.definitionErrors.push(o)}this.definedRulesNames.push(e);var a=this.defineRule(e,t,r);return this[e]=a,a},e.prototype.OVERRIDE_RULE=function(e,t,r){void 0===r&&(r=s.DEFAULT_RULE_CONFIG);var n=[];n=n.concat(Object(a.validateRuleIsOverridden)(e,this.definedRulesNames,this.className)),this.definitionErrors.push.apply(this.definitionErrors,n);var o=this.defineRule(e,t,r);return this[e]=o,o},e.prototype.BACKTRACK=function(e,t){return function(){this.isBackTrackingStack.push(1);var r=this.saveRecogState();try{return e.apply(this,t),!0}catch(e){if(Object(o.isRecognitionException)(e))return!1;throw e}finally{this.reloadRecogState(r),this.isBackTrackingStack.pop()}}},e.prototype.getGAstProductions=function(){return this.gastProductionsCache},e.prototype.getSerializedGastProductions=function(){return Object(u.serializeGrammar)(Object(n.values)(this.gastProductionsCache))},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"RecognizerEngine",(function(){return p}));var n=r(87),o=r(104),s=r(112),i=r(107),a=r(108),u=r(86),c=r(111),l=r(91),h=r(97),d=r(116),p=function(){function e(){}return e.prototype.initRecognizerEngine=function(e,t){if(this.className=Object(d.classNameFromInstance)(this),this.shortRuleNameToFull={},this.fullRuleNameToShort={},this.ruleShortNameIdx=256,this.tokenMatcher=h.tokenStructuredMatcherNoCategories,this.definedRulesNames=[],this.tokensMap={},this.allRuleNames=[],this.isBackTrackingStack=[],this.RULE_STACK=[],this.RULE_OCCURRENCE_STACK=[],this.gastProductionsCache={},Object(n.has)(t,"serializedGrammar"))throw Error("The Parser's configuration can no longer contain a <serializedGrammar> property.\n\tSee: https://sap.github.io/chevrotain/docs/changes/BREAKING_CHANGES.html#_6-0-0\n\tFor Further details.");if(Object(n.isArray)(e)){if(Object(n.isEmpty)(e))throw Error("A Token Vocabulary cannot be empty.\n\tNote that the first argument for the parser constructor\n\tis no longer a Token vector (since v4.0).");if("number"==typeof e[0].startOffset)throw Error("The Parser constructor no longer accepts a token vector as the first argument.\n\tSee: https://sap.github.io/chevrotain/docs/changes/BREAKING_CHANGES.html#_4-0-0\n\tFor Further details.")}if(Object(n.isArray)(e))this.tokensMap=Object(n.reduce)(e,(function(e,t){return e[t.name]=t,e}),{});else if(Object(n.has)(e,"modes")&&Object(n.every)(Object(n.flatten)(Object(n.values)(e.modes)),h.isTokenType)){var r=Object(n.flatten)(Object(n.values)(e.modes)),o=Object(n.uniq)(r);this.tokensMap=Object(n.reduce)(o,(function(e,t){return e[t.name]=t,e}),{})}else{if(!Object(n.isObject)(e))throw new Error("<tokensDictionary> argument must be An Array of Token constructors, A dictionary of Token constructors or an IMultiModeLexerDefinition");this.tokensMap=Object(n.cloneObj)(e)}this.tokensMap.EOF=l.EOF;var s=Object(n.every)(Object(n.values)(e),(function(e){return Object(n.isEmpty)(e.categoryMatches)}));this.tokenMatcher=s?h.tokenStructuredMatcherNoCategories:h.tokenStructuredMatcher,Object(h.augmentTokenTypes)(Object(n.values)(this.tokensMap))},e.prototype.defineRule=function(e,t,r){if(this.selfAnalysisDone)throw Error("Grammar rule <"+e+"> may not be defined after the 'performSelfAnalysis' method has been called'\nMake sure that all grammar rule definitions are done before 'performSelfAnalysis' is called.");var s,i=Object(n.has)(r,"resyncEnabled")?r.resyncEnabled:u.DEFAULT_RULE_CONFIG.resyncEnabled,a=Object(n.has)(r,"recoveryValueFunc")?r.recoveryValueFunc:u.DEFAULT_RULE_CONFIG.recoveryValueFunc,c=this.ruleShortNameIdx<<o.BITS_FOR_METHOD_TYPE+o.BITS_FOR_OCCURRENCE_IDX;function l(e){try{if(!0===this.outputCst){t.apply(this,e);var r=this.CST_STACK[this.CST_STACK.length-1];return this.cstPostRule(r),r}return t.apply(this,e)}catch(e){return this.invokeRuleCatch(e,i,a)}finally{this.ruleFinallyStateUpdate()}}return this.ruleShortNameIdx++,this.shortRuleNameToFull[c]=e,this.fullRuleNameToShort[e]=c,(s=function(t,r){return void 0===t&&(t=0),this.ruleInvocationStateUpdate(c,e,t),l.call(this,r)}).ruleName=e,s.originalGrammarAction=t,s},e.prototype.invokeRuleCatch=function(e,t,r){var n=1===this.RULE_STACK.length,o=t&&!this.isBackTracking()&&this.recoveryEnabled;if(Object(s.isRecognitionException)(e)){var i=e;if(o){var a,u=this.findReSyncTokenType();if(this.isInCurrentRuleReSyncSet(u))return i.resyncedTokens=this.reSyncTo(u),this.outputCst?((a=this.CST_STACK[this.CST_STACK.length-1]).recoveredNode=!0,a):r();throw this.outputCst&&((a=this.CST_STACK[this.CST_STACK.length-1]).recoveredNode=!0,i.partialCstResult=a),i}if(n)return this.moveToTerminatedState(),r();throw i}throw e},e.prototype.optionInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(o.OPTION_IDX,t),n=this.nestedRuleBeforeClause(e,r);try{return this.optionInternalLogic(e,t,r)}finally{void 0!==n&&this.nestedRuleFinallyClause(r,n)}},e.prototype.optionInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead(o.OPTION_IDX,t);return this.optionInternalLogic(e,t,r)},e.prototype.optionInternalLogic=function(e,t,r){var n,o,s=this,i=this.getLaFuncFromCache(r);if(void 0!==e.DEF){if(n=e.DEF,void 0!==(o=e.GATE)){var a=i;i=function(){return o.call(s)&&a.call(s)}}}else n=e;if(!0===i.call(this))return n.call(this)},e.prototype.atLeastOneInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(o.AT_LEAST_ONE_IDX,e),n=this.nestedRuleBeforeClause(t,r);try{return this.atLeastOneInternalLogic(e,t,r)}finally{void 0!==n&&this.nestedRuleFinallyClause(r,n)}},e.prototype.atLeastOneInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead(o.AT_LEAST_ONE_IDX,e);this.atLeastOneInternalLogic(e,t,r)},e.prototype.atLeastOneInternalLogic=function(e,t,r){var n,s,u=this,c=this.getLaFuncFromCache(r);if(void 0!==t.DEF){if(n=t.DEF,void 0!==(s=t.GATE)){var l=c;c=function(){return s.call(u)&&l.call(u)}}}else n=t;if(!0!==c.call(this))throw this.raiseEarlyExitException(e,i.PROD_TYPE.REPETITION_MANDATORY,t.ERR_MSG);for(var h=this.doSingleRepetition(n);!0===c.call(this)&&!0===h;)h=this.doSingleRepetition(n);this.attemptInRepetitionRecovery(this.atLeastOneInternal,[e,t],c,o.AT_LEAST_ONE_IDX,e,a.NextTerminalAfterAtLeastOneWalker)},e.prototype.atLeastOneSepFirstInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(o.AT_LEAST_ONE_SEP_IDX,e),n=this.nestedRuleBeforeClause(t,r);try{this.atLeastOneSepFirstInternalLogic(e,t,r)}finally{void 0!==n&&this.nestedRuleFinallyClause(r,n)}},e.prototype.atLeastOneSepFirstInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead(o.AT_LEAST_ONE_SEP_IDX,e);this.atLeastOneSepFirstInternalLogic(e,t,r)},e.prototype.atLeastOneSepFirstInternalLogic=function(e,t,r){var n=this,s=t.DEF,u=t.SEP;if(!0!==this.getLaFuncFromCache(r).call(this))throw this.raiseEarlyExitException(e,i.PROD_TYPE.REPETITION_MANDATORY_WITH_SEPARATOR,t.ERR_MSG);s.call(this);for(var c=function(){return n.tokenMatcher(n.LA(1),u)};!0===this.tokenMatcher(this.LA(1),u);)this.CONSUME(u),s.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,u,c,s,a.NextTerminalAfterAtLeastOneSepWalker],c,o.AT_LEAST_ONE_SEP_IDX,e,a.NextTerminalAfterAtLeastOneSepWalker)},e.prototype.manyInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(o.MANY_IDX,e),n=this.nestedRuleBeforeClause(t,r);try{return this.manyInternalLogic(e,t,r)}finally{void 0!==n&&this.nestedRuleFinallyClause(r,n)}},e.prototype.manyInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead(o.MANY_IDX,e);return this.manyInternalLogic(e,t,r)},e.prototype.manyInternalLogic=function(e,t,r){var n,s,i=this,u=this.getLaFuncFromCache(r);if(void 0!==t.DEF){if(n=t.DEF,void 0!==(s=t.GATE)){var c=u;u=function(){return s.call(i)&&c.call(i)}}}else n=t;for(var l=!0;!0===u.call(this)&&!0===l;)l=this.doSingleRepetition(n);this.attemptInRepetitionRecovery(this.manyInternal,[e,t],u,o.MANY_IDX,e,a.NextTerminalAfterManyWalker,l)},e.prototype.manySepFirstInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(o.MANY_SEP_IDX,e),n=this.nestedRuleBeforeClause(t,r);try{this.manySepFirstInternalLogic(e,t,r)}finally{void 0!==n&&this.nestedRuleFinallyClause(r,n)}},e.prototype.manySepFirstInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead(o.MANY_SEP_IDX,e);this.manySepFirstInternalLogic(e,t,r)},e.prototype.manySepFirstInternalLogic=function(e,t,r){var n=this,s=t.DEF,i=t.SEP;if(!0===this.getLaFuncFromCache(r).call(this)){s.call(this);for(var u=function(){return n.tokenMatcher(n.LA(1),i)};!0===this.tokenMatcher(this.LA(1),i);)this.CONSUME(i),s.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,i,u,s,a.NextTerminalAfterManySepWalker],u,o.MANY_SEP_IDX,e,a.NextTerminalAfterManySepWalker)}},e.prototype.repetitionSepSecondInternal=function(e,t,r,n,s){for(;r();)this.CONSUME(t),n.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,t,r,n,s],r,o.AT_LEAST_ONE_SEP_IDX,e,s)},e.prototype.doSingleRepetition=function(e){var t=this.getLexerPosition();return e.call(this),this.getLexerPosition()>t},e.prototype.orInternalNoCst=function(e,t){var r=Object(n.isArray)(e)?e:e.DEF,s=this.getKeyForAutomaticLookahead(o.OR_IDX,t),i=this.getLaFuncFromCache(s).call(this,r);if(void 0!==i)return r[i].ALT.call(this);this.raiseNoAltException(t,e.ERR_MSG)},e.prototype.orInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(o.OR_IDX,t),s=this.nestedRuleBeforeClause(e,r);try{var i=Object(n.isArray)(e)?e:e.DEF,a=this.getLaFuncFromCache(r).call(this,i);if(void 0!==a){var u=i[a],c=this.nestedAltBeforeClause(u,t,o.OR_IDX,a);try{return u.ALT.call(this)}finally{void 0!==c&&this.nestedRuleFinallyClause(c.shortName,c.nestedName)}}this.raiseNoAltException(t,e.ERR_MSG)}finally{void 0!==s&&this.nestedRuleFinallyClause(r,s)}},e.prototype.ruleFinallyStateUpdate=function(){if(this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstFinallyStateUpdate(),0===this.RULE_STACK.length&&!1===this.isAtEndOfInput()){var e=this.LA(1),t=this.errorMessageProvider.buildNotAllInputParsedMessage({firstRedundant:e,ruleName:this.getCurrRuleFullName()});this.SAVE_ERROR(new s.NotAllInputParsedException(t,e))}},e.prototype.subruleInternal=function(e,t,r){var n;try{var o=void 0!==r?r.ARGS:void 0;return n=e.call(this,t,o),this.cstPostNonTerminal(n,void 0!==r&&void 0!==r.LABEL?r.LABEL:e.ruleName),n}catch(t){this.subruleInternalError(t,r,e.ruleName)}},e.prototype.subruleInternalError=function(e,t,r){throw Object(s.isRecognitionException)(e)&&void 0!==e.partialCstResult&&(this.cstPostNonTerminal(e.partialCstResult,void 0!==t&&void 0!==t.LABEL?t.LABEL:r),delete e.partialCstResult),e},e.prototype.consumeInternal=function(e,t,r){var n;try{var o=this.LA(1);!0===this.tokenMatcher(o,e)?(this.consumeToken(),n=o):this.consumeInternalError(e,o,r)}catch(r){n=this.consumeInternalRecovery(e,t,r)}return this.cstPostTerminal(void 0!==r&&void 0!==r.LABEL?r.LABEL:e.name,n),n},e.prototype.consumeInternalError=function(e,t,r){var n,o=this.LA(0);throw n=void 0!==r&&r.ERR_MSG?r.ERR_MSG:this.errorMessageProvider.buildMismatchTokenMessage({expected:e,actual:t,previous:o,ruleName:this.getCurrRuleFullName()}),this.SAVE_ERROR(new s.MismatchedTokenException(n,t,o))},e.prototype.consumeInternalRecovery=function(e,t,r){if(!this.recoveryEnabled||"MismatchedTokenException"!==r.name||this.isBackTracking())throw r;var n=this.getFollowsForInRuleRecovery(e,t);try{return this.tryInRuleRecovery(e,n)}catch(e){throw e.name===c.IN_RULE_RECOVERY_EXCEPTION?r:e}},e.prototype.saveRecogState=function(){var e=this.errors,t=Object(n.cloneArr)(this.RULE_STACK);return{errors:e,lexerState:this.exportLexerState(),RULE_STACK:t,CST_STACK:this.CST_STACK,LAST_EXPLICIT_RULE_STACK:this.LAST_EXPLICIT_RULE_STACK}},e.prototype.reloadRecogState=function(e){this.errors=e.errors,this.importLexerState(e.lexerState),this.RULE_STACK=e.RULE_STACK},e.prototype.ruleInvocationStateUpdate=function(e,t,r){this.RULE_OCCURRENCE_STACK.push(r),this.RULE_STACK.push(e),this.cstInvocationStateUpdate(t,e)},e.prototype.isBackTracking=function(){return 0!==this.isBackTrackingStack.length},e.prototype.getCurrRuleFullName=function(){var e=this.getLastExplicitRuleShortName();return this.shortRuleNameToFull[e]},e.prototype.shortRuleNameToFullName=function(e){return this.shortRuleNameToFull[e]},e.prototype.isAtEndOfInput=function(){return this.tokenMatcher(this.LA(1),l.EOF)},e.prototype.reset=function(){this.resetLexerState(),this.isBackTrackingStack=[],this.errors=[],this.RULE_STACK=[],this.LAST_EXPLICIT_RULE_STACK=[],this.CST_STACK=[],this.RULE_OCCURRENCE_STACK=[]},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"ErrorHandler",(function(){return a}));var n=r(112),o=r(87),s=r(107),i=r(86),a=function(){function e(){}return e.prototype.initErrorHandler=function(e){this._errors=[],this.errorMessageProvider=Object(o.defaults)(e.errorMessageProvider,i.DEFAULT_PARSER_CONFIG.errorMessageProvider)},e.prototype.SAVE_ERROR=function(e){if(Object(n.isRecognitionException)(e))return e.context={ruleStack:this.getHumanReadableRuleStack(),ruleOccurrenceStack:Object(o.cloneArr)(this.RULE_OCCURRENCE_STACK)},this._errors.push(e),e;throw Error("Trying to save an Error which is not a RecognitionException")},Object.defineProperty(e.prototype,"errors",{get:function(){return Object(o.cloneArr)(this._errors)},set:function(e){this._errors=e},enumerable:!0,configurable:!0}),e.prototype.raiseEarlyExitException=function(e,t,r){for(var o=this.getCurrRuleFullName(),i=this.getGAstProductions()[o],a=Object(s.getLookaheadPathsForOptionalProd)(e,i,t,this.maxLookahead)[0],u=[],c=1;c<=this.maxLookahead;c++)u.push(this.LA(c));var l=this.errorMessageProvider.buildEarlyExitMessage({expectedIterationPaths:a,actual:u,previous:this.LA(0),customUserDescription:r,ruleName:o});throw this.SAVE_ERROR(new n.EarlyExitException(l,this.LA(1),this.LA(0)))},e.prototype.raiseNoAltException=function(e,t){for(var r=this.getCurrRuleFullName(),o=this.getGAstProductions()[r],i=Object(s.getLookaheadPathsForOr)(e,o,this.maxLookahead),a=[],u=1;u<=this.maxLookahead;u++)a.push(this.LA(u));var c=this.LA(0),l=this.errorMessageProvider.buildNoViableAltMessage({expectedPathsPerAlt:i,actual:a,previous:c,customUserDescription:t,ruleName:this.getCurrRuleFullName()});throw this.SAVE_ERROR(new n.NoViableAltException(l,this.LA(1),c))},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"ContentAssist",(function(){return s}));var n=r(108),o=r(87),s=function(){function e(){}return e.prototype.initContentAssist=function(){},e.prototype.computeContentAssist=function(e,t){var r=this.gastProductionsCache[e];if(Object(o.isUndefined)(r))throw Error("Rule ->"+e+"<- does not exist in this grammar.");return Object(n.nextPossibleTokensAfter)([r],t,this.tokenMatcher,this.maxLookahead)},e.prototype.getNextPossibleTokenTypes=function(e){var t=Object(o.first)(e.ruleStack),r=this.getGAstProductions()[t];return new n.NextAfterTokenWalker(r,e).startWalking()},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"GastRecorder",(function(){return g}));var n=r(87),o=r(90),s=r(92),i=r(97),a=r(91),u=r(86),c=r(104),l={description:"This Object indicates the Parser is during Recording Phase"};Object.freeze(l);var h=Math.pow(2,c.BITS_FOR_OCCURRENCE_IDX)-1,d=Object(a.createToken)({name:"RECORDING_PHASE_TOKEN",pattern:s.Lexer.NA});Object(i.augmentTokenTypes)([d]);var p=Object(a.createTokenInstance)(d,"This IToken indicates the Parser is in Recording Phase\n\tSee: https://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording for details",-1,-1,-1,-1,-1,-1);Object.freeze(p);var m={name:"This CSTNode indicates the Parser is in Recording Phase\n\tSee: https://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording for details",children:{}},g=function(){function e(){}return e.prototype.initGastRecorder=function(e){this.recordingProdStack=[],this.RECORDING_PHASE=!1},e.prototype.enableRecording=function(){var e=this;this.RECORDING_PHASE=!0,this.TRACE_INIT("Enable Recording",(function(){for(var t=function(t){var r=t>0?t:"";e["CONSUME"+r]=function(e,r){return this.consumeInternalRecord(e,t,r)},e["SUBRULE"+r]=function(e,r){return this.subruleInternalRecord(e,t,r)},e["OPTION"+r]=function(e){return this.optionInternalRecord(e,t)},e["OR"+r]=function(e){return this.orInternalRecord(e,t)},e["MANY"+r]=function(e){this.manyInternalRecord(t,e)},e["MANY_SEP"+r]=function(e){this.manySepFirstInternalRecord(t,e)},e["AT_LEAST_ONE"+r]=function(e){this.atLeastOneInternalRecord(t,e)},e["AT_LEAST_ONE_SEP"+r]=function(e){this.atLeastOneSepFirstInternalRecord(t,e)}},r=0;r<10;r++)t(r);e.consume=function(e,t,r){return this.consumeInternalRecord(t,e,r)},e.subrule=function(e,t,r){return this.subruleInternalRecord(t,e,r)},e.option=function(e,t){return this.optionInternalRecord(t,e)},e.or=function(e,t){return this.orInternalRecord(t,e)},e.many=function(e,t){this.manyInternalRecord(e,t)},e.atLeastOne=function(e,t){this.atLeastOneInternalRecord(e,t)},e.ACTION=e.ACTION_RECORD,e.BACKTRACK=e.BACKTRACK_RECORD,e.LA=e.LA_RECORD}))},e.prototype.disableRecording=function(){var e=this;this.RECORDING_PHASE=!1,this.TRACE_INIT("Deleting Recording methods",(function(){for(var t=0;t<10;t++){var r=t>0?t:"";delete e["CONSUME"+r],delete e["SUBRULE"+r],delete e["OPTION"+r],delete e["OR"+r],delete e["MANY"+r],delete e["MANY_SEP"+r],delete e["AT_LEAST_ONE"+r],delete e["AT_LEAST_ONE_SEP"+r]}delete e.consume,delete e.subrule,delete e.option,delete e.or,delete e.many,delete e.atLeastOne,delete e.ACTION,delete e.BACKTRACK,delete e.LA}))},e.prototype.ACTION_RECORD=function(e){},e.prototype.BACKTRACK_RECORD=function(e,t){return function(){return!0}},e.prototype.LA_RECORD=function(e){return u.END_OF_FILE},e.prototype.topLevelRuleRecord=function(e,t){try{var r=new o.Rule({definition:[],name:e});return r.name=e,this.recordingProdStack.push(r),t.call(this),this.recordingProdStack.pop(),r}catch(e){if(!0!==e.KNOWN_RECORDER_ERROR)try{e.message=e.message+'\n\t This error was thrown during the "grammar recording phase" For more info see:\n\thttps://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording'}catch(t){throw e}throw e}},e.prototype.optionInternalRecord=function(e,t){return f.call(this,o.Option,e,t)},e.prototype.atLeastOneInternalRecord=function(e,t){f.call(this,o.RepetitionMandatory,t,e)},e.prototype.atLeastOneSepFirstInternalRecord=function(e,t){f.call(this,o.RepetitionMandatoryWithSeparator,t,e,!0)},e.prototype.manyInternalRecord=function(e,t){f.call(this,o.Repetition,t,e)},e.prototype.manySepFirstInternalRecord=function(e,t){f.call(this,o.RepetitionWithSeparator,t,e,!0)},e.prototype.orInternalRecord=function(e,t){return E.call(this,e,t)},e.prototype.subruleInternalRecord=function(e,t,r){if(y(t),!e||!1===Object(n.has)(e,"ruleName")){var s=new Error("<SUBRULE"+T(t)+"> argument is invalid expecting a Parser method reference but got: <"+JSON.stringify(e)+">\n inside top level rule: <"+this.recordingProdStack[0].name+">");throw s.KNOWN_RECORDER_ERROR=!0,s}var i=Object(n.peek)(this.recordingProdStack),a=e.ruleName,u=new o.NonTerminal({idx:t,nonTerminalName:a,referencedRule:void 0});return i.definition.push(u),this.outputCst?m:l},e.prototype.consumeInternalRecord=function(e,t,r){if(y(t),!Object(i.hasShortKeyProperty)(e)){var s=new Error("<CONSUME"+T(t)+"> argument is invalid expecting a TokenType reference but got: <"+JSON.stringify(e)+">\n inside top level rule: <"+this.recordingProdStack[0].name+">");throw s.KNOWN_RECORDER_ERROR=!0,s}var a=Object(n.peek)(this.recordingProdStack),u=new o.Terminal({idx:t,terminalType:e});return a.definition.push(u),p},e}();function f(e,t,r,o){void 0===o&&(o=!1),y(r);var s=Object(n.peek)(this.recordingProdStack),i=Object(n.isFunction)(t)?t:t.DEF,a=new e({definition:[],idx:r});return Object(n.has)(t,"NAME")&&(a.name=t.NAME),o&&(a.separator=t.SEP),Object(n.has)(t,"MAX_LOOKAHEAD")&&(a.maxLookahead=t.MAX_LOOKAHEAD),this.recordingProdStack.push(a),i.call(this),s.definition.push(a),this.recordingProdStack.pop(),l}function E(e,t){var r=this;y(t);var s=Object(n.peek)(this.recordingProdStack),i=!1===Object(n.isArray)(e),a=!1===i?e:e.DEF,u=new o.Alternation({definition:[],idx:t,ignoreAmbiguities:i&&!0===e.IGNORE_AMBIGUITIES});Object(n.has)(e,"NAME")&&(u.name=e.NAME),Object(n.has)(e,"MAX_LOOKAHEAD")&&(u.maxLookahead=e.MAX_LOOKAHEAD);var c=Object(n.some)(a,(function(e){return Object(n.isFunction)(e.GATE)}));return u.hasPredicates=c,s.definition.push(u),Object(n.forEach)(a,(function(e){var t=new o.Flat({definition:[]});u.definition.push(t),Object(n.has)(e,"NAME")&&(t.name=e.NAME),Object(n.has)(e,"IGNORE_AMBIGUITIES")?t.ignoreAmbiguities=e.IGNORE_AMBIGUITIES:Object(n.has)(e,"GATE")&&(t.ignoreAmbiguities=!0),r.recordingProdStack.push(t),e.ALT.call(r),r.recordingProdStack.pop()})),l}function T(e){return 0===e?"":""+e}function y(e){if(e<0||e>h){var t=new Error("Invalid DSL Method idx value: <"+e+">\n\tIdx value must be a none negative value smaller than "+(h+1));throw t.KNOWN_RECORDER_ERROR=!0,t}}},function(e,t,r){"use strict";r.r(t),r.d(t,"PerformanceTracer",(function(){return s}));var n=r(87),o=r(86),s=function(){function e(){}return e.prototype.initPerformanceTracer=function(e){if(Object(n.has)(e,"traceInitPerf")){var t=e.traceInitPerf,r="number"==typeof t;this.traceInitMaxIdent=r?t:1/0,this.traceInitPerf=r?t>0:t}else this.traceInitMaxIdent=0,this.traceInitPerf=o.DEFAULT_PARSER_CONFIG.traceInitPerf;this.traceInitIndent=-1},e.prototype.TRACE_INIT=function(e,t){if(!0===this.traceInitPerf){this.traceInitIndent++;var r=new Array(this.traceInitIndent+1).join("\t");this.traceInitIndent<this.traceInitMaxIdent&&console.log(r+"--\x3e <"+e+">");var o=Object(n.timer)(t),s=o.time,i=o.value,a=s>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&a(r+"<-- <"+e+"> time: "+s+"ms"),this.traceInitIndent--,i}return t()},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"createSyntaxDiagramsCode",(function(){return o}));var n=r(85);function o(e,t){var r=void 0===t?{}:t,o=r.resourceBase,s=void 0===o?"https://unpkg.com/chevrotain@"+n.VERSION+"/diagrams/":o,i=r.css;return"\n\x3c!-- This is a generated file --\x3e\n<!DOCTYPE html>\n<meta charset=\"utf-8\">\n<style>\n  body {\n    background-color: hsl(30, 20%, 95%)\n  }\n</style>\n\n\n<link rel='stylesheet' href='"+(void 0===i?"https://unpkg.com/chevrotain@"+n.VERSION+"/diagrams/diagrams.css":i)+"'>\n\n<script src='"+s+"vendor/railroad-diagrams.js'><\/script>\n<script src='"+s+"src/diagrams_builder.js'><\/script>\n<script src='"+s+"src/diagrams_behavior.js'><\/script>\n<script src='"+s+'src/main.js\'><\/script>\n\n<div id="diagrams" align="center"></div>    \n\n<script>\n    window.serializedGrammar = '+JSON.stringify(e,null,"  ")+';\n<\/script>\n\n<script>\n    var diagramsDiv = document.getElementById("diagrams");\n    main.drawDiagramsFromSerializedGrammar(serializedGrammar, diagramsDiv);\n<\/script>\n'}},function(e,t,r){"use strict";r.r(t),r.d(t,"generateParserFactory",(function(){return o})),r.d(t,"generateParserModule",(function(){return s}));var n=r(126);function o(e){var t=Object(n.genWrapperFunction)({name:e.name,rules:e.rules}),o=new Function("tokenVocabulary","config","chevrotain",t);return function(t){return o(e.tokenVocabulary,t,r(84))}}function s(e){return Object(n.genUmdModule)({name:e.name,rules:e.rules})}},function(e,t,r){"use strict";r.r(t),r.d(t,"genUmdModule",(function(){return i})),r.d(t,"genWrapperFunction",(function(){return a})),r.d(t,"genClass",(function(){return u})),r.d(t,"genAllRules",(function(){return c})),r.d(t,"genRule",(function(){return l})),r.d(t,"genTerminal",(function(){return h})),r.d(t,"genNonTerminal",(function(){return d})),r.d(t,"genAlternation",(function(){return p})),r.d(t,"genSingleAlt",(function(){return m}));var n=r(87),o=r(90),s="\n";function i(e){return"\n(function (root, factory) {\n    if (typeof define === 'function' && define.amd) {\n        // AMD. Register as an anonymous module.\n        define(['chevrotain'], factory);\n    } else if (typeof module === 'object' && module.exports) {\n        // Node. Does not work with strict CommonJS, but\n        // only CommonJS-like environments that support module.exports,\n        // like Node.\n        module.exports = factory(require('chevrotain'));\n    } else {\n        // Browser globals (root is window)\n        root.returnExports = factory(root.b);\n    }\n}(typeof self !== 'undefined' ? self : this, function (chevrotain) {\n\n"+u(e)+"\n    \nreturn {\n    "+e.name+": "+e.name+" \n}\n}));\n"}function a(e){return"    \n"+u(e)+"\nreturn new "+e.name+"(tokenVocabulary, config)    \n"}function u(e){return"\nfunction "+e.name+"(tokenVocabulary, config) {\n    // invoke super constructor\n    // No support for embedded actions currently, so we can 'hardcode'\n    // The use of CstParser.\n    chevrotain.CstParser.call(this, tokenVocabulary, config)\n\n    const $ = this\n\n    "+c(e.rules)+"\n\n    // very important to call this after all the rules have been defined.\n    // otherwise the parser may not work correctly as it will lack information\n    // derived during the self analysis phase.\n    this.performSelfAnalysis(this)\n}\n\n// inheritance as implemented in javascript in the previous decade... :(\n"+e.name+".prototype = Object.create(chevrotain.CstParser.prototype)\n"+e.name+".prototype.constructor = "+e.name+"    \n    "}function c(e){return Object(n.map)(e,(function(e){return l(e,1)})).join("\n")}function l(e,t){var r=T(t,'$.RULE("'+e.name+'", function() {')+s;return r+=E(e.definition,t+1),r+=T(t+1,"})")+s}function h(e,t){var r=e.terminalType.name;return T(t,"$.CONSUME"+e.idx+"(this.tokensMap."+r+")"+s)}function d(e,t){return T(t,"$.SUBRULE"+e.idx+"($."+e.nonTerminalName+")"+s)}function p(e,t){var r=T(t,"$.OR"+e.idx+"([")+s;return r+=Object(n.map)(e.definition,(function(e){return m(e,t+1)})).join(",\n"),r+=s+T(t,"])\n")}function m(e,t){var r=T(t,"{")+s;return e.name&&(r+=T(t+1,'NAME: "'+e.name+'",')+s),r+=T(t+1,"ALT: function() {")+s,r+=E(e.definition,t+1),r+=T(t+1,"}")+s,r+=T(t,"}")}function g(e,t,r){var n=T(r,"$."+(e+t.idx)+"(");return t.name||t.separator?(n+="{\n",t.name&&(n+=T(r+1,'NAME: "'+t.name+'"')+","+s),t.separator&&(n+=T(r+1,"SEP: this.tokensMap."+t.separator.name)+","+s),n+="DEF: "+f(t.definition,r+2)+s,n+=T(r,"}")+s):n+=f(t.definition,r+1),n+=T(r,")")+s}function f(e,t){var r="function() {\n";return r+=E(e,t),r+=T(t,"}")+s}function E(e,t){var r="";return Object(n.forEach)(e,(function(e){r+=function(e,t){if(e instanceof o.NonTerminal)return d(e,t);if(e instanceof o.Option)return g("OPTION",e,t);if(e instanceof o.RepetitionMandatory)return g("AT_LEAST_ONE",e,t);if(e instanceof o.RepetitionMandatoryWithSeparator)return g("AT_LEAST_ONE_SEP",e,t);if(e instanceof o.RepetitionWithSeparator)return g("MANY_SEP",e,t);if(e instanceof o.Repetition)return g("MANY",e,t);if(e instanceof o.Alternation)return p(e,t);if(e instanceof o.Terminal)return h(e,t);if(e instanceof o.Flat)return E(e.definition,t);throw Error("non exhaustive match")}(e,t+1)})),r}function T(e,t){return Array(4*e+1).join(" ")+t}},function(e,t,r){"use strict";t.__esModule=!0,t.buildTimesOpAst=t.buildStringAst=t.buildRowRangeAst=t.buildProcedureAst=t.buildPowerOpAst=t.buildPlusUnaryOpAst=t.buildPlusOpAst=t.buildPercentOpAst=t.buildParsingErrorAst=t.buildParenthesisAst=t.buildNumberAst=t.buildNotEqualOpAst=t.buildNamedExpressionAst=t.buildMinusUnaryOpAst=t.buildMinusOpAst=t.buildLessThanOrEqualOpAst=t.buildLessThanOpAst=t.buildGreaterThanOrEqualOpAst=t.buildGreaterThanOpAst=t.buildErrorWithRawInputAst=t.buildEqualsOpAst=t.buildEmptyArgAst=t.buildDivOpAst=t.buildConcatenateOpAst=t.buildColumnRangeAst=t.buildCellReferenceAst=t.buildCellRangeAst=t.buildCellErrorAst=t.buildArrayAst=t.RangeSheetReferenceType=t.ParsingErrorType=t.AstNodeType=void 0,t.imageWithWhitespace=function(e,t){return(null!=t?t:"")+e},t.parsingError=void 0;var n,o,s,i=r(73);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */function a(e,t,r){if(void 0!==e.sheet&&void 0===t.sheet||void 0===e.sheet&&void 0!==t.sheet)throw new Error("Start address inconsistent with end address");if(void 0===e.sheet&&r!==s.RELATIVE||void 0!==e.sheet&&r===s.RELATIVE)throw new Error("Sheet address inconsistent with sheet reference type")}t.parsingError=(e,t)=>({type:e,message:t}),function(e){e.LexingError="LexingError",e.ParserError="ParsingError",e.StaticOffsetError="StaticOffsetError",e.StaticOffsetOutOfRangeError="StaticOffsetOutOfRangeError",e.RangeOffsetNotAllowed="RangeOffsetNotAllowed",e.InvalidRangeSize="InvalidRangeSize"}(n||(t.ParsingErrorType=n={})),function(e){e.EMPTY="EMPTY",e.NUMBER="NUMBER",e.STRING="STRING",e.MINUS_UNARY_OP="MINUS_UNARY_OP",e.PLUS_UNARY_OP="PLUS_UNARY_OP",e.PERCENT_OP="PERCENT_OP",e.CONCATENATE_OP="CONCATENATE_OP",e.EQUALS_OP="EQUALS_OP",e.NOT_EQUAL_OP="NOT_EQUAL_OP",e.GREATER_THAN_OP="GREATER_THAN_OP",e.LESS_THAN_OP="LESS_THAN_OP",e.GREATER_THAN_OR_EQUAL_OP="GREATER_THAN_OR_EQUAL_OP",e.LESS_THAN_OR_EQUAL_OP="LESS_THAN_OR_EQUAL_OP",e.PLUS_OP="PLUS_OP",e.MINUS_OP="MINUS_OP",e.TIMES_OP="TIMES_OP",e.DIV_OP="DIV_OP",e.POWER_OP="POWER_OP",e.FUNCTION_CALL="FUNCTION_CALL",e.NAMED_EXPRESSION="NAMED_EXPRESSION",e.PARENTHESIS="PARENTHESES",e.CELL_REFERENCE="CELL_REFERENCE",e.CELL_RANGE="CELL_RANGE",e.COLUMN_RANGE="COLUMN_RANGE",e.ROW_RANGE="ROW_RANGE",e.ERROR="ERROR",e.ERROR_WITH_RAW_INPUT="ERROR_WITH_RAW_INPUT",e.ARRAY="ARRAY"}(o||(t.AstNodeType=o={})),function(e){e[e.RELATIVE=0]="RELATIVE",e[e.START_ABSOLUTE=1]="START_ABSOLUTE",e[e.BOTH_ABSOLUTE=2]="BOTH_ABSOLUTE"}(s||(t.RangeSheetReferenceType=s={})),t.buildEmptyArgAst=e=>({type:o.EMPTY,leadingWhitespace:null==e?void 0:e.image}),t.buildNumberAst=(e,t)=>({type:o.NUMBER,value:e,leadingWhitespace:null==t?void 0:t.image}),t.buildStringAst=e=>{var t;return{type:o.STRING,value:e.image.slice(1,-1),leadingWhitespace:null===(t=e.leadingWhitespace)||void 0===t?void 0:t.image}},t.buildCellReferenceAst=(e,t)=>({type:o.CELL_REFERENCE,reference:e,leadingWhitespace:null==t?void 0:t.image}),t.buildCellRangeAst=(e,t,r,n)=>(a(e,t,r),{type:o.CELL_RANGE,start:e,end:t,sheetReferenceType:r,leadingWhitespace:n}),t.buildColumnRangeAst=(e,t,r,n)=>(a(e,t,r),{type:o.COLUMN_RANGE,start:e,end:t,sheetReferenceType:r,leadingWhitespace:null==n?void 0:n.image}),t.buildRowRangeAst=(e,t,r,n)=>(a(e,t,r),{type:o.ROW_RANGE,start:e,end:t,sheetReferenceType:r,leadingWhitespace:null==n?void 0:n.image}),t.buildConcatenateOpAst=(e,t,r)=>({type:o.CONCATENATE_OP,left:e,right:t,leadingWhitespace:null==r?void 0:r.image}),t.buildEqualsOpAst=(e,t,r)=>({type:o.EQUALS_OP,left:e,right:t,leadingWhitespace:null==r?void 0:r.image}),t.buildNotEqualOpAst=(e,t,r)=>({type:o.NOT_EQUAL_OP,left:e,right:t,leadingWhitespace:null==r?void 0:r.image}),t.buildGreaterThanOpAst=(e,t,r)=>({type:o.GREATER_THAN_OP,left:e,right:t,leadingWhitespace:null==r?void 0:r.image}),t.buildLessThanOpAst=(e,t,r)=>({type:o.LESS_THAN_OP,left:e,right:t,leadingWhitespace:null==r?void 0:r.image}),t.buildGreaterThanOrEqualOpAst=(e,t,r)=>({type:o.GREATER_THAN_OR_EQUAL_OP,left:e,right:t,leadingWhitespace:null==r?void 0:r.image}),t.buildLessThanOrEqualOpAst=(e,t,r)=>({type:o.LESS_THAN_OR_EQUAL_OP,left:e,right:t,leadingWhitespace:null==r?void 0:r.image}),t.buildPlusOpAst=(e,t,r)=>({type:o.PLUS_OP,left:e,right:t,leadingWhitespace:null==r?void 0:r.image}),t.buildMinusOpAst=(e,t,r)=>({type:o.MINUS_OP,left:e,right:t,leadingWhitespace:null==r?void 0:r.image}),t.buildTimesOpAst=(e,t,r)=>({type:o.TIMES_OP,left:e,right:t,leadingWhitespace:null==r?void 0:r.image}),t.buildDivOpAst=(e,t,r)=>({type:o.DIV_OP,left:e,right:t,leadingWhitespace:null==r?void 0:r.image}),t.buildPowerOpAst=(e,t,r)=>({type:o.POWER_OP,left:e,right:t,leadingWhitespace:null==r?void 0:r.image}),t.buildMinusUnaryOpAst=(e,t)=>({type:o.MINUS_UNARY_OP,value:e,leadingWhitespace:null==t?void 0:t.image}),t.buildPlusUnaryOpAst=(e,t)=>({type:o.PLUS_UNARY_OP,value:e,leadingWhitespace:null==t?void 0:t.image}),t.buildPercentOpAst=(e,t)=>({type:o.PERCENT_OP,value:e,leadingWhitespace:null==t?void 0:t.image}),t.buildProcedureAst=(e,t,r,n,s)=>({type:o.FUNCTION_CALL,procedureName:e,args:t,leadingWhitespace:null==r?void 0:r.image,internalWhitespace:null==n?void 0:n.image,hyperlink:s}),t.buildArrayAst=(e,t,r)=>({type:o.ARRAY,args:e,leadingWhitespace:null==t?void 0:t.image,internalWhitespace:null==r?void 0:r.image}),t.buildNamedExpressionAst=(e,t)=>({type:o.NAMED_EXPRESSION,expressionName:e,leadingWhitespace:null==t?void 0:t.image}),t.buildParenthesisAst=(e,t,r)=>({type:o.PARENTHESIS,expression:e,leadingWhitespace:null==t?void 0:t.image,internalWhitespace:null==r?void 0:r.image}),t.buildCellErrorAst=(e,t)=>({type:o.ERROR,error:e,leadingWhitespace:null==t?void 0:t.image}),t.buildErrorWithRawInputAst=(e,t,r)=>({type:o.ERROR_WITH_RAW_INPUT,error:t,rawInput:e,leadingWhitespace:null==r?void 0:r.image}),t.buildParsingErrorAst=()=>({type:o.ERROR,error:i.CellError.parsingError()})},function(e,t,r){"use strict";t.__esModule=!0,t.binaryOpTokenMap=void 0;var n=r(127);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */t.binaryOpTokenMap={[n.AstNodeType.PLUS_OP]:"+",[n.AstNodeType.MINUS_OP]:"-",[n.AstNodeType.TIMES_OP]:"*",[n.AstNodeType.DIV_OP]:"/",[n.AstNodeType.CONCATENATE_OP]:"&",[n.AstNodeType.POWER_OP]:"^",[n.AstNodeType.EQUALS_OP]:"=",[n.AstNodeType.NOT_EQUAL_OP]:"<>",[n.AstNodeType.GREATER_THAN_OP]:">",[n.AstNodeType.GREATER_THAN_OR_EQUAL_OP]:">=",[n.AstNodeType.LESS_THAN_OP]:"<",[n.AstNodeType.LESS_THAN_OR_EQUAL_OP]:"<="}},function(e,t,r){"use strict";t.__esModule=!0,t.doesContainFunctions=t.Cache=void 0;var n=r(77);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */t.Cache=class{constructor(e){this.functionRegistry=e,this.cache=new Map}set(e,t){const r=((e,t,r,n)=>({ast:e,relativeDependencies:t,hasVolatileFunction:r,hasStructuralChangeFunction:n}))(t,(0,n.collectDependencies)(t,this.functionRegistry),o(t,this.functionRegistry.isFunctionVolatile),o(t,this.functionRegistry.isFunctionDependentOnSheetStructureChange));return this.cache.set(e,r),r}get(e){return this.cache.get(e)}maybeSetAndThenGet(e,t){const r=this.cache.get(e);return void 0!==r?r.ast:(this.set(e,t),t)}};const o=(e,t)=>{switch(e.type){case n.AstNodeType.EMPTY:case n.AstNodeType.NUMBER:case n.AstNodeType.STRING:case n.AstNodeType.ERROR:case n.AstNodeType.ERROR_WITH_RAW_INPUT:case n.AstNodeType.CELL_REFERENCE:case n.AstNodeType.CELL_RANGE:case n.AstNodeType.COLUMN_RANGE:case n.AstNodeType.ROW_RANGE:case n.AstNodeType.NAMED_EXPRESSION:return!1;case n.AstNodeType.PERCENT_OP:case n.AstNodeType.PLUS_UNARY_OP:case n.AstNodeType.MINUS_UNARY_OP:return o(e.value,t);case n.AstNodeType.CONCATENATE_OP:case n.AstNodeType.EQUALS_OP:case n.AstNodeType.NOT_EQUAL_OP:case n.AstNodeType.LESS_THAN_OP:case n.AstNodeType.GREATER_THAN_OP:case n.AstNodeType.LESS_THAN_OR_EQUAL_OP:case n.AstNodeType.GREATER_THAN_OR_EQUAL_OP:case n.AstNodeType.MINUS_OP:case n.AstNodeType.PLUS_OP:case n.AstNodeType.TIMES_OP:case n.AstNodeType.DIV_OP:case n.AstNodeType.POWER_OP:return o(e.left,t)||o(e.right,t);case n.AstNodeType.PARENTHESIS:return o(e.expression,t);case n.AstNodeType.FUNCTION_CALL:return!!t(e.procedureName)||e.args.some(e=>o(e,t));case n.AstNodeType.ARRAY:return e.args.some(e=>e.some(e=>o(e,t)))}};t.doesContainFunctions=o},function(e,t,r){"use strict";t.__esModule=!0,t.FormulaParser=t.FormulaLexer=void 0,r(2);var n=r(84),o=r(73),s=r(131),i=r(78),a=r(127),u=r(79),c=r(132);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
class l extends n.EmbeddedActionsParser{constructor(e,t){super(e.allTokens,{outputCst:!1,maxLookahead:7}),this.booleanExpressionOrEmpty=this.RULE("booleanExpressionOrEmpty",()=>this.OR([{ALT:()=>this.SUBRULE(this.booleanExpression)},{ALT:(0,n.EMPTY_ALT)((0,a.buildEmptyArgAst)())}])),this.procedureExpression=this.RULE("procedureExpression",()=>{var e;const t=this.CONSUME(c.ProcedureName),r=t.image.toUpperCase().slice(0,-1),n=null!==(e=this.lexerConfig.functionMapping[r])&&void 0!==e?e:r,o=[];let s=this.SUBRULE(this.booleanExpressionOrEmpty);this.MANY(()=>{var e;const t=this.CONSUME(this.lexerConfig.ArgSeparator);s.type===a.AstNodeType.EMPTY&&(s.leadingWhitespace=null===(e=t.leadingWhitespace)||void 0===e?void 0:e.image),o.push(s),s=this.SUBRULE2(this.booleanExpressionOrEmpty)}),o.push(s),1===o.length&&o[0].type===a.AstNodeType.EMPTY&&(o.length=0);const i=this.CONSUME(c.RParen);return(0,a.buildProcedureAst)(n,o,t.leadingWhitespace,i.leadingWhitespace)}),this.namedExpressionExpression=this.RULE("namedExpressionExpression",()=>{const e=this.CONSUME(c.NamedExpression);return(0,a.buildNamedExpressionAst)(e.image,e.leadingWhitespace)}),this.offsetProcedureExpression=this.RULE("offsetProcedureExpression",()=>{const e=[];return this.CONSUME(this.lexerConfig.OffsetProcedureName),this.CONSUME(c.LParen),this.MANY_SEP({SEP:this.lexerConfig.ArgSeparator,DEF:()=>{e.push(this.SUBRULE(this.booleanExpression))}}),this.CONSUME(c.RParen),this.handleOffsetHeuristic(e)}),this.columnRangeExpression=this.RULE("columnRangeExpression",()=>{const e=this.CONSUME(c.ColumnRange),[t,r]=e.image.split(":"),n=this.ACTION(()=>(0,i.columnAddressFromString)(this.sheetMapping,t,this.formulaAddress)),s=this.ACTION(()=>(0,i.columnAddressFromString)(this.sheetMapping,r,this.formulaAddress));if(void 0===n||void 0===s)return(0,a.buildCellErrorAst)(new o.CellError(o.ErrorType.REF));if(n.exceedsSheetSizeLimits(this.lexerConfig.maxColumns)||s.exceedsSheetSizeLimits(this.lexerConfig.maxColumns))return(0,a.buildErrorWithRawInputAst)(e.image,new o.CellError(o.ErrorType.NAME),e.leadingWhitespace);if(void 0===n.sheet&&void 0!==s.sheet)return this.parsingError(a.ParsingErrorType.ParserError,"Malformed range expression");const{firstEnd:u,secondEnd:h,sheetRefType:d}=l.fixSheetIdsForRangeEnds(n,s);return(0,a.buildColumnRangeAst)(u,h,d,e.leadingWhitespace)}),this.rowRangeExpression=this.RULE("rowRangeExpression",()=>{const e=this.CONSUME(c.RowRange),[t,r]=e.image.split(":"),n=this.ACTION(()=>(0,i.rowAddressFromString)(this.sheetMapping,t,this.formulaAddress)),s=this.ACTION(()=>(0,i.rowAddressFromString)(this.sheetMapping,r,this.formulaAddress));if(void 0===n||void 0===s)return(0,a.buildCellErrorAst)(new o.CellError(o.ErrorType.REF));if(n.exceedsSheetSizeLimits(this.lexerConfig.maxRows)||s.exceedsSheetSizeLimits(this.lexerConfig.maxRows))return(0,a.buildErrorWithRawInputAst)(e.image,new o.CellError(o.ErrorType.NAME),e.leadingWhitespace);if(void 0===n.sheet&&void 0!==s.sheet)return this.parsingError(a.ParsingErrorType.ParserError,"Malformed range expression");const{firstEnd:u,secondEnd:h,sheetRefType:d}=l.fixSheetIdsForRangeEnds(n,s);return(0,a.buildRowRangeAst)(u,h,d,e.leadingWhitespace)}),this.cellReference=this.RULE("cellReference",()=>{const e=this.CONSUME(c.CellReference),t=this.ACTION(()=>(0,i.cellAddressFromString)(this.sheetMapping,e.image,this.formulaAddress));return void 0===t?(0,a.buildErrorWithRawInputAst)(e.image,new o.CellError(o.ErrorType.REF),e.leadingWhitespace):t.exceedsSheetSizeLimits(this.lexerConfig.maxColumns,this.lexerConfig.maxRows)?(0,a.buildErrorWithRawInputAst)(e.image,new o.CellError(o.ErrorType.NAME),e.leadingWhitespace):(0,a.buildCellReferenceAst)(t,e.leadingWhitespace)}),this.endRangeReference=this.RULE("endRangeReference",e=>{var t;const r=this.CONSUME(c.CellReference),n=this.ACTION(()=>(0,i.cellAddressFromString)(this.sheetMapping,e.image,this.formulaAddress)),s=this.ACTION(()=>(0,i.cellAddressFromString)(this.sheetMapping,r.image,this.formulaAddress));return void 0===n||void 0===s?this.ACTION(()=>(0,a.buildErrorWithRawInputAst)(`${e.image}:${r.image}`,new o.CellError(o.ErrorType.REF),e.leadingWhitespace)):n.exceedsSheetSizeLimits(this.lexerConfig.maxColumns,this.lexerConfig.maxRows)||s.exceedsSheetSizeLimits(this.lexerConfig.maxColumns,this.lexerConfig.maxRows)?this.ACTION(()=>(0,a.buildErrorWithRawInputAst)(`${e.image}:${r.image}`,new o.CellError(o.ErrorType.NAME),e.leadingWhitespace)):this.buildCellRange(n,s,null===(t=e.leadingWhitespace)||void 0===t?void 0:t.image)}),this.endOfRangeExpression=this.RULE("endOfRangeExpression",e=>this.OR([{ALT:()=>this.SUBRULE(this.endRangeReference,{ARGS:[e]})},{ALT:()=>{var t;const r=this.SUBRULE(this.offsetProcedureExpression),n=this.ACTION(()=>(0,i.cellAddressFromString)(this.sheetMapping,e.image,this.formulaAddress));return void 0===n?(0,a.buildCellErrorAst)(new o.CellError(o.ErrorType.REF)):r.type===a.AstNodeType.CELL_REFERENCE?this.buildCellRange(n,r.reference,null===(t=e.leadingWhitespace)||void 0===t?void 0:t.image):this.parsingError(a.ParsingErrorType.RangeOffsetNotAllowed,"Range offset not allowed here")}}])),this.cellRangeExpression=this.RULE("cellRangeExpression",()=>{const e=this.CONSUME(c.CellReference);return this.CONSUME2(c.RangeSeparator),this.SUBRULE(this.endOfRangeExpression,{ARGS:[e]})}),this.endRangeWithOffsetStartReference=this.RULE("endRangeWithOffsetStartReference",e=>{const t=this.CONSUME(c.CellReference),r=this.ACTION(()=>(0,i.cellAddressFromString)(this.sheetMapping,t.image,this.formulaAddress));return void 0===r?this.ACTION(()=>(0,a.buildCellErrorAst)(new o.CellError(o.ErrorType.REF))):this.buildCellRange(e.reference,r,e.leadingWhitespace)}),this.endOfRangeWithOffsetStartExpression=this.RULE("endOfRangeWithOffsetStartExpression",e=>this.OR([{ALT:()=>this.SUBRULE(this.endRangeWithOffsetStartReference,{ARGS:[e]})},{ALT:()=>{const t=this.SUBRULE(this.offsetProcedureExpression);return t.type===a.AstNodeType.CELL_REFERENCE?this.buildCellRange(e.reference,t.reference,e.leadingWhitespace):this.parsingError(a.ParsingErrorType.RangeOffsetNotAllowed,"Range offset not allowed here")}}])),this.offsetExpression=this.RULE("offsetExpression",()=>{const e=this.SUBRULE(this.offsetProcedureExpression);let t;return this.OPTION(()=>{this.CONSUME(c.RangeSeparator),t=e.type===a.AstNodeType.CELL_RANGE?this.parsingError(a.ParsingErrorType.RangeOffsetNotAllowed,"Range offset not allowed here"):this.SUBRULE(this.endOfRangeWithOffsetStartExpression,{ARGS:[e]})}),void 0!==t?t:e}),this.insideArrayExpression=this.RULE("insideArrayExpression",()=>{const e=[[]];return e[e.length-1].push(this.SUBRULE(this.booleanExpression)),this.MANY(()=>{this.OR([{ALT:()=>{this.CONSUME(this.lexerConfig.ArrayColSeparator),e[e.length-1].push(this.SUBRULE2(this.booleanExpression))}},{ALT:()=>{this.CONSUME(this.lexerConfig.ArrayRowSeparator),e.push([]),e[e.length-1].push(this.SUBRULE3(this.booleanExpression))}}])}),(0,a.buildArrayAst)(e)}),this.parenthesisExpression=this.RULE("parenthesisExpression",()=>{const e=this.CONSUME(c.LParen),t=this.SUBRULE(this.booleanExpression),r=this.CONSUME(c.RParen);return(0,a.buildParenthesisAst)(t,e.leadingWhitespace,r.leadingWhitespace)}),this.arrayExpression=this.RULE("arrayExpression",()=>this.OR([{ALT:()=>{const e=this.CONSUME(c.ArrayLParen),t=this.SUBRULE(this.insideArrayExpression),r=this.CONSUME(c.ArrayRParen);return(0,a.buildArrayAst)(t.args,e.leadingWhitespace,r.leadingWhitespace)}},{ALT:()=>this.SUBRULE(this.parenthesisExpression)}])),this.numericStringToNumber=e=>{const t=e.replace(this.lexerConfig.decimalSeparator,".");return Number(t)},this.positiveAtomicExpression=this.RULE("positiveAtomicExpression",()=>{var e;return this.OR(null!==(e=this.atomicExpCache)&&void 0!==e?e:this.atomicExpCache=[{ALT:()=>this.SUBRULE(this.arrayExpression)},{ALT:()=>this.SUBRULE(this.cellRangeExpression)},{ALT:()=>this.SUBRULE(this.columnRangeExpression)},{ALT:()=>this.SUBRULE(this.rowRangeExpression)},{ALT:()=>this.SUBRULE(this.offsetExpression)},{ALT:()=>this.SUBRULE(this.cellReference)},{ALT:()=>this.SUBRULE(this.procedureExpression)},{ALT:()=>this.SUBRULE(this.namedExpressionExpression)},{ALT:()=>{const e=this.CONSUME(this.lexerConfig.NumberLiteral);return(0,a.buildNumberAst)(this.numericStringToNumber(e.image),e.leadingWhitespace)}},{ALT:()=>{const e=this.CONSUME(c.StringLiteral);return(0,a.buildStringAst)(e)}},{ALT:()=>{const e=this.CONSUME(c.ErrorLiteral),t=e.image.toUpperCase(),r=this.lexerConfig.errorMapping[t];return r?(0,a.buildCellErrorAst)(new o.CellError(r),e.leadingWhitespace):this.parsingError(a.ParsingErrorType.ParserError,"Unknown error literal")}}])}),this.rightUnaryOpAtomicExpression=this.RULE("rightUnaryOpAtomicExpression",()=>{const e=this.SUBRULE(this.positiveAtomicExpression),t=this.OPTION(()=>this.CONSUME(c.PercentOp));return t?(0,a.buildPercentOpAst)(e,t.leadingWhitespace):e}),this.atomicExpression=this.RULE("atomicExpression",()=>this.OR([{ALT:()=>{const e=this.CONSUME(c.AdditionOp),t=this.SUBRULE(this.atomicExpression);return(0,n.tokenMatcher)(e,c.PlusOp)?(0,a.buildPlusUnaryOpAst)(t,e.leadingWhitespace):(0,n.tokenMatcher)(e,c.MinusOp)?(0,a.buildMinusUnaryOpAst)(t,e.leadingWhitespace):(this.customParsingError=(0,a.parsingError)(a.ParsingErrorType.ParserError,"Mismatched token type"),this.customParsingError)}},{ALT:()=>this.SUBRULE2(this.rightUnaryOpAtomicExpression)}])),this.powerExpression=this.RULE("powerExpression",()=>{let e=this.SUBRULE(this.atomicExpression);return this.MANY(()=>{const t=this.CONSUME(c.PowerOp),r=this.SUBRULE2(this.atomicExpression);(0,n.tokenMatcher)(t,c.PowerOp)?e=(0,a.buildPowerOpAst)(e,r,t.leadingWhitespace):this.ACTION(()=>{throw Error("Operator not supported")})}),e}),this.multiplicationExpression=this.RULE("multiplicationExpression",()=>{let e=this.SUBRULE(this.powerExpression);return this.MANY(()=>{const t=this.CONSUME(c.MultiplicationOp),r=this.SUBRULE2(this.powerExpression);(0,n.tokenMatcher)(t,c.TimesOp)?e=(0,a.buildTimesOpAst)(e,r,t.leadingWhitespace):(0,n.tokenMatcher)(t,c.DivOp)?e=(0,a.buildDivOpAst)(e,r,t.leadingWhitespace):this.ACTION(()=>{throw Error("Operator not supported")})}),e}),this.additionExpression=this.RULE("additionExpression",()=>{let e=this.SUBRULE(this.multiplicationExpression);return this.MANY(()=>{const t=this.CONSUME(c.AdditionOp),r=this.SUBRULE2(this.multiplicationExpression);(0,n.tokenMatcher)(t,c.PlusOp)?e=(0,a.buildPlusOpAst)(e,r,t.leadingWhitespace):(0,n.tokenMatcher)(t,c.MinusOp)?e=(0,a.buildMinusOpAst)(e,r,t.leadingWhitespace):this.ACTION(()=>{throw Error("Operator not supported")})}),e}),this.concatenateExpression=this.RULE("concatenateExpression",()=>{let e=this.SUBRULE(this.additionExpression);return this.MANY(()=>{const t=this.CONSUME(c.ConcatenateOp),r=this.SUBRULE2(this.additionExpression);e=(0,a.buildConcatenateOpAst)(e,r,t.leadingWhitespace)}),e}),this.booleanExpression=this.RULE("booleanExpression",()=>{let e=this.SUBRULE(this.concatenateExpression);return this.MANY(()=>{const t=this.CONSUME(c.BooleanOp),r=this.SUBRULE2(this.concatenateExpression);(0,n.tokenMatcher)(t,c.EqualsOp)?e=(0,a.buildEqualsOpAst)(e,r,t.leadingWhitespace):(0,n.tokenMatcher)(t,c.NotEqualOp)?e=(0,a.buildNotEqualOpAst)(e,r,t.leadingWhitespace):(0,n.tokenMatcher)(t,c.GreaterThanOp)?e=(0,a.buildGreaterThanOpAst)(e,r,t.leadingWhitespace):(0,n.tokenMatcher)(t,c.LessThanOp)?e=(0,a.buildLessThanOpAst)(e,r,t.leadingWhitespace):(0,n.tokenMatcher)(t,c.GreaterThanOrEqualOp)?e=(0,a.buildGreaterThanOrEqualOpAst)(e,r,t.leadingWhitespace):(0,n.tokenMatcher)(t,c.LessThanOrEqualOp)?e=(0,a.buildLessThanOrEqualOpAst)(e,r,t.leadingWhitespace):this.ACTION(()=>{throw Error("Operator not supported")})}),e}),this.formula=this.RULE("formula",()=>(this.CONSUME(c.EqualsOp),this.SUBRULE(this.booleanExpression))),this.lexerConfig=e,this.sheetMapping=t,this.formulaAddress=(0,o.simpleCellAddress)(0,0,0),this.performSelfAnalysis()}parseFromTokens(e,t){this.input=e;let r=this.formulaWithContext(t),n=[];return this.customParsingError&&n.push(this.customParsingError),n=n.concat(this.errors.map(e=>({type:a.ParsingErrorType.ParserError,message:e.message}))),n.length>0&&(r=(0,a.buildParsingErrorAst)()),{ast:r,errors:n}}reset(){super.reset(),this.customParsingError=void 0}formulaWithContext(e){return this.formulaAddress=e,this.formula()}buildCellRange(e,t,r){if(void 0===e.sheet&&void 0!==t.sheet)return this.parsingError(a.ParsingErrorType.ParserError,"Malformed range expression");const{firstEnd:n,secondEnd:o,sheetRefType:s}=l.fixSheetIdsForRangeEnds(e,t);return(0,a.buildCellRangeAst)(n,o,s,r)}static fixSheetIdsForRangeEnds(e,t){const r=l.rangeSheetReferenceType(e.sheet,t.sheet);return{firstEnd:e,secondEnd:void 0!==e.sheet&&void 0===t.sheet?t.withSheet(e.sheet):t,sheetRefType:r}}handleOffsetHeuristic(e){const t=e[0];if(t.type!==a.AstNodeType.CELL_REFERENCE)return this.parsingError(a.ParsingErrorType.StaticOffsetError,"First argument to OFFSET is not a reference");const r=e[1];let n;if(r.type===a.AstNodeType.NUMBER&&Number.isInteger(r.value))n=r.value;else if(r.type===a.AstNodeType.PLUS_UNARY_OP&&r.value.type===a.AstNodeType.NUMBER&&Number.isInteger(r.value.value))n=r.value.value;else{if(r.type!==a.AstNodeType.MINUS_UNARY_OP||r.value.type!==a.AstNodeType.NUMBER||!Number.isInteger(r.value.value))return this.parsingError(a.ParsingErrorType.StaticOffsetError,"Second argument to OFFSET is not a static number");n=-r.value.value}const i=e[2];let c;if(i.type===a.AstNodeType.NUMBER&&Number.isInteger(i.value))c=i.value;else if(i.type===a.AstNodeType.PLUS_UNARY_OP&&i.value.type===a.AstNodeType.NUMBER&&Number.isInteger(i.value.value))c=i.value.value;else{if(i.type!==a.AstNodeType.MINUS_UNARY_OP||i.value.type!==a.AstNodeType.NUMBER||!Number.isInteger(i.value.value))return this.parsingError(a.ParsingErrorType.StaticOffsetError,"Third argument to OFFSET is not a static number");c=-i.value.value}const l=e[3];let h;if(void 0===l)h=1;else{if(l.type!==a.AstNodeType.NUMBER)return this.parsingError(a.ParsingErrorType.StaticOffsetError,"Fourth argument to OFFSET is not a static number");if(h=l.value,h<1)return this.parsingError(a.ParsingErrorType.StaticOffsetError,"Fourth argument to OFFSET is too small number");if(!Number.isInteger(h))return this.parsingError(a.ParsingErrorType.StaticOffsetError,"Fourth argument to OFFSET is not integer")}const d=e[4];let p;if(void 0===d)p=1;else{if(d.type!==a.AstNodeType.NUMBER)return this.parsingError(a.ParsingErrorType.StaticOffsetError,"Fifth argument to OFFSET is not a static number");if(p=d.value,p<1)return this.parsingError(a.ParsingErrorType.StaticOffsetError,"Fifth argument to OFFSET is too small number");if(!Number.isInteger(p))return this.parsingError(a.ParsingErrorType.StaticOffsetError,"Fifth argument to OFFSET is not integer")}const m=new u.CellAddress(t.reference.col+c,t.reference.row+n,t.reference.type);let g=m.col,f=m.row;if(t.reference.type!==u.CellReferenceType.CELL_REFERENCE_RELATIVE&&t.reference.type!==u.CellReferenceType.CELL_REFERENCE_ABSOLUTE_COL||(f+=this.formulaAddress.row),t.reference.type!==u.CellReferenceType.CELL_REFERENCE_RELATIVE&&t.reference.type!==u.CellReferenceType.CELL_REFERENCE_ABSOLUTE_ROW||(g+=this.formulaAddress.col),g<0||f<0)return(0,a.buildCellErrorAst)(new o.CellError(o.ErrorType.REF,s.ErrorMessage.OutOfSheet));if(1===p&&1===h)return(0,a.buildCellReferenceAst)(m);{const e=new u.CellAddress(m.col+p-1,m.row+h-1,m.type);return(0,a.buildCellRangeAst)(m,e,a.RangeSheetReferenceType.RELATIVE)}}parsingError(e,t){return this.customParsingError=(0,a.parsingError)(e,t),(0,a.buildParsingErrorAst)()}static rangeSheetReferenceType(e,t){return void 0===e?a.RangeSheetReferenceType.RELATIVE:void 0===t?a.RangeSheetReferenceType.START_ABSOLUTE:a.RangeSheetReferenceType.BOTH_ABSOLUTE}}t.FormulaParser=l;class h{constructor(e){this.lexerConfig=e,this.lexer=new n.Lexer(e.allTokens,{ensureOptimizations:!0})}tokenizeFormula(e){const t=this.lexer.tokenize(e);let r=t.tokens;return r=this.trimTrailingWhitespaces(r),r=this.skipWhitespacesInsideRanges(r),r=this.skipWhitespacesBeforeArgSeparators(r),t.tokens=r,t}skipWhitespacesInsideRanges(e){return h.filterTokensByNeighbors(e,(e,t,r)=>((0,n.tokenMatcher)(e,c.CellReference)||(0,n.tokenMatcher)(e,c.RangeSeparator))&&(0,n.tokenMatcher)(t,this.lexerConfig.WhiteSpace)&&((0,n.tokenMatcher)(r,c.CellReference)||(0,n.tokenMatcher)(r,c.RangeSeparator)))}skipWhitespacesBeforeArgSeparators(e){return h.filterTokensByNeighbors(e,(e,t,r)=>!(0,n.tokenMatcher)(e,this.lexerConfig.ArgSeparator)&&(0,n.tokenMatcher)(t,this.lexerConfig.WhiteSpace)&&(0,n.tokenMatcher)(r,this.lexerConfig.ArgSeparator))}static filterTokensByNeighbors(e,t){if(e.length<3)return e;let r=0;const n=[e[r++]];for(;r<e.length-1;)t(e[r-1],e[r],e[r+1])||n.push(e[r]),++r;return n.push(e[r]),n}trimTrailingWhitespaces(e){return e.length>0&&(0,n.tokenMatcher)(e[e.length-1],this.lexerConfig.WhiteSpace)&&e.pop(),e}}t.FormulaLexer=h},function(e,t,r){"use strict";t.__esModule=!0,t.ErrorMessage=void 0;
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
class n{}t.ErrorMessage=n,n.DistinctSigns="Distinct signs.",n.WrongArgNumber="Wrong number of arguments.",n.EmptyArg="Empty function argument.",n.EmptyArray="Empty array not allowed.",n.ArrayDimensions="Array dimensions are not compatible.",n.NoSpaceForArrayResult="No space for array result.",n.ValueSmall="Value too small.",n.ValueLarge="Value too large.",n.BadCriterion="Incorrect criterion.",n.RangeManySheets="Range spans more than one sheet.",n.CellRangeExpected="Cell range expected.",n.WrongDimension="Wrong range dimension.",n.ScalarExpected="Cell range not allowed.",n.NumberCoercion="Value cannot be coerced to number.",n.NumberExpected="Number argument expected.",n.IntegerExpected="Value needs to be an integer.",n.BadMode="Mode not recognized.",n.DateBounds="Date outside of bounds.",n.OutOfSheet="Resulting reference is out of the sheet.",n.WrongType="Wrong type of argument.",n.NaN="NaN or infinite value encountered.",n.EqualLength="Ranges need to be of equal length.",n.Negative="Value cannot be negative.",n.NotBinary="String does not represent a binary number.",n.NotOctal="String does not represent an octal number.",n.NotHex="String does not represent a hexadecimal number.",n.EndStartPeriod="End period needs to be at least start period.",n.CellRefExpected="Cell reference expected.",n.EmptyRange="Empty range not allowed.",n.BadRef="Address is not correct.",n.NumberRange="Number-only range expected.",n.ValueNotFound="Value not found.",n.ValueBaseLarge="Value in base too large.",n.ValueBaseSmall="Value in base too small.",n.ValueBaseLong="Value in base too long.",n.NegativeLength="Length cannot be negative.",n.PatternNotFound="Pattern not found.",n.OneValue="Needs at least one value.",n.TwoValues="Range needs to contain at least two elements.",n.ThreeValues="Range needs to contain at least three elements.",n.IndexBounds="Index out of bounds.",n.IndexLarge="Index too large.",n.Formula="Expected formula.",n.NegativeCount="Count cannot be negative.",n.ParseError="Parsing error.",n.SheetRef="Sheet does not exist.",n.PeriodLong="Period number cannot exceed life length.",n.InvalidDate="Invalid date.",n.BitshiftLong="Result of bitshift is too long.",n.EmptyString="Empty-string argument not allowed.",n.LengthBounds="Length out of bounds.",n.NegativeTime="Time cannot be negative.",n.NoDefault="No default option.",n.NoConditionMet="None of the conditions were met.",n.Selector="Selector cannot exceed the number of arguments.",n.StartEndDate="Start date needs to be earlier than end date.",n.IncorrectDateTime="String does not represent correct DateTime.",n.CharacterCodeBounds="Character code out of bounds.",n.NonZero="Argument cannot be 0.",n.LessThanOne="Argument cannot be less than 1.",n.WeekendString="Incorrect weekend bitmask string.",n.InvalidRoman="Invalid roman numeral.",n.WrongOrder="Wrong order of values.",n.ComplexNumberExpected="Complex number expected.",n.ShouldBeIorJ="Should be 'i' or 'j'.",n.SizeMismatch="Array dimensions mismatched.",n.FunctionName=e=>`Function name ${e} not recognized.`,n.NamedExpressionName=e=>`Named expression ${e} not recognized.`,n.LicenseKey=e=>`License key is ${e}.`},function(e,t,r){"use strict";t.__esModule=!0,t.buildLexerConfig=t.TimesOp=t.StringLiteral=t.RowRange=t.RangeSeparator=t.RParen=t.ProcedureName=t.PowerOp=t.PlusOp=t.PercentOp=t.NotEqualOp=t.NamedExpression=t.MultiplicationOp=t.MinusOp=t.LessThanOrEqualOp=t.LessThanOp=t.LParen=t.GreaterThanOrEqualOp=t.GreaterThanOp=t.ErrorLiteral=t.EqualsOp=t.DivOp=t.ConcatenateOp=t.ColumnRange=t.CellReference=t.BooleanOp=t.ArrayRParen=t.ArrayLParen=t.AdditionOp=void 0;var n=r(84),o=r(82),s=r(133),i=r(134);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
const a=t.AdditionOp=(0,n.createToken)({name:"AdditionOp",pattern:n.Lexer.NA}),u=t.PlusOp=(0,n.createToken)({name:"PlusOp",pattern:/\+/,categories:a}),c=t.MinusOp=(0,n.createToken)({name:"MinusOp",pattern:/-/,categories:a}),l=t.MultiplicationOp=(0,n.createToken)({name:"MultiplicationOp",pattern:n.Lexer.NA}),h=t.TimesOp=(0,n.createToken)({name:"TimesOp",pattern:/\*/,categories:l}),d=t.DivOp=(0,n.createToken)({name:"DivOp",pattern:/\//,categories:l}),p=t.PowerOp=(0,n.createToken)({name:"PowerOp",pattern:/\^/}),m=t.PercentOp=(0,n.createToken)({name:"PercentOp",pattern:/%/}),g=t.BooleanOp=(0,n.createToken)({name:"BooleanOp",pattern:n.Lexer.NA}),f=t.EqualsOp=(0,n.createToken)({name:"EqualsOp",pattern:/=/,categories:g}),E=t.NotEqualOp=(0,n.createToken)({name:"NotEqualOp",pattern:/<>/,categories:g}),T=t.GreaterThanOp=(0,n.createToken)({name:"GreaterThanOp",pattern:/>/,categories:g}),y=t.LessThanOp=(0,n.createToken)({name:"LessThanOp",pattern:/</,categories:g}),A=t.GreaterThanOrEqualOp=(0,n.createToken)({name:"GreaterThanOrEqualOp",pattern:/>=/,categories:g}),R=t.LessThanOrEqualOp=(0,n.createToken)({name:"LessThanOrEqualOp",pattern:/<=/,categories:g}),N=t.ConcatenateOp=(0,n.createToken)({name:"ConcatenateOp",pattern:/&/}),S=t.LParen=(0,n.createToken)({name:"LParen",pattern:/\(/}),C=t.RParen=(0,n.createToken)({name:"RParen",pattern:/\)/}),v=t.ArrayLParen=(0,n.createToken)({name:"ArrayLParen",pattern:/{/}),O=t.ArrayRParen=(0,n.createToken)({name:"ArrayRParen",pattern:/}/}),I=t.StringLiteral=(0,n.createToken)({name:"StringLiteral",pattern:/"([^"\\]*(\\.[^"\\]*)*)"/}),M=t.ErrorLiteral=(0,n.createToken)({name:"ErrorLiteral",pattern:/#[A-Za-z0-9\/]+[?!]?/}),b=t.RangeSeparator=(0,n.createToken)({name:"RangeSeparator",pattern:new RegExp(o.RANGE_OPERATOR)}),F=t.ColumnRange=(0,n.createToken)({name:"ColumnRange",pattern:new RegExp(`${o.COLUMN_REFERENCE_PATTERN}${o.RANGE_OPERATOR}${o.COLUMN_REFERENCE_PATTERN}`)}),w=t.RowRange=(0,n.createToken)({name:"RowRange",pattern:new RegExp(`${o.ROW_REFERENCE_PATTERN}${o.RANGE_OPERATOR}${o.ROW_REFERENCE_PATTERN}`)}),_=t.ProcedureName=(0,n.createToken)({name:"ProcedureName",pattern:new RegExp(`([${o.UNICODE_LETTER_PATTERN}][${o.NON_RESERVED_CHARACTER_PATTERN}]*)\\(`)}),L=new s.CellReferenceMatcher,x=t.CellReference=(0,n.createToken)({name:"CellReference",pattern:L.match.bind(L),start_chars_hint:L.POSSIBLE_START_CHARACTERS,line_breaks:!1}),P=new i.NamedExpressionMatcher,U=t.NamedExpression=(0,n.createToken)({name:"NamedExpression",pattern:P.match.bind(P),start_chars_hint:P.POSSIBLE_START_CHARACTERS,line_breaks:!1});t.buildLexerConfig=e=>{const t=e.translationPackage.getFunctionTranslation("OFFSET"),r=e.errorMapping,s=e.translationPackage.buildFunctionMapping(),i=new RegExp("standard"===e.ignoreWhiteSpace?o.ODFF_WHITESPACE_PATTERN:o.ALL_WHITESPACE_PATTERN),L=(0,n.createToken)({name:"WhiteSpace",pattern:i}),P=(0,n.createToken)({name:"ArrayRowSep",pattern:e.arrayRowSeparator}),V=(0,n.createToken)({name:"ArrayColSep",pattern:e.arrayColumnSeparator}),D=(0,n.createToken)({name:"NumberLiteral",pattern:new RegExp(`(([${e.decimalSeparator}]\\d+)|(\\d+([${e.decimalSeparator}]\\d*)?))(e[+-]?\\d+)?`)}),B=(0,n.createToken)({name:"OffsetProcedureName",pattern:new RegExp(t,"i")});let k,G;return e.functionArgSeparator===e.arrayColumnSeparator?(k=V,G=[]):e.functionArgSeparator===e.arrayRowSeparator?(k=P,G=[]):(k=(0,n.createToken)({name:"ArgSeparator",pattern:e.functionArgSeparator}),G=[k]),{ArgSeparator:k,NumberLiteral:D,OffsetProcedureName:B,ArrayRowSeparator:P,ArrayColSeparator:V,WhiteSpace:L,allTokens:[L,u,c,h,d,p,f,E,m,A,R,T,y,S,C,v,O,B,_,b,...G,F,w,D,I,M,N,g,a,l,x,U,P,V],errorMapping:r,functionMapping:s,decimalSeparator:e.decimalSeparator,maxColumns:e.maxColumns,maxRows:e.maxRows}}},function(e,t,r){"use strict";t.__esModule=!0,t.CellReferenceMatcher=void 0;var n=r(82);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */t.CellReferenceMatcher=class{constructor(){this.POSSIBLE_START_CHARACTERS=[...n.ALL_UNICODE_LETTERS_ARRAY,...n.ALL_DIGITS_ARRAY,n.ABSOLUTE_OPERATOR,"'","_"],this.cellReferenceRegexp=new RegExp(n.CELL_REFERENCE_WITH_NEXT_CHARACTER_PATTERN,"y")}match(e,t){this.cellReferenceRegexp.lastIndex=t;const r=this.cellReferenceRegexp.exec(e+"@");return null==r||null==r[1]?null:(r[0]=r[1],r)}}},function(e,t,r){"use strict";t.__esModule=!0,t.NamedExpressionMatcher=void 0;var n=r(82);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */t.NamedExpressionMatcher=class{constructor(){this.POSSIBLE_START_CHARACTERS=[...n.ALL_UNICODE_LETTERS_ARRAY,"_"],this.namedExpressionRegexp=new RegExp(n.NAMED_EXPRESSION_PATTERN,"y"),this.r1c1CellRefRegexp=new RegExp(`^${n.R1C1_CELL_REFERENCE_PATTERN}$`)}match(e,t){this.namedExpressionRegexp.lastIndex=t;const r=this.namedExpressionRegexp.exec(e);return null==r||null==r[0]||this.r1c1CellRefRegexp.test(r[0])?null:r}}},function(e,t,r){"use strict";t.__esModule=!0,t.Unparser=void 0,t.formatNumber=u;var n=r(73),o=r(0),s=r(78),i=r(127),a=r(128);function u(e,t){return e.toString().replace(".",t)}t.Unparser=
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
class{constructor(e,t,r,n){this.config=e,this.lexerConfig=t,this.sheetMappingFn=r,this.namedExpressions=n}unparse(e,t){return"="+this.unparseAst(e,t)}unparseAst(e,t){var r,o;switch(e.type){case i.AstNodeType.EMPTY:return(0,i.imageWithWhitespace)("",e.leadingWhitespace);case i.AstNodeType.NUMBER:return(0,i.imageWithWhitespace)(u(e.value,this.config.decimalSeparator),e.leadingWhitespace);case i.AstNodeType.STRING:return(0,i.imageWithWhitespace)('"'+e.value+'"',e.leadingWhitespace);case i.AstNodeType.FUNCTION_CALL:{const r=e.args.map(e=>void 0!==e?this.unparseAst(e,t):"").join(this.config.functionArgSeparator),n=(this.config.translationPackage.isFunctionTranslated(e.procedureName)?this.config.translationPackage.getFunctionTranslation(e.procedureName):e.procedureName)+"("+r+(0,i.imageWithWhitespace)(")",e.internalWhitespace);return(0,i.imageWithWhitespace)(n,e.leadingWhitespace)}case i.AstNodeType.NAMED_EXPRESSION:{const n=null===(r=this.namedExpressions.nearestNamedExpression(e.expressionName,t.sheet))||void 0===r?void 0:r.displayName;return(0,i.imageWithWhitespace)(n||e.expressionName,e.leadingWhitespace)}case i.AstNodeType.CELL_REFERENCE:{let r;return r=void 0!==e.reference.sheet?this.unparseSheetName(e.reference.sheet)+"!":"",r+=null!==(o=e.reference.unparse(t))&&void 0!==o?o:this.config.translationPackage.getErrorTranslation(n.ErrorType.REF),(0,i.imageWithWhitespace)(r,e.leadingWhitespace)}case i.AstNodeType.COLUMN_RANGE:case i.AstNodeType.ROW_RANGE:case i.AstNodeType.CELL_RANGE:return(0,i.imageWithWhitespace)(this.formatRange(e,t),e.leadingWhitespace);case i.AstNodeType.PLUS_UNARY_OP:{const r=this.unparseAst(e.value,t);return(0,i.imageWithWhitespace)("+",e.leadingWhitespace)+r}case i.AstNodeType.MINUS_UNARY_OP:{const r=this.unparseAst(e.value,t);return(0,i.imageWithWhitespace)("-",e.leadingWhitespace)+r}case i.AstNodeType.PERCENT_OP:return this.unparseAst(e.value,t)+(0,i.imageWithWhitespace)("%",e.leadingWhitespace);case i.AstNodeType.ERROR:{const t=this.config.translationPackage.getErrorTranslation(e.error?e.error.type:n.ErrorType.ERROR);return(0,i.imageWithWhitespace)(t,e.leadingWhitespace)}case i.AstNodeType.ERROR_WITH_RAW_INPUT:return(0,i.imageWithWhitespace)(e.rawInput,e.leadingWhitespace);case i.AstNodeType.PARENTHESIS:{const r="("+this.unparseAst(e.expression,t)+(0,i.imageWithWhitespace)(")",e.internalWhitespace);return(0,i.imageWithWhitespace)(r,e.leadingWhitespace)}case i.AstNodeType.ARRAY:{const r="{"+e.args.map(e=>e.map(e=>this.unparseAst(e,t)).join(this.config.arrayColumnSeparator)).join(this.config.arrayRowSeparator)+(0,i.imageWithWhitespace)("}",e.internalWhitespace);return(0,i.imageWithWhitespace)(r,e.leadingWhitespace)}default:{const r=this.unparseAst(e.left,t),n=this.unparseAst(e.right,t);return r+(0,i.imageWithWhitespace)(a.binaryOpTokenMap[e.type],e.leadingWhitespace)+n}}}unparseSheetName(e){const t=(0,s.sheetIndexToString)(e,this.sheetMappingFn);if(void 0===t)throw new o.NoSheetWithIdError(e);return t}formatRange(e,t){let r="",o="";void 0!==e.start.sheet&&e.sheetReferenceType!==i.RangeSheetReferenceType.RELATIVE&&(r=this.unparseSheetName(e.start.sheet)+"!"),void 0!==e.end.sheet&&e.sheetReferenceType===i.RangeSheetReferenceType.BOTH_ABSOLUTE&&(o=this.unparseSheetName(e.end.sheet)+"!");const s=e.start.unparse(t),a=e.end.unparse(t);return void 0===s||void 0===a?this.config.translationPackage.getErrorTranslation(n.ErrorType.REF):`${r}${s}:${o}${a}`}}},function(e,t,r){"use strict";t.__esModule=!0,t.collectDependencies=void 0,r(2);var n=r(77);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const o=(e,t,r,s)=>{switch(e.type){case n.AstNodeType.EMPTY:case n.AstNodeType.NUMBER:case n.AstNodeType.STRING:case n.AstNodeType.ERROR:return;case n.AstNodeType.NAMED_EXPRESSION:return void(s&&r.push(new n.NamedExpressionDependency(e.expressionName)));case n.AstNodeType.CELL_REFERENCE:return void(s&&r.push(new n.AddressDependency(e.reference)));case n.AstNodeType.CELL_RANGE:return void(s&&e.start.sheet===e.end.sheet&&r.push(new n.CellRangeDependency(e.start,e.end)));case n.AstNodeType.COLUMN_RANGE:return void(s&&e.start.sheet===e.end.sheet&&r.push(new n.ColumnRangeDependency(e.start,e.end)));case n.AstNodeType.ROW_RANGE:return void(s&&e.start.sheet===e.end.sheet&&r.push(new n.RowRangeDependency(e.start,e.end)));case n.AstNodeType.PERCENT_OP:case n.AstNodeType.PLUS_UNARY_OP:case n.AstNodeType.MINUS_UNARY_OP:return void o(e.value,t,r,!0);case n.AstNodeType.CONCATENATE_OP:case n.AstNodeType.EQUALS_OP:case n.AstNodeType.NOT_EQUAL_OP:case n.AstNodeType.LESS_THAN_OP:case n.AstNodeType.GREATER_THAN_OP:case n.AstNodeType.LESS_THAN_OR_EQUAL_OP:case n.AstNodeType.GREATER_THAN_OR_EQUAL_OP:case n.AstNodeType.MINUS_OP:case n.AstNodeType.PLUS_OP:case n.AstNodeType.TIMES_OP:case n.AstNodeType.DIV_OP:case n.AstNodeType.POWER_OP:return o(e.left,t,r,!0),void o(e.right,t,r,!0);case n.AstNodeType.PARENTHESIS:return void o(e.expression,t,r,s);case n.AstNodeType.FUNCTION_CALL:{const n=!t.doesFunctionNeedArgumentToBeComputed(e.procedureName);return void e.args.forEach(e=>o(e,t,r,n))}}};t.collectDependencies=(e,t)=>{const r=new Array;return o(e,t,r,!0),r}},function(e,t,r){"use strict";t.__esModule=!0,t.RowRangeDependency=t.NamedExpressionDependency=t.ColumnRangeDependency=t.CellRangeDependency=t.AddressDependency=void 0;var n=r(72);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */t.AddressDependency=class{constructor(e){this.dependency=e}absolutize(e){return this.dependency.toSimpleCellAddress(e)}},t.CellRangeDependency=class{constructor(e,t){this.start=e,this.end=t}absolutize(e){return new n.AbsoluteCellRange(this.start.toSimpleCellAddress(e),this.end.toSimpleCellAddress(e))}},t.ColumnRangeDependency=class{constructor(e,t){this.start=e,this.end=t}absolutize(e){const t=this.start.toSimpleColumnAddress(e),r=this.end.toSimpleColumnAddress(e);return new n.AbsoluteColumnRange(t.sheet,t.col,r.col)}},t.RowRangeDependency=class{constructor(e,t){this.start=e,this.end=t}absolutize(e){const t=this.start.toSimpleRowAddress(e),r=this.end.toSimpleRowAddress(e);return new n.AbsoluteRowRange(t.sheet,t.row,r.row)}},t.NamedExpressionDependency=class{constructor(e){this.name=e}absolutize(e){return this}}},function(e,t,r){"use strict";t.__esModule=!0,t.ContentChanges=void 0,r(2);var n=r(73),o=r(139);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
class s{constructor(){this.changes=new Map}static empty(){return new s}addAll(e){for(const t of e.changes.values())this.add(t.address,t);return this}addChange(e,t,r){this.addInterpreterValue(e,t,r)}exportChanges(e){let t=[];return this.changes.forEach(r=>{const n=e.exportChange(r);Array.isArray(n)?t=t.concat(n):t.push(n)}),t}getChanges(){return Array.from(this.changes.values())}isEmpty(){return 0===this.changes.size}add(e,t){const r=t.value;if(r instanceof o.SimpleRangeValue)for(const t of r.effectiveAddressesFromData(e))this.changes.delete((0,n.addressKey)(t));this.changes.set((0,n.addressKey)(e),t)}addInterpreterValue(e,t,r){this.add(t,{address:t,value:e,oldValue:r})}}t.ContentChanges=s},function(e,t,r){"use strict";t.__esModule=!0,t.SimpleRangeValue=void 0,r(2);var n=r(1),o=r(73),s=r(131),i=r(140);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
class a{constructor(e,t,r,o){this._data=e,this.range=t,this.dependencyGraph=r,this._hasOnlyNumbers=o,this.size=void 0===e?new n.ArraySize(t.effectiveWidth(r),t.effectiveHeight(r)):new n.ArraySize(e[0].length,e.length)}get data(){return this.ensureThatComputed(),this._data}static fromRange(e,t,r){return new a(e,t,r,!0)}static onlyNumbers(e){return new a(e,void 0,void 0,!0)}static onlyValues(e){return new a(e,void 0,void 0,void 0)}static onlyRange(e,t){return new a(void 0,e,t,void 0)}static fromScalar(e){return new a([[e]],void 0,void 0,void 0)}isAdHoc(){return void 0===this.range}width(){return this.size.width}height(){return this.size.height}valuesFromTopLeftCorner(){this.ensureThatComputed();const e=[];for(let t=0;t<this._data.length;t++)for(let r=0;r<this._data[0].length;r++)e.push(this._data[t][r]);return e}*effectiveAddressesFromData(e){for(let t=0;t<this.data.length;++t){const r=this.data[t];for(let n=0;n<r.length;++n)yield(0,o.simpleCellAddress)(e.sheet,e.col+n,e.row+t)}}*entriesFromTopLeftCorner(e){this.ensureThatComputed();for(let t=0;t<this.size.height;++t)for(let r=0;r<this.size.width;++r)yield[this._data[t][r],(0,o.simpleCellAddress)(e.sheet,e.col+r,e.row+t)]}*iterateValuesFromTopLeftCorner(){yield*this.valuesFromTopLeftCorner()}numberOfElements(){return this.size.width*this.size.height}hasOnlyNumbers(){if(void 0===this._hasOnlyNumbers){this._hasOnlyNumbers=!0;for(const e of this.data)for(const t of e)if("number"!=typeof t)return this._hasOnlyNumbers=!1,!1}return this._hasOnlyNumbers}rawNumbers(){return this._data}rawData(){var e;return this.ensureThatComputed(),null!==(e=this._data)&&void 0!==e?e:[]}sameDimensionsAs(e){return this.width()===e.width()&&this.height()===e.height()}ensureThatComputed(){void 0===this._data&&(this._hasOnlyNumbers=!0,this._data=this.range.addressesArrayMap(this.dependencyGraph,e=>{const t=this.dependencyGraph.getCellValue(e);return t instanceof a?(this._hasOnlyNumbers=!1,new o.CellError(o.ErrorType.VALUE,s.ErrorMessage.ScalarExpected)):((0,i.isExtendedNumber)(t)||(this._hasOnlyNumbers=!1),t)}))}}t.SimpleRangeValue=a},function(e,t,r){"use strict";t.__esModule=!0,t.TimeNumber=t.RichNumber=t.PercentNumber=t.NumberType=t.EmptyValue=t.DateTimeNumber=t.DateNumber=t.CurrencyNumber=void 0,t.cloneNumber=function(e,t){if("number"==typeof e)return t;{const r=e.fromNumber(t);return r.format=e.format,r}},t.getFormatOfExtendedNumber=function(e){return e instanceof n?e.format:void 0},t.getRawValue=function(e){return e instanceof n?e.val:e},t.getTypeFormatOfExtendedNumber=function(e){return e instanceof n?{type:e.getDetailedType(),format:e.format}:{type:o.NUMBER_RAW}},t.getTypeOfExtendedNumber=function(e){return e instanceof n?e.getDetailedType():o.NUMBER_RAW},t.isExtendedNumber=function(e){return"number"==typeof e||e instanceof n},t.EmptyValue=Symbol("Empty value");class n{constructor(e,t){this.val=e,this.format=t}fromNumber(e){return new this.constructor(e)}}var o;t.RichNumber=n,t.DateNumber=class extends n{getDetailedType(){return o.NUMBER_DATE}},t.CurrencyNumber=class extends n{getDetailedType(){return o.NUMBER_CURRENCY}},t.TimeNumber=class extends n{getDetailedType(){return o.NUMBER_TIME}},t.DateTimeNumber=class extends n{getDetailedType(){return o.NUMBER_DATETIME}},t.PercentNumber=class extends n{getDetailedType(){return o.NUMBER_PERCENT}},function(e){e.NUMBER_RAW="NUMBER_RAW",e.NUMBER_DATE="NUMBER_DATE",e.NUMBER_TIME="NUMBER_TIME",e.NUMBER_DATETIME="NUMBER_DATETIME",e.NUMBER_CURRENCY="NUMBER_CURRENCY",e.NUMBER_PERCENT="NUMBER_PERCENT"}(o||(t.NumberType=o={}))},function(e,t,r){"use strict";t.__esModule=!0,t.RowsSpan=t.ColumnsSpan=void 0;
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
class n{constructor(e,t,r){if(this.sheet=e,this.rowStart=t,this.rowEnd=r,t<0)throw Error("Starting row cant be less than 0");if(r<t)throw Error("Row span cant end before start")}get numberOfRows(){return this.rowEnd-this.rowStart+1}get start(){return this.rowStart}get end(){return this.rowEnd}static fromNumberOfRows(e,t,r){return new n(e,t,t+r-1)}static fromRowStartAndEnd(e,t,r){return new n(e,t,r)}*rows(){for(let e=this.rowStart;e<=this.rowEnd;++e)yield e}intersect(e){if(this.sheet!==e.sheet)throw Error("Can't intersect spans from different sheets");const t=Math.max(this.rowStart,e.rowStart),r=Math.min(this.rowEnd,e.rowEnd);return t>r?null:new n(this.sheet,t,r)}firstRow(){return new n(this.sheet,this.rowStart,this.rowStart)}}t.RowsSpan=n;class o{constructor(e,t,r){if(this.sheet=e,this.columnStart=t,this.columnEnd=r,t<0)throw Error("Starting column cant be less than 0");if(r<t)throw Error("Column span cant end before start")}get numberOfColumns(){return this.columnEnd-this.columnStart+1}get start(){return this.columnStart}get end(){return this.columnEnd}static fromNumberOfColumns(e,t,r){return new o(e,t,t+r-1)}static fromColumnStartAndEnd(e,t,r){return new o(e,t,r)}*columns(){for(let e=this.columnStart;e<=this.columnEnd;++e)yield e}intersect(e){if(this.sheet!==e.sheet)throw Error("Can't intersect spans from different sheets");const t=Math.max(this.columnStart,e.columnStart),r=Math.min(this.columnEnd,e.columnEnd);return t>r?null:new o(this.sheet,t,r)}firstColumn(){return new o(this.sheet,this.columnStart,this.columnStart)}}t.ColumnsSpan=o},function(e,t,r){"use strict";t.__esModule=!0,t.Statistics=t.StatType=t.EmptyStatistics=void 0;var n=r(143);t.EmptyStatistics=n.EmptyStatistics;var o=r(144);t.Statistics=o.Statistics;var s=r(145);t.StatType=s.StatType},function(e,t,r){"use strict";t.__esModule=!0,t.EmptyStatistics=void 0;var n=r(144);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class o extends n.Statistics{incrementCriterionFunctionFullCacheUsed(){}incrementCriterionFunctionPartialCacheUsed(){}start(e){}end(e){}}t.EmptyStatistics=o},function(e,t,r){"use strict";t.__esModule=!0,t.Statistics=void 0;var n=r(145);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */t.Statistics=class{constructor(){this.stats=new Map([[n.StatType.CRITERION_FUNCTION_FULL_CACHE_USED,0],[n.StatType.CRITERION_FUNCTION_PARTIAL_CACHE_USED,0]]),this.startTimes=new Map}incrementCriterionFunctionFullCacheUsed(){var e;const t=(null!==(e=this.stats.get(n.StatType.CRITERION_FUNCTION_FULL_CACHE_USED))&&void 0!==e?e:0)+1;this.stats.set(n.StatType.CRITERION_FUNCTION_FULL_CACHE_USED,t)}incrementCriterionFunctionPartialCacheUsed(){var e;const t=(null!==(e=this.stats.get(n.StatType.CRITERION_FUNCTION_PARTIAL_CACHE_USED))&&void 0!==e?e:0)+1;this.stats.set(n.StatType.CRITERION_FUNCTION_PARTIAL_CACHE_USED,t)}reset(){this.stats.clear(),this.startTimes.clear(),this.stats.set(n.StatType.CRITERION_FUNCTION_FULL_CACHE_USED,0),this.stats.set(n.StatType.CRITERION_FUNCTION_PARTIAL_CACHE_USED,0)}start(e){if(this.startTimes.get(e))throw Error(`Statistics ${e} already started`);this.startTimes.set(e,Date.now())}end(e){var t;const r=Date.now(),n=this.startTimes.get(e);if(!n)throw Error(`Statistics ${e} not started`);{let o=null!==(t=this.stats.get(e))&&void 0!==t?t:0;o+=r-n,this.stats.set(e,o),this.startTimes.delete(e)}}measure(e,t){this.start(e);const r=t();return this.end(e),r}snapshot(){return new Map(this.stats)}}},function(e,t,r){"use strict";
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
var n;t.__esModule=!0,t.StatType=void 0,function(e){e.BUILD_ENGINE_TOTAL="BUILD_ENGINE_TOTAL",e.PARSER="PARSER",e.GRAPH_BUILD="GRAPH_BUILD",e.COLLECT_DEPENDENCIES="COLLECT_DEPENDENCIES",e.PROCESS_DEPENDENCIES="PROCESS_DEPENDENCIES",e.TOP_SORT="TOP_SORT",e.BUILD_COLUMN_INDEX="BUILD_COLUMN_INDEX",e.EVALUATION="EVALUATION",e.VLOOKUP="VLOOKUP",e.TRANSFORM_ASTS="TRANSFORM_ASTS",e.TRANSFORM_ASTS_POSTPONED="TRANSFORM_ASTS_POSTPONED",e.ADJUSTING_ADDRESS_MAPPING="ADJUSTING_ADDRESS_MAPPING",e.ADJUSTING_ARRAY_MAPPING="ADJUSTING_ARRAY_MAPPING",e.ADJUSTING_RANGES="ADJUSTING_RANGES",e.ADJUSTING_GRAPH="ADJUSTING_GRAPH",e.CRITERION_FUNCTION_FULL_CACHE_USED="CRITERION_FUNCTION_FULL_CACHE_USED",e.CRITERION_FUNCTION_PARTIAL_CACHE_USED="CRITERION_FUNCTION_PARTIAL_CACHE_USED"}(n||(t.StatType=n={}))},function(e,t,r){"use strict";t.__esModule=!0,t.AddressMapping=void 0;var n=r(147),o=r(140),s=r(74);t.AddressMapping=
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
class{constructor(e){this.policy=e,this.mapping=new Map}getCell(e){const t=this.mapping.get(e.sheet);if(void 0===t)throw new n.NoSheetWithIdError(e.sheet);return t.getCell(e)}fetchCell(e){const t=this.mapping.get(e.sheet);if(void 0===t)throw new n.NoSheetWithIdError(e.sheet);const r=t.getCell(e);if(!r)throw Error("Vertex for address missing in AddressMapping");return r}strategyFor(e){const t=this.mapping.get(e);if(void 0===t)throw new n.NoSheetWithIdError(e);return t}addSheet(e,t){if(this.mapping.has(e))throw Error("Sheet already added");this.mapping.set(e,t)}autoAddSheet(e,t){const{height:r,width:n,fill:o}=t,s=this.policy.call(o);this.addSheet(e,new s(n,r))}getCellValue(e){const t=this.getCell(e);return void 0===t?o.EmptyValue:t instanceof s.ArrayVertex?t.getArrayCellValue(e):t.getCellValue()}getRawValue(e){const t=this.getCell(e);return t instanceof s.ValueCellVertex?t.getValues().rawValue:t instanceof s.ArrayVertex?t.getArrayCellRawValue(e):null}setCell(e,t){const r=this.mapping.get(e.sheet);if(!r)throw Error("Sheet not initialized");r.setCell(e,t)}moveCell(e,t){const r=this.mapping.get(e.sheet);if(!r)throw Error("Sheet not initialized.");if(e.sheet!==t.sheet)throw Error("Cannot move cells between sheets.");if(r.has(t))throw new Error("Cannot move cell. Destination already occupied.");const n=r.getCell(e);if(void 0===n)throw new Error("Cannot move cell. No cell with such address.");this.setCell(t,n),this.removeCell(e)}removeCell(e){const t=this.mapping.get(e.sheet);if(!t)throw Error("Sheet not initialized");t.removeCell(e)}has(e){const t=this.mapping.get(e.sheet);return void 0!==t&&t.has(e)}getHeight(e){const t=this.mapping.get(e);if(void 0===t)throw new n.NoSheetWithIdError(e);return t.getHeight()}getWidth(e){const t=this.mapping.get(e);if(!t)throw new n.NoSheetWithIdError(e);return t.getWidth()}addRows(e,t,r){const o=this.mapping.get(e);if(void 0===o)throw new n.NoSheetWithIdError(e);o.addRows(t,r)}removeRows(e){const t=this.mapping.get(e.sheet);if(void 0===t)throw new n.NoSheetWithIdError(e.sheet);t.removeRows(e)}removeSheet(e){this.mapping.delete(e)}addColumns(e,t,r){const o=this.mapping.get(e);if(void 0===o)throw new n.NoSheetWithIdError(e);o.addColumns(t,r)}removeColumns(e){const t=this.mapping.get(e.sheet);if(void 0===t)throw new n.NoSheetWithIdError(e.sheet);t.removeColumns(e)}*verticesFromRowsSpan(e){yield*this.mapping.get(e.sheet).verticesFromRowsSpan(e)}*verticesFromColumnsSpan(e){yield*this.mapping.get(e.sheet).verticesFromColumnsSpan(e)}*entriesFromRowsSpan(e){yield*this.mapping.get(e.sheet).entriesFromRowsSpan(e)}*entriesFromColumnsSpan(e){yield*this.mapping.get(e.sheet).entriesFromColumnsSpan(e)}*entries(){for(const[e,t]of this.mapping.entries())yield*t.getEntries(e)}*sheetEntries(e){const t=this.mapping.get(e);if(void 0===t)throw new n.NoSheetWithIdError(e);yield*t.getEntries(e)}}},function(e,t,r){"use strict";t.__esModule=!0,t.UnableToParseError=t.TargetLocationHasArrayError=t.SourceLocationHasArrayError=t.SheetsNotEqual=t.SheetSizeLimitExceededError=t.SheetNameAlreadyTakenError=t.ProtectedFunctionTranslationError=t.ProtectedFunctionError=t.NothingToPasteError=t.NotAFormulaError=t.NoSheetWithNameError=t.NoSheetWithIdError=t.NoRelativeAddressesAllowedError=t.NoOperationToUndoError=t.NoOperationToRedoError=t.NamedExpressionNameIsInvalidError=t.NamedExpressionNameIsAlreadyTakenError=t.NamedExpressionDoesNotExistError=t.MissingTranslationError=t.LanguageNotRegisteredError=t.LanguageAlreadyRegisteredError=t.InvalidArgumentsError=t.InvalidAddressError=t.FunctionPluginValidationError=t.ExpectedValueOfTypeError=t.ExpectedOneOfValuesError=t.EvaluationSuspendedError=t.ConfigValueTooSmallError=t.ConfigValueTooBigError=t.ConfigValueEmpty=t.AliasAlreadyExisting=void 0;
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
class n extends Error{constructor(e){super("There's no sheet with id = "+e)}}t.NoSheetWithIdError=n;class o extends Error{constructor(e){super(`There's no sheet with name '${e}'`)}}t.NoSheetWithNameError=o;class s extends Error{constructor(e){super(`Sheet with name ${e} already exists`)}}t.SheetNameAlreadyTakenError=s;class i extends Error{constructor(){super("Sheet size limit exceeded")}}t.SheetSizeLimitExceededError=i;class a extends Error{constructor(){super("This is not a formula")}}t.NotAFormulaError=a;class u extends Error{constructor(e){super(`Address (row = ${e.row}, col = ${e.col}) is invalid`)}}t.InvalidAddressError=u;class c extends Error{constructor(e){super("Invalid arguments, expected "+e)}}t.InvalidArgumentsError=c;class l extends Error{constructor(e,t){super(`Sheets ${e} and ${t} are not equal.`)}}t.SheetsNotEqual=l;class h extends Error{constructor(e){super(`Name of Named Expression '${e}' is already present`)}}t.NamedExpressionNameIsAlreadyTakenError=h;class d extends Error{constructor(e){super(`Name of Named Expression '${e}' is invalid`)}}t.NamedExpressionNameIsInvalidError=d;class p extends Error{constructor(e){super(`Named Expression '${e}' does not exist`)}}t.NamedExpressionDoesNotExistError=p;class m extends Error{constructor(){super("There is no operation to undo")}}t.NoOperationToUndoError=m;class g extends Error{constructor(){super("There is no operation to redo")}}t.NoOperationToRedoError=g;class f extends Error{constructor(){super("There is nothing to paste")}}function E(e,t){switch(typeof t){case"function":case"symbol":return t.toString();case"bigint":return"BigInt("+t.toString()+")";default:return t instanceof RegExp?"RegExp("+t.toString()+")":t}}t.NothingToPasteError=f;class T extends Error{constructor(e){super("Unable to parse value: "+JSON.stringify(e,E,4))}}t.UnableToParseError=T;class y extends Error{constructor(e,t){super(`Expected value of type: ${e} for config parameter: ${t}`)}}t.ExpectedValueOfTypeError=y;class A extends Error{constructor(e){super(`Config parameter ${e} cannot be empty.`)}}t.ConfigValueEmpty=A;class R extends Error{constructor(e,t){super(`Config parameter ${e} should be at least ${t}`)}}t.ConfigValueTooSmallError=R;class N extends Error{constructor(e,t){super(`Config parameter ${e} should be at most ${t}`)}}t.ConfigValueTooBigError=N;class S extends Error{constructor(e,t){super(`Expected one of ${e} for config parameter: ${t}`)}}t.ExpectedOneOfValuesError=S;class C extends Error{constructor(){super("Computations are suspended")}}t.EvaluationSuspendedError=C;class v extends Error{constructor(e){super(`Translation for ${e} is missing in the translation package you're using.`)}}t.MissingTranslationError=v;class O extends Error{constructor(e){super("Cannot register translation for function with id: "+e)}}t.ProtectedFunctionTranslationError=O;class I extends Error{constructor(){super("Language not registered.")}}t.LanguageNotRegisteredError=I;class M extends Error{constructor(){super("Language already registered.")}}t.LanguageAlreadyRegisteredError=M;class b extends Error{static functionNotDeclaredInPlugin(e,t){return new b(`Function with id ${e} not declared in plugin ${t}`)}static functionMethodNotFound(e,t){return new b(`Function method ${e} not found in plugin ${t}`)}}t.FunctionPluginValidationError=b;class F extends Error{static cannotRegisterFunctionWithId(e){return new F("Cannot register function with id "+e)}static cannotUnregisterFunctionWithId(e){return new F("Cannot unregister function with id "+e)}static cannotUnregisterProtectedPlugin(){return new F("Cannot unregister protected plugin")}}t.ProtectedFunctionError=F;class w extends Error{constructor(){super("Cannot perform this operation, source location has an array inside.")}}t.SourceLocationHasArrayError=w;class _ extends Error{constructor(){super("Cannot perform this operation, target location has an array inside.")}}t.TargetLocationHasArrayError=_;class L extends Error{constructor(){super("Relative addresses not allowed in named expressions.")}}t.NoRelativeAddressesAllowedError=L;class x extends Error{constructor(e,t){super(`Alias id ${e} in plugin ${t} already defined as a function or alias.`)}}t.AliasAlreadyExisting=x},function(e,t,r){"use strict";t.__esModule=!0,t.ArrayMapping=void 0,r(2);var n=r(73);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */t.ArrayMapping=class{constructor(){this.arrayMapping=new Map}getArray(e){const t=this.getArrayByCorner(e.start);if(null==t?void 0:t.getRange().sameAs(e))return t}getArrayByCorner(e){return this.arrayMapping.get((0,n.addressKey)(e))}setArray(e,t){this.arrayMapping.set((0,n.addressKey)(e.start),t)}removeArray(e){"string"==typeof e?this.arrayMapping.delete(e):this.arrayMapping.delete((0,n.addressKey)(e.start))}count(){return this.arrayMapping.size}*arraysInRows(e){for(const[t,r]of this.arrayMapping.entries())r.spansThroughSheetRows(e.sheet,e.rowStart,e.rowEnd)&&(yield[t,r])}*arraysInCols(e){for(const[t,r]of this.arrayMapping.entries())r.spansThroughSheetColumn(e.sheet,e.columnStart,e.columnEnd)&&(yield[t,r])}isFormulaArrayInRow(e,t){for(const r of this.arrayMapping.values())if(r.spansThroughSheetRows(e,t))return!0;return!1}isFormulaArrayInAllRows(e){let t=!0;for(const r of e.rows())this.isFormulaArrayInRow(e.sheet,r)||(t=!1);return t}isFormulaArrayInColumn(e,t){for(const r of this.arrayMapping.values())if(r.spansThroughSheetColumn(e,t))return!0;return!1}isFormulaArrayInAllColumns(e){let t=!0;for(const r of e.columns())this.isFormulaArrayInColumn(e.sheet,r)||(t=!1);return t}isFormulaArrayInRange(e){for(const t of this.arrayMapping.values())if(t.getRange().doesOverlap(e))return!0;return!1}isFormulaArrayAtAddress(e){for(const t of this.arrayMapping.values())if(t.getRange().addressInRange(e))return!0;return!1}moveArrayVerticesAfterRowByRows(e,t,r){this.updateArrayVerticesInSheet(e,(e,n)=>{const o=n.getRange();return t<=o.start.row?[o.shifted(0,r),n]:void 0})}moveArrayVerticesAfterColumnByColumns(e,t,r){this.updateArrayVerticesInSheet(e,(e,n)=>{const o=n.getRange();return t<=o.start.col?[o.shifted(r,0),n]:void 0})}updateArrayVerticesInSheet(e,t){const r=Array();for(const[n,o]of this.arrayMapping.entries()){if(o.sheet!==e)continue;const s=t(n,o);void 0!==s&&(this.removeArray(n),r.push(s))}r.forEach(([e,t])=>{this.setArray(e,t)})}}},function(e,t,r){"use strict";t.__esModule=!0,t.collectAddressesDependentToRange=void 0;var n=r(77),o=r(150),s=r(152);t.collectAddressesDependentToRange=(e,t,r,i,a)=>{if(t instanceof s.RangeVertex){const e=t.range.intersectionWith(r);return void 0!==e?Array.from(e.addresses(a)):[]}let u,c;return t instanceof o.FormulaVertex?(u=t.getFormula(i),c=t.getAddress(i),(0,n.collectDependencies)(u,e).filter(e=>e instanceof n.AddressDependency).map(e=>e.dependency.toSimpleCellAddress(c)).filter(e=>r.addressInRange(e))):[]}},function(e,t,r){"use strict";t.__esModule=!0,t.FormulaVertex=t.FormulaCellVertex=t.ArrayVertex=void 0;var n=r(72),o=r(1),s=r(151),i=r(73),a=r(131),u=r(140),c=r(141);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
class l{constructor(e,t,r){this.formula=e,this.cellAddress=t,this.version=r}get width(){return 1}get height(){return 1}static fromAst(e,t,r,n){return r.isScalar()?new d(e,t,n):new h(e,t,r,n)}getFormula(e){return this.ensureRecentData(e),this.formula}ensureRecentData(e){if(this.version!=e.version()){const[t,r,n]=e.applyTransformations(this.formula,this.cellAddress,this.version);this.formula=t,this.cellAddress=r,this.version=n}}getAddress(e){return this.ensureRecentData(e),this.cellAddress}}t.FormulaVertex=l;class h extends l{constructor(e,t,r,n=0){super(e,t,n),r.isRef?this.array=new s.ErroredArray(new i.CellError(i.ErrorType.REF,a.ErrorMessage.NoSpaceForArrayResult),o.ArraySize.error()):this.array=new s.NotComputedArray(r)}get width(){return this.array.width()}get height(){return this.array.height()}get sheet(){return this.cellAddress.sheet}get leftCorner(){return this.cellAddress}setCellValue(e){if(e instanceof i.CellError)return this.setErrorValue(e),e;const t=s.ArrayValue.fromInterpreterValue(e);return t.resize(this.array.size),this.array=t,e}getCellValue(){if(this.array instanceof s.NotComputedArray)throw Error("Array not computed yet.");return this.array.simpleRangeValue()}valueOrUndef(){if(!(this.array instanceof s.NotComputedArray))return this.array.simpleRangeValue()}getArrayCellValue(e){const t=e.col-this.cellAddress.col,r=e.row-this.cellAddress.row;try{return this.array.get(t,r)}catch(e){return new i.CellError(i.ErrorType.REF)}}getArrayCellRawValue(e){const t=this.getArrayCellValue(e);return t instanceof i.CellError||t===u.EmptyValue?void 0:(0,u.getRawValue)(t)}setArrayCellValue(e,t){const r=e.col-this.cellAddress.col,n=e.row-this.cellAddress.row;this.array instanceof s.ArrayValue&&this.array.set(r,n,t)}setNoSpace(){return this.array=new s.ErroredArray(new i.CellError(i.ErrorType.SPILL,a.ErrorMessage.NoSpaceForArrayResult),o.ArraySize.error()),this.getCellValue()}getRange(){return n.AbsoluteCellRange.spanFrom(this.cellAddress,this.width,this.height)}getRangeOrUndef(){return n.AbsoluteCellRange.spanFromOrUndef(this.cellAddress,this.width,this.height)}setAddress(e){this.cellAddress=e}setFormula(e){this.formula=e}spansThroughSheetRows(e,t,r=t){return this.cellAddress.sheet===e&&this.cellAddress.row<=r&&t<this.cellAddress.row+this.height}spansThroughSheetColumn(e,t,r=t){return this.cellAddress.sheet===e&&this.cellAddress.col<=r&&t<this.cellAddress.col+this.width}isComputed(){return!(this.array instanceof s.NotComputedArray)}columnsFromArray(){return c.ColumnsSpan.fromNumberOfColumns(this.cellAddress.sheet,this.cellAddress.col,this.width)}rowsFromArray(){return c.RowsSpan.fromNumberOfRows(this.cellAddress.sheet,this.cellAddress.row,this.height)}ensureRecentData(e){}isLeftCorner(e){return(0,i.equalSimpleCellAddress)(this.cellAddress,e)}setErrorValue(e){this.array=new s.ErroredArray(e,this.array.size)}}t.ArrayVertex=h;class d extends l{constructor(e,t,r){super(e,t,r)}valueOrUndef(){return this.cachedCellValue}setCellValue(e){return this.cachedCellValue=e,this.cachedCellValue}getCellValue(){if(void 0!==this.cachedCellValue)return this.cachedCellValue;throw Error("Value of the formula cell is not computed.")}isComputed(){return void 0!==this.cachedCellValue}}t.FormulaCellVertex=d},function(e,t,r){"use strict";t.__esModule=!0,t.NotComputedArray=t.ErroredArray=t.ArrayValue=void 0,r(2);var n=r(1),o=r(140),s=r(139);t.NotComputedArray=
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
class{constructor(e){this.size=e}width(){return this.size.width}height(){return this.size.height}get(e,t){throw Error("Array not computed yet.")}simpleRangeValue(){throw Error("Array not computed yet.")}};class i{constructor(e){if(this.size=new n.ArraySize(e.length>0?e[0].length:0,e.length),this.array=e,this.size.width<=0||this.size.height<=0)throw Error("Incorrect array size")}static fromInterpreterValue(e){return e instanceof s.SimpleRangeValue?new i(e.data):new i([[e]])}simpleRangeValue(){return s.SimpleRangeValue.onlyValues(this.array)}addRows(e,t){this.array.splice(e,0,...this.nullArrays(t,this.width())),this.size.height+=t}addColumns(e,t){for(let r=0;r<this.height();r++)this.array[r].splice(e,0,...new Array(t).fill(o.EmptyValue));this.size.width+=t}removeRows(e,t){if(this.outOfBound(0,e)||this.outOfBound(0,t))throw Error("Array index out of bound");const r=t-e+1;this.array.splice(e,r),this.size.height-=r}removeColumns(e,t){if(this.outOfBound(e,0)||this.outOfBound(t,0))throw Error("Array index out of bound");const r=t-e+1;for(const t of this.array)t.splice(e,r);this.size.width-=r}nullArrays(e,t){const r=[];for(let n=0;n<e;++n)r.push(new Array(t).fill(o.EmptyValue));return r}get(e,t){if(this.outOfBound(e,t))throw Error("Array index out of bound");return this.array[t][e]}set(e,t,r){if(this.outOfBound(e,t))throw Error("Array index out of bound");this.array[t][e]=r}width(){return this.size.width}height(){return this.size.height}raw(){return this.array}resize(e){if(this.height()<e.height&&isFinite(e.height)&&this.addRows(this.height(),e.height-this.height()),this.height()>e.height)throw Error("Resizing to smaller array");if(this.width()<e.width&&isFinite(e.width)&&this.addColumns(this.width(),e.width-this.width()),this.width()>e.width)throw Error("Resizing to smaller array")}outOfBound(e,t){return e<0||t<0||t>this.size.height-1||e>this.size.width-1}}t.ArrayValue=i,t.ErroredArray=class{constructor(e,t){this.error=e,this.size=t}get(e,t){return this.error}width(){return this.size.width}height(){return this.size.height}simpleRangeValue(){return this.error}}},function(e,t,r){"use strict";t.__esModule=!0,t.RangeVertex=void 0,t.RangeVertex=
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
class{constructor(e){this.range=e,this.functionCache=new Map,this.criterionFunctionCache=new Map,this.dependentCacheRanges=new Set,this.bruteForce=!1}get start(){return this.range.start}get end(){return this.range.end}get sheet(){return this.range.start.sheet}getFunctionValue(e){return this.functionCache.get(e)}setFunctionValue(e,t){this.functionCache.set(e,t)}getCriterionFunctionValue(e,t){var r;return null===(r=this.getCriterionFunctionValues(e).get(t))||void 0===r?void 0:r[0]}getCriterionFunctionValues(e){var t;return null!==(t=this.criterionFunctionCache.get(e))&&void 0!==t?t:new Map}setCriterionFunctionValues(e,t){this.criterionFunctionCache.set(e,t)}addDependentCacheRange(e){e!==this&&this.dependentCacheRanges.add(e)}clearCache(){this.functionCache.clear(),this.criterionFunctionCache.clear(),this.dependentCacheRanges.forEach(e=>e.criterionFunctionCache.clear()),this.dependentCacheRanges.clear()}getStart(){return this.start}getEnd(){return this.end}}},function(e,t,r){"use strict";t.__esModule=!0,t.Graph=void 0,r(2);var n=r(154),o=r(155);t.Graph=
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
class{constructor(e){this.dependencyQuery=e,this.nodesSparseArray=[],this.edgesSparseArray=[],this.nodesIds=new Map,this.dirtyAndVolatileNodeIds=new o.ProcessableValue({dirty:[],volatile:[]},e=>this.processDirtyAndVolatileNodeIds(e)),this.infiniteRangeIds=new Set,this.changingWithStructureNodeIds=[],this.nextId=0}getNodes(){return this.nodesSparseArray.filter(e=>void 0!==e)}hasNode(e){return this.nodesIds.has(e)}existsEdge(e,t){const r=this.getNodeId(e),n=this.getNodeId(t);return void 0!==r&&void 0!==n&&this.edgesSparseArray[r].includes(n)}adjacentNodes(e){const t=this.getNodeId(e);if(void 0===t)throw this.missingNodeError(e);return new Set(this.edgesSparseArray[t].filter(e=>void 0!==e).map(e=>this.nodesSparseArray[e]))}adjacentNodesCount(e){const t=this.getNodeId(e);if(void 0===t)throw this.missingNodeError(e);return this.fixEdgesArrayForNode(t).length}addNodeAndReturnId(e){const t=this.nodesIds.get(e);if(void 0!==t)return t;const r=this.nextId;return this.nextId++,this.nodesSparseArray[r]=e,this.edgesSparseArray[r]=[],this.nodesIds.set(e,r),r}addEdge(e,t){const r=this.getNodeIdIfNotNumber(e),n=this.getNodeIdIfNotNumber(t);if(void 0===r)throw this.missingNodeError(e);if(void 0===n)throw this.missingNodeError(t);this.edgesSparseArray[r].includes(n)||this.edgesSparseArray[r].push(n)}removeNode(e){const t=this.getNodeId(e);if(void 0===t)throw this.missingNodeError(e);this.edgesSparseArray[t].length>0&&(this.edgesSparseArray[t].forEach(e=>this.dirtyAndVolatileNodeIds.rawValue.dirty.push(e)),this.dirtyAndVolatileNodeIds.markAsModified());const r=this.removeDependencies(e);return delete this.nodesSparseArray[t],delete this.edgesSparseArray[t],this.infiniteRangeIds.delete(t),this.nodesIds.delete(e),r}removeEdge(e,t){const r=this.getNodeIdIfNotNumber(e),n=this.getNodeIdIfNotNumber(t);if(void 0===r)throw this.missingNodeError(e);if(void 0===n)throw this.missingNodeError(t);const o=this.edgesSparseArray[r].indexOf(n);if(-1===o)throw new Error("Edge does not exist");delete this.edgesSparseArray[r][o]}removeEdgeIfExists(e,t){const r=this.getNodeId(e),n=this.getNodeId(t);if(void 0===r)return;if(void 0===n)return;const o=this.edgesSparseArray[r].indexOf(n);-1!==o&&delete this.edgesSparseArray[r][o]}topSortWithScc(){return this.getTopSortedWithSccSubgraphFrom(this.getNodes(),()=>!0,()=>{})}getTopSortedWithSccSubgraphFrom(e,t,r){const o=new n.TopSort(this.nodesSparseArray,this.edgesSparseArray),s=e.map(e=>this.getNodeId(e)).filter(e=>void 0!==e);return o.getTopSortedWithSccSubgraphFrom(s,t,r)}markNodeAsVolatile(e){const t=this.getNodeId(e);void 0!==t&&(this.dirtyAndVolatileNodeIds.rawValue.volatile.push(t),this.dirtyAndVolatileNodeIds.markAsModified())}markNodeAsDirty(e){const t=this.getNodeId(e);void 0!==t&&(this.dirtyAndVolatileNodeIds.rawValue.dirty.push(t),this.dirtyAndVolatileNodeIds.markAsModified())}getDirtyAndVolatileNodes(){return this.dirtyAndVolatileNodeIds.getProcessedValue()}clearDirtyNodes(){this.dirtyAndVolatileNodeIds.rawValue.dirty=[],this.dirtyAndVolatileNodeIds.markAsModified()}markNodeAsChangingWithStructure(e){const t=this.getNodeId(e);void 0!==t&&this.changingWithStructureNodeIds.push(t)}markChangingWithStructureNodesAsDirty(){this.changingWithStructureNodeIds.length<=0||(this.dirtyAndVolatileNodeIds.rawValue.dirty=[...this.dirtyAndVolatileNodeIds.rawValue.dirty,...this.changingWithStructureNodeIds],this.dirtyAndVolatileNodeIds.markAsModified())}markNodeAsInfiniteRange(e){const t=this.getNodeIdIfNotNumber(e);void 0!==t&&this.infiniteRangeIds.add(t)}getInfiniteRanges(){return[...this.infiniteRangeIds].map(e=>({node:this.nodesSparseArray[e],id:e}))}getNodeId(e){return this.nodesIds.get(e)}getNodeIdIfNotNumber(e){return"number"==typeof e?e:this.nodesIds.get(e)}fixEdgesArrayForNode(e){const t=this.edgesSparseArray[e];return this.edgesSparseArray[e]=t.filter(e=>void 0!==e&&this.nodesSparseArray[e]),this.edgesSparseArray[e]}removeDependencies(e){const t=this.dependencyQuery(e);return t.forEach(([t,r])=>{this.removeEdgeIfExists(r,e)}),t}processDirtyAndVolatileNodeIds({dirty:e,volatile:t}){return[...new Set([...e,...t])].map(e=>this.nodesSparseArray[e]).filter(e=>void 0!==e)}missingNodeError(e){return new Error("Unknown node "+e)}}},function(e,t,r){"use strict";
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
var n;t.__esModule=!0,t.TopSort=void 0,r(2),function(e){e[e.ON_STACK=0]="ON_STACK",e[e.PROCESSED=1]="PROCESSED",e[e.POPPED=2]="POPPED"}(n||(n={})),t.TopSort=class{constructor(e=[],t=[]){this.nodesSparseArray=e,this.edgesSparseArray=t,this.entranceTime=[],this.low=[],this.parent=[],this.inSCC=[],this.nodeStatus=[],this.order=[],this.sccNonSingletons=[],this.timeCounter=0}getTopSortedWithSccSubgraphFrom(e,t,r){const n=e.reverse();return n.forEach(e=>this.runDFS(e)),this.postprocess(n,r,t)}getAdjacentNodeIds(e){return this.edgesSparseArray[e].filter(e=>void 0!==e&&this.nodesSparseArray[e])}runDFS(e){if(void 0!==this.nodeStatus[e])return;this.nodeStatus[e]=n.ON_STACK;const t=[e],r=[];for(;t.length>0;){const e=t[t.length-1];switch(this.nodeStatus[e]){case n.ON_STACK:this.handleOnStack(e,r,t);break;case n.PROCESSED:this.handleProcessed(e,r,t);break;case n.POPPED:t.pop()}}}handleOnStack(e,t,r){this.entranceTime[e]=this.timeCounter,this.low[e]=this.timeCounter,this.timeCounter++,t.push(e),this.getAdjacentNodeIds(e).forEach(t=>{void 0===this.entranceTime[t]&&(r.push(t),this.parent[t]=e,this.nodeStatus[t]=n.ON_STACK)}),this.nodeStatus[e]=n.PROCESSED}handleProcessed(e,t,r){let o=this.entranceTime[e];if(this.getAdjacentNodeIds(e).forEach(t=>{this.inSCC[t]||(o=this.parent[t]===e?Math.min(o,this.low[t]):Math.min(o,this.entranceTime[t]))}),this.low[e]=o,o===this.entranceTime[e]){const r=[];do{r.push(t[t.length-1]),t.pop()}while(r[r.length-1]!==e);r.forEach(e=>{this.inSCC[e]=!0}),this.order.push(...r),r.length>1&&r.forEach(e=>{this.sccNonSingletons[e]=!0})}r.pop(),this.nodeStatus[e]=n.POPPED}postprocess(e,t,r){const n=[];e.forEach(e=>{n[e]=!0});const o=[],s=[];return this.order.reverse(),this.order.forEach(e=>{const i=this.getAdjacentNodeIds(e);this.sccNonSingletons[e]||i.includes(e)?(s.push(this.nodesSparseArray[e]),t(this.nodesSparseArray[e]),i.forEach(e=>n[e]=!0)):(o.push(this.nodesSparseArray[e]),n[e]&&r(this.nodesSparseArray[e])&&i.forEach(e=>n[e]=!0))}),{sorted:o,cycled:s}}}},function(e,t,r){"use strict";t.__esModule=!0,t.ProcessableValue=void 0,t.ProcessableValue=
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
class{constructor(e,t){this.rawValue=e,this.processFn=t,this.processedValue=null}getProcessedValue(){return null===this.processedValue&&(this.processedValue=this.processFn(this.rawValue)),this.processedValue}markAsModified(){this.processedValue=null}}},function(e,t,r){"use strict";t.__esModule=!0,t.RangeMapping=void 0,r(2);var n=r(72),o=r(73);function s(e,t){return`${e.col},${e.row},${t.col},${t.row}`}t.RangeMapping=
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
class{constructor(){this.rangeMapping=new Map}getMappingSize(e){var t,r;return null!==(r=null===(t=this.rangeMapping.get(e))||void 0===t?void 0:t.size)&&void 0!==r?r:0}setRange(e){let t=this.rangeMapping.get(e.getStart().sheet);void 0===t&&(t=new Map,this.rangeMapping.set(e.getStart().sheet,t));const r=s(e.getStart(),e.getEnd());t.set(r,e)}removeRange(e){const t=e.getStart().sheet,r=this.rangeMapping.get(t);if(void 0===r)return;const n=s(e.getStart(),e.getEnd());r.delete(n),0===r.size&&this.rangeMapping.delete(t)}getRange(e,t){const r=this.rangeMapping.get(e.sheet),n=s(e,t);return null==r?void 0:r.get(n)}fetchRange(e,t){const r=this.getRange(e,t);if(!r)throw Error("Range does not exist");return r}truncateRanges(e,t){const r=Array(),n=Array(),o=Array(),a=e.sheet;for(const[s,i]of this.entriesFromSheet(e.sheet)){const u=i.range;e.start<=t(i.range.end)&&(u.removeSpan(e),u.shouldBeRemoved()?(this.removeByKey(a,s),r.push(i)):n.push([s,i]),o.push(i))}const u=[];n.sort((e,r)=>i(e[1],r[1],t));for(const[e,t]of n){const r=s((c=t.range).start,c.end);if(r===e)continue;const n=this.getByKey(a,r);this.removeByKey(a,e),void 0!==n&&t!=n?u.push([n,t]):this.setRange(t)}var c;return{verticesToRemove:r,verticesToMerge:u,verticesWithChangedSize:o}}moveAllRangesInSheetAfterRowByRows(e,t,r){return this.updateVerticesFromSheet(e,(e,n)=>t<=n.start.row?(n.range.shiftByRows(r),{changedSize:!1,vertex:n}):t>n.start.row&&t<=n.end.row?(n.range.expandByRows(r),{changedSize:!0,vertex:n}):void 0)}moveAllRangesInSheetAfterColumnByColumns(e,t,r){return this.updateVerticesFromSheet(e,(e,n)=>t<=n.start.col?(n.range.shiftByColumns(r),{changedSize:!1,vertex:n}):t>n.start.col&&t<=n.end.col?(n.range.expandByColumns(r),{changedSize:!0,vertex:n}):void 0)}moveRangesInsideSourceRange(e,t,r,n){this.updateVerticesFromSheet(e.sheet,(o,s)=>e.containsRange(s.range)?(s.range.shiftByColumns(t),s.range.shiftByRows(r),s.range.moveToSheet(n),{changedSize:!1,vertex:s}):void 0)}removeRangesInSheet(e){if(this.rangeMapping.has(e)){const t=this.rangeMapping.get(e).values();return this.rangeMapping.delete(e),t}return[][Symbol.iterator]()}*rangesInSheet(e){const t=this.rangeMapping.get(e);t&&(yield*t.values())}*rangeVerticesContainedInRange(e){for(const t of this.rangesInSheet(e.sheet))e.containsRange(t.range)&&(yield t)}findSmallerRange(e){if(e.height()>1&&Number.isFinite(e.height())){const t=(0,o.simpleCellAddress)(e.end.sheet,e.end.col,e.end.row-1),r=this.getRange(e.start,t);if(void 0!==r)return{smallerRangeVertex:r,restRange:n.AbsoluteCellRange.fromSimpleCellAddresses((0,o.simpleCellAddress)(e.start.sheet,e.start.col,e.end.row),e.end)}}return{restRange:e}}*entriesFromSheet(e){const t=this.rangeMapping.get(e);t&&(yield*t.entries())}removeByKey(e,t){this.rangeMapping.get(e).delete(t)}getByKey(e,t){var r;return null===(r=this.rangeMapping.get(e))||void 0===r?void 0:r.get(t)}updateVerticesFromSheet(e,t){const r=Array();for(const[n,o]of this.entriesFromSheet(e)){const s=t(n,o);void 0!==s&&(this.removeByKey(e,n),r.push(s))}return r.forEach(e=>{this.setRange(e.vertex)}),{verticesWithChangedSize:r.filter(e=>e.changedSize).map(e=>e.vertex)}}};const i=(e,t,r)=>{const n=r(e.range.start),o=r(e.range.start);return n===o?r(e.range.end)-r(t.range.end):n-o}},function(e,t,r){"use strict";t.__esModule=!0,t.SheetMapping=void 0;var n=r(147),o=r(158);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
function s(e){return e.toLowerCase()}class i{constructor(e,t){this.id=e,this.displayName=t}get canonicalName(){return s(this.displayName)}}t.SheetMapping=class{constructor(e){this.languages=e,this.mappingFromCanonicalName=new Map,this.mappingFromId=new Map,this.lastSheetId=-1,this.fetch=e=>{const t=this.mappingFromCanonicalName.get(s(e));if(void 0===t)throw new n.NoSheetWithNameError(e);return t.id},this.get=e=>{var t;return null===(t=this.mappingFromCanonicalName.get(s(e)))||void 0===t?void 0:t.id},this.fetchDisplayName=e=>this.fetchSheetById(e).displayName,this.sheetNamePrefix=e.getUITranslation(o.UIElement.NEW_SHEET_PREFIX)}addSheet(e=`${this.sheetNamePrefix}${this.lastSheetId+2}`){const t=s(e);if(this.mappingFromCanonicalName.has(t))throw new n.SheetNameAlreadyTakenError(e);this.lastSheetId++;const r=new i(this.lastSheetId,e);return this.store(r),r.id}removeSheet(e){const t=this.fetchSheetById(e);e==this.lastSheetId&&--this.lastSheetId,this.mappingFromCanonicalName.delete(t.canonicalName),this.mappingFromId.delete(t.id)}getDisplayName(e){var t;return null===(t=this.mappingFromId.get(e))||void 0===t?void 0:t.displayName}*displayNames(){for(const e of this.mappingFromCanonicalName.values())yield e.displayName}numberOfSheets(){return this.mappingFromCanonicalName.size}hasSheetWithId(e){return this.mappingFromId.has(e)}hasSheetWithName(e){return this.mappingFromCanonicalName.has(s(e))}renameSheet(e,t){const r=this.fetchSheetById(e),o=r.displayName;if(o===t)return;const i=this.mappingFromCanonicalName.get(s(t));if(void 0!==i&&i.id!==r.id)throw new n.SheetNameAlreadyTakenError(t);const a=r.canonicalName;return this.mappingFromCanonicalName.delete(a),r.displayName=t,this.store(r),o}sheetNames(){return Array.from(this.mappingFromId.values()).map(e=>e.displayName)}store(e){this.mappingFromId.set(e.id,e),this.mappingFromCanonicalName.set(e.canonicalName,e)}fetchSheetById(e){const t=this.mappingFromId.get(e);if(void 0===t)throw new n.NoSheetWithIdError(e);return t}}},function(e,t,r){"use strict";t.__esModule=!0,t.UIElement=void 0;var n,o=r(159);t.buildTranslationPackage=o.buildTranslationPackage,t.TranslationPackage=o.TranslationPackage,function(e){e.NEW_SHEET_PREFIX="NEW_SHEET_PREFIX"}(n||(t.UIElement=n={}))},function(e,t,r){"use strict";t.__esModule=!0,t.TranslationPackage=void 0,t.buildTranslationPackage=function(e){return new i(Object.assign({},e.functions),Object.assign({},e.errors),Object.assign({},e.ui))},r(2);var n=r(73),o=r(147),s=r(158);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
class i{constructor(e,t,r){this.functions=e,this.errors=t,this.ui=r,this._protectedTranslations={VERSION:"VERSION"},this.checkUI(),this.checkErrors(),this.checkFunctionTranslations(this.functions),Object.assign(this.functions,this._protectedTranslations)}extendFunctions(e){this.checkFunctionTranslations(e),Object.assign(this.functions,e)}buildFunctionMapping(){return Object.keys(this.functions).reduce((e,t)=>(e[this.functions[t]]=t,e),{})}buildErrorMapping(){return Object.keys(this.errors).reduce((e,t)=>(e[this.errors[t]]=t,e),{})}isFunctionTranslated(e){return void 0!==this.functions[e]}getFunctionTranslations(e){const t=[];for(const r of e)this.isFunctionTranslated(r)&&t.push(this.functions[r]);return t}getFunctionTranslation(e){const t=this.functions[e];if(void 0===t)throw new o.MissingTranslationError("functions."+e);return t}getMaybeFunctionTranslation(e){return this.functions[e]}getErrorTranslation(e){if(e===n.ErrorType.LIC)return`#${n.ErrorType.LIC}!`;const t=this.errors[e];if(void 0===t)throw new o.MissingTranslationError("errors."+e);return t}getUITranslation(e){const t=this.ui[e];if(void 0===t)throw new o.MissingTranslationError("ui."+e);return t}checkUI(){for(const e of Object.values(s.UIElement))if(!(e in this.ui))throw new o.MissingTranslationError("ui."+e)}checkErrors(){for(const e of Object.values(n.ErrorType))if(!(e in this.errors)&&e!==n.ErrorType.LIC)throw new o.MissingTranslationError("errors."+e)}checkFunctionTranslations(e){const t=new Set(Object.getOwnPropertyNames(e));for(const e of Object.getOwnPropertyNames(this._protectedTranslations))if(t.has(e))throw new o.ProtectedFunctionTranslationError(e)}}t.TranslationPackage=i},function(e,t,r){"use strict";t.__esModule=!0,t.EmptyCellVertex=void 0;var n=r(140);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */t.EmptyCellVertex=class{constructor(){}getCellValue(){return n.EmptyValue}}},function(e,t,r){"use strict";t.__esModule=!0,t.ValueCellVertex=void 0,t.ValueCellVertex=
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
class{constructor(e,t){this.parsedValue=e,this.rawValue=t}getValues(){return{parsedValue:this.parsedValue,rawValue:this.rawValue}}setValues(e){this.parsedValue=e.parsedValue,this.rawValue=e.rawValue}getCellValue(){return this.parsedValue}setCellValue(e){throw Error("SetCellValue is deprecated for ValueCellVertex")}}},function(e,t,r){"use strict";t.__esModule=!0,t.ParsingErrorVertex=void 0;var n=r(73);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */t.ParsingErrorVertex=class{constructor(e,t){this.errors=e,this.rawInput=t}getCellValue(){const e=this.errors.map(e=>e.message).find(e=>e);return n.CellError.parsingError(e)}getFormula(){return this.rawInput}}},function(e,t,r){"use strict";t.__esModule=!0,t.SparseStrategy=void 0;var n=r(73);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */t.SparseStrategy=class{constructor(e,t){this.width=e,this.height=t,this.mapping=new Map}getCell(e){var t;return null===(t=this.mapping.get(e.col))||void 0===t?void 0:t.get(e.row)}setCell(e,t){this.width=Math.max(this.width,e.col+1),this.height=Math.max(this.height,e.row+1);let r=this.mapping.get(e.col);r||(r=new Map,this.mapping.set(e.col,r)),r.set(e.row,t)}has(e){var t;return!!(null===(t=this.mapping.get(e.col))||void 0===t?void 0:t.get(e.row))}getHeight(){return this.height}getWidth(){return this.width}removeCell(e){var t;null===(t=this.mapping.get(e.col))||void 0===t||t.delete(e.row)}addRows(e,t){this.mapping.forEach(r=>{const n=new Map;r.forEach((o,s)=>{s>=e&&(n.set(s+t,o),r.delete(s))}),n.forEach((e,t)=>{r.set(t,e)})}),this.height+=t}addColumns(e,t){const r=new Map;this.mapping.forEach((n,o)=>{o>=e&&(r.set(o+t,n),this.mapping.delete(o))}),r.forEach((e,t)=>{this.mapping.set(t,e)}),this.width+=t}removeRows(e){this.mapping.forEach(t=>{const r=new Map;t.forEach((n,o)=>{o>=e.rowStart&&(t.delete(o),o>e.rowEnd&&r.set(o-e.numberOfRows,n))}),r.forEach((e,r)=>{t.set(r,e)})});const t=Math.min(this.height-1,e.rowEnd),r=Math.max(0,t-e.rowStart+1);this.height=Math.max(0,this.height-r)}removeColumns(e){const t=new Map;this.mapping.forEach((r,n)=>{n>=e.columnStart&&(this.mapping.delete(n),n>e.columnEnd&&t.set(n-e.numberOfColumns,r))}),t.forEach((e,t)=>{this.mapping.set(t,e)});const r=Math.min(this.width-1,e.columnEnd),n=Math.max(0,r-e.columnStart+1);this.width=Math.max(0,this.width-n)}*getEntries(e){for(const[t,r]of this.mapping)for(const[o,s]of r)yield[(0,n.simpleCellAddress)(e,t,o),s]}*verticesFromColumn(e){const t=this.mapping.get(e);if(void 0!==t)for(const[e,r]of t)yield r}*verticesFromRow(e){for(const t of this.mapping.values()){const r=t.get(e);void 0!==r&&(yield r)}}*verticesFromColumnsSpan(e){for(const t of e.columns()){const e=this.mapping.get(t);if(void 0!==e)for(const[t,r]of e)yield r}}*verticesFromRowsSpan(e){for(const t of this.mapping.values())for(const r of e.rows()){const e=t.get(r);void 0!==e&&(yield e)}}*entriesFromRowsSpan(e){for(const[t,r]of this.mapping.entries())for(const o of e.rows()){const s=r.get(o);void 0!==s&&(yield[(0,n.simpleCellAddress)(e.sheet,t,o),s])}}*entriesFromColumnsSpan(e){for(const t of e.columns()){const r=this.mapping.get(t);if(void 0!==r)for(const[o,s]of r.entries())yield[(0,n.simpleCellAddress)(e.sheet,t,o),s]}}*vertices(){for(const[e,t]of this.mapping)for(const[e,r]of t)void 0!==r&&(yield r)}}},function(e,t,r){"use strict";t.__esModule=!0,t.DenseStrategy=void 0,r(2);var n=r(73);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */t.DenseStrategy=class{constructor(e,t){this.width=e,this.height=t,this.mapping=new Array(t);for(let r=0;r<t;r++)this.mapping[r]=new Array(e)}getCell(e){return this.getCellVertex(e.col,e.row)}setCell(e,t){this.width=Math.max(this.width,e.col+1),this.height=Math.max(this.height,e.row+1),this.mapping[e.row]||(this.mapping[e.row]=new Array(this.width)),this.mapping[e.row][e.col]=t}has(e){const t=this.mapping[e.row];return!!t&&!!t[e.col]}getHeight(){return this.height}getWidth(){return this.width}removeCell(e){void 0!==this.mapping[e.row]&&delete this.mapping[e.row][e.col]}addRows(e,t){const r=[];for(let e=0;e<t;e++)r.push(new Array(this.width));this.mapping.splice(e,0,...r),this.height+=t}addColumns(e,t){for(let r=0;r<this.height;r++)void 0!==this.mapping[r]&&this.mapping[r].splice(e,0,...new Array(t));this.width+=t}removeRows(e){this.mapping.splice(e.rowStart,e.numberOfRows);const t=Math.min(this.height-1,e.rowEnd),r=Math.max(0,t-e.rowStart+1);this.height=Math.max(0,this.height-r)}removeColumns(e){for(let t=0;t<this.height;t++)void 0!==this.mapping[t]&&this.mapping[t].splice(e.columnStart,e.numberOfColumns);const t=Math.min(this.width-1,e.columnEnd),r=Math.max(0,t-e.columnStart+1);this.width=Math.max(0,this.width-r)}*getEntries(e){for(let t=0;t<this.height;++t)for(let r=0;r<this.width;++r){const o=this.getCellVertex(r,t);o&&(yield[(0,n.simpleCellAddress)(e,r,t),o])}}*verticesFromColumn(e){for(let t=0;t<this.height;++t){const r=this.getCellVertex(e,t);r&&(yield r)}}*verticesFromRow(e){for(let t=0;t<this.width;++t){const r=this.getCellVertex(t,e);r&&(yield r)}}*verticesFromColumnsSpan(e){for(let t=e.columnStart;t<=e.columnEnd;++t)for(let e=0;e<this.height;++e){const r=this.getCellVertex(t,e);r&&(yield r)}}*verticesFromRowsSpan(e){for(let t=0;t<this.width;++t)for(let r=e.rowStart;r<=e.rowEnd;++r){const e=this.getCellVertex(t,r);e&&(yield e)}}*entriesFromRowsSpan(e){for(let t=0;t<this.width;++t)for(let r=e.rowStart;r<=e.rowEnd;++r){const o=this.getCellVertex(t,r);o&&(yield[(0,n.simpleCellAddress)(e.sheet,t,r),o])}}*entriesFromColumnsSpan(e){for(let t=e.columnStart;t<=e.columnEnd;++t)for(let r=0;r<this.height;++r){const o=this.getCellVertex(t,r);o&&(yield[(0,n.simpleCellAddress)(e.sheet,t,r),o])}}*vertices(){for(let e=0;e<this.height;++e)for(let t=0;t<this.width;++t){const r=this.getCellVertex(t,e);r&&(yield r)}}getCellVertex(e,t){var r;return null===(r=this.mapping[t])||void 0===r?void 0:r[e]}}},function(e,t,r){"use strict";t.__esModule=!0,t.InterpreterState=void 0,t.InterpreterState=
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
class{constructor(e,t,r){this.formulaAddress=e,this.arraysFlag=t,this.formulaVertex=r}}},function(e,t,r){"use strict";t.__esModule=!0;var n=r(167);t.FunctionPlugin=n.FunctionPlugin,t.FunctionArgumentType=n.FunctionArgumentType;var o=r(140);t.EmptyValue=o.EmptyValue},function(e,t,r){"use strict";t.__esModule=!0,t.FunctionPlugin=t.FunctionArgumentType=void 0,r(2);var n,o=r(72),s=r(73),i=r(131),a=r(77),u=r(168),c=r(140),l=r(139);!function(e){e.STRING="STRING",e.NUMBER="NUMBER",e.BOOLEAN="BOOLEAN",e.SCALAR="SCALAR",e.NOERROR="NOERROR",e.RANGE="RANGE",e.INTEGER="INTEGER",e.COMPLEX="COMPLEX",e.ANY="ANY"}(n||(t.FunctionArgumentType=n={})),t.FunctionPlugin=class{constructor(e){this.coerceScalarToNumberOrError=e=>this.arithmeticHelper.coerceScalarToNumberOrError(e),this.runFunction=(e,t,r,n)=>{const o=this.evaluateArguments(e,t,r),a=o.map(([e,t])=>e),u=o.map(([e,t])=>t),c=this.buildMetadataForEachArgumentValue(a.length,r),h=t.arraysFlag&&!r.vectorizationForbidden;if(!this.isNumberOfArgumentValuesValid(c,a.length))return new s.CellError(s.ErrorType.NA,i.ErrorMessage.WrongArgNumber);const[d,p]=h?this.calculateSizeOfVectorizedResultArray(a,c):[1,1];if(1===d&&1===p){const e=this.vectorizeAndBroadcastArgumentsIfNecessary(h,a,c,0,0);return this.calculateSingleCellOfResultArray(t,e,c,u,n,r.returnNumberType)}const m=[...Array(d).keys()].map(e=>[...Array(p).keys()].map(o=>{const s=this.vectorizeAndBroadcastArgumentsIfNecessary(h,a,c,e,o),i=this.calculateSingleCellOfResultArray(t,s,c,u,n,r.returnNumberType);if(i instanceof l.SimpleRangeValue)throw new Error("Function returning array cannot be vectorized.");return i}));return l.SimpleRangeValue.onlyValues(m)},this.runFunctionWithReferenceArgument=(e,t,r,n,u,c=(()=>new s.CellError(s.ErrorType.NA,i.ErrorMessage.CellRefExpected)))=>{if(0===e.length)return this.returnNumberWrapper(n(),r.returnNumberType);if(e.length>1)return new s.CellError(s.ErrorType.NA,i.ErrorMessage.WrongArgNumber);let l,h=e[0];for(;h.type===a.AstNodeType.PARENTHESIS;)h=h.expression;if(h.type===a.AstNodeType.CELL_REFERENCE)l=h.reference.toSimpleCellAddress(t.formulaAddress);else if(h.type===a.AstNodeType.CELL_RANGE||h.type===a.AstNodeType.COLUMN_RANGE||h.type===a.AstNodeType.ROW_RANGE)try{l=o.AbsoluteCellRange.fromAst(h,t.formulaAddress).start}catch(e){return new s.CellError(s.ErrorType.REF,i.ErrorMessage.CellRefExpected)}return void 0!==l?this.returnNumberWrapper(u(l),r.returnNumberType):this.runFunction(e,t,r,c)},this.interpreter=e,this.dependencyGraph=e.dependencyGraph,this.columnSearch=e.columnSearch,this.config=e.config,this.serialization=e.serialization,this.arraySizePredictor=e.arraySizePredictor,this.dateTimeHelper=e.dateTimeHelper,this.arithmeticHelper=e.arithmeticHelper}evaluateAst(e,t){return this.interpreter.evaluateAst(e,t)}arraySizeForAst(e,t){return this.arraySizePredictor.checkArraySizeForAst(e,t)}listOfScalarValues(e,t){const r=[];for(const n of e){const e=this.evaluateAst(n,t);if(e instanceof l.SimpleRangeValue)for(const t of e.valuesFromTopLeftCorner())r.push([t,!0]);else r.push([e,!1])}return r}coerceToType(e,t,r){let o;if(e instanceof l.SimpleRangeValue)switch(t.argumentType){case n.RANGE:case n.ANY:o=e;break;default:{const t=(0,u.coerceRangeToScalar)(e,r);if(void 0===t)return;e=t}}if(!(e instanceof l.SimpleRangeValue))switch(t.argumentType){case n.INTEGER:case n.NUMBER:const r=this.coerceScalarToNumberOrError(e);if(!(0,c.isExtendedNumber)(r)){o=r;break}const a=(0,c.getRawValue)(r);if(void 0!==t.maxValue&&a>t.maxValue)return new s.CellError(s.ErrorType.NUM,i.ErrorMessage.ValueLarge);if(void 0!==t.minValue&&a<t.minValue)return new s.CellError(s.ErrorType.NUM,i.ErrorMessage.ValueSmall);if(void 0!==t.lessThan&&a>=t.lessThan)return new s.CellError(s.ErrorType.NUM,i.ErrorMessage.ValueLarge);if(void 0!==t.greaterThan&&a<=t.greaterThan)return new s.CellError(s.ErrorType.NUM,i.ErrorMessage.ValueSmall);if(t.argumentType===n.INTEGER&&!Number.isInteger(a))return new s.CellError(s.ErrorType.NUM,i.ErrorMessage.IntegerExpected);o=r;break;case n.STRING:o=(0,u.coerceScalarToString)(e);break;case n.BOOLEAN:o=(0,u.coerceScalarToBoolean)(e);break;case n.SCALAR:case n.NOERROR:case n.ANY:o=e;break;case n.RANGE:if(e instanceof s.CellError)return e;o=(0,u.coerceToRange)(e);break;case n.COMPLEX:return this.arithmeticHelper.coerceScalarToComplex((0,c.getRawValue)(e))}return t.passSubtype||void 0===o?o:(0,c.getRawValue)(o)}calculateSingleCellOfResultArray(e,t,r,n,o,i){const a=this.coerceArgumentsToRequiredTypes(e,t,r,n);if(a instanceof s.CellError)return a;const u=o(...a);return this.returnNumberWrapper(u,i)}coerceArgumentsToRequiredTypes(e,t,r,o){const a=[];for(let u=0;u<r.length;u++){const c=r[u],l=void 0!==t[u]?t[u]:null==c?void 0:c.defaultValue;if(void 0===l){a.push(void 0);continue}const h=this.coerceToType(l,c,e);if(void 0===h&&!o[u])return new s.CellError(s.ErrorType.VALUE,i.ErrorMessage.WrongType);if(h instanceof s.CellError&&c.argumentType!==n.SCALAR)return h;a.push(h)}return a}vectorizeAndBroadcastArgumentsIfNecessary(e,t,r,n,o){return t.map((t,s)=>e&&this.isRangePassedAsAScalarArgument(t,r[s])?this.vectorizeAndBroadcastRangeArgument(t,n,o):t)}vectorizeAndBroadcastRangeArgument(e,t,r){var n;const o=1===e.height()?0:t,s=1===e.width()?0:r;return null===(n=e.data[o])||void 0===n?void 0:n[s]}evaluateArguments(e,t,r){return r.expandRanges?this.listOfScalarValues(e,t):e.map(e=>[this.evaluateAst(e,t),!1])}buildMetadataForEachArgumentValue(e,t){const r=t.parameters?[...t.parameters]:[];if(void 0!==t.repeatLastArgs&&Number.isInteger(t.repeatLastArgs)&&t.repeatLastArgs>0)for(;e>r.length;)r.push(...r.slice(r.length-t.repeatLastArgs));return r}isNumberOfArgumentValuesValid(e,t){return!(t>e.length)&&(!(t<e.length)||e.slice(t).every(e=>(null==e?void 0:e.optionalArg)||void 0!==(null==e?void 0:e.defaultValue)))}calculateSizeOfVectorizedResultArray(e,t){const r=e.filter((e,r)=>this.isRangePassedAsAScalarArgument(e,t[r]));return[Math.max(1,...r.map(e=>e.height())),Math.max(1,...r.map(e=>e.width()))]}isRangePassedAsAScalarArgument(e,t){return null!=e&&null!=t&&e instanceof l.SimpleRangeValue&&![n.RANGE,n.ANY].includes(t.argumentType)}metadata(e){const t=this.constructor.implementedFunctions[e];if(void 0!==t)return t;throw new Error(`No metadata for function ${e}.`)}returnNumberWrapper(e,t,r){return void 0!==t&&(0,c.isExtendedNumber)(e)?this.arithmeticHelper.ExtendedNumberFactory((0,c.getRawValue)(e),{type:t,format:r}):e}}},function(e,t,r){"use strict";t.__esModule=!0,t.ArithmeticHelper=void 0,t.coerceBooleanToNumber=c,t.coerceComplexToString=function([e,t],r){if(!isFinite(e)||!isFinite(t))return new n.CellError(n.ErrorType.NUM,o.ErrorMessage.NaN);if(r=null!=r?r:"i",0===t)return""+e;const s=`${-1===t||1===t?"":Math.abs(t)}${r}`;return 0===e?`${t<0?"-":""}${s}`:`${e}${t<0?"-":"+"}${s}`},t.coerceEmptyToValue=l,t.coerceRangeToScalar=function(e,t){var r;if(e.isAdHoc())return null===(r=e.data[0])||void 0===r?void 0:r[0];const n=e.range;if(t.formulaAddress.sheet===n.sheet)if(1===n.width()){const r=t.formulaAddress.row-n.start.row;if(r>=0&&r<n.height())return e.data[r][0]}else if(1===n.height()){const r=t.formulaAddress.col-n.start.col;if(r>=0&&r<n.width())return e.data[0][r]}},t.coerceScalarToBoolean=function(e){if(e instanceof n.CellError||"boolean"==typeof e)return e;if(e===i.EmptyValue)return!1;if((0,i.isExtendedNumber)(e))return 0!==(0,i.getRawValue)(e);{const t=e.toUpperCase();return"TRUE"===t||"FALSE"!==t&&""!==t&&void 0}},t.coerceScalarToString=function(e){return e instanceof n.CellError||"string"==typeof e?e:e===i.EmptyValue?"":(0,i.isExtendedNumber)(e)?(0,i.getRawValue)(e).toString():e?"TRUE":"FALSE"},t.coerceToRange=function(e){return e instanceof a.SimpleRangeValue?e:a.SimpleRangeValue.fromScalar(e)},t.coerceToRangeNumbersOrError=function(e){return e instanceof a.SimpleRangeValue&&e.hasOnlyNumbers()||e instanceof n.CellError?e:(0,i.isExtendedNumber)(e)?a.SimpleRangeValue.fromScalar(e):null},t.fixNegativeZero=function(e){return 0===e?0:e},t.forceNormalizeString=function(e){return E(e.toLowerCase(),"nfd").replace(/[\u0300-\u036f]/g,"")},t.isNumberOverflow=function(e){return isNaN(e)||e===1/0||e===-1/0},t.normalizeString=E,t.numberCmp=h,t.zeroIfEmpty=function(e){return e===i.EmptyValue?0:e},r(2);var n=r(73),o=r(131),s=r(169),i=r(140),a=r(139);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
const u=/^\s*([+-]?)\s*(([\d\.,]+(e[+-]?\d+)?)\s*([ij]?)|([ij]))\s*(([+-])\s*([+-]?)\s*(([\d\.,]+(e[+-]?\d+)?)\s*([ij]?)|([ij])))?$/;function c(e){return Number(e)}function l(e){return"string"==typeof e?"":(0,i.isExtendedNumber)(e)?0:"boolean"!=typeof e&&i.EmptyValue}function h(e,t){const r=(0,i.getRawValue)(e),n=(0,i.getRawValue)(t);return r>n?1:r<n?-1:0}function d(e){return["*","?"].includes(e)}t.ArithmeticHelper=class{constructor(e,t,r){this.config=e,this.dateTimeHelper=t,this.numberLiteralsHelper=r,this.lt=(e,t)=>this.compare(e,t)<0,this.leq=(e,t)=>this.compare(e,t)<=0,this.gt=(e,t)=>this.compare(e,t)>0,this.geq=(e,t)=>this.compare(e,t)>=0,this.eq=(e,t)=>0===this.compare(e,t),this.neq=(e,t)=>0!==this.compare(e,t),this.pow=(e,t)=>Math.pow((0,i.getRawValue)(e),(0,i.getRawValue)(t)),this.addWithEpsilonRaw=(e,t)=>{const r=e+t;return Math.abs(r)<this.actualEps*Math.abs(e)?0:r},this.addWithEpsilon=(e,t)=>{const r=g(e,t);return this.ExtendedNumberFactory(this.addWithEpsilonRaw((0,i.getRawValue)(e),(0,i.getRawValue)(t)),r)},this.unaryMinus=e=>(0,i.cloneNumber)(e,-(0,i.getRawValue)(e)),this.unaryPlus=e=>e,this.unaryPercent=e=>new i.PercentNumber((0,i.getRawValue)(e)/100),this.concat=(e,t)=>e.concat(t),this.nonstrictadd=(e,t)=>e instanceof n.CellError?e:t instanceof n.CellError?t:"number"==typeof e?"number"==typeof t?this.addWithEpsilonRaw(e,t):e:"number"==typeof t?t:0,this.subtract=(e,t)=>{const r=g(e,t),n=(0,i.getRawValue)(e);let o=n-(0,i.getRawValue)(t);return Math.abs(o)<this.actualEps*Math.abs(n)&&(o=0),this.ExtendedNumberFactory(o,r)},this.divide=(e,t)=>{const r=(0,i.getRawValue)(e),o=(0,i.getRawValue)(t);if(0===o)return new n.CellError(n.ErrorType.DIV_BY_ZERO);{const n=f(e,t);return this.ExtendedNumberFactory(r/o,n)}},this.multiply=(e,t)=>{const r=f(e,t);return this.ExtendedNumberFactory((0,i.getRawValue)(e)*(0,i.getRawValue)(t),r)},this.manyToExactComplex=e=>{const t=[];for(const r of e){if(r instanceof n.CellError)return r;if((0,i.isExtendedNumber)(r)||"string"==typeof r){const e=this.coerceScalarToComplex(r);e instanceof n.CellError||t.push(e)}}return t},this.coerceNumbersExactRanges=e=>this.manyToNumbers(e,this.manyToExactNumbers),this.coerceNumbersCoerceRangesDropNulls=e=>this.manyToNumbers(e,this.manyToCoercedNumbersDropNulls),this.manyToExactNumbers=e=>{const t=[];for(const r of e){if(r instanceof n.CellError)return r;(0,i.isExtendedNumber)(r)&&t.push((0,i.getRawValue)(r))}return t},this.manyToOnlyNumbersDropNulls=e=>{const t=[];for(const r of e){if(r instanceof n.CellError)return r;if((0,i.isExtendedNumber)(r))t.push((0,i.getRawValue)(r));else if(r!==i.EmptyValue)return new n.CellError(n.ErrorType.VALUE,o.ErrorMessage.NumberExpected)}return t},this.manyToCoercedNumbersDropNulls=e=>{const t=[];for(const r of e){if(r instanceof n.CellError)return r;if(r===i.EmptyValue)continue;const e=this.coerceScalarToNumberOrError(r);(0,i.isExtendedNumber)(e)&&t.push((0,i.getRawValue)(e))}return t},this.collator=(0,s.collatorFromConfig)(e),this.actualEps=e.smartRounding?e.precisionEpsilon:0}eqMatcherFunction(e){const t=this.buildRegex(e);return e=>"string"==typeof e&&t.test(this.normalizeString(e))}neqMatcherFunction(e){const t=this.buildRegex(e);return e=>!("string"==typeof e&&t.test(this.normalizeString(e)))}searchString(e,t){var r;const n=this.buildRegex(e,!1).exec(t);return null!==(r=null==n?void 0:n.index)&&void 0!==r?r:-1}requiresRegex(e){if(!this.config.useRegularExpressions&&!this.config.useWildcards)return!this.config.matchWholeCell;for(let t=0;t<e.length;t++){const r=e.charAt(t);if(d(r)||this.config.useRegularExpressions&&m(r))return!0}return!1}floatCmp(e,t){const r=(0,i.getRawValue)(e),n=(0,i.getRawValue)(t),o=1+this.actualEps;return n>=0&&r*o>=n&&r<=n*o||n<=0&&r*o<=n&&r>=n*o?0:r>n?1:-1}coerceScalarToNumberOrError(e){var t;return e instanceof n.CellError?e:null!==(t=this.coerceToMaybeNumber(e))&&void 0!==t?t:new n.CellError(n.ErrorType.VALUE,o.ErrorMessage.NumberCoercion)}coerceToMaybeNumber(e){var t;return null!==(t=this.coerceNonDateScalarToMaybeNumber(e))&&void 0!==t?t:"string"==typeof e?this.dateTimeHelper.dateStringToDateNumber(e):void 0}coerceNonDateScalarToMaybeNumber(e){if(e===i.EmptyValue)return 0;if("string"==typeof e){if(""===e)return 0;const t=this.coerceStringToMaybePercentNumber(e);if(void 0!==t)return t;const r=this.coerceStringToMaybeCurrencyNumber(e);return void 0!==r?r:this.numberLiteralsHelper.numericStringToMaybeNumber(e.trim())}return(0,i.isExtendedNumber)(e)?e:"boolean"==typeof e?Number(e):void 0}coerceStringToMaybePercentNumber(e){const t=e.trim();if(t.endsWith("%")){const e=t.slice(0,t.length-1).trim(),r=this.numberLiteralsHelper.numericStringToMaybeNumber(e);if(void 0!==r)return new i.PercentNumber(r/100)}}coerceStringToMaybeCurrencyNumber(e){const t=this.currencyMatcher(e.trim());if(void 0!==t){const[e,r]=t,n=this.numberLiteralsHelper.numericStringToMaybeNumber(r);if(void 0!==n)return new i.CurrencyNumber(n,e)}}currencyMatcher(e){for(const t of this.config.currencySymbol){if(e.startsWith(t))return[t,e.slice(t.length).trim()];if(e.endsWith(t))return[t,e.slice(0,e.length-t.length).trim()]}}coerceComplexExactRanges(e){const t=[];for(const r of e)if(r instanceof a.SimpleRangeValue)t.push(r);else if(r!==i.EmptyValue){const e=this.coerceScalarToComplex(r);if(e instanceof n.CellError)return e;t.push(e)}const r=[];for(const e of t)if(e instanceof a.SimpleRangeValue){const t=this.manyToExactComplex(e.valuesFromTopLeftCorner());if(t instanceof n.CellError)return t;r.push(...t)}else r.push(e);return r}coerceScalarToComplex(e){return e instanceof n.CellError?e:e===i.EmptyValue?[0,0]:(0,i.isExtendedNumber)(e)?[(0,i.getRawValue)(e),0]:"string"==typeof e?this.coerceStringToComplex(e):new n.CellError(n.ErrorType.NUM,o.ErrorMessage.ComplexNumberExpected)}ExtendedNumberFactory(e,t){const{type:r,format:n}=t;switch(r){case i.NumberType.NUMBER_RAW:return e;case i.NumberType.NUMBER_CURRENCY:return new i.CurrencyNumber(e,null!=n?n:this.config.currencySymbol[0]);case i.NumberType.NUMBER_DATE:return new i.DateNumber(e,n);case i.NumberType.NUMBER_DATETIME:return new i.DateTimeNumber(e,n);case i.NumberType.NUMBER_TIME:return new i.TimeNumber(e,n);case i.NumberType.NUMBER_PERCENT:return new i.PercentNumber(e,n)}}buildRegex(e,t=!0){let r;e=this.normalizeString(e);let n=this.config.useWildcards,o=this.config.useRegularExpressions;if(o)try{RegExp(e)}catch(e){o=!1,n=!1}return r=o?function(e,t){let r="";for(let n=0;n<e.length;n++){const o=e.charAt(n);d(o)||m(o)?r+=o:r+=t?o:o.toLowerCase()}return r}(e,this.config.caseSensitive):n?function(e,t){let r="";for(let n=0;n<e.length;n++){const o=e.charAt(n);if("~"===o){if(n==e.length-1){r+="~";continue}const t=e.charAt(n+1);d(t)||m(t)?(r+="\\"+t,n++):(r+=t,n++)}else d(o)?r+="."+o:m(o)?r+="\\"+o:r+=t?o:o.toLowerCase()}return r}(e,this.config.caseSensitive):function(e,t){let r="";for(let n=0;n<e.length;n++){const o=e.charAt(n);d(o)||m(o)?r+="\\"+o:r+=t?o:o.toLowerCase()}return r}(e,this.config.caseSensitive),this.config.matchWholeCell&&t?RegExp("^("+r+")$"):RegExp(r)}normalizeString(e){return this.config.caseSensitive||(e=e.toLowerCase()),this.config.accentSensitive||(e=E(e,"nfd").replace(/[\u0300-\u036f]/g,"")),e}compare(e,t){if("string"==typeof e||"string"==typeof t){const r="string"==typeof e?this.dateTimeHelper.dateStringToDateNumber(e):e,n="string"==typeof t?this.dateTimeHelper.dateStringToDateNumber(t):t;if((0,i.isExtendedNumber)(r)&&(0,i.isExtendedNumber)(n))return this.floatCmp(r,n)}return e===i.EmptyValue?e=l(t):t===i.EmptyValue&&(t=l(e)),"string"==typeof e&&"string"==typeof t?this.stringCmp(e,t):"boolean"==typeof e&&"boolean"==typeof t?h(c(e),c(t)):(0,i.isExtendedNumber)(e)&&(0,i.isExtendedNumber)(t)?this.floatCmp(e,t):e===i.EmptyValue&&t===i.EmptyValue?0:h((0,n.CellValueTypeOrd)((0,n.getCellValueType)(e)),(0,n.CellValueTypeOrd)((0,n.getCellValueType)(t)))}stringCmp(e,t){return this.collator.compare(e,t)}manyToNumbers(e,t){const r=[];for(const t of e)if(t instanceof a.SimpleRangeValue)r.push(t);else{const e=(0,i.getRawValue)(this.coerceScalarToNumberOrError(t));if(e instanceof n.CellError)return e;r.push(e)}const o=[];for(const e of r)if(e instanceof a.SimpleRangeValue){const r=t(e.valuesFromTopLeftCorner());if(r instanceof n.CellError)return r;o.push(...r)}else o.push(e);return o}coerceStringToComplex(e){const t=u.exec(e);if(null===t)return new n.CellError(n.ErrorType.NUM,o.ErrorMessage.ComplexNumberExpected);let r,s;return r=void 0!==t[6]?"-"===t[1]?[0,-1]:[0,1]:this.parseComplexToken(t[1]+t[3],t[5]),r instanceof n.CellError||void 0===t[8]?r:(s=void 0!==t[14]?"-"===t[9]?[0,-1]:[0,1]:this.parseComplexToken(t[9]+t[11],t[13]),s instanceof n.CellError?s:""!==t[5]||""===t[13]?new n.CellError(n.ErrorType.NUM,o.ErrorMessage.ComplexNumberExpected):"+"===t[8]?[r[0]+s[0],r[1]+s[1]]:[r[0]-s[0],r[1]-s[1]])}parseComplexToken(e,t){const r=(0,i.getRawValue)(this.coerceNonDateScalarToMaybeNumber(e));return void 0===r?new n.CellError(n.ErrorType.NUM,o.ErrorMessage.ComplexNumberExpected):""===t?[r,0]:[0,r]}};const p=["{","}","[","]","(",")","<",">","=",".","+","-",",","\\","$","^","!"];function m(e){return p.includes(e)}function g(e,t){const{type:r,format:n}=(0,i.getTypeFormatOfExtendedNumber)(e),{type:o,format:s}=(0,i.getTypeFormatOfExtendedNumber)(t);if(r===i.NumberType.NUMBER_RAW)return{type:o,format:s};if(o===i.NumberType.NUMBER_RAW)return{type:r,format:n};if(!(r!==i.NumberType.NUMBER_DATETIME&&r!==i.NumberType.NUMBER_DATE||o!==i.NumberType.NUMBER_DATETIME&&o!==i.NumberType.NUMBER_DATE))return{type:i.NumberType.NUMBER_RAW};if(r===i.NumberType.NUMBER_TIME){if(o===i.NumberType.NUMBER_DATE)return{type:i.NumberType.NUMBER_DATETIME,format:`${s} ${n}`};if(o===i.NumberType.NUMBER_DATETIME)return{type:i.NumberType.NUMBER_DATETIME,format:s}}if(o===i.NumberType.NUMBER_TIME){if(r===i.NumberType.NUMBER_DATE)return{type:i.NumberType.NUMBER_DATETIME,format:`${n} ${s}`};if(r===i.NumberType.NUMBER_DATETIME)return{type:i.NumberType.NUMBER_DATETIME,format:n}}return{type:r,format:n}}function f(e,t){let{type:r,format:n}=(0,i.getTypeFormatOfExtendedNumber)(e),{type:o,format:s}=(0,i.getTypeFormatOfExtendedNumber)(t);return r===i.NumberType.NUMBER_PERCENT&&(r=i.NumberType.NUMBER_RAW,n=void 0),o===i.NumberType.NUMBER_PERCENT&&(o=i.NumberType.NUMBER_RAW,s=void 0),r===i.NumberType.NUMBER_RAW?{type:o,format:s}:o===i.NumberType.NUMBER_RAW?{type:r,format:n}:{type:i.NumberType.NUMBER_RAW}}function E(e,t){return e.normalize(t.toUpperCase())}},function(e,t,r){"use strict";t.__esModule=!0,t.collatorFromConfig=
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
function(e){const t=e.caseSensitive?e.accentSensitive?"variant":"case":e.accentSensitive?"accent":"base",r=e.caseFirst,n=e.ignorePunctuation;return new Intl.Collator(e.localeLang,{sensitivity:t,caseFirst:r,ignorePunctuation:n})}},function(e,t,r){"use strict";t.__esModule=!0,t.DetailedCellError=void 0,t.DetailedCellError=
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
class{constructor(e,t,r){var n;this.value=t,this.address=r,this.type=e.type,this.message=null!==(n=e.message)&&void 0!==n?n:""}toString(){return this.value}valueOf(){return this.value}}},function(e,t,r){"use strict";t.__esModule=!0,t.Config=void 0,t.getDefaultConfig=function(){return p({})};var n=r(172),o=r(173),s=r(174),i=r(175),a=r(147),u=r(176),c=r(178),l=r(180);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
const h=new WeakMap;class d{constructor(e={},t=!0){const{accentSensitive:r,binarySearchThreshold:o,caseSensitive:i,caseFirst:a,chooseAddressMappingPolicy:u,context:p,currencySymbol:m,dateFormats:g,decimalSeparator:f,evaluateNullToZero:E,functionArgSeparator:T,functionPlugins:y,ignorePunctuation:A,leapYear1900:R,localeLang:N,language:S,ignoreWhiteSpace:C,licenseKey:v,matchWholeCell:O,arrayColumnSeparator:I,arrayRowSeparator:M,maxRows:b,maxColumns:F,nullYear:w,nullDate:_,parseDateTime:L,precisionEpsilon:x,precisionRounding:P,stringifyDateTime:U,stringifyDuration:V,smartRounding:D,timeFormats:B,thousandSeparator:k,useArrayArithmetic:G,useStats:j,undoLimit:W,useColumnIndex:H,useRegularExpressions:z,useWildcards:Y}=e;t&&d.warnDeprecatedOptions(e),this.useArrayArithmetic=(0,n.configValueFromParam)(G,"boolean","useArrayArithmetic"),this.accentSensitive=(0,n.configValueFromParam)(r,"boolean","accentSensitive"),this.caseSensitive=(0,n.configValueFromParam)(i,"boolean","caseSensitive"),this.caseFirst=(0,n.configValueFromParam)(a,["upper","lower","false"],"caseFirst"),this.ignorePunctuation=(0,n.configValueFromParam)(A,"boolean","ignorePunctuation"),this.chooseAddressMappingPolicy=null!=u?u:d.defaultConfig.chooseAddressMappingPolicy,this.dateFormats=[...(0,n.configValueFromParamCheck)(g,Array.isArray,"array","dateFormats")],this.timeFormats=[...(0,n.configValueFromParamCheck)(B,Array.isArray,"array","timeFormats")],this.functionArgSeparator=(0,n.configValueFromParam)(T,"string","functionArgSeparator"),this.decimalSeparator=(0,n.configValueFromParam)(f,[".",","],"decimalSeparator"),this.language=(0,n.configValueFromParam)(S,"string","language"),this.ignoreWhiteSpace=(0,n.configValueFromParam)(C,["standard","any"],"ignoreWhiteSpace"),this.licenseKey=(0,n.configValueFromParam)(v,"string","licenseKey"),this.thousandSeparator=(0,n.configValueFromParam)(k,["",","," ","."],"thousandSeparator"),this.arrayColumnSeparator=(0,n.configValueFromParam)(I,[",",";"],"arrayColumnSeparator"),this.arrayRowSeparator=(0,n.configValueFromParam)(M,[";","|"],"arrayRowSeparator"),this.localeLang=(0,n.configValueFromParam)(N,"string","localeLang"),this.functionPlugins=[...null!=y?y:d.defaultConfig.functionPlugins],this.smartRounding=(0,n.configValueFromParam)(D,"boolean","smartRounding"),this.evaluateNullToZero=(0,n.configValueFromParam)(E,"boolean","evaluateNullToZero"),this.nullYear=(0,n.configValueFromParam)(w,"number","nullYear"),(0,n.validateNumberToBeAtLeast)(this.nullYear,"nullYear",0),(0,n.validateNumberToBeAtMost)(this.nullYear,"nullYear",100),this.precisionRounding=(0,n.configValueFromParam)(P,"number","precisionRounding"),(0,n.validateNumberToBeAtLeast)(this.precisionRounding,"precisionRounding",0),this.precisionEpsilon=(0,n.configValueFromParam)(x,"number","precisionEpsilon"),(0,n.validateNumberToBeAtLeast)(this.precisionEpsilon,"precisionEpsilon",0),this.useColumnIndex=(0,n.configValueFromParam)(H,"boolean","useColumnIndex"),this.useStats=(0,n.configValueFromParam)(j,"boolean","useStats"),this.binarySearchThreshold=null!=o?o:d.defaultConfig.binarySearchThreshold,this.parseDateTime=(0,n.configValueFromParam)(L,"function","parseDateTime"),this.stringifyDateTime=(0,n.configValueFromParam)(U,"function","stringifyDateTime"),this.stringifyDuration=(0,n.configValueFromParam)(V,"function","stringifyDuration"),this.translationPackage=l.HyperFormula.getLanguage(this.language),this.errorMapping=this.translationPackage.buildErrorMapping(),this.nullDate=(0,n.configValueFromParamCheck)(_,s.instanceOfSimpleDate,"IDate","nullDate"),this.leapYear1900=(0,n.configValueFromParam)(R,"boolean","leapYear1900"),this.undoLimit=(0,n.configValueFromParam)(W,"number","undoLimit"),this.useRegularExpressions=(0,n.configValueFromParam)(z,"boolean","useRegularExpressions"),this.useWildcards=(0,n.configValueFromParam)(Y,"boolean","useWildcards"),this.matchWholeCell=(0,n.configValueFromParam)(O,"boolean","matchWholeCell"),(0,n.validateNumberToBeAtLeast)(this.undoLimit,"undoLimit",0),this.maxRows=(0,n.configValueFromParam)(b,"number","maxRows"),(0,n.validateNumberToBeAtLeast)(this.maxRows,"maxRows",1),this.maxColumns=(0,n.configValueFromParam)(F,"number","maxColumns"),this.currencySymbol=this.setupCurrencySymbol(m),(0,n.validateNumberToBeAtLeast)(this.maxColumns,"maxColumns",1),this.context=p,h.set(this,{licenseKeyValidityState:(0,c.checkLicenseKeyValidity)(this.licenseKey)}),(0,n.configCheckIfParametersNotInConflict)({value:this.decimalSeparator,name:"decimalSeparator"},{value:this.functionArgSeparator,name:"functionArgSeparator"},{value:this.thousandSeparator,name:"thousandSeparator"}),(0,n.configCheckIfParametersNotInConflict)({value:this.arrayRowSeparator,name:"arrayRowSeparator"},{value:this.arrayColumnSeparator,name:"arrayColumnSeparator"})}setupCurrencySymbol(e){const t=[...(0,n.configValueFromParamCheck)(e,Array.isArray,"array","currencySymbol")];return t.forEach(e=>{if("string"!=typeof e)throw new a.ExpectedValueOfTypeError("string[]","currencySymbol");if(""===e)throw new a.ConfigValueEmpty("currencySymbol")}),t}get licenseKeyValidityState(){return h.get(this).licenseKeyValidityState}getConfig(){return p(this)}mergeConfig(e){const t=Object.assign({},this.getConfig(),e);return d.warnDeprecatedOptions(e),new d(t,!1)}static warnDeprecatedOptions(e){d.warnDeprecatedIfUsed(e.binarySearchThreshold,"binarySearchThreshold","1.1")}static warnDeprecatedIfUsed(e,t,r,n){void 0!==e&&(void 0===n?console.warn(`${t} option is deprecated since ${r}`):console.warn(`${t} option is deprecated since ${r}, please use ${n}`))}}function p(e){var t;const r={};for(const n in d.defaultConfig){const o=null!==(t=e[n])&&void 0!==t?t:d.defaultConfig[n];Array.isArray(o)?r[n]=[...o]:r[n]=o}return r}t.Config=d,d.defaultConfig={accentSensitive:!1,binarySearchThreshold:20,currencySymbol:["$"],caseSensitive:!1,caseFirst:"lower",context:void 0,chooseAddressMappingPolicy:new i.AlwaysDense,dateFormats:["DD/MM/YYYY","DD/MM/YY"],decimalSeparator:".",evaluateNullToZero:!1,functionArgSeparator:",",functionPlugins:[],ignorePunctuation:!1,language:"enGB",ignoreWhiteSpace:"standard",licenseKey:"",leapYear1900:!1,localeLang:"en",matchWholeCell:!0,arrayColumnSeparator:",",arrayRowSeparator:";",maxRows:4e4,maxColumns:18278,nullYear:30,nullDate:{year:1899,month:12,day:30},parseDateTime:o.defaultParseToDateTime,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,stringifyDateTime:u.defaultStringifyDateTime,stringifyDuration:u.defaultStringifyDuration,timeFormats:["hh:mm","hh:mm:ss.sss"],thousandSeparator:"",undoLimit:20,useRegularExpressions:!1,useWildcards:!0,useColumnIndex:!1,useStats:!1,useArrayArithmetic:!1}},function(e,t,r){"use strict";t.__esModule=!0,t.configCheckIfParametersNotInConflict=function(...e){const t=new Map;e.forEach(e=>{const r=t.get(e.value)||[];r.push(e.name),t.set(e.value,r)});const r=[];for(const e of t.values())e.length>1&&r.push(e);if(r.length>0){r.forEach(e=>e.sort());const e=r.map(e=>`[${e}]`).join("; ");throw new Error("Config initialization failed. Parameters in conflict: "+e)}},t.configValueFromParam=
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
function(e,t,r){if(void 0===e)return n.Config.defaultConfig[r];if("string"==typeof t){if(typeof e===t)return e;throw new o.ExpectedValueOfTypeError(t,r)}if(t.includes(e))return e;throw new o.ExpectedOneOfValuesError(t.map(e=>`'${e}'`).join(" "),r)},t.configValueFromParamCheck=function(e,t,r,s){if(t(e))return e;if(void 0===e)return n.Config.defaultConfig[s];throw new o.ExpectedValueOfTypeError(r,s)},t.validateArgToType=function(e,t,r){if(typeof e!==t)throw new o.ExpectedValueOfTypeError(t,r)},t.validateNumberToBeAtLeast=function(e,t,r){if(e<r)throw new o.ConfigValueTooSmallError(t,r)},t.validateNumberToBeAtMost=function(e,t,r){if(e>r)throw new o.ConfigValueTooBigError(t,r)},r(2);var n=r(171),o=r(147)},function(e,t,r){"use strict";t.__esModule=!0,t.TIME_FORMAT_SECONDS_ITEM_REGEXP=void 0,t.defaultParseToDateTime=function(e,t,r){if(void 0===t&&void 0===r)return;let n=e.replace(s," ").trim().toLowerCase();if(!function(e){return o.test(e)}(n))return;let a=n.substring(n.length-2);"am"===a||"pm"===a?n=n.substring(0,n.length-2).trim():(a=n.substring(n.length-1),"a"===a||"p"===a?n=n.substring(0,n.length-1).trim():a=void 0);const u=n.split(i);u.length>=2&&u[u.length-2].includes(":")&&(u[u.length-2]=u[u.length-2]+"."+u[u.length-1],u.pop());const h=u[u.length-1].split(":");if(void 0!==a&&h.push(a),1===u.length)return c(h,r);if(1===h.length)return l(u,t);const d=l(u.slice(0,u.length-1),t),p=c(h,r);return void 0===d||void 0===p?void 0:Object.assign(Object.assign({},d),p)},r(2);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
const n=t.TIME_FORMAT_SECONDS_ITEM_REGEXP=new RegExp("^ss(\\.(s+|0+))?$"),o=new RegExp("^[0-9/.\\-: ]+[ap]?m?$"),s=new RegExp("\\s+"),i=new RegExp("[ /.-]"),a=h((function(e){const t=e.toLowerCase().trim(),r=(t.endsWith("am/pm")?t.substring(0,t.length-5):t.endsWith("a/p")?t.substring(0,e.length-3):t).trim().split(":");return{itemsCount:r.length,hourItem:r.indexOf("hh"),minuteItem:r.indexOf("mm"),secondItem:r.findIndex(e=>n.test(e))}})),u=h((function(e){const t=e.toLowerCase().trim().split(i);return{itemsCount:t.length,dayItem:t.indexOf("dd"),monthItem:t.indexOf("mm"),shortYearItem:t.indexOf("yy"),longYearItem:t.indexOf("yyyy")}}));function c(e,t){var r,n,o;if(void 0===t)return;const{itemsCount:s,hourItem:i,minuteItem:u,secondItem:c}=a(t);let l=void 0;if("am"===e[e.length-1]||"a"===e[e.length-1]?(l=!1,e.pop()):"pm"!==e[e.length-1]&&"p"!==e[e.length-1]||(l=!0,e.pop()),e.length!==s)return;const h=Number(null!==(r=e[c])&&void 0!==r?r:"0");if(!Number.isFinite(h))return;const d=Math.round(1e3*h)/1e3,p=Number(null!==(n=e[u])&&void 0!==n?n:"0");if(!Number.isFinite(p)||!Number.isInteger(p))return;const m=Number(null!==(o=e[i])&&void 0!==o?o:"0");return!Number.isFinite(m)||!Number.isInteger(m)||void 0!==l&&(m<0||m>12)?void 0:{hours:void 0!==l?m%12+(l?12:0):m,minutes:p,seconds:d}}function l(e,t){var r;if(void 0===t)return;const{itemsCount:n,dayItem:o,monthItem:s,shortYearItem:i,longYearItem:a}=u(t);if(e.length!==n)return;const c=Number(e[o]);if(!Number.isFinite(c)||!Number.isInteger(c))return;const l=Number(e[s]);if(!Number.isFinite(l)||!Number.isInteger(l))return;if(e[a]&&e[i])return;const h=Number(null!==(r=e[a])&&void 0!==r?r:e[i]);return Number.isFinite(h)&&Number.isInteger(h)&&!(e[a]&&(h<1e3||h>9999)||e[i]&&(h<0||h>99))?{year:h,month:l,day:c}:void 0}function h(e){const t={};return r=>{const n=t[r];if(void 0!==n)return n;const o=e(r);return t[r]=o,o}}},function(e,t,r){"use strict";t.__esModule=!0,t.DateTimeHelper=void 0,t.instanceOfSimpleDate=i,t.instanceOfSimpleTime=a,t.maxDate=void 0,t.numberToSimpleTime=c,t.offsetMonth=function(e,t){const r=12*e.year+e.month-1+t;return{year:Math.floor(r/12),month:r%12+1,day:e.day}},t.roundToNearestSecond=function(e){return Math.round(3600*e*24)/86400},t.timeToNumber=l,t.toBasisEU=function(e){return{year:e.year,month:e.month,day:Math.min(30,e.day)}},t.truncateDayInMonth=function(e){return{year:e.year,month:e.month,day:Math.min(e.day,o[e.month-1])}};var n=r(140);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const o=[31,28,31,30,31,30,31,31,30,31,30,31],s=[0,31,59,90,120,151,181,212,243,273,304,334];function i(e){return!(!e||"object"!=typeof e&&"function"!=typeof e)&&"year"in e&&"number"==typeof e.year&&"month"in e&&"number"==typeof e.month&&"day"in e&&"number"==typeof e.day}function a(e){return!(!e||"object"!=typeof e&&"function"!=typeof e)&&"hours"in e&&"number"==typeof e.hours&&"minutes"in e&&"number"==typeof e.minutes&&"seconds"in e&&"number"==typeof e.seconds}const u=t.maxDate={year:9999,month:12,day:31};function c(e){const t=24*e*60*60,r=function(e,t=1){return Math.round(e*t)/t}(t%60,1e5)%60,n=(t-r)/60,o=Math.round(n%60)%60,s=(n-o)/60;return{hours:Math.round(s),minutes:o,seconds:r}}function l(e){return((e.seconds/60+e.minutes)/60+e.hours)/24}t.DateTimeHelper=class{constructor(e){this.config=e,this.minDateAbsoluteValue=this.dateToNumberFromZero(e.nullDate),this.maxDateValue=this.dateToNumber(u),this.leapYear1900=e.leapYear1900,!this.leapYear1900&&0<=this.dateToNumber({year:1900,month:2,day:28})?this.epochYearZero=this.numberToSimpleDate(2).year:this.epochYearZero=this.numberToSimpleDate(1).year,this.parseDateTime=e.parseDateTime}getWithinBounds(e){return e<=this.maxDateValue&&e>=0?e:void 0}dateStringToDateNumber(e){const{dateTime:t,dateFormat:r="",timeFormat:o=""}=this.parseDateTimeFromConfigFormats(e);if(void 0!==t)return a(t)?i(t)?new n.DateTimeNumber(l(t)+this.dateToNumber(t),r+" "+o):new n.TimeNumber(l(t),o):i(t)?new n.DateNumber(this.dateToNumber(t),r):0}parseDateTimeFromConfigFormats(e){return this.parseDateTimeFromFormats(e,this.config.dateFormats,this.config.timeFormats)}getNullYear(){return this.config.nullYear}getEpochYearZero(){return this.epochYearZero}isValidDate(e){return!(isNaN(e.year)||isNaN(e.month)||isNaN(e.day)||e.day!==Math.round(e.day)||e.month!==Math.round(e.month)||e.year!==Math.round(e.year)||e.year<1582||e.month<1||e.month>12||e.day<1||!(this.isLeapYear(e.year)&&2===e.month?e.day<=29:e.day<=o[e.month-1]))}dateToNumber(e){return this.dateToNumberFromZero(e)-this.minDateAbsoluteValue}relativeNumberToAbsoluteNumber(e){return e+this.minDateAbsoluteValue-(this.leapYear1900?1:0)}numberToSimpleDate(e){const t=Math.floor(e)+this.minDateAbsoluteValue;let r=Math.floor(t/365.2425);this.dateToNumberFromZero({year:r+1,month:1,day:1})<=t?r++:this.dateToNumberFromZero({year:r-1,month:1,day:1})>t&&r--;const n=t-this.dateToNumberFromZero({year:r,month:1,day:1}),o=function(e){let t=0;return s[t+6]<=e&&(t+=6),s[t+3]<=e&&(t+=3),s[t+2]<=e?t+=2:s[t+1]<=e&&(t+=1),t}(n-(this.isLeapYear(r)&&n>=59?1:0));return{year:r,month:o+1,day:n-s[o]-(this.isLeapYear(r)&&o>1?1:0)+1}}numberToSimpleDateTime(e){const t=c(e%1),r=Math.floor(t.hours/24);t.hours=t.hours%24;const n=this.numberToSimpleDate(Math.floor(e)+r);return Object.assign(Object.assign({},n),t)}leapYearsCount(e){return Math.floor(e/4)-Math.floor(e/100)+Math.floor(e/400)+(this.config.leapYear1900&&e>=1900?1:0)}daysInMonth(e,t){return this.isLeapYear(e)&&2===t?29:o[t-1]}endOfMonth(e){return{year:e.year,month:e.month,day:this.daysInMonth(e.year,e.month)}}toBasisUS(e,t){return 31===e.day&&(e.day=30),30===e.day&&31===t.day&&(t.day=30),2===e.month&&e.day===this.daysInMonth(e.year,e.month)&&(e.day=30,2===t.month&&t.day===this.daysInMonth(t.year,t.month)&&(t.day=30)),[e,t]}yearLengthForBasis(e,t){return e.year!==t.year?e.year+1!==t.year||e.month<t.month||e.month===t.month&&e.day<t.day?(this.leapYearsCount(t.year)-this.leapYearsCount(e.year-1))/(t.year-e.year+1)+365:this.countLeapDays(t)!==this.countLeapDays({year:e.year,month:e.month,day:e.day-1})?366:365:this.isLeapYear(e.year)?366:365}parseSingleFormat(e,t,r){const n=this.parseDateTime(e,t,r);if(!i(n)||(n.year>=0&&n.year<100&&(n.year<this.getNullYear()?n.year+=2e3:n.year+=1900),this.isValidDate(n)))return n}parseDateTimeFromFormats(e,t,r){const n=0===t.length?[void 0]:t,o=0===r.length?[void 0]:r;for(const t of n)for(const r of o){const n=this.parseSingleFormat(e,t,r);if(void 0!==n)return{dateTime:n,timeFormat:r,dateFormat:t}}return{}}countLeapDays(e){return e.month>2||2===e.month&&e.day>=29?this.leapYearsCount(e.year):this.leapYearsCount(e.year-1)}dateToNumberFromZero(e){return 365*e.year+s[e.month-1]+e.day-1+(e.month<=2?this.leapYearsCount(e.year-1):this.leapYearsCount(e.year))}isLeapYear(e){return!(e%4)&&(!!(e%100)||!(e%400)||1900===e&&this.config.leapYear1900)}}},function(e,t,r){"use strict";t.__esModule=!0,t.DenseSparseChooseBasedOnThreshold=t.AlwaysSparse=t.AlwaysDense=void 0;var n=r(164),o=r(163);t.DenseSparseChooseBasedOnThreshold=
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
class{constructor(e){this.threshold=e}call(e){return e>this.threshold?n.DenseStrategy:o.SparseStrategy}},t.AlwaysSparse=class{call(){return o.SparseStrategy}},t.AlwaysDense=class{call(){return n.DenseStrategy}}},function(e,t,r){"use strict";t.__esModule=!0,t.defaultStringifyDateTime=function(e,t){const r=(0,s.parseForDateTimeFormat)(t);if(void 0===r)return;const o=r.tokens;let a="",u=!1;const c=o.some(e=>e.type===s.TokenType.FORMAT&&("a/p"===e.value||"A/P"===e.value||"am/pm"===e.value||"AM/PM"===e.value));for(let t=0;t<o.length;t++){const r=o[t];if(r.type!==s.TokenType.FREE_TEXT)switch(r.value.toLowerCase()){case"h":case"hh":u=!0,a+=i(c?(e.hours+11)%12+1:e.hours,r.value.length);break;case"d":case"dd":a+=i(e.day,r.value.length);break;case"s":case"ss":a+=i(Math.floor(e.seconds),r.value.length);break;case"m":case"mm":t+1<o.length&&o[t+1].value.startsWith(":")&&(u=!0),a+=i(u?e.minutes:e.month,r.value.length),u=!0;break;case"yy":a+=i(e.year%100,r.value.length);break;case"yyyy":a+=e.year;break;case"am/pm":case"a/p":{const[t,n]=r.value.split("/");a+=e.hours<12?t:n;break}default:if(n.TIME_FORMAT_SECONDS_ITEM_REGEXP.test(r.value)){const t=r.value.length-3;a+=`${e.seconds<10?"0":""}${Math.floor(e.seconds*Math.pow(10,t))/Math.pow(10,t)}`;continue}return}else a+=r.value}return a},t.defaultStringifyDuration=function(e,t){const r=(0,s.parseForDateTimeFormat)(t);if(void 0===r)return;const o=r.tokens;let a="";for(const t of o)if(t.type!==s.TokenType.FREE_TEXT)switch(t.value.toLowerCase()){case"h":case"hh":a+=i(e.hours,t.value.length),e.hours=0;break;case"[hh]":a+=i(e.hours,t.value.length-2),e.hours=0;break;case"m":case"mm":a+=i(e.minutes,t.value.length),e.minutes=0;break;case"[mm]":a+=i(e.minutes+60*e.hours,t.value.length-2),e.minutes=0,e.hours=0;break;case"s":case"ss":a+=i(Math.floor(e.seconds),t.value.length);break;default:if(n.TIME_FORMAT_SECONDS_ITEM_REGEXP.test(t.value)){const r=Math.max(t.value.length-3,0);a+=`${e.seconds<10?"0":""}${Math.floor(e.seconds*Math.pow(10,r))/Math.pow(10,r)}`;continue}return}else a+=t.value;return a},t.format=
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
function(e,t,r,n){const c=r.stringifyDateTime(n.numberToSimpleDateTime(e),t);if(void 0!==c)return c;const l=r.stringifyDuration((0,o.numberToSimpleTime)(e),t);if(void 0!==l)return l;const h=(0,s.parseForNumberFormat)(t);return void 0!==h?function(e,t){let r="";for(let n=0;n<e.length;++n){const o=e[n];if(o.type===s.TokenType.FREE_TEXT){r+=o.value;continue}const c=o.value.split("."),l=c[0],h=c[1]||"",d=c[1]?".":"",p=Number(t.toFixed(h.length)).toString().split(".");let m=p[0]||"",g=p[1]||"";if(l.length>m.length){const e=u(l.substr(0,l.length-m.length),"0");m=i(m,e+m.length)}const f=u(h.substr(g.length,h.length-g.length),"0");g=a(g,f+g.length),r+=m+d+g}return r}(h.tokens,e):t},t.padLeft=i,t.padRight=a;var n=r(173),o=r(174),s=r(177);function i(e,t){let r=""+e;for(;r.length<t;)r="0"+r;return r}function a(e,t){let r=""+e;for(;r.length<t;)r+="0";return r}function u(e,t){return e.split(t).length-1}},function(e,t,r){"use strict";t.__esModule=!0,t.TokenType=t.FormatExpressionType=void 0,t.formatToken=a,t.isEscapeToken=h,t.parse=function(e){var t,r;return null!==(r=null!==(t=c(e))&&void 0!==t?t:l(e))&&void 0!==r?r:{type:i.STRING,tokens:[{type:s.FREE_TEXT,value:e}]}},t.parseForDateTimeFormat=c,t.parseForNumberFormat=l,r(2);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
const n=/(\\.|dd|DD|d|D|mm|MM|m|M|YYYY|YY|yyyy|yy|HH|hh|H|h|ss(\.(0+|s+))?|s|AM\/PM|am\/pm|A\/P|a\/p|\[mm]|\[MM]|\[hh]|\[HH])/g,o=/(\\.|[#0]+(\.[#0]*)?)/g;var s,i;function a(e,t){return{type:e,value:t}}function u(e,t){const r=[];let n=0;for(let o=0;o<e.length;++o){const i=e[o];if(i.index!==n){const e=t.substr(n,i.index-n);r.push(a(s.FREE_TEXT,e))}i[0].startsWith("\\")?r.push(a(s.FREE_TEXT,i[0])):r.push(a(s.FORMAT,i[0])),n=i.index+i[0].length}const o=e[e.length-1];if(o.index+o[0].length<t.length){const e=t.substr(o.index+o[0].length,t.length);r.push(a(s.FREE_TEXT,e))}return r}function c(e){const t=function(e){n.lastIndex=0;const t=[];let r;do{r=n.exec(e),null!==r&&t.push(r)}while(r);return t}(e);return t.every(e=>h(e))?void 0:{type:i.DATE,tokens:u(t,e)}}function l(e){const t=function(e){o.lastIndex=0;const t=o.exec(e);return null!==t?[t]:[]}(e);return t.every(e=>h(e))?void 0:{type:i.NUMBER,tokens:u(t,e)}}function h(e){return e[0].startsWith("\\")}!function(e){e.FORMAT="FORMAT",e.FREE_TEXT="FREE_TEXT"}(s||(t.TokenType=s={})),function(e){e.DATE="DATE",e.NUMBER="NUMBER",e.STRING="STRING"}(i||(t.FormatExpressionType=i={}))},function(e,t,r){"use strict";t.__esModule=!0,t.checkLicenseKeyValidity=function(e){const t={template:"missing",vars:{}};if("gpl-v3"===e||"internal-use-in-handsontable"===e)t.template="valid";else if("string"==typeof e&&(0,n.checkKeySchema)(e)){const[r,o,s]="18/07/2024".split("/"),i=Math.floor(new Date(`${o}/${r}/${s}`).getTime()/864e5),a=(0,n.extractTime)(e);t.vars.keyValidityDate=function(e){const t=["January","February","March","April","May","June","July","August","September","October","November","December"][e.getMonth()],r=e.getDate(),n=e.getFullYear();return`${t} ${r}, ${n}`}(new Date(864e5*(a+1))),t.template=i>a?"expired":"valid"}else""!==e&&(t.template="invalid");return s||"valid"===t.template||(console.warn(o[t.template](t.vars)),s=!0),t.template};var n=r(179);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const o={invalid:()=>"The license key for HyperFormula is invalid.",expired:({keyValidityDate:e})=>`The license key for HyperFormula expired on ${e}, and is not valid for the installed version.`,missing:()=>"The license key for HyperFormula is missing."};let s=!1},function(e,t,r){"use strict";t.__esModule=!0,t.checkKeySchema=function(e){if((e=(e+"").replace(/\-/g,""))[n]!==u("Z"))return!1;let t=0;return[[0,u("G")+1],[u("H"),u("H")-1],[u("G")+u("H"),u("G")]].reduce((r,[n,i],u)=>(r|=(s(""+s(o(a(e,t+n-(0===u?0:2),i+(u?2:0)))+(o(a(e,t+n+i,2))+[]).padStart(2,"0")))%97||2)>>1,t+=2,r),u("A"))===[]+1>>1},t.extractTime=function(e){return 25===i(e)[n]?o(a(i(e),o("12"),u("F")))/(o(a(i(e),u("C"),u("Y")>>4))||1+(~~![][n]<<3)):0};
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const n="length",o=e=>parseInt(e,16),s=e=>parseInt(e,10),i=e=>(e+"").replace(/\-/g,""),a=(e,t,r)=>e.substr(t,r),u=e=>e.codePointAt(0)-65},function(e,t,r){"use strict";t.__esModule=!0,t.HyperFormula=void 0;var n=r(72),o=r(172),s=r(181),i=r(73),a=r(182),u=r(171),c=r(174),l=r(213),h=r(214),d=r(147),p=r(158),m=r(200),g=r(186),f=r(77);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
class E{constructor(e,t,r,n,o,s,i,a,u,c,l,d,p,m){this._config=e,this._stats=t,this._dependencyGraph=r,this._columnSearch=n,this._parser=o,this._unparser=s,this._cellContentParser=i,this._evaluator=a,this._lazilyTransformingAstService=u,this._crudOperations=c,this._exporter=l,this._namedExpressions=d,this._serialization=p,this._functionRegistry=m,this._emitter=new h.Emitter,this._evaluationSuspended=!1}static get defaultConfig(){return(0,u.getDefaultConfig)()}get graph(){return this.dependencyGraph.graph}get rangeMapping(){return this.dependencyGraph.rangeMapping}get arrayMapping(){return this.dependencyGraph.arrayMapping}get sheetMapping(){return this.dependencyGraph.sheetMapping}get addressMapping(){return this.dependencyGraph.addressMapping}get dependencyGraph(){return this._dependencyGraph}get evaluator(){return this._evaluator}get columnSearch(){return this._columnSearch}get lazilyTransformingAstService(){return this._lazilyTransformingAstService}get licenseKeyValidityState(){return this._config.licenseKeyValidityState}static buildFromArray(e,t={},r=[]){return this.buildFromEngineState(s.BuildEngineFactory.buildFromSheet(e,t,r))}static buildFromSheets(e,t={},r=[]){return this.buildFromEngineState(s.BuildEngineFactory.buildFromSheets(e,t,r))}static buildEmpty(e={},t=[]){return this.buildFromEngineState(s.BuildEngineFactory.buildEmpty(e,t))}static getLanguage(e){(0,o.validateArgToType)(e,"string","languageCode");const t=this.registeredLanguages.get(e);if(void 0===t)throw new d.LanguageNotRegisteredError;return t}static registerLanguage(e,t){if((0,o.validateArgToType)(e,"string","languageCode"),this.registeredLanguages.has(e))throw new d.LanguageAlreadyRegisteredError;this.registeredLanguages.set(e,(0,p.buildTranslationPackage)(t))}static unregisterLanguage(e){if((0,o.validateArgToType)(e,"string","languageCode"),!this.registeredLanguages.has(e))throw new d.LanguageNotRegisteredError;this.registeredLanguages.delete(e)}static getRegisteredLanguagesCodes(){return Array.from(this.registeredLanguages.keys())}static registerFunctionPlugin(e,t){m.FunctionRegistry.registerFunctionPlugin(e,t)}static unregisterFunctionPlugin(e){m.FunctionRegistry.unregisterFunctionPlugin(e)}static registerFunction(e,t,r){(0,o.validateArgToType)(e,"string","functionId"),m.FunctionRegistry.registerFunction(e,t,r)}static unregisterFunction(e){(0,o.validateArgToType)(e,"string","functionId"),m.FunctionRegistry.unregisterFunction(e)}static unregisterAllFunctions(){m.FunctionRegistry.unregisterAll()}static getRegisteredFunctionNames(e){(0,o.validateArgToType)(e,"string","code");const t=m.FunctionRegistry.getRegisteredFunctionIds();return this.getLanguage(e).getFunctionTranslations(t)}static getFunctionPlugin(e){return(0,o.validateArgToType)(e,"string","functionId"),m.FunctionRegistry.getFunctionPlugin(e)}static getAllFunctionPlugins(){return m.FunctionRegistry.getPlugins()}static buildFromEngineState(e){return new E(e.config,e.stats,e.dependencyGraph,e.columnSearch,e.parser,e.unparser,e.cellContentParser,e.evaluator,e.lazilyTransformingAstService,e.crudOperations,e.exporter,e.namedExpressions,e.serialization,e.functionRegistry)}getCellValue(e){if(!(0,i.isSimpleCellAddress)(e))throw new d.ExpectedValueOfTypeError("SimpleCellAddress","cellAddress");return this.ensureEvaluationIsNotSuspended(),this._serialization.getCellValue(e)}getCellFormula(e){if(!(0,i.isSimpleCellAddress)(e))throw new d.ExpectedValueOfTypeError("SimpleCellAddress","cellAddress");return this._serialization.getCellFormula(e)}getCellHyperlink(e){if(!(0,i.isSimpleCellAddress)(e))throw new d.ExpectedValueOfTypeError("SimpleCellAddress","cellAddress");return this.ensureEvaluationIsNotSuspended(),this._serialization.getCellHyperlink(e)}getCellSerialized(e){if(!(0,i.isSimpleCellAddress)(e))throw new d.ExpectedValueOfTypeError("SimpleCellAddress","cellAddress");return this.ensureEvaluationIsNotSuspended(),this._serialization.getCellSerialized(e)}getSheetValues(e){return(0,o.validateArgToType)(e,"number","sheetId"),this.ensureEvaluationIsNotSuspended(),this._serialization.getSheetValues(e)}getSheetFormulas(e){return(0,o.validateArgToType)(e,"number","sheetId"),this._serialization.getSheetFormulas(e)}getSheetSerialized(e){return(0,o.validateArgToType)(e,"number","sheetId"),this.ensureEvaluationIsNotSuspended(),this._serialization.getSheetSerialized(e)}getAllSheetsDimensions(){return this._serialization.genericAllSheetsGetter(e=>this.getSheetDimensions(e))}getSheetDimensions(e){return(0,o.validateArgToType)(e,"number","sheetId"),{width:this.dependencyGraph.getSheetWidth(e),height:this.dependencyGraph.getSheetHeight(e)}}getAllSheetsValues(){return this.ensureEvaluationIsNotSuspended(),this._serialization.getAllSheetsValues()}getAllSheetsFormulas(){return this._serialization.getAllSheetsFormulas()}getAllSheetsSerialized(){return this.ensureEvaluationIsNotSuspended(),this._serialization.getAllSheetsSerialized()}updateConfig(e){Object.entries(e).every(([e,t])=>this._config[e]===t)||this.rebuildWithConfig(e)}getConfig(){return this._config.getConfig()}rebuildAndRecalculate(){this.rebuildWithConfig({})}getStats(){return this._stats.snapshot()}undo(){return this._crudOperations.undo(),this.recomputeIfDependencyGraphNeedsIt()}redo(){return this._crudOperations.redo(),this.recomputeIfDependencyGraphNeedsIt()}isThereSomethingToUndo(){return this._crudOperations.isThereSomethingToUndo()}isThereSomethingToRedo(){return this._crudOperations.isThereSomethingToRedo()}isItPossibleToSetCellContents(e){let t;if((0,i.isSimpleCellAddress)(e))t=new n.AbsoluteCellRange(e,e);else{if(!(0,n.isSimpleCellRange)(e))throw new d.ExpectedValueOfTypeError("SimpleCellAddress | SimpleCellRange","address");t=new n.AbsoluteCellRange(e.start,e.end)}try{this._crudOperations.ensureRangeInSizeLimits(t);for(const e of t.addresses(this._dependencyGraph))this._crudOperations.ensureItIsPossibleToChangeContent(e)}catch(e){return!1}return!0}setCellContents(e,t){return this._crudOperations.setCellContents(e,t),this.recomputeIfDependencyGraphNeedsIt()}swapRowIndexes(e,t){return(0,o.validateArgToType)(e,"number","sheetId"),this._crudOperations.setRowOrder(e,t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToSwapRowIndexes(e,t){(0,o.validateArgToType)(e,"number","sheetId");try{return this._crudOperations.validateSwapRowIndexes(e,t),this._crudOperations.testRowOrderForArrays(e,t),!0}catch(e){return!1}}setRowOrder(e,t){(0,o.validateArgToType)(e,"number","sheetId");const r=this._crudOperations.mappingFromOrder(e,t,"row");return this.swapRowIndexes(e,r)}isItPossibleToSetRowOrder(e,t){(0,o.validateArgToType)(e,"number","sheetId");try{const r=this._crudOperations.mappingFromOrder(e,t,"row");return this._crudOperations.validateSwapRowIndexes(e,r),this._crudOperations.testRowOrderForArrays(e,r),!0}catch(e){return!1}}swapColumnIndexes(e,t){return(0,o.validateArgToType)(e,"number","sheetId"),this._crudOperations.setColumnOrder(e,t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToSwapColumnIndexes(e,t){(0,o.validateArgToType)(e,"number","sheetId");try{return this._crudOperations.validateSwapColumnIndexes(e,t),this._crudOperations.testColumnOrderForArrays(e,t),!0}catch(e){return!1}}setColumnOrder(e,t){(0,o.validateArgToType)(e,"number","sheetId");const r=this._crudOperations.mappingFromOrder(e,t,"column");return this.swapColumnIndexes(e,r)}isItPossibleToSetColumnOrder(e,t){(0,o.validateArgToType)(e,"number","sheetId");try{const r=this._crudOperations.mappingFromOrder(e,t,"column");return this._crudOperations.validateSwapColumnIndexes(e,r),this._crudOperations.testColumnOrderForArrays(e,r),!0}catch(e){return!1}}isItPossibleToAddRows(e,...t){(0,o.validateArgToType)(e,"number","sheetId");const r=(0,g.normalizeAddedIndexes)(t);try{return this._crudOperations.ensureItIsPossibleToAddRows(e,...r),!0}catch(e){return!1}}addRows(e,...t){return(0,o.validateArgToType)(e,"number","sheetId"),this._crudOperations.addRows(e,...t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToRemoveRows(e,...t){(0,o.validateArgToType)(e,"number","sheetId");const r=(0,g.normalizeRemovedIndexes)(t);try{return this._crudOperations.ensureItIsPossibleToRemoveRows(e,...r),!0}catch(e){return!1}}removeRows(e,...t){return(0,o.validateArgToType)(e,"number","sheetId"),this._crudOperations.removeRows(e,...t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToAddColumns(e,...t){(0,o.validateArgToType)(e,"number","sheetId");const r=(0,g.normalizeAddedIndexes)(t);try{return this._crudOperations.ensureItIsPossibleToAddColumns(e,...r),!0}catch(e){return!1}}addColumns(e,...t){return(0,o.validateArgToType)(e,"number","sheetId"),this._crudOperations.addColumns(e,...t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToRemoveColumns(e,...t){(0,o.validateArgToType)(e,"number","sheetId");const r=(0,g.normalizeRemovedIndexes)(t);try{return this._crudOperations.ensureItIsPossibleToRemoveColumns(e,...r),!0}catch(e){return!1}}removeColumns(e,...t){return(0,o.validateArgToType)(e,"number","sheetId"),this._crudOperations.removeColumns(e,...t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToMoveCells(e,t){if(!(0,i.isSimpleCellAddress)(t))throw new d.ExpectedValueOfTypeError("SimpleCellAddress","destinationLeftCorner");if(!(0,n.isSimpleCellRange)(e))throw new d.ExpectedValueOfTypeError("SimpleCellRange","source");try{const r=new n.AbsoluteCellRange(e.start,e.end);return this._crudOperations.operations.ensureItIsPossibleToMoveCells(r.start,r.width(),r.height(),t),!0}catch(e){return!1}}moveCells(e,t){if(!(0,i.isSimpleCellAddress)(t))throw new d.ExpectedValueOfTypeError("SimpleCellAddress","destinationLeftCorner");if(!(0,n.isSimpleCellRange)(e))throw new d.ExpectedValueOfTypeError("SimpleCellRange","source");const r=new n.AbsoluteCellRange(e.start,e.end);return this._crudOperations.moveCells(r.start,r.width(),r.height(),t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToMoveRows(e,t,r,n){(0,o.validateArgToType)(e,"number","sheetId"),(0,o.validateArgToType)(t,"number","startRow"),(0,o.validateArgToType)(r,"number","numberOfRows"),(0,o.validateArgToType)(n,"number","targetRow");try{return this._crudOperations.ensureItIsPossibleToMoveRows(e,t,r,n),!0}catch(e){return!1}}moveRows(e,t,r,n){return(0,o.validateArgToType)(e,"number","sheetId"),(0,o.validateArgToType)(t,"number","startRow"),(0,o.validateArgToType)(r,"number","numberOfRows"),(0,o.validateArgToType)(n,"number","targetRow"),this._crudOperations.moveRows(e,t,r,n),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToMoveColumns(e,t,r,n){(0,o.validateArgToType)(e,"number","sheetId"),(0,o.validateArgToType)(t,"number","startColumn"),(0,o.validateArgToType)(r,"number","numberOfColumns"),(0,o.validateArgToType)(n,"number","targetColumn");try{return this._crudOperations.ensureItIsPossibleToMoveColumns(e,t,r,n),!0}catch(e){return!1}}moveColumns(e,t,r,n){return(0,o.validateArgToType)(e,"number","sheetId"),(0,o.validateArgToType)(t,"number","startColumn"),(0,o.validateArgToType)(r,"number","numberOfColumns"),(0,o.validateArgToType)(n,"number","targetColumn"),this._crudOperations.moveColumns(e,t,r,n),this.recomputeIfDependencyGraphNeedsIt()}copy(e){if(!(0,n.isSimpleCellRange)(e))throw new d.ExpectedValueOfTypeError("SimpleCellRange","source");const t=new n.AbsoluteCellRange(e.start,e.end);return this._crudOperations.copy(t.start,t.width(),t.height()),this.getRangeValues(e)}cut(e){if(!(0,n.isSimpleCellRange)(e))throw new d.ExpectedValueOfTypeError("SimpleCellRange","source");const t=new n.AbsoluteCellRange(e.start,e.end);return this._crudOperations.cut(t.start,t.width(),t.height()),this.getRangeValues(e)}paste(e){if(!(0,i.isSimpleCellAddress)(e))throw new d.ExpectedValueOfTypeError("SimpleCellAddress","targetLeftCorner");return this.ensureEvaluationIsNotSuspended(),this._crudOperations.paste(e),this.recomputeIfDependencyGraphNeedsIt()}isClipboardEmpty(){return this._crudOperations.isClipboardEmpty()}clearClipboard(){this._crudOperations.clearClipboard()}clearRedoStack(){this._crudOperations.undoRedo.clearRedoStack()}clearUndoStack(){this._crudOperations.undoRedo.clearUndoStack()}getRangeValues(e){if(!(0,n.isSimpleCellRange)(e))throw new d.ExpectedValueOfTypeError("SimpleCellRange","source");return new n.AbsoluteCellRange(e.start,e.end).arrayOfAddressesInRange().map(e=>e.map(e=>this.getCellValue(e)))}getRangeFormulas(e){if(!(0,n.isSimpleCellRange)(e))throw new d.ExpectedValueOfTypeError("SimpleCellRange","source");return new n.AbsoluteCellRange(e.start,e.end).arrayOfAddressesInRange().map(e=>e.map(e=>this.getCellFormula(e)))}getRangeSerialized(e){if(!(0,n.isSimpleCellRange)(e))throw new d.ExpectedValueOfTypeError("SimpleCellRange","source");return new n.AbsoluteCellRange(e.start,e.end).arrayOfAddressesInRange().map(e=>e.map(e=>this.getCellSerialized(e)))}getFillRangeData(e,t,r=!1){if(!(0,n.isSimpleCellRange)(e))throw new d.ExpectedValueOfTypeError("SimpleCellRange","source");if(!(0,n.isSimpleCellRange)(t))throw new d.ExpectedValueOfTypeError("SimpleCellRange","target");const o=new n.AbsoluteCellRange(e.start,e.end),s=new n.AbsoluteCellRange(t.start,t.end);return this.ensureEvaluationIsNotSuspended(),s.arrayOfAddressesInRange().map(n=>n.map(n=>{const s=((n.row-(r?t:e).start.row)%o.height()+o.height())%o.height()+e.start.row,i=((n.col-(r?t:e).start.col)%o.width()+o.width())%o.width()+e.start.col;return this._serialization.getCellSerialized({row:s,col:i,sheet:o.sheet},n)}))}isItPossibleToAddSheet(e){(0,o.validateArgToType)(e,"string","sheetName");try{return this._crudOperations.ensureItIsPossibleToAddSheet(e),!0}catch(e){return!1}}addSheet(e){void 0!==e&&(0,o.validateArgToType)(e,"string","sheetName");const t=this._crudOperations.addSheet(e);return this._emitter.emit(h.Events.SheetAdded,t),t}isItPossibleToRemoveSheet(e){(0,o.validateArgToType)(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),!0}catch(e){return!1}}removeSheet(e){(0,o.validateArgToType)(e,"number","sheetId");const t=this.sheetMapping.getDisplayName(e);this._crudOperations.removeSheet(e);const r=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(h.Events.SheetRemoved,t,r),r}isItPossibleToClearSheet(e){(0,o.validateArgToType)(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),!0}catch(e){return!1}}clearSheet(e){return(0,o.validateArgToType)(e,"number","sheetId"),this._crudOperations.clearSheet(e),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToReplaceSheetContent(e,t){(0,o.validateArgToType)(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),this._crudOperations.ensureItIsPossibleToChangeSheetContents(e,t),!0}catch(e){return!1}}setSheetContent(e,t){return(0,o.validateArgToType)(e,"number","sheetId"),this._crudOperations.setSheetContent(e,t),this.recomputeIfDependencyGraphNeedsIt()}simpleCellAddressFromString(e,t){return(0,o.validateArgToType)(e,"string","cellAddress"),(0,o.validateArgToType)(t,"number","sheetId"),(0,f.simpleCellAddressFromString)(this.sheetMapping.get,e,t)}simpleCellRangeFromString(e,t){return(0,o.validateArgToType)(e,"string","cellRange"),(0,o.validateArgToType)(t,"number","sheetId"),(0,f.simpleCellRangeFromString)(this.sheetMapping.get,e,t)}simpleCellAddressToString(e,t){if(!(0,i.isSimpleCellAddress)(e))throw new d.ExpectedValueOfTypeError("SimpleCellAddress","cellAddress");return(0,o.validateArgToType)(t,"number","sheetId"),(0,f.simpleCellAddressToString)(this.sheetMapping.fetchDisplayName,e,t)}simpleCellRangeToString(e,t){if(!(0,n.isSimpleCellRange)(e))throw new d.ExpectedValueOfTypeError("SimpleCellRange","cellRange");return(0,o.validateArgToType)(t,"number","sheetId"),(0,f.simpleCellRangeToString)(this.sheetMapping.fetchDisplayName,e,t)}getCellDependents(e){let t;if((0,i.isSimpleCellAddress)(e))t=this._dependencyGraph.addressMapping.getCell(e);else{if(!(0,n.isSimpleCellRange)(e))throw new d.ExpectedValueOfTypeError("SimpleCellAddress | SimpleCellRange",e);t=this._dependencyGraph.rangeMapping.getRange(e.start,e.end)}return void 0===t?[]:this._dependencyGraph.getAdjacentNodesAddresses(t)}getCellPrecedents(e){let t;if((0,i.isSimpleCellAddress)(e))t=this._dependencyGraph.addressMapping.getCell(e);else{if(!(0,n.isSimpleCellRange)(e))throw new d.ExpectedValueOfTypeError("SimpleCellAddress | SimpleCellRange",e);t=this._dependencyGraph.rangeMapping.getRange(e.start,e.end)}return void 0===t?[]:this._dependencyGraph.dependencyQueryAddresses(t)}getSheetName(e){return(0,o.validateArgToType)(e,"number","sheetId"),this.sheetMapping.getDisplayName(e)}getSheetNames(){return this.sheetMapping.sheetNames()}getSheetId(e){return(0,o.validateArgToType)(e,"string","sheetName"),this.sheetMapping.get(e)}doesSheetExist(e){return(0,o.validateArgToType)(e,"string","sheetName"),this.sheetMapping.hasSheetWithName(e)}getCellType(e){if(!(0,i.isSimpleCellAddress)(e))throw new d.ExpectedValueOfTypeError("SimpleCellAddress","cellAddress");const t=this.dependencyGraph.getCell(e);return(0,i.getCellType)(t,e)}doesCellHaveSimpleValue(e){if(!(0,i.isSimpleCellAddress)(e))throw new d.ExpectedValueOfTypeError("SimpleCellAddress","cellAddress");return this.getCellType(e)===i.CellType.VALUE}doesCellHaveFormula(e){if(!(0,i.isSimpleCellAddress)(e))throw new d.ExpectedValueOfTypeError("SimpleCellAddress","cellAddress");const t=this.getCellType(e);return t===i.CellType.FORMULA||t===i.CellType.ARRAYFORMULA}isCellEmpty(e){if(!(0,i.isSimpleCellAddress)(e))throw new d.ExpectedValueOfTypeError("SimpleCellAddress","cellAddress");return this.getCellType(e)===i.CellType.EMPTY}isCellPartOfArray(e){if(!(0,i.isSimpleCellAddress)(e))throw new d.ExpectedValueOfTypeError("SimpleCellAddress","cellAddress");const t=this.getCellType(e);return t===i.CellType.ARRAY||t===i.CellType.ARRAYFORMULA}getCellValueType(e){if(!(0,i.isSimpleCellAddress)(e))throw new d.ExpectedValueOfTypeError("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();const t=this.dependencyGraph.getCellValue(e);return(0,i.getCellValueType)(t)}getCellValueDetailedType(e){if(!(0,i.isSimpleCellAddress)(e))throw new d.ExpectedValueOfTypeError("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();const t=this.dependencyGraph.getCellValue(e);return(0,i.getCellValueDetailedType)(t)}getCellValueFormat(e){if(!(0,i.isSimpleCellAddress)(e))throw new d.ExpectedValueOfTypeError("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();const t=this.dependencyGraph.getCellValue(e);return(0,i.getCellValueFormat)(t)}countSheets(){return this.sheetMapping.numberOfSheets()}isItPossibleToRenameSheet(e,t){(0,o.validateArgToType)(e,"number","sheetId"),(0,o.validateArgToType)(t,"string","newName");try{return this._crudOperations.ensureItIsPossibleToRenameSheet(e,t),!0}catch(e){return!1}}renameSheet(e,t){(0,o.validateArgToType)(e,"number","sheetId"),(0,o.validateArgToType)(t,"string","newName");const r=this._crudOperations.renameSheet(e,t);void 0!==r&&this._emitter.emit(h.Events.SheetRenamed,r,t)}batch(e){this.suspendEvaluation(),this._crudOperations.beginUndoRedoBatchMode();try{e()}catch(e){throw this._crudOperations.commitUndoRedoBatchMode(),this.resumeEvaluation(),e}return this._crudOperations.commitUndoRedoBatchMode(),this.resumeEvaluation()}suspendEvaluation(){this._evaluationSuspended=!0,this._emitter.emit(h.Events.EvaluationSuspended)}resumeEvaluation(){this._evaluationSuspended=!1;const e=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(h.Events.EvaluationResumed,e),e}isEvaluationSuspended(){return this._evaluationSuspended}isItPossibleToAddNamedExpression(e,t,r){(0,o.validateArgToType)(e,"string","expressionName"),void 0!==r&&(0,o.validateArgToType)(r,"number","scope");try{return this._crudOperations.ensureItIsPossibleToAddNamedExpression(e,t,r),!0}catch(e){return!1}}addNamedExpression(e,t,r,n){(0,o.validateArgToType)(e,"string","expressionName"),void 0!==r&&(0,o.validateArgToType)(r,"number","scope"),this._crudOperations.addNamedExpression(e,t,r,n);const s=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(h.Events.NamedExpressionAdded,e,s),s}getNamedExpressionValue(e,t){(0,o.validateArgToType)(e,"string","expressionName"),void 0!==t&&(0,o.validateArgToType)(t,"number","scope"),this.ensureEvaluationIsNotSuspended(),this._crudOperations.ensureScopeIdIsValid(t);const r=this._namedExpressions.namedExpressionForScope(e,t);return r?this._serialization.getCellValue(r.address):void 0}getNamedExpressionFormula(e,t){(0,o.validateArgToType)(e,"string","expressionName"),void 0!==t&&(0,o.validateArgToType)(t,"number","scope"),this._crudOperations.ensureScopeIdIsValid(t);const r=this._namedExpressions.namedExpressionForScope(e,t);return void 0===r?void 0:this._serialization.getCellFormula(r.address)}getNamedExpression(e,t){(0,o.validateArgToType)(e,"string","expressionName"),void 0!==t&&(0,o.validateArgToType)(t,"number","scope");const r=this._namedExpressions.namedExpressionForScope(e,t);if(void 0!==r)return{name:e,scope:t,expression:this._serialization.getCellFormula(r.address),options:r.options}}isItPossibleToChangeNamedExpression(e,t,r){(0,o.validateArgToType)(e,"string","expressionName"),void 0!==r&&(0,o.validateArgToType)(r,"number","scope");try{return this._crudOperations.ensureItIsPossibleToChangeNamedExpression(e,t,r),!0}catch(e){return!1}}changeNamedExpression(e,t,r,n){return(0,o.validateArgToType)(e,"string","expressionName"),void 0!==r&&(0,o.validateArgToType)(r,"number","scope"),this._crudOperations.changeNamedExpressionExpression(e,r,t,n),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToRemoveNamedExpression(e,t){(0,o.validateArgToType)(e,"string","expressionName"),void 0!==t&&(0,o.validateArgToType)(t,"number","scope");try{return this._crudOperations.isItPossibleToRemoveNamedExpression(e,t),!0}catch(e){return!1}}removeNamedExpression(e,t){(0,o.validateArgToType)(e,"string","expressionName"),void 0!==t&&(0,o.validateArgToType)(t,"number","scope");const r=this._crudOperations.removeNamedExpression(e,t);if(r){const e=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(h.Events.NamedExpressionRemoved,r.displayName,e),e}return[]}listNamedExpressions(e){return void 0!==e&&(0,o.validateArgToType)(e,"number","scope"),this._crudOperations.ensureScopeIdIsValid(e),this._namedExpressions.getAllNamedExpressionsNamesInScope(e)}getAllNamedExpressionsSerialized(){return this._serialization.getAllNamedExpressionsSerialized()}normalizeFormula(e){(0,o.validateArgToType)(e,"string","formulaString");const{ast:t,address:r}=this.extractTemporaryFormula(e);if(void 0===t)throw new d.NotAFormulaError;return this._unparser.unparse(t,r)}calculateFormula(e,t){(0,o.validateArgToType)(e,"string","formulaString"),(0,o.validateArgToType)(t,"number","sheetId"),this._crudOperations.ensureScopeIdIsValid(t);const{ast:r,address:n,dependencies:s}=this.extractTemporaryFormula(e,t);if(void 0===r)throw new d.NotAFormulaError;const i=this.evaluator.runAndForget(r,n,s);return this._exporter.exportScalarOrRange(i)}getNamedExpressionsFromFormula(e){(0,o.validateArgToType)(e,"string","formulaString");const{ast:t,dependencies:r}=this.extractTemporaryFormula(e);if(void 0===t)throw new d.NotAFormulaError;const n=r.filter(e=>e instanceof f.NamedExpressionDependency).map(e=>e.name);return[...new Set(n)]}validateFormula(e){(0,o.validateArgToType)(e,"string","formulaString");const{ast:t}=this.extractTemporaryFormula(e);return void 0!==t}getRegisteredFunctionNames(){return E.getLanguage(this._config.language).getFunctionTranslations(this._functionRegistry.getRegisteredFunctionIds())}getFunctionPlugin(e){return(0,o.validateArgToType)(e,"string","functionId"),this._functionRegistry.getFunctionPlugin(e)}getAllFunctionPlugins(){return this._functionRegistry.getPlugins()}numberToDateTime(e){return(0,o.validateArgToType)(e,"number","val"),this._evaluator.interpreter.dateTimeHelper.numberToSimpleDateTime(e)}numberToDate(e){return(0,o.validateArgToType)(e,"number","val"),this._evaluator.interpreter.dateTimeHelper.numberToSimpleDate(e)}numberToTime(e){return(0,o.validateArgToType)(e,"number","val"),(0,c.numberToSimpleTime)(e)}on(e,t){this._emitter.on(e,t)}once(e,t){this._emitter.once(e,t)}off(e,t){this._emitter.off(e,t)}destroy(){(0,l.objectDestroy)(this)}ensureEvaluationIsNotSuspended(){if(this._evaluationSuspended)throw new d.EvaluationSuspendedError}extractTemporaryFormula(e,t=1){const r=this._cellContentParser.parse(e),n={sheet:t,col:0,row:0};if(!(r instanceof a.CellContent.Formula))return{address:n,dependencies:[]};const{ast:o,errors:s,dependencies:i}=this._parser.parse(r.formula,n);return s.length>0?{address:n,dependencies:[]}:{ast:o,address:n,dependencies:i}}rebuildWithConfig(e){const t=this._config.mergeConfig(e),r=this._config.mergeConfig({language:e.language}),n=this._serialization.withNewConfig(r,this._namedExpressions).getAllSheetsSerialized(),o=this._serialization.getAllNamedExpressionsSerialized(),i=s.BuildEngineFactory.rebuildWithConfig(t,n,o,this._stats);this._config=i.config,this._stats=i.stats,this._dependencyGraph=i.dependencyGraph,this._columnSearch=i.columnSearch,this._parser=i.parser,this._unparser=i.unparser,this._cellContentParser=i.cellContentParser,this._evaluator=i.evaluator,this._lazilyTransformingAstService=i.lazilyTransformingAstService,this._crudOperations=i.crudOperations,this._exporter=i.exporter,this._namedExpressions=i.namedExpressions,this._serialization=i.serialization,this._functionRegistry=i.functionRegistry}recomputeIfDependencyGraphNeedsIt(){if(this._evaluationSuspended)return[];{const e=this._crudOperations.getAndClearContentChanges(),t=this.dependencyGraph.verticesToRecompute();this.dependencyGraph.clearDirtyVertices(),t.length>0&&e.addAll(this.evaluator.partialRun(t));const r=e.exportChanges(this._exporter);return e.isEmpty()||this._emitter.emit(h.Events.ValuesUpdated,r),r}}}t.HyperFormula=E,E.version="2.7.1",E.buildDate="04/09/2024 12:44:07",E.releaseDate="18/07/2024",E.languages={},E.registeredLanguages=new Map},function(e,t,r){"use strict";t.__esModule=!0,t.BuildEngineFactory=void 0;var n=r(1),o=r(182),s=r(183),i=r(171),a=r(184),u=r(174),c=r(74),l=r(147),h=r(197),d=r(198),p=r(199),m=r(158),g=r(168),f=r(200),E=r(202),T=r(204),y=r(206),A=r(185),R=r(211),N=r(186),S=r(77),C=r(212),v=r(195),O=r(142),I=r(196);t.BuildEngineFactory=
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
class{static buildFromSheets(e,t={},r=[]){const n=new i.Config(t);return this.buildEngine(n,e,r)}static buildFromSheet(e,t={},r=[]){const n=new i.Config(t),o=n.translationPackage.getUITranslation(m.UIElement.NEW_SHEET_PREFIX)+"1";return this.buildEngine(n,{[o]:e},r)}static buildEmpty(e={},t=[]){return this.buildEngine(new i.Config(e),{},t)}static rebuildWithConfig(e,t,r,n){return this.buildEngine(e,t,r,n)}static buildEngine(e,t={},r=[],i=(e.useStats?new O.Statistics:new O.EmptyStatistics)){i.start(O.StatType.BUILD_ENGINE_TOTAL);const m=new A.NamedExpressions,M=new f.FunctionRegistry(e),b=new T.LazilyTransformingAstService(i),F=c.DependencyGraph.buildEmpty(b,e,M,m,i),w=(0,y.buildColumnSearchStrategy)(F,e,i),_=F.sheetMapping,L=F.addressMapping;for(const r in t)if(Object.prototype.hasOwnProperty.call(t,r)){const n=t[r];(0,v.validateAsSheet)(n);const o=(0,v.findBoundaries)(n);if(o.height>e.maxRows||o.width>e.maxColumns)throw new l.SheetSizeLimitExceededError;const s=_.addSheet(r);L.autoAddSheet(s,o)}const x=new S.ParserWithCaching(e,M,_.get);b.parser=x;const P=new S.Unparser(e,(0,S.buildLexerConfig)(e),_.fetchDisplayName,m),U=new u.DateTimeHelper(e),V=new R.NumberLiteralHelper(e),D=new g.ArithmeticHelper(e,U,V),B=new o.CellContentParser(e,U,V),k=new n.ArraySizePredictor(e,M),G=new N.Operations(e,F,w,B,x,i,b,m,k),j=new I.UndoRedo(e,G);b.undoRedo=j;const W=new s.ClipboardOperations(e,F,G),H=new a.CrudOperations(e,G,j,W,F,w,x,B,b,m);r.forEach(e=>{H.ensureItIsPossibleToAddNamedExpression(e.name,e.expression,e.scope),H.operations.addNamedExpression(e.name,e.expression,e.scope,e.options)});const z=new d.Exporter(e,m,_.fetchDisplayName,b),Y=new C.Serialization(F,P,z),X=new E.Interpreter(e,F,w,i,D,M,m,Y,k,U);i.measure(O.StatType.GRAPH_BUILD,()=>{new p.GraphBuilder(F,w,x,B,i,k).buildGraph(t,i)});const K=new h.Evaluator(e,i,X,b,F,w);return K.run(),i.end(O.StatType.BUILD_ENGINE_TOTAL),{config:e,stats:i,dependencyGraph:F,columnSearch:w,parser:x,unparser:P,cellContentParser:B,evaluator:K,lazilyTransformingAstService:b,crudOperations:H,exporter:z,namedExpressions:m,serialization:Y,functionRegistry:M}}}},function(e,t,r){"use strict";t.__esModule=!0,t.CellContentParser=t.CellContent=void 0,t.isBoolean=h,t.isError=d,t.isFormula=l;var n,o=r(73),s=r(174),i=r(131),a=r(147),u=r(168),c=r(140);function l(e){return e.startsWith("=")}function h(e){const t=e.toLowerCase();return"true"===t||"false"===t}function d(e,t){const r=e.toUpperCase();return/#[A-Za-z0-9\/]+[?!]?/.test(r)&&Object.prototype.hasOwnProperty.call(t,r)}!function(e){e.Number=class{constructor(e){this.value=e,this.value=(0,c.cloneNumber)(this.value,(0,u.fixNegativeZero)((0,c.getRawValue)(this.value)))}},e.String=class{constructor(e){this.value=e}},e.Boolean=class{constructor(e){this.value=e}};class t{static getSingletonInstance(){return t.instance||(t.instance=new t),t.instance}}e.Empty=t,e.Formula=class{constructor(e){this.formula=e}},e.Error=class{constructor(e,t){this.value=new o.CellError(e,t)}}}(n||(t.CellContent=n={})),t.CellContentParser=class{constructor(e,t,r){this.config=e,this.dateHelper=t,this.numberLiteralsHelper=r}parse(e){if(null==e)return n.Empty.getSingletonInstance();if("number"==typeof e)return(0,u.isNumberOverflow)(e)?new n.Error(o.ErrorType.NUM,i.ErrorMessage.ValueLarge):new n.Number(e);if("boolean"==typeof e)return new n.Boolean(e);if(e instanceof Date){const t=this.dateHelper.dateToNumber({day:e.getDate(),month:e.getMonth()+1,year:e.getFullYear()})+(0,s.timeToNumber)({hours:e.getHours(),minutes:e.getMinutes(),seconds:e.getSeconds()+e.getMilliseconds()/1e3});return t<0?new n.Error(o.ErrorType.NUM,i.ErrorMessage.DateBounds):t%1==0?new n.Number(new c.DateNumber(t,"Date()")):t<1?new n.Number(new c.TimeNumber(t,"Date()")):new n.Number(new c.DateTimeNumber(t,"Date()"))}if("string"==typeof e){if(h(e))return new n.Boolean("true"===e.toLowerCase());if(l(e))return new n.Formula(e);if(d(e,this.config.errorMapping))return new n.Error(this.config.errorMapping[e.toUpperCase()]);{let t,r=e.trim(),o=0;if(r.endsWith("%"))o=1,r=r.slice(0,r.length-1);else{const e=this.currencyMatcher(r);void 0!==e&&(o=2,[t,r]=e)}const s=this.numberLiteralsHelper.numericStringToMaybeNumber(r);if(void 0!==s){let e;return e=1===o?new c.PercentNumber(s/100):2===o?new c.CurrencyNumber(s,t):s,new n.Number(e)}const i=this.dateHelper.dateStringToDateNumber(r);return void 0!==i?new n.Number(i):new n.String(e.startsWith("'")?e.slice(1):e)}}throw new a.UnableToParseError(e)}currencyMatcher(e){for(const t of this.config.currencySymbol){if(e.startsWith(t))return[t,e.slice(t.length)];if(e.endsWith(t))return[t,e.slice(0,e.length-t.length)]}}}},function(e,t,r){"use strict";t.__esModule=!0,t.ClipboardOperations=t.ClipboardCellType=void 0,r(2);var n,o,s=r(72),i=r(73),a=r(147);!function(e){e[e.COPY=0]="COPY",e[e.CUT=1]="CUT"}(n||(n={})),function(e){e[e.VALUE=0]="VALUE",e[e.EMPTY=1]="EMPTY",e[e.FORMULA=2]="FORMULA",e[e.PARSING_ERROR=3]="PARSING_ERROR"}(o||(t.ClipboardCellType=o={}));class u{constructor(e,t,r,n,o){this.sourceLeftCorner=e,this.width=t,this.height=r,this.type=n,this.content=o}*getContent(e){if(void 0!==this.content)for(let t=0;t<this.height;++t)for(let r=0;r<this.width;++r)yield[(0,i.simpleCellAddress)(e.sheet,e.col+r,e.row+t),this.content[t][r]]}}t.ClipboardOperations=class{constructor(e,t,r){this.dependencyGraph=t,this.operations=r,this.maxRows=e.maxRows,this.maxColumns=e.maxColumns}cut(e,t,r){this.clipboard=new u(e,t,r,n.CUT)}copy(e,t,r){const o=[];for(let n=0;n<r;++n){o[n]=[];for(let r=0;r<t;++r){const t=this.operations.getClipboardCell((0,i.simpleCellAddress)(e.sheet,e.col+r,e.row+n));o[n].push(t)}}this.clipboard=new u(e,t,r,n.COPY,o)}abortCut(){this.clipboard&&this.clipboard.type===n.CUT&&this.clear()}clear(){this.clipboard=void 0}ensureItIsPossibleToCopyPaste(e){if(void 0===this.clipboard)return;if((0,i.invalidSimpleCellAddress)(e)||!this.dependencyGraph.sheetMapping.hasSheetWithId(e.sheet))throw new a.InvalidArgumentsError("a valid target address.");const t=s.AbsoluteCellRange.spanFrom(e,this.clipboard.width,this.clipboard.height);if(t.exceedsSheetSizeLimits(this.maxColumns,this.maxRows))throw new a.SheetSizeLimitExceededError;if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(t))throw new Error("It is not possible to paste onto an array")}isCutClipboard(){return void 0!==this.clipboard&&this.clipboard.type===n.CUT}isCopyClipboard(){return void 0!==this.clipboard&&this.clipboard.type===n.COPY}}},function(e,t,r){"use strict";t.__esModule=!0,t.CrudOperations=void 0,r(2);var n=r(72),o=r(73),s=r(182),i=r(147),a=r(185),u=r(186),c=r(195),l=r(141),h=r(196);function d(e){return Number.isInteger(e)&&e>0}function p(e){return Number.isInteger(e)&&e>=0}t.CrudOperations=
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
class{constructor(e,t,r,n,o,s,i,a,u,c){this.operations=t,this.undoRedo=r,this.clipboardOperations=n,this.dependencyGraph=o,this.columnSearch=s,this.parser=i,this.cellContentParser=a,this.lazilyTransformingAstService=u,this.namedExpressions=c,this.maxRows=e.maxRows,this.maxColumns=e.maxColumns}get sheetMapping(){return this.dependencyGraph.sheetMapping}addRows(e,...t){const r=new u.AddRowsCommand(e,t);this.ensureItIsPossibleToAddRows(e,...t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.operations.addRows(r),this.undoRedo.saveOperation(new h.AddRowsUndoEntry(r))}removeRows(e,...t){const r=new u.RemoveRowsCommand(e,t);this.ensureItIsPossibleToRemoveRows(e,...t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const n=this.operations.removeRows(r);this.undoRedo.saveOperation(new h.RemoveRowsUndoEntry(r,n))}addColumns(e,...t){const r=new u.AddColumnsCommand(e,t);this.ensureItIsPossibleToAddColumns(e,...t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.operations.addColumns(r),this.undoRedo.saveOperation(new h.AddColumnsUndoEntry(r))}removeColumns(e,...t){const r=new u.RemoveColumnsCommand(e,t);this.ensureItIsPossibleToRemoveColumns(e,...t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const n=this.operations.removeColumns(r);this.undoRedo.saveOperation(new h.RemoveColumnsUndoEntry(r,n))}moveCells(e,t,r,n){this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const{version:o,overwrittenCellsData:s,addedGlobalNamedExpressions:i}=this.operations.moveCells(e,t,r,n);this.undoRedo.saveOperation(new h.MoveCellsUndoEntry(e,t,r,n,s,i,o))}moveRows(e,t,r,n){this.ensureItIsPossibleToMoveRows(e,t,r,n),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const o=this.operations.moveRows(e,t,r,n);this.undoRedo.saveOperation(new h.MoveRowsUndoEntry(e,t,r,n,o))}moveColumns(e,t,r,n){this.ensureItIsPossibleToMoveColumns(e,t,r,n),this.undoRedo.clearRedoStack();const o=this.operations.moveColumns(e,t,r,n);this.undoRedo.saveOperation(new h.MoveColumnsUndoEntry(e,t,r,n,o))}cut(e,t,r){this.clipboardOperations.cut(e,t,r)}ensureItIsPossibleToCopy(e,t,r){if(!d(t))throw new i.InvalidArgumentsError("width to be positive integer.");if(!d(r))throw new i.InvalidArgumentsError("height to be positive integer.")}copy(e,t,r){this.ensureItIsPossibleToCopy(e,t,r),this.clipboardOperations.copy(e,t,r)}paste(e){const t=this.clipboardOperations.clipboard;if(void 0===t)throw new i.NothingToPasteError;if(this.clipboardOperations.isCutClipboard())this.moveCells(t.sourceLeftCorner,t.width,t.height,e);else if(this.clipboardOperations.isCopyClipboard()){this.clipboardOperations.ensureItIsPossibleToCopyPaste(e);const r=n.AbsoluteCellRange.spanFrom(e,t.width,t.height),o=this.operations.getRangeClipboardCells(r);this.undoRedo.clearRedoStack();const s=this.operations.restoreClipboardCells(t.sourceLeftCorner.sheet,t.getContent(e));this.undoRedo.saveOperation(new h.PasteUndoEntry(e,o,t.content,s))}}beginUndoRedoBatchMode(){this.undoRedo.beginBatchMode()}commitUndoRedoBatchMode(){this.undoRedo.commitBatchMode()}isClipboardEmpty(){return void 0===this.clipboardOperations.clipboard}clearClipboard(){this.clipboardOperations.clear()}addSheet(e){void 0!==e&&this.ensureItIsPossibleToAddSheet(e),this.undoRedo.clearRedoStack();const t=this.operations.addSheet(e);return this.undoRedo.saveOperation(new h.AddSheetUndoEntry(t)),t}removeSheet(e){this.ensureScopeIdIsValid(e),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const t=this.sheetMapping.fetchDisplayName(e),r=this.operations.getSheetClipboardCells(e),{version:n,scopedNamedExpressions:o}=this.operations.removeSheet(e);this.undoRedo.saveOperation(new h.RemoveSheetUndoEntry(t,e,r,o,n))}renameSheet(e,t){this.ensureItIsPossibleToRenameSheet(e,t);const r=this.operations.renameSheet(e,t);return void 0!==r&&(this.undoRedo.clearRedoStack(),this.undoRedo.saveOperation(new h.RenameSheetUndoEntry(e,r,t))),r}clearSheet(e){this.ensureScopeIdIsValid(e),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const t=this.operations.getSheetClipboardCells(e);this.operations.clearSheet(e),this.undoRedo.saveOperation(new h.ClearSheetUndoEntry(e,t))}setCellContents(e,t){if(t instanceof Array){for(let e=0;e<t.length;e++)if(!(t[e]instanceof Array))throw new i.InvalidArgumentsError("an array of arrays or a raw cell value.")}else t=[[t]];this.ensureItIsPossibleToChangeCellContents(e,t),this.undoRedo.clearRedoStack();const r=[];for(let n=0;n<t.length;n++)for(let o=0;o<t[n].length;o++){const s={sheet:e.sheet,row:e.row+n,col:e.col+o},i=t[n][o];this.clipboardOperations.abortCut();const a=this.operations.setCellContent(s,i);r.push({address:s,newContent:i,oldContent:a})}this.undoRedo.saveOperation(new h.SetCellContentsUndoEntry(r))}setSheetContent(e,t){this.ensureScopeIdIsValid(e),this.ensureItIsPossibleToChangeSheetContents(e,t),(0,c.validateAsSheet)(t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const r=this.operations.getSheetClipboardCells(e);this.operations.setSheetContent(e,t),this.undoRedo.saveOperation(new h.SetSheetContentUndoEntry(e,r,t))}setRowOrder(e,t){this.validateSwapRowIndexes(e,t),this.testRowOrderForArrays(e,t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const r=this.operations.setRowOrder(e,t);this.undoRedo.saveOperation(new h.SetRowOrderUndoEntry(e,t,r))}validateSwapRowIndexes(e,t){if(!this.sheetMapping.hasSheetWithId(e))throw new i.NoSheetWithIdError(e);this.validateRowOrColumnMapping(e,t,"row")}testColumnOrderForArrays(e,t){for(const[r,o]of t)if(r!==o){const t=n.AbsoluteCellRange.spanFrom({sheet:e,col:r,row:0},1,1/0);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(t))throw new i.SourceLocationHasArrayError}}setColumnOrder(e,t){this.validateSwapColumnIndexes(e,t),this.testColumnOrderForArrays(e,t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const r=this.operations.setColumnOrder(e,t);this.undoRedo.saveOperation(new h.SetColumnOrderUndoEntry(e,t,r))}validateSwapColumnIndexes(e,t){if(!this.sheetMapping.hasSheetWithId(e))throw new i.NoSheetWithIdError(e);this.validateRowOrColumnMapping(e,t,"column")}testRowOrderForArrays(e,t){for(const[r,o]of t)if(r!==o){const t=n.AbsoluteCellRange.spanFrom({sheet:e,col:0,row:r},1/0,1);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(t))throw new i.SourceLocationHasArrayError}}mappingFromOrder(e,t,r){if(!this.sheetMapping.hasSheetWithId(e))throw new i.NoSheetWithIdError(e);const n="row"===r?this.dependencyGraph.getSheetHeight(e):this.dependencyGraph.getSheetWidth(e);if(t.length!==n)throw new i.InvalidArgumentsError(`number of ${r}s provided to be sheet ${"row"===r?"height":"width"}.`);const o=[];for(let e=0;e<n;e++)t[e]!==e&&o.push([e,t[e]]);return o}undo(){if(this.undoRedo.isUndoStackEmpty())throw new i.NoOperationToUndoError;this.clipboardOperations.abortCut(),this.undoRedo.undo()}redo(){if(this.undoRedo.isRedoStackEmpty())throw new i.NoOperationToRedoError;this.clipboardOperations.abortCut(),this.undoRedo.redo()}addNamedExpression(e,t,r,n){this.ensureItIsPossibleToAddNamedExpression(e,t,r),this.operations.addNamedExpression(e,t,r,n),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new h.AddNamedExpressionUndoEntry(e,t,r,n))}changeNamedExpressionExpression(e,t,r,n){this.ensureItIsPossibleToChangeNamedExpression(e,r,t);const[o,s]=this.operations.changeNamedExpressionExpression(e,r,t,n);this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new h.ChangeNamedExpressionUndoEntry(o,r,s,t,n))}removeNamedExpression(e,t){this.ensureScopeIdIsValid(t);const[r,n]=this.operations.removeNamedExpression(e,t);return this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new h.RemoveNamedExpressionUndoEntry(r,n,t)),r}ensureItIsPossibleToAddNamedExpression(e,t,r){this.ensureScopeIdIsValid(r),this.ensureNamedExpressionNameIsValid(e,r),this.ensureNamedExpressionIsValid(t)}ensureItIsPossibleToChangeNamedExpression(e,t,r){if(this.ensureScopeIdIsValid(r),void 0===this.namedExpressions.namedExpressionForScope(e,r))throw new i.NamedExpressionDoesNotExistError(e);this.ensureNamedExpressionIsValid(t)}isItPossibleToRemoveNamedExpression(e,t){if(this.ensureScopeIdIsValid(t),void 0===this.namedExpressions.namedExpressionForScope(e,t))throw new i.NamedExpressionDoesNotExistError(e)}ensureItIsPossibleToAddRows(e,...t){if(!this.sheetMapping.hasSheetWithId(e))throw new i.NoSheetWithIdError(e);if(this.dependencyGraph.getSheetHeight(e)+t.map(e=>e[1]).reduce((e,t)=>e+t,0)>this.maxRows)throw new i.SheetSizeLimitExceededError;for(const[e,r]of t)if(!p(e)||!d(r))throw new i.InvalidArgumentsError("row number to be nonnegative and number of rows to add to be positive.")}ensureItIsPossibleToRemoveRows(e,...t){for(const[r,n]of t){const t=r+n-1;if(!p(r)||!p(t))throw new i.InvalidArgumentsError("starting and ending row to be nonnegative.");if(t<r)throw new i.InvalidArgumentsError("starting row to be smaller than the ending row.");if(!this.sheetMapping.hasSheetWithId(e))throw new i.NoSheetWithIdError(e)}}ensureItIsPossibleToAddColumns(e,...t){if(!this.sheetMapping.hasSheetWithId(e))throw new i.NoSheetWithIdError(e);if(this.dependencyGraph.getSheetWidth(e)+t.map(e=>e[1]).reduce((e,t)=>e+t,0)>this.maxColumns)throw new i.SheetSizeLimitExceededError;for(const[e,r]of t)if(!p(e)||!d(r))throw new i.InvalidArgumentsError("column number to be nonnegative and number of columns to add to be positive.")}ensureItIsPossibleToRemoveColumns(e,...t){for(const[r,n]of t){const t=r+n-1;if(!p(r)||!p(t))throw new i.InvalidArgumentsError("starting and ending column to be nonnegative.");if(t<r)throw new i.InvalidArgumentsError("starting column to be smaller than the ending column.");if(!this.sheetMapping.hasSheetWithId(e))throw new i.NoSheetWithIdError(e)}}ensureItIsPossibleToMoveRows(e,t,r,s){this.ensureItIsPossibleToAddRows(e,[s,r]);const a=(0,o.simpleCellAddress)(e,0,t),u=(0,o.simpleCellAddress)(e,0,s);if(!this.sheetMapping.hasSheetWithId(e)||(0,o.invalidSimpleCellAddress)(a)||(0,o.invalidSimpleCellAddress)(u)||!d(r)||s<=t+r&&s>=t)throw new i.InvalidArgumentsError("a valid range of rows to move.");const c=this.dependencyGraph.getSheetWidth(e),h=n.AbsoluteCellRange.spanFrom(a,c,r);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(h))throw new i.SourceLocationHasArrayError;if(s>0&&this.dependencyGraph.arrayMapping.isFormulaArrayInAllRows(l.RowsSpan.fromNumberOfRows(e,s-1,2)))throw new i.TargetLocationHasArrayError}ensureItIsPossibleToMoveColumns(e,t,r,s){this.ensureItIsPossibleToAddColumns(e,[s,r]);const a=(0,o.simpleCellAddress)(e,t,0),u=(0,o.simpleCellAddress)(e,s,0);if(!this.sheetMapping.hasSheetWithId(e)||(0,o.invalidSimpleCellAddress)(a)||(0,o.invalidSimpleCellAddress)(u)||!d(r)||s<=t+r&&s>=t)throw new i.InvalidArgumentsError("a valid range of columns to move.");const c=this.dependencyGraph.getSheetHeight(e),h=n.AbsoluteCellRange.spanFrom(a,r,c);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(h))throw new i.SourceLocationHasArrayError;if(s>0&&this.dependencyGraph.arrayMapping.isFormulaArrayInAllColumns(l.ColumnsSpan.fromNumberOfColumns(e,s-1,2)))throw new i.TargetLocationHasArrayError}ensureItIsPossibleToAddSheet(e){if(this.sheetMapping.hasSheetWithName(e))throw new i.SheetNameAlreadyTakenError(e)}ensureItIsPossibleToRenameSheet(e,t){if(!this.sheetMapping.hasSheetWithId(e))throw new i.NoSheetWithIdError(e);const r=this.sheetMapping.get(t);if(void 0!==r&&r!==e)throw new i.SheetNameAlreadyTakenError(t)}ensureItIsPossibleToChangeContent(e){if((0,o.invalidSimpleCellAddress)(e))throw new i.InvalidAddressError(e);if(!this.sheetMapping.hasSheetWithId(e.sheet))throw new i.NoSheetWithIdError(e.sheet)}ensureItIsPossibleToChangeCellContents(e,t){const r=(0,c.findBoundaries)(t),o=n.AbsoluteCellRange.spanFrom(e,r.width,r.height);this.ensureRangeInSizeLimits(o);for(const e of o.addresses(this.dependencyGraph))this.ensureItIsPossibleToChangeContent(e)}ensureItIsPossibleToChangeSheetContents(e,t){const r=(0,c.findBoundaries)(t),s=n.AbsoluteCellRange.spanFrom((0,o.simpleCellAddress)(e,0,0),r.width,r.height);this.ensureRangeInSizeLimits(s)}ensureRangeInSizeLimits(e){if(e.exceedsSheetSizeLimits(this.maxColumns,this.maxRows))throw new i.SheetSizeLimitExceededError}isThereSomethingToUndo(){return!this.undoRedo.isUndoStackEmpty()}isThereSomethingToRedo(){return!this.undoRedo.isRedoStackEmpty()}getAndClearContentChanges(){return this.operations.getAndClearContentChanges()}ensureScopeIdIsValid(e){if(void 0!==e&&!this.sheetMapping.hasSheetWithId(e))throw new i.NoSheetWithIdError(e)}validateRowOrColumnMapping(e,t,r){const n="row"===r?this.dependencyGraph.getSheetHeight(e):this.dependencyGraph.getSheetWidth(e),o=t.map(([e,t])=>e).sort((e,t)=>e-t),s=t.map(([e,t])=>t).sort((e,t)=>e-t);for(let e=0;e<o.length;e++){if(!p(o[e])||o[e]>=n)throw new i.InvalidArgumentsError(`${r} numbers to be nonnegative integers and less than sheet ${"row"===r?"height":"width"}.`);if(o[e]===o[e+1])throw new i.InvalidArgumentsError(`source ${r} numbers to be unique.`);if(o[e]!==s[e])throw new i.InvalidArgumentsError(`target ${r} numbers to be permutation of source ${r} numbers.`)}}ensureNamedExpressionNameIsValid(e,t){if(!this.namedExpressions.isNameValid(e))throw new i.NamedExpressionNameIsInvalidError(e);if(!this.namedExpressions.isNameAvailable(e,t))throw new i.NamedExpressionNameIsAlreadyTakenError(e)}ensureNamedExpressionIsValid(e){const t=this.cellContentParser.parse(e);if(t instanceof s.CellContent.Formula){const e=this.parser.parse(t.formula,(0,o.simpleCellAddress)(-1,0,0));if((0,a.doesContainRelativeReferences)(e.ast))throw new i.NoRelativeAddressesAllowedError}}}},function(e,t,r){"use strict";t.__esModule=!0,t.doesContainRelativeReferences=t.NamedExpressions=t.InternalNamedExpression=void 0,r(2);var n=r(73),o=r(77),s=r(82);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
class i{constructor(e,t,r,n){this.displayName=e,this.address=t,this.added=r,this.options=n}normalizeExpressionName(){return this.displayName.toLowerCase()}copy(){return new i(this.displayName,this.address,this.added,this.options)}}t.InternalNamedExpression=i;class a{constructor(){this.mapping=new Map}has(e){return this.mapping.has(this.normalizeExpressionName(e))}isNameAvailable(e){const t=this.normalizeExpressionName(e),r=this.mapping.get(t);return!(r&&r.added)}add(e){this.mapping.set(e.normalizeExpressionName(),e)}get(e){return this.mapping.get(this.normalizeExpressionName(e))}getExisting(e){const t=this.mapping.get(this.normalizeExpressionName(e));return t&&t.added?t:void 0}remove(e){const t=this.normalizeExpressionName(e),r=this.mapping.get(t);r&&(r.added=!1)}getAllNamedExpressions(){return Array.from(this.mapping.values()).filter(e=>e.added)}normalizeExpressionName(e){return e.toLowerCase()}}class u{constructor(){this.mapping=new Map}add(e){this.mapping.set(this.normalizeExpressionName(e.displayName),e)}get(e){return this.mapping.get(this.normalizeExpressionName(e))}has(e){return this.mapping.has(this.normalizeExpressionName(e))}getAllNamedExpressions(){return Array.from(this.mapping.values()).filter(e=>e.added)}isNameAvailable(e){const t=this.normalizeExpressionName(e);return!this.mapping.has(t)}remove(e){const t=this.normalizeExpressionName(e);this.mapping.get(t)&&this.mapping.delete(t)}normalizeExpressionName(e){return e.toLowerCase()}}class c{constructor(){this.nextNamedExpressionRow=0,this.workbookStore=new a,this.worksheetStores=new Map,this.addressCache=new Map}isNameAvailable(e,t){var r,n;return void 0===t?this.workbookStore.isNameAvailable(e):null===(n=null===(r=this.worksheetStore(t))||void 0===r?void 0:r.isNameAvailable(e))||void 0===n||n}namedExpressionInAddress(e){const t=this.addressCache.get(e);return t&&t.added?t:void 0}namedExpressionForScope(e,t){var r;return void 0===t?this.workbookStore.getExisting(e):null===(r=this.worksheetStore(t))||void 0===r?void 0:r.get(e)}nearestNamedExpression(e,t){var r,n;return null!==(n=null===(r=this.worksheetStore(t))||void 0===r?void 0:r.get(e))&&void 0!==n?n:this.workbookStore.getExisting(e)}isExpressionInScope(e,t){var r,n;return null!==(n=null===(r=this.worksheetStore(t))||void 0===r?void 0:r.has(e))&&void 0!==n&&n}isNameValid(e){const t=new RegExp(`^${s.CELL_REFERENCE_PATTERN}$`),r=new RegExp(`^${s.R1C1_CELL_REFERENCE_PATTERN}$`),n=new RegExp(`^${s.NAMED_EXPRESSION_PATTERN}$`);return!t.test(e)&&!r.test(e)&&n.test(e)}addNamedExpression(e,t,r){const n=void 0===t?this.workbookStore:this.worksheetStoreOrCreate(t);let o=n.get(e);return void 0!==o?(o.added=!0,o.displayName=e,o.options=r):(o=new i(e,this.nextAddress(),!0,r),n.add(o)),this.addressCache.set(o.address.row,o),o}restoreNamedExpression(e,t){const r=void 0===t?this.workbookStore:this.worksheetStoreOrCreate(t);return e.added=!0,r.add(e),this.addressCache.set(e.address.row,e),e}namedExpressionOrPlaceholder(e,t){var r;return null!==(r=this.worksheetStoreOrCreate(t).get(e))&&void 0!==r?r:this.workbookNamedExpressionOrPlaceholder(e)}workbookNamedExpressionOrPlaceholder(e){let t=this.workbookStore.get(e);return void 0===t&&(t=new i(e,this.nextAddress(),!1),this.workbookStore.add(t)),t}remove(e,t){let r;r=void 0===t?this.workbookStore:this.worksheetStore(t);const n=null==r?void 0:r.get(e);if(void 0===r||void 0===n||!n.added)throw Error("Named expression does not exist");r.remove(e),r instanceof u&&0===r.mapping.size&&this.worksheetStores.delete(t),this.addressCache.delete(n.address.row)}getAllNamedExpressionsNamesInScope(e){return this.getAllNamedExpressions().filter(({scope:t})=>t===e).map(e=>e.expression.displayName)}getAllNamedExpressionsNames(){return this.getAllNamedExpressions().map(e=>e.expression.displayName)}getAllNamedExpressions(){const e=[];return this.workbookStore.getAllNamedExpressions().forEach(t=>{e.push({expression:t,scope:void 0})}),this.worksheetStores.forEach((t,r)=>{t.getAllNamedExpressions().forEach(t=>{e.push({expression:t,scope:r})})}),e}getAllNamedExpressionsForScope(e){var t,r;return void 0===e?this.workbookStore.getAllNamedExpressions():null!==(r=null===(t=this.worksheetStores.get(e))||void 0===t?void 0:t.getAllNamedExpressions())&&void 0!==r?r:[]}worksheetStoreOrCreate(e){let t=this.worksheetStores.get(e);return t||(t=new u,this.worksheetStores.set(e,t)),t}worksheetStore(e){return this.worksheetStores.get(e)}nextAddress(){return(0,n.simpleCellAddress)(c.SHEET_FOR_WORKBOOK_EXPRESSIONS,0,this.nextNamedExpressionRow++)}}t.NamedExpressions=c,c.SHEET_FOR_WORKBOOK_EXPRESSIONS=-1;const l=e=>{switch(e.type){case o.AstNodeType.EMPTY:case o.AstNodeType.NUMBER:case o.AstNodeType.STRING:case o.AstNodeType.ERROR:case o.AstNodeType.ERROR_WITH_RAW_INPUT:return!1;case o.AstNodeType.CELL_REFERENCE:return!e.reference.isAbsolute();case o.AstNodeType.CELL_RANGE:case o.AstNodeType.COLUMN_RANGE:case o.AstNodeType.ROW_RANGE:return!e.start.isAbsolute();case o.AstNodeType.NAMED_EXPRESSION:return!1;case o.AstNodeType.PERCENT_OP:case o.AstNodeType.PLUS_UNARY_OP:case o.AstNodeType.MINUS_UNARY_OP:return l(e.value);case o.AstNodeType.CONCATENATE_OP:case o.AstNodeType.EQUALS_OP:case o.AstNodeType.NOT_EQUAL_OP:case o.AstNodeType.LESS_THAN_OP:case o.AstNodeType.GREATER_THAN_OP:case o.AstNodeType.LESS_THAN_OR_EQUAL_OP:case o.AstNodeType.GREATER_THAN_OR_EQUAL_OP:case o.AstNodeType.MINUS_OP:case o.AstNodeType.PLUS_OP:case o.AstNodeType.TIMES_OP:case o.AstNodeType.DIV_OP:case o.AstNodeType.POWER_OP:return l(e.left)||l(e.right);case o.AstNodeType.PARENTHESIS:return l(e.expression);case o.AstNodeType.FUNCTION_CALL:return e.args.some(e=>l(e));case o.AstNodeType.ARRAY:return e.args.some(e=>e.some(e=>l(e)))}};t.doesContainRelativeReferences=l},function(e,t,r){"use strict";t.__esModule=!0,t.RemoveRowsCommand=t.RemoveColumnsCommand=t.Operations=t.AddRowsCommand=t.AddColumnsCommand=void 0,t.normalizeAddedIndexes=I,t.normalizeRemovedIndexes=O,r(2);var n=r(72),o=r(76),s=r(1),i=r(73),a=r(182),u=r(183),c=r(138),l=r(74),h=r(150),d=r(187),p=r(189),m=r(190),g=r(191),f=r(192),E=r(193),T=r(194),y=r(147),A=r(140),R=r(185),N=r(77),S=r(195),C=r(141),v=r(142);function O(e){if(e.length<=1)return e;const t=[...e].sort(([e],[t])=>e-t),r=t.reduce((e,[t,r])=>{const n=e[e.length-1],o=n[0]+n[1];return t<=o?n[1]+=Math.max(0,r-(o-t)):e.push([t,r]),e},[t[0]]);let n=0;for(let e=0;e<r.length;++e)r[e][0]-=n,n+=r[e][1];return r}function I(e){if(e.length<=1)return e;const t=[...e].sort(([e],[t])=>e-t),r=t.reduce((e,[t,r])=>{const n=e[e.length-1];return t===n[0]?n[1]=Math.max(n[1],r):e.push([t,r]),e},[t[0]]);let n=0;for(let e=0;e<r.length;++e)r[e][0]+=n,n+=r[e][1];return r}function M(e){return Number.isInteger(e)&&e>0}t.RemoveRowsCommand=
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
class{constructor(e,t){this.sheet=e,this.indexes=t}normalizedIndexes(){return O(this.indexes)}rowsSpans(){return this.normalizedIndexes().map(e=>C.RowsSpan.fromNumberOfRows(this.sheet,e[0],e[1]))}},t.AddRowsCommand=class{constructor(e,t){this.sheet=e,this.indexes=t}normalizedIndexes(){return I(this.indexes)}rowsSpans(){return this.normalizedIndexes().map(e=>C.RowsSpan.fromNumberOfRows(this.sheet,e[0],e[1]))}},t.AddColumnsCommand=class{constructor(e,t){this.sheet=e,this.indexes=t}normalizedIndexes(){return I(this.indexes)}columnsSpans(){return this.normalizedIndexes().map(e=>C.ColumnsSpan.fromNumberOfColumns(this.sheet,e[0],e[1]))}},t.RemoveColumnsCommand=class{constructor(e,t){this.sheet=e,this.indexes=t}normalizedIndexes(){return O(this.indexes)}columnsSpans(){return this.normalizedIndexes().map(e=>C.ColumnsSpan.fromNumberOfColumns(this.sheet,e[0],e[1]))}},t.Operations=class{constructor(e,t,r,n,o,s,i,a,u){this.dependencyGraph=t,this.columnSearch=r,this.cellContentParser=n,this.parser=o,this.stats=s,this.lazilyTransformingAstService=i,this.namedExpressions=a,this.arraySizePredictor=u,this.changes=c.ContentChanges.empty(),this.allocateNamedExpressionAddressSpace(),this.maxColumns=e.maxColumns,this.maxRows=e.maxRows}get sheetMapping(){return this.dependencyGraph.sheetMapping}get addressMapping(){return this.dependencyGraph.addressMapping}removeRows(e){const t=[];for(const r of e.rowsSpans()){const e=this.doRemoveRows(r);e&&t.push(e)}return t}addRows(e){for(const t of e.rowsSpans())this.doAddRows(t)}addColumns(e){for(const t of e.columnsSpans())this.doAddColumns(t)}removeColumns(e){const t=[];for(const r of e.columnsSpans()){const e=this.doRemoveColumns(r);e&&t.push(e)}return t}removeSheet(e){this.dependencyGraph.removeSheet(e);let t=0;this.stats.measure(v.StatType.TRANSFORM_ASTS,()=>{const r=new T.RemoveSheetTransformer(e);r.performEagerTransformations(this.dependencyGraph,this.parser),t=this.lazilyTransformingAstService.addTransformation(r)}),this.sheetMapping.removeSheet(e),this.columnSearch.removeSheet(e);const r=this.namedExpressions.getAllNamedExpressionsForScope(e).map(t=>this.removeNamedExpression(t.normalizeExpressionName(),e));return{version:t,scopedNamedExpressions:r}}removeSheetByName(e){const t=this.sheetMapping.fetch(e);return this.removeSheet(t)}clearSheet(e){this.dependencyGraph.clearSheet(e),this.columnSearch.removeSheet(e)}addSheet(e){const t=this.sheetMapping.addSheet(e);return this.dependencyGraph.addressMapping.autoAddSheet(t,(0,S.findBoundaries)([])),this.sheetMapping.fetchDisplayName(t)}renameSheet(e,t){return this.sheetMapping.renameSheet(e,t)}moveRows(e,t,r,n){const o=C.RowsSpan.fromNumberOfRows(e,n,r);this.lazilyTransformingAstService.beginCombinedMode(e),this.doAddRows(o),n<t&&(t+=r);const s=(0,i.simpleCellAddress)(e,0,t),a=(0,i.simpleCellAddress)(e,0,n);this.moveCells(s,Number.POSITIVE_INFINITY,r,a);const u=C.RowsSpan.fromNumberOfRows(e,t,r);return this.doRemoveRows(u),this.lazilyTransformingAstService.commitCombinedMode()}moveColumns(e,t,r,n){const o=C.ColumnsSpan.fromNumberOfColumns(e,n,r);this.lazilyTransformingAstService.beginCombinedMode(e),this.doAddColumns(o),n<t&&(t+=r);const s=(0,i.simpleCellAddress)(e,t,0),a=(0,i.simpleCellAddress)(e,n,0);this.moveCells(s,r,Number.POSITIVE_INFINITY,a);const u=C.ColumnsSpan.fromNumberOfColumns(e,t,r);return this.doRemoveColumns(u),this.lazilyTransformingAstService.commitCombinedMode()}moveCells(e,t,r,o){this.ensureItIsPossibleToMoveCells(e,t,r,o);const s=n.AbsoluteCellRange.spanFrom(e,t,r),i=n.AbsoluteCellRange.spanFrom(o,t,r),a=o.col-e.col,u=o.row-e.row,c=o.sheet,l=this.getRangeClipboardCells(i),h=this.dependencyGraph.rawValuesFromRange(i);this.columnSearch.removeValues(h);const d=this.dependencyGraph.rawValuesFromRange(s);this.columnSearch.moveValues(d,a,u,c);let p=0;this.stats.measure(v.StatType.TRANSFORM_ASTS,()=>{const e=new g.MoveCellsTransformer(s,a,u,c);e.performEagerTransformations(this.dependencyGraph,this.parser),p=this.lazilyTransformingAstService.addTransformation(e)}),this.dependencyGraph.moveCells(s,a,u,c);const m=this.updateNamedExpressionsForMovedCells(e,t,r,o);return{version:p,overwrittenCellsData:l,addedGlobalNamedExpressions:m}}setRowOrder(e,t){const r=[];let o=[];for(const[s,i]of t)if(s!==i){const t=n.AbsoluteCellRange.spanFrom({sheet:e,col:0,row:s},1/0,1),a=this.getRangeClipboardCells(t);o=o.concat(a),r.push(a.map(([{sheet:e,col:t},r])=>[{sheet:e,col:t,row:i},r]))}return r.forEach(t=>this.restoreClipboardCells(e,t.values())),o}setColumnOrder(e,t){const r=[];let o=[];for(const[s,i]of t)if(s!==i){const t=n.AbsoluteCellRange.spanFrom({sheet:e,col:s,row:0},1,1/0),a=this.getRangeClipboardCells(t);o=o.concat(a),r.push(a.map(([{sheet:e,col:t,row:r},n])=>[{sheet:e,col:i,row:r},n]))}return r.forEach(t=>this.restoreClipboardCells(e,t.values())),o}addNamedExpression(e,t,r,n){const o=this.namedExpressions.addNamedExpression(e,r,n);this.storeNamedExpressionInCell(o.address,t),this.adjustNamedExpressionEdges(o,e,r)}restoreNamedExpression(e,t,r){const n=e.displayName;this.restoreCell(e.address,t);const o=this.namedExpressions.restoreNamedExpression(e,r);this.adjustNamedExpressionEdges(o,n,r)}changeNamedExpressionExpression(e,t,r,n){const o=this.namedExpressions.namedExpressionForScope(e,r);if(!o)throw new y.NamedExpressionDoesNotExistError(e);const s=o.copy();o.options=n;const i=this.getClipboardCell(o.address);return this.storeNamedExpressionInCell(o.address,t),[s,i]}removeNamedExpression(e,t){const r=this.namedExpressions.namedExpressionForScope(e,t);if(!r)throw new y.NamedExpressionDoesNotExistError(e);this.namedExpressions.remove(r.displayName,t);const n=this.getClipboardCell(r.address);if(void 0!==t){const t=this.namedExpressions.workbookNamedExpressionOrPlaceholder(e);this.dependencyGraph.exchangeNode(r.address,t.address)}else this.dependencyGraph.setCellEmpty(r.address);return[r,n]}ensureItIsPossibleToMoveCells(e,t,r,o){if((0,i.invalidSimpleCellAddress)(e)||!(M(t)&&M(r)||function(e,t,r){return 0===e.row&&M(t)&&r===Number.POSITIVE_INFINITY||0===e.col&&M(r)&&t===Number.POSITIVE_INFINITY}(e,t,r))||(0,i.invalidSimpleCellAddress)(o)||!this.sheetMapping.hasSheetWithId(e.sheet)||!this.sheetMapping.hasSheetWithId(o.sheet))throw new y.InvalidArgumentsError("a valid range of cells to move.");const s=n.AbsoluteCellRange.spanFrom(e,t,r),a=n.AbsoluteCellRange.spanFrom(o,t,r);if(a.exceedsSheetSizeLimits(this.maxColumns,this.maxRows))throw new y.SheetSizeLimitExceededError;if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(s))throw new y.SourceLocationHasArrayError;if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(a))throw new y.TargetLocationHasArrayError}restoreClipboardCells(e,t){const r=[];for(const[n,o]of t)if(this.restoreCell(n,o),o.type===u.ClipboardCellType.FORMULA){const{dependencies:t}=this.parser.fetchCachedResult(o.hash);r.push(...this.updateNamedExpressionsForTargetAddress(e,n,t))}return r}restoreCell(e,t){switch(t.type){case u.ClipboardCellType.VALUE:this.setValueToCell(t,e);break;case u.ClipboardCellType.FORMULA:this.setFormulaToCellFromCache(t.hash,e);break;case u.ClipboardCellType.EMPTY:this.setCellEmpty(e);break;case u.ClipboardCellType.PARSING_ERROR:this.setParsingErrorToCell(t.rawInput,t.errors,e)}}getOldContent(e){const t=this.dependencyGraph.getCell(e);if(void 0===t||t instanceof l.EmptyCellVertex)return[e,{type:u.ClipboardCellType.EMPTY}];if(t instanceof l.ValueCellVertex)return[e,Object.assign({type:u.ClipboardCellType.VALUE},t.getValues())];if(t instanceof h.FormulaVertex)return[t.getAddress(this.lazilyTransformingAstService),{type:u.ClipboardCellType.FORMULA,hash:this.parser.computeHashFromAst(t.getFormula(this.lazilyTransformingAstService))}];if(t instanceof l.ParsingErrorVertex)return[e,{type:u.ClipboardCellType.PARSING_ERROR,rawInput:t.rawInput,errors:t.errors}];throw Error("Trying to copy unsupported type")}getClipboardCell(e){const t=this.dependencyGraph.getCell(e);if(void 0===t||t instanceof l.EmptyCellVertex)return{type:u.ClipboardCellType.EMPTY};if(t instanceof l.ValueCellVertex)return Object.assign({type:u.ClipboardCellType.VALUE},t.getValues());if(t instanceof l.ArrayVertex){const r=t.getArrayCellValue(e);return r===A.EmptyValue?{type:u.ClipboardCellType.EMPTY}:{type:u.ClipboardCellType.VALUE,parsedValue:r,rawValue:t.getArrayCellRawValue(e)}}if(t instanceof l.FormulaCellVertex)return{type:u.ClipboardCellType.FORMULA,hash:this.parser.computeHashFromAst(t.getFormula(this.lazilyTransformingAstService))};if(t instanceof l.ParsingErrorVertex)return{type:u.ClipboardCellType.PARSING_ERROR,rawInput:t.rawInput,errors:t.errors};throw Error("Trying to copy unsupported type")}getSheetClipboardCells(e){const t=this.dependencyGraph.getSheetHeight(e),r=this.dependencyGraph.getSheetWidth(e),n=new Array(t);for(let o=0;o<t;o++){n[o]=new Array(r);for(let t=0;t<r;t++){const r=(0,i.simpleCellAddress)(e,t,o);n[o][t]=this.getClipboardCell(r)}}return n}getRangeClipboardCells(e){const t=[];for(const r of e.addresses(this.dependencyGraph))t.push([r,this.getClipboardCell(r)]);return t}setCellContent(e,t){const r=this.cellContentParser.parse(t),n=this.getOldContent(e);if(r instanceof a.CellContent.Formula){const t=this.parser.parse(r.formula,e),{ast:n,errors:o}=t;if(o.length>0)this.setParsingErrorToCell(r.formula,o,e);else try{const r=this.arraySizePredictor.checkArraySize(n,e);if(r.width<=0||r.height<=0)throw Error("Incorrect array size");this.setFormulaToCell(e,r,t)}catch(t){if(!t.message)throw t;const n={type:N.ParsingErrorType.InvalidRangeSize,message:"Invalid range size."};this.setParsingErrorToCell(r.formula,[n],e)}}else r instanceof a.CellContent.Empty?this.setCellEmpty(e):this.setValueToCell({parsedValue:r.value,rawValue:t},e);return n}setSheetContent(e,t){this.clearSheet(e);for(let r=0;r<t.length;r++)for(let n=0;n<t[r].length;n++){const o=(0,i.simpleCellAddress)(e,n,r);this.setCellContent(o,t[r][n])}}setParsingErrorToCell(e,t,r){const n=this.dependencyGraph.getCellValue(r),o=new l.ParsingErrorVertex(t,e),s=this.dependencyGraph.setParsingErrorToCell(r,o);this.columnSearch.remove((0,A.getRawValue)(n),r),this.columnSearch.applyChanges(s.getChanges()),this.changes.addAll(s),this.changes.addChange(o.getCellValue(),r)}setFormulaToCell(e,t,{ast:r,hasVolatileFunction:n,hasStructuralChangeFunction:s,dependencies:i}){const a=this.dependencyGraph.getCellValue(e),u=this.dependencyGraph.setFormulaToCell(e,r,(0,o.absolutizeDependencies)(i,e),t,n,s);this.columnSearch.remove((0,A.getRawValue)(a),e),this.columnSearch.applyChanges(u.getChanges()),this.changes.addAll(u)}setValueToCell(e,t){const r=this.dependencyGraph.getCellValue(t),n=this.dependencyGraph.setValueToCell(t,e);this.columnSearch.change((0,A.getRawValue)(r),(0,A.getRawValue)(e.parsedValue),t),this.columnSearch.applyChanges(n.getChanges().filter(e=>!(0,i.equalSimpleCellAddress)(e.address,t))),this.changes.addAll(n),this.changes.addChange(e.parsedValue,t)}setCellEmpty(e){if(this.dependencyGraph.isArrayInternalCell(e))return;const t=this.dependencyGraph.getCellValue(e),r=this.dependencyGraph.setCellEmpty(e);this.columnSearch.remove((0,A.getRawValue)(t),e),this.columnSearch.applyChanges(r.getChanges()),this.changes.addAll(r),this.changes.addChange(A.EmptyValue,e)}setFormulaToCellFromCache(e,t){const{ast:r,hasVolatileFunction:n,hasStructuralChangeFunction:s,dependencies:i}=this.parser.fetchCachedResult(e),a=(0,o.absolutizeDependencies)(i,t),[u]=new m.CleanOutOfScopeDependenciesTransformer(t.sheet).transformSingleAst(r,t);this.parser.rememberNewAst(u);const c=(0,o.filterDependenciesOutOfScope)(a),l=this.arraySizePredictor.checkArraySize(r,t);this.dependencyGraph.setFormulaToCell(t,u,c,l,n,s)}rowEffectivelyNotInSheet(e,t){return e>=this.dependencyGraph.addressMapping.getHeight(t)}getAndClearContentChanges(){const e=this.changes;return this.changes=c.ContentChanges.empty(),e}forceApplyPostponedTransformations(){this.dependencyGraph.forceApplyPostponedTransformations()}doRemoveRows(e){if(this.rowEffectivelyNotInSheet(e.rowStart,e.sheet))return;const t=[];for(const[r]of this.dependencyGraph.entriesFromRowsSpan(e))t.push({address:r,cellType:this.getClipboardCell(r)});const{affectedArrays:r,contentChanges:n}=this.dependencyGraph.removeRows(e);this.columnSearch.applyChanges(n.getChanges());let o=0;return this.stats.measure(v.StatType.TRANSFORM_ASTS,()=>{const t=new E.RemoveRowsTransformer(e);t.performEagerTransformations(this.dependencyGraph,this.parser),o=this.lazilyTransformingAstService.addTransformation(t)}),this.rewriteAffectedArrays(r),{version:o,removedCells:t,rowFrom:e.rowStart,rowCount:e.numberOfRows}}doRemoveColumns(e){if(this.columnEffectivelyNotInSheet(e.columnStart,e.sheet))return;const t=[];for(const[r]of this.dependencyGraph.entriesFromColumnsSpan(e))t.push({address:r,cellType:this.getClipboardCell(r)});const{affectedArrays:r,contentChanges:n}=this.dependencyGraph.removeColumns(e);this.columnSearch.applyChanges(n.getChanges()),this.columnSearch.removeColumns(e);let o=0;return this.stats.measure(v.StatType.TRANSFORM_ASTS,()=>{const t=new f.RemoveColumnsTransformer(e);t.performEagerTransformations(this.dependencyGraph,this.parser),o=this.lazilyTransformingAstService.addTransformation(t)}),this.rewriteAffectedArrays(r),{version:o,removedCells:t,columnFrom:e.columnStart,columnCount:e.numberOfColumns}}doAddRows(e){if(this.rowEffectivelyNotInSheet(e.rowStart,e.sheet))return;const{affectedArrays:t}=this.dependencyGraph.addRows(e);this.stats.measure(v.StatType.TRANSFORM_ASTS,()=>{const t=new p.AddRowsTransformer(e);t.performEagerTransformations(this.dependencyGraph,this.parser),this.lazilyTransformingAstService.addTransformation(t)}),this.rewriteAffectedArrays(t)}rewriteAffectedArrays(e){for(const t of e.values()){if(t.array.size.isRef)continue;const e=t.getFormula(this.lazilyTransformingAstService),r=t.getAddress(this.lazilyTransformingAstService),n=this.parser.computeHashFromAst(e);this.setFormulaToCellFromCache(n,r)}}doAddColumns(e){if(this.columnEffectivelyNotInSheet(e.columnStart,e.sheet))return;const{affectedArrays:t,contentChanges:r}=this.dependencyGraph.addColumns(e);this.columnSearch.addColumns(e),this.columnSearch.applyChanges(r.getChanges()),this.stats.measure(v.StatType.TRANSFORM_ASTS,()=>{const t=new d.AddColumnsTransformer(e);t.performEagerTransformations(this.dependencyGraph,this.parser),this.lazilyTransformingAstService.addTransformation(t)}),this.rewriteAffectedArrays(t)}columnEffectivelyNotInSheet(e,t){return e>=this.dependencyGraph.addressMapping.getWidth(t)}adjustNamedExpressionEdges(e,t,r){if(void 0===r)return;const{vertex:n,id:s}=this.dependencyGraph.fetchCellOrCreateEmpty(e.address),i=null!=s?s:this.dependencyGraph.graph.getNodeId(n),a=this.namedExpressions.workbookNamedExpressionOrPlaceholder(t),{vertex:u,id:c}=this.dependencyGraph.fetchCellOrCreateEmpty(a.address),h=null!=c?c:this.dependencyGraph.graph.getNodeId(u);for(const t of this.dependencyGraph.graph.adjacentNodes(u))if(t instanceof l.FormulaCellVertex&&t.getAddress(this.lazilyTransformingAstService).sheet===r){const r=t.getFormula(this.lazilyTransformingAstService),n=t.getAddress(this.lazilyTransformingAstService),{dependencies:s}=this.parser.fetchCachedResultForAst(r);for(const r of(0,o.absolutizeDependencies)(s,n))r instanceof N.NamedExpressionDependency&&r.name.toLowerCase()===e.displayName.toLowerCase()&&(this.dependencyGraph.graph.removeEdge(h,t),this.dependencyGraph.graph.addEdge(i,t))}}storeNamedExpressionInCell(e,t){const r=this.cellContentParser.parse(t);if(r instanceof a.CellContent.Formula){const t=this.parser.parse(r.formula,(0,i.simpleCellAddress)(-1,0,0));if((0,R.doesContainRelativeReferences)(t.ast))throw new y.NoRelativeAddressesAllowedError;const{ast:n,hasVolatileFunction:a,hasStructuralChangeFunction:u,dependencies:c}=t;this.dependencyGraph.setFormulaToCell(e,n,(0,o.absolutizeDependencies)(c,e),s.ArraySize.scalar(),a,u)}else r instanceof a.CellContent.Empty?this.setCellEmpty(e):this.setValueToCell({parsedValue:r.value,rawValue:t},e)}updateNamedExpressionsForMovedCells(e,t,r,o){if(e.sheet===o.sheet)return[];const s=[],i=n.AbsoluteCellRange.spanFrom(o,t,r);for(const t of i.addresses(this.dependencyGraph)){const r=this.addressMapping.fetchCell(t);if(r instanceof l.FormulaCellVertex&&t.sheet!==e.sheet){const n=r.getFormula(this.lazilyTransformingAstService),{dependencies:o}=this.parser.fetchCachedResultForAst(n);s.push(...this.updateNamedExpressionsForTargetAddress(e.sheet,t,o))}}return s}updateNamedExpressionsForTargetAddress(e,t,r){if(e===t.sheet)return[];const n=[],s=this.addressMapping.fetchCell(t);for(const i of(0,o.absolutizeDependencies)(r,t)){if(!(i instanceof N.NamedExpressionDependency))continue;const r=i.name,o=this.dependencyGraph.fetchNamedExpressionVertex(r,e).vertex,a=this.namedExpressions.isExpressionInScope(r,t.sheet)?this.dependencyGraph.fetchNamedExpressionVertex(r,t.sheet).vertex:this.copyOrFetchGlobalNamedExpressionVertex(r,o,n);a!==o&&(this.dependencyGraph.graph.removeEdgeIfExists(o,s),this.dependencyGraph.graph.addEdge(a,s))}return n}allocateNamedExpressionAddressSpace(){this.dependencyGraph.addressMapping.addSheet(R.NamedExpressions.SHEET_FOR_WORKBOOK_EXPRESSIONS,new l.SparseStrategy(0,0))}copyOrFetchGlobalNamedExpressionVertex(e,t,r){let n=this.namedExpressions.namedExpressionForScope(e);if(void 0===n)if(n=this.namedExpressions.addNamedExpression(e),r.push(n.normalizeExpressionName()),t instanceof l.FormulaCellVertex){const e=this.parser.fetchCachedResultForAst(t.getFormula(this.lazilyTransformingAstService)),{ast:r,hasVolatileFunction:i,hasStructuralChangeFunction:a,dependencies:u}=e;this.dependencyGraph.setFormulaToCell(n.address,r,(0,o.absolutizeDependencies)(u,n.address),s.ArraySize.scalar(),i,a)}else t instanceof l.EmptyCellVertex?this.setCellEmpty(n.address):t instanceof l.ValueCellVertex&&this.setValueToCell(t.getValues(),n.address);return this.dependencyGraph.fetchCellOrCreateEmpty(n.address).vertex}}},function(e,t,r){"use strict";t.__esModule=!0,t.AddColumnsTransformer=void 0;var n=r(73),o=r(188);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
class s extends o.Transformer{constructor(e){super(),this.columnsSpan=e}get sheet(){return this.columnsSpan.sheet}isIrreversible(){return!1}transformRowRangeAst(e,t){return e}transformCellRange(e,t,r){return this.transformRange(e,t,r)}transformRowRange(e,t,r){throw Error("Not implemented")}transformColumnRange(e,t,r){return this.transformRange(e,t,r)}transformCellAddress(e,t){const r=(0,n.absoluteSheetReference)(e,t);if(r!==this.columnsSpan.sheet&&t.sheet!==this.columnsSpan.sheet)return!1;const o=e.toSimpleColumnAddress(t);return r===this.columnsSpan.sheet&&t.sheet!==this.columnsSpan.sheet?this.columnsSpan.columnStart<=o.col&&e.shiftedByColumns(this.columnsSpan.numberOfColumns):t.sheet===this.columnsSpan.sheet&&r!==this.columnsSpan.sheet?!e.isColumnAbsolute()&&!(t.col<this.columnsSpan.columnStart)&&e.shiftedByColumns(-this.columnsSpan.numberOfColumns):e.isColumnAbsolute()?!(e.col<this.columnsSpan.columnStart)&&e.shiftedByColumns(this.columnsSpan.numberOfColumns):e.toSimpleColumnAddress(t).col<this.columnsSpan.columnStart?!(t.col<this.columnsSpan.columnStart)&&e.shiftedByColumns(-this.columnsSpan.numberOfColumns):t.col<this.columnsSpan.columnStart&&e.shiftedByColumns(this.columnsSpan.numberOfColumns)}fixNodeAddress(e){return this.columnsSpan.sheet===e.sheet&&this.columnsSpan.columnStart<=e.col?Object.assign(Object.assign({},e),{col:e.col+this.columnsSpan.numberOfColumns}):e}transformRange(e,t,r){const o=this.transformCellAddress(e,r),s=this.transformCellAddress(t,r);return o===n.ErrorType.REF||s===n.ErrorType.REF?n.ErrorType.REF:!(!o&&!s)&&[o||e,s||t]}}t.AddColumnsTransformer=s},function(e,t,r){"use strict";t.__esModule=!0,t.Transformer=void 0;var n=r(73),o=r(77);t.Transformer=
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
class{performEagerTransformations(e,t){for(const r of e.arrayFormulaNodes()){const[n,o]=this.transformSingleAst(r.getFormula(e.lazilyTransformingAstService),r.getAddress(e.lazilyTransformingAstService)),s=t.rememberNewAst(n);r.setFormula(s),r.setAddress(o)}}transformSingleAst(e,t){return[this.transformAst(e,t),this.fixNodeAddress(t)]}transformAst(e,t){switch(e.type){case o.AstNodeType.CELL_REFERENCE:return this.transformCellReferenceAst(e,t);case o.AstNodeType.CELL_RANGE:return this.transformCellRangeAst(e,t);case o.AstNodeType.COLUMN_RANGE:return this.transformColumnRangeAst(e,t);case o.AstNodeType.ROW_RANGE:return this.transformRowRangeAst(e,t);case o.AstNodeType.EMPTY:case o.AstNodeType.ERROR:case o.AstNodeType.NUMBER:case o.AstNodeType.NAMED_EXPRESSION:case o.AstNodeType.ERROR_WITH_RAW_INPUT:case o.AstNodeType.STRING:return e;case o.AstNodeType.PERCENT_OP:case o.AstNodeType.MINUS_UNARY_OP:case o.AstNodeType.PLUS_UNARY_OP:return Object.assign(Object.assign({},e),{value:this.transformAst(e.value,t)});case o.AstNodeType.FUNCTION_CALL:return Object.assign(Object.assign({},e),{procedureName:e.procedureName,args:e.args.map(e=>this.transformAst(e,t))});case o.AstNodeType.PARENTHESIS:return Object.assign(Object.assign({},e),{expression:this.transformAst(e.expression,t)});case o.AstNodeType.ARRAY:return Object.assign(Object.assign({},e),{args:e.args.map(e=>e.map(e=>this.transformAst(e,t)))});default:return Object.assign(Object.assign({},e),{left:this.transformAst(e.left,t),right:this.transformAst(e.right,t)})}}transformCellReferenceAst(e,t){const r=this.transformCellAddress(e.reference,t);return r instanceof o.CellAddress?Object.assign(Object.assign({},e),{reference:r}):r===n.ErrorType.REF?(0,o.buildCellErrorAst)(new n.CellError(n.ErrorType.REF)):e}transformCellRangeAst(e,t){const r=this.transformCellRange(e.start,e.end,t);return Array.isArray(r)?Object.assign(Object.assign({},e),{start:r[0],end:r[1]}):r===n.ErrorType.REF?(0,o.buildCellErrorAst)(new n.CellError(n.ErrorType.REF)):e}transformColumnRangeAst(e,t){const r=this.transformColumnRange(e.start,e.end,t);return Array.isArray(r)?Object.assign(Object.assign({},e),{start:r[0],end:r[1]}):r===n.ErrorType.REF?(0,o.buildCellErrorAst)(new n.CellError(n.ErrorType.REF)):e}transformRowRangeAst(e,t){const r=this.transformRowRange(e.start,e.end,t);return Array.isArray(r)?Object.assign(Object.assign({},e),{start:r[0],end:r[1]}):r===n.ErrorType.REF?(0,o.buildCellErrorAst)(new n.CellError(n.ErrorType.REF)):e}}},function(e,t,r){"use strict";t.__esModule=!0,t.AddRowsTransformer=void 0;var n=r(73),o=r(188);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
class s extends o.Transformer{constructor(e){super(),this.rowsSpan=e}get sheet(){return this.rowsSpan.sheet}isIrreversible(){return!1}transformColumnRangeAst(e,t){return e}transformCellRange(e,t,r){return this.transformRange(e,t,r)}transformRowRange(e,t,r){return this.transformRange(e,t,r)}transformColumnRange(e,t,r){throw Error("Not implemented")}transformCellAddress(e,t){const r=(0,n.absoluteSheetReference)(e,t);if(r!==this.rowsSpan.sheet&&t.sheet!==this.rowsSpan.sheet)return!1;const o=e.toSimpleRowAddress(t);return r===this.rowsSpan.sheet&&t.sheet!==this.rowsSpan.sheet?this.rowsSpan.rowStart<=o.row&&e.shiftedByRows(this.rowsSpan.numberOfRows):t.sheet===this.rowsSpan.sheet&&r!==this.rowsSpan.sheet?!e.isRowAbsolute()&&!(t.row<this.rowsSpan.rowStart)&&e.shiftedByRows(-this.rowsSpan.numberOfRows):e.isRowAbsolute()?!(e.row<this.rowsSpan.rowStart)&&e.shiftedByRows(this.rowsSpan.numberOfRows):o.row<this.rowsSpan.rowStart?!(t.row<this.rowsSpan.rowStart)&&e.shiftedByRows(-this.rowsSpan.numberOfRows):t.row<this.rowsSpan.rowStart&&e.shiftedByRows(this.rowsSpan.numberOfRows)}fixNodeAddress(e){return this.rowsSpan.sheet===e.sheet&&this.rowsSpan.rowStart<=e.row?Object.assign(Object.assign({},e),{row:e.row+this.rowsSpan.numberOfRows}):e}transformRange(e,t,r){const o=this.transformCellAddress(e,r),s=this.transformCellAddress(t,r);return o===n.ErrorType.REF||s===n.ErrorType.REF?n.ErrorType.REF:!(!o&&!s)&&[o||e,s||t]}}t.AddRowsTransformer=s},function(e,t,r){"use strict";t.__esModule=!0,t.CleanOutOfScopeDependenciesTransformer=void 0;var n=r(73),o=r(188);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
class s extends o.Transformer{constructor(e){super(),this.sheet=e}isIrreversible(){return!0}fixNodeAddress(e){return e}transformCellAddress(e,t){return!!e.isInvalid(t)&&n.ErrorType.REF}transformCellRange(e,t,r){return!(!e.isInvalid(r)&&!t.isInvalid(r))&&n.ErrorType.REF}transformColumnRange(e,t,r){return!(!e.isInvalid(r)&&!t.isInvalid(r))&&n.ErrorType.REF}transformRowRange(e,t,r){return!(!e.isInvalid(r)&&!t.isInvalid(r))&&n.ErrorType.REF}}t.CleanOutOfScopeDependenciesTransformer=s},function(e,t,r){"use strict";t.__esModule=!0,t.MoveCellsTransformer=t.DependentFormulaTransformer=void 0;var n=r(73),o=r(77),s=r(81),i=r(188);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
class a extends i.Transformer{constructor(e,t,r,n){super(),this.sourceRange=e,this.toRight=t,this.toBottom=r,this.toSheet=n,this.dependentFormulaTransformer=new u(e,t,r,n)}get sheet(){return this.sourceRange.sheet}isIrreversible(){return!0}transformSingleAst(e,t){return this.sourceRange.addressInRange(t)?[this.transformAst(e,t),this.fixNodeAddress(t)]:this.dependentFormulaTransformer.transformSingleAst(e,t)}fixNodeAddress(e){return(0,n.simpleCellAddress)(this.toSheet,e.col+this.toRight,e.row+this.toBottom)}transformCellAddress(e,t){return this.transformAddress(e,t)}transformCellRange(e,t,r){return this.transformRange(e,t,r)}transformColumnRange(e,t,r){return this.transformRange(e,t,r)}transformRowRange(e,t,r){return this.transformRange(e,t,r)}transformAddress(e,t){const r=this.sourceRange;if(e instanceof o.CellAddress){const n=e.toSimpleCellAddress(t);if(r.addressInRange(n))return e.shiftAbsoluteDimensions(this.toRight,this.toBottom)}return e.shiftRelativeDimensions(-this.toRight,-this.toBottom)}transformRange(e,t,r){const n=this.sourceRange;if(e instanceof o.CellAddress&&t instanceof o.CellAddress){const o=e.toSimpleCellAddress(r),s=t.toSimpleCellAddress(r);if(n.addressInRange(o)&&n.addressInRange(s))return[e.shiftAbsoluteDimensions(this.toRight,this.toBottom),t.shiftAbsoluteDimensions(this.toRight,this.toBottom)]}return[e.shiftRelativeDimensions(-this.toRight,-this.toBottom),t.shiftRelativeDimensions(-this.toRight,-this.toBottom)]}}t.MoveCellsTransformer=a;class u extends i.Transformer{constructor(e,t,r,n){super(),this.sourceRange=e,this.toRight=t,this.toBottom=r,this.toSheet=n}get sheet(){return this.sourceRange.sheet}isIrreversible(){return!0}fixNodeAddress(e){return e}transformCellAddress(e,t){return!!this.shouldMove(e,t)&&e.moved(this.toSheet,this.toRight,this.toBottom)}transformCellRange(e,t,r){return this.transformRange(e,t,r)}transformColumnRange(e,t,r){return this.transformRange(e,t,r)}transformRowRange(e,t,r){return this.transformRange(e,t,r)}shouldMove(e,t){return e instanceof o.CellAddress?this.sourceRange.addressInRange(e.toSimpleCellAddress(t)):e instanceof s.RowAddress?this.sourceRange.rowInRange(e.toSimpleRowAddress(t))&&!this.sourceRange.isFinite():this.sourceRange.columnInRange(e.toSimpleColumnAddress(t))&&!this.sourceRange.isFinite()}transformRange(e,t,r){const n=this.transformCellAddress(e,r),o=this.transformCellAddress(t,r);return!(!n||!o)&&[n,o]}}t.DependentFormulaTransformer=u},function(e,t,r){"use strict";t.__esModule=!0,t.RemoveColumnsTransformer=void 0;var n=r(73),o=r(188);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
class s extends o.Transformer{constructor(e){super(),this.columnsSpan=e}get sheet(){return this.columnsSpan.sheet}isIrreversible(){return!0}transformRowRangeAst(e,t){return e}transformCellRange(e,t,r){return this.transformRange(e,t,r)}transformRowRange(e,t,r){throw Error("Not implemented")}transformColumnRange(e,t,r){return this.transformRange(e,t,r)}transformCellAddress(e,t){const r=(0,n.absoluteSheetReference)(e,t);if(this.columnsSpan.sheet!==t.sheet&&this.columnsSpan.sheet!==r)return!1;if(this.columnsSpan.sheet!==t.sheet&&this.columnsSpan.sheet===r){const r=e.toSimpleColumnAddress(t);if(r.col<this.columnsSpan.columnStart)return!1;if(r.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns)}if(this.columnsSpan.sheet===t.sheet&&this.columnsSpan.sheet!==r){if(e.isColumnAbsolute())return!1;if(t.col<this.columnsSpan.columnStart)return!1;if(t.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(this.columnsSpan.numberOfColumns)}if(this.columnsSpan.sheet===t.sheet&&this.columnsSpan.sheet===r)if(e.isColumnAbsolute()){if(e.col<this.columnsSpan.columnStart)return!1;if(e.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns)}else{const r=e.toSimpleColumnAddress(t);if(r.col<this.columnsSpan.columnStart){if(t.col<this.columnsSpan.columnStart)return!1;if(t.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(this.columnsSpan.numberOfColumns)}else if(r.col>this.columnsSpan.columnEnd){if(t.col<this.columnsSpan.columnStart)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns);if(t.col>this.columnsSpan.columnEnd)return!1}}return n.ErrorType.REF}fixNodeAddress(e){return this.columnsSpan.sheet===e.sheet&&this.columnsSpan.columnStart<=e.col?Object.assign(Object.assign({},e),{col:e.col-this.columnsSpan.numberOfColumns}):e}transformRange(e,t,r){const o=(0,n.absoluteSheetReference)(e,r);let s=e,i=t;if(this.columnsSpan.sheet===o){const o=e.toSimpleColumnAddress(r),a=t.toSimpleColumnAddress(r);if(this.columnsSpan.columnStart<=o.col&&this.columnsSpan.columnEnd>=a.col)return n.ErrorType.REF;o.col>=this.columnsSpan.columnStart&&o.col<=this.columnsSpan.columnEnd&&(s=e.shiftedByColumns(this.columnsSpan.columnEnd-o.col+1)),a.col>=this.columnsSpan.columnStart&&a.col<=this.columnsSpan.columnEnd&&(i=t.shiftedByColumns(-(a.col-this.columnsSpan.columnStart+1)))}const a=this.transformCellAddress(s,r),u=this.transformCellAddress(i,r);if(!1===a&&!1===u)return[s,i];if(a===n.ErrorType.REF||u===n.ErrorType.REF)throw Error("Cannot happen");return[a||s,u||i]}}t.RemoveColumnsTransformer=s},function(e,t,r){"use strict";t.__esModule=!0,t.RemoveRowsTransformer=void 0;var n=r(73),o=r(188);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
class s extends o.Transformer{constructor(e){super(),this.rowsSpan=e}get sheet(){return this.rowsSpan.sheet}isIrreversible(){return!0}transformColumnRangeAst(e,t){return e}transformCellAddress(e,t){const r=(0,n.absoluteSheetReference)(e,t);if(this.rowsSpan.sheet!==t.sheet&&this.rowsSpan.sheet!==r)return!1;if(this.rowsSpan.sheet!==t.sheet&&this.rowsSpan.sheet===r){const r=e.toSimpleRowAddress(t);if(r.row<this.rowsSpan.rowStart)return!1;if(r.row>this.rowsSpan.rowEnd)return e.shiftedByRows(-this.rowsSpan.numberOfRows)}if(this.rowsSpan.sheet===t.sheet&&this.rowsSpan.sheet!==r){if(e.isRowAbsolute())return!1;if(t.row<this.rowsSpan.rowStart)return!1;if(t.row>this.rowsSpan.rowEnd)return e.shiftedByRows(this.rowsSpan.numberOfRows)}if(this.rowsSpan.sheet===t.sheet&&this.rowsSpan.sheet===r)if(e.isRowAbsolute()){if(e.row<this.rowsSpan.rowStart)return!1;if(e.row>this.rowsSpan.rowEnd)return e.shiftedByRows(-this.rowsSpan.numberOfRows)}else{const r=e.toSimpleRowAddress(t);if(r.row<this.rowsSpan.rowStart){if(t.row<this.rowsSpan.rowStart)return!1;if(t.row>this.rowsSpan.rowEnd)return e.shiftedByRows(this.rowsSpan.numberOfRows)}else if(r.row>this.rowsSpan.rowEnd){if(t.row<this.rowsSpan.rowStart)return e.shiftedByRows(-this.rowsSpan.numberOfRows);if(t.row>this.rowsSpan.rowEnd)return!1}}return n.ErrorType.REF}transformCellRange(e,t,r){return this.transformRange(e,t,r)}transformRowRange(e,t,r){return this.transformRange(e,t,r)}transformColumnRange(e,t,r){throw Error("Not implemented")}fixNodeAddress(e){return this.rowsSpan.sheet===e.sheet&&this.rowsSpan.rowStart<=e.row?Object.assign(Object.assign({},e),{row:e.row-this.rowsSpan.numberOfRows}):e}transformRange(e,t,r){const o=(0,n.absoluteSheetReference)(e,r);let s=e,i=t;if(this.rowsSpan.sheet===o){const o=e.toSimpleRowAddress(r),a=t.toSimpleRowAddress(r);if(this.rowsSpan.rowStart<=o.row&&this.rowsSpan.rowEnd>=a.row)return n.ErrorType.REF;o.row>=this.rowsSpan.rowStart&&o.row<=this.rowsSpan.rowEnd&&(s=e.shiftedByRows(this.rowsSpan.rowEnd-o.row+1)),a.row>=this.rowsSpan.rowStart&&a.row<=this.rowsSpan.rowEnd&&(i=t.shiftedByRows(-(a.row-this.rowsSpan.rowStart+1)))}const a=this.transformCellAddress(s,r),u=this.transformCellAddress(i,r);return!1===a&&!1===u?[s,i]:a===n.ErrorType.REF||u===n.ErrorType.REF?n.ErrorType.REF:[a||s,u||i]}}t.RemoveRowsTransformer=s},function(e,t,r){"use strict";t.__esModule=!0,t.RemoveSheetTransformer=void 0;var n=r(73),o=r(188);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
class s extends o.Transformer{constructor(e){super(),this.sheet=e}isIrreversible(){return!0}performEagerTransformations(e,t){for(const t of e.arrayFormulaNodes()){const[r]=this.transformSingleAst(t.getFormula(e.lazilyTransformingAstService),t.getAddress(e.lazilyTransformingAstService));t.setFormula(r)}}fixNodeAddress(e){return e}transformCellAddress(e,t){return this.transformAddress(e)}transformCellRange(e,t,r){return this.transformAddress(e)}transformColumnRange(e,t,r){return this.transformAddress(e)}transformRowRange(e,t,r){return this.transformAddress(e)}transformAddress(e){return e.sheet===this.sheet&&n.ErrorType.REF}}t.RemoveSheetTransformer=s},function(e,t,r){"use strict";t.__esModule=!0,t.findBoundaries=function(e){let t=0,r=0,n=0;for(let o=0;o<e.length;o++){let s=0;for(let t=0;t<e[o].length;t++){const r=e[o][t];null!=r&&(s=t+1,++n)}t=Math.max(t,s),s>0&&(r=o+1)}const o=t*r;return{height:r,width:t,fill:0===o?0:n/o}},t.validateAsSheet=
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
function(e){if(!Array.isArray(e))throw new n.InvalidArgumentsError("an array of arrays.");for(let t=0;t<e.length;t++)if(!Array.isArray(e[t]))throw new n.InvalidArgumentsError("an array of arrays.")};var n=r(147)},function(e,t,r){"use strict";t.__esModule=!0,t.UndoRedo=t.SetSheetContentUndoEntry=t.SetRowOrderUndoEntry=t.SetColumnOrderUndoEntry=t.SetCellContentsUndoEntry=t.RenameSheetUndoEntry=t.RemoveSheetUndoEntry=t.RemoveRowsUndoEntry=t.RemoveNamedExpressionUndoEntry=t.RemoveColumnsUndoEntry=t.PasteUndoEntry=t.MoveRowsUndoEntry=t.MoveColumnsUndoEntry=t.MoveCellsUndoEntry=t.ClearSheetUndoEntry=t.ChangeNamedExpressionUndoEntry=t.BatchUndoEntry=t.BaseUndoEntry=t.AddSheetUndoEntry=t.AddRowsUndoEntry=t.AddNamedExpressionUndoEntry=t.AddColumnsUndoEntry=void 0,r(2);var n=r(73),o=r(186);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
class s{}t.BaseUndoEntry=s,t.RemoveRowsUndoEntry=class extends s{constructor(e,t){super(),this.command=e,this.rowsRemovals=t}doUndo(e){e.undoRemoveRows(this)}doRedo(e){e.redoRemoveRows(this)}},t.MoveCellsUndoEntry=class extends s{constructor(e,t,r,n,o,s,i){super(),this.sourceLeftCorner=e,this.width=t,this.height=r,this.destinationLeftCorner=n,this.overwrittenCellsData=o,this.addedGlobalNamedExpressions=s,this.version=i}doUndo(e){e.undoMoveCells(this)}doRedo(e){e.redoMoveCells(this)}},t.AddRowsUndoEntry=class extends s{constructor(e){super(),this.command=e}doUndo(e){e.undoAddRows(this)}doRedo(e){e.redoAddRows(this)}},t.SetRowOrderUndoEntry=class extends s{constructor(e,t,r){super(),this.sheetId=e,this.rowMapping=t,this.oldContent=r}doUndo(e){e.undoSetRowOrder(this)}doRedo(e){e.redoSetRowOrder(this)}},t.SetColumnOrderUndoEntry=class extends s{constructor(e,t,r){super(),this.sheetId=e,this.columnMapping=t,this.oldContent=r}doUndo(e){e.undoSetColumnOrder(this)}doRedo(e){e.redoSetColumnOrder(this)}},t.SetSheetContentUndoEntry=class extends s{constructor(e,t,r){super(),this.sheetId=e,this.oldSheetContent=t,this.newSheetContent=r}doUndo(e){e.undoSetSheetContent(this)}doRedo(e){e.redoSetSheetContent(this)}},t.MoveRowsUndoEntry=class extends s{constructor(e,t,r,n,o){super(),this.sheet=e,this.startRow=t,this.numberOfRows=r,this.targetRow=n,this.version=o,this.undoStart=this.startRow<this.targetRow?this.targetRow-this.numberOfRows:this.targetRow,this.undoEnd=this.startRow>this.targetRow?this.startRow+this.numberOfRows:this.startRow}doUndo(e){e.undoMoveRows(this)}doRedo(e){e.redoMoveRows(this)}},t.MoveColumnsUndoEntry=class extends s{constructor(e,t,r,n,o){super(),this.sheet=e,this.startColumn=t,this.numberOfColumns=r,this.targetColumn=n,this.version=o,this.undoStart=this.startColumn<this.targetColumn?this.targetColumn-this.numberOfColumns:this.targetColumn,this.undoEnd=this.startColumn>this.targetColumn?this.startColumn+this.numberOfColumns:this.startColumn}doUndo(e){e.undoMoveColumns(this)}doRedo(e){e.redoMoveColumns(this)}},t.AddColumnsUndoEntry=class extends s{constructor(e){super(),this.command=e}doUndo(e){e.undoAddColumns(this)}doRedo(e){e.redoAddColumns(this)}},t.RemoveColumnsUndoEntry=class extends s{constructor(e,t){super(),this.command=e,this.columnsRemovals=t}doUndo(e){e.undoRemoveColumns(this)}doRedo(e){e.redoRemoveColumns(this)}},t.AddSheetUndoEntry=class extends s{constructor(e){super(),this.sheetName=e}doUndo(e){e.undoAddSheet(this)}doRedo(e){e.redoAddSheet(this)}},t.RemoveSheetUndoEntry=class extends s{constructor(e,t,r,n,o){super(),this.sheetName=e,this.sheetId=t,this.oldSheetContent=r,this.scopedNamedExpressions=n,this.version=o}doUndo(e){e.undoRemoveSheet(this)}doRedo(e){e.redoRemoveSheet(this)}},t.RenameSheetUndoEntry=class extends s{constructor(e,t,r){super(),this.sheetId=e,this.oldName=t,this.newName=r}doUndo(e){e.undoRenameSheet(this)}doRedo(e){e.redoRenameSheet(this)}},t.ClearSheetUndoEntry=class extends s{constructor(e,t){super(),this.sheetId=e,this.oldSheetContent=t}doUndo(e){e.undoClearSheet(this)}doRedo(e){e.redoClearSheet(this)}},t.SetCellContentsUndoEntry=class extends s{constructor(e){super(),this.cellContents=e}doUndo(e){e.undoSetCellContents(this)}doRedo(e){e.redoSetCellContents(this)}},t.PasteUndoEntry=class extends s{constructor(e,t,r,n){super(),this.targetLeftCorner=e,this.oldContent=t,this.newContent=r,this.addedGlobalNamedExpressions=n}doUndo(e){e.undoPaste(this)}doRedo(e){e.redoPaste(this)}},t.AddNamedExpressionUndoEntry=class extends s{constructor(e,t,r,n){super(),this.name=e,this.newContent=t,this.scope=r,this.options=n}doUndo(e){e.undoAddNamedExpression(this)}doRedo(e){e.redoAddNamedExpression(this)}},t.RemoveNamedExpressionUndoEntry=class extends s{constructor(e,t,r){super(),this.namedExpression=e,this.content=t,this.scope=r}doUndo(e){e.undoRemoveNamedExpression(this)}doRedo(e){e.redoRemoveNamedExpression(this)}},t.ChangeNamedExpressionUndoEntry=class extends s{constructor(e,t,r,n,o){super(),this.namedExpression=e,this.newContent=t,this.oldContent=r,this.scope=n,this.options=o}doUndo(e){e.undoChangeNamedExpression(this)}doRedo(e){e.redoChangeNamedExpression(this)}};class i extends s{constructor(){super(...arguments),this.operations=[]}add(e){this.operations.push(e)}*reversedOperations(){for(let e=this.operations.length-1;e>=0;e--)yield this.operations[e]}doUndo(e){e.undoBatch(this)}doRedo(e){e.redoBatch(this)}}t.BatchUndoEntry=i,t.UndoRedo=class{constructor(e,t){this.operations=t,this.oldData=new Map,this.undoStack=[],this.redoStack=[],this.undoLimit=e.undoLimit}saveOperation(e){void 0!==this.batchUndoEntry?this.batchUndoEntry.add(e):this.addUndoEntry(e)}beginBatchMode(){this.batchUndoEntry=new i}commitBatchMode(){if(void 0===this.batchUndoEntry)throw Error("Batch mode wasn't started");this.addUndoEntry(this.batchUndoEntry),this.batchUndoEntry=void 0}storeDataForVersion(e,t,r){this.oldData.has(e)||this.oldData.set(e,[]),this.oldData.get(e).push([t,r])}clearRedoStack(){this.redoStack=[]}clearUndoStack(){this.undoStack=[]}isUndoStackEmpty(){return 0===this.undoStack.length}isRedoStackEmpty(){return 0===this.redoStack.length}undo(){const e=this.undoStack.pop();if(!e)throw Error("Attempted to undo without operation on stack");this.undoEntry(e),this.redoStack.push(e)}undoBatch(e){for(const t of e.reversedOperations())this.undoEntry(t)}undoRemoveRows(e){this.operations.forceApplyPostponedTransformations();const{command:{sheet:t},rowsRemovals:r}=e;for(let e=r.length-1;e>=0;--e){const n=r[e];this.operations.addRows(new o.AddRowsCommand(t,[[n.rowFrom,n.rowCount]]));for(const{address:e,cellType:t}of n.removedCells)this.operations.restoreCell(e,t);this.restoreOldDataFromVersion(n.version-1)}}undoRemoveColumns(e){this.operations.forceApplyPostponedTransformations();const{command:{sheet:t},columnsRemovals:r}=e;for(let e=r.length-1;e>=0;--e){const n=r[e];this.operations.addColumns(new o.AddColumnsCommand(t,[[n.columnFrom,n.columnCount]]));for(const{address:e,cellType:t}of n.removedCells)this.operations.restoreCell(e,t);this.restoreOldDataFromVersion(n.version-1)}}undoAddRows(e){const t=e.command.rowsSpans();for(let r=t.length-1;r>=0;--r){const n=t[r];this.operations.removeRows(new o.RemoveRowsCommand(e.command.sheet,[[n.rowStart,n.numberOfRows]]))}}undoAddColumns(e){const t=e.command.columnsSpans();for(let r=t.length-1;r>=0;--r){const n=t[r];this.operations.removeColumns(new o.RemoveColumnsCommand(e.command.sheet,[[n.columnStart,n.numberOfColumns]]))}}undoSetCellContents(e){for(const t of e.cellContents){const e=t.address,[r,o]=t.oldContent;(0,n.equalSimpleCellAddress)(e,r)||this.operations.setCellEmpty(e),this.operations.restoreCell(r,o)}}undoPaste(e){this.restoreOperationOldContent(e.oldContent);for(const t of e.addedGlobalNamedExpressions)this.operations.removeNamedExpression(t)}undoMoveRows(e){const{sheet:t}=e;this.operations.moveRows(t,e.undoStart,e.numberOfRows,e.undoEnd),this.restoreOldDataFromVersion(e.version-1)}undoMoveColumns(e){const{sheet:t}=e;this.operations.moveColumns(t,e.undoStart,e.numberOfColumns,e.undoEnd),this.restoreOldDataFromVersion(e.version-1)}undoMoveCells(e){this.operations.forceApplyPostponedTransformations(),this.operations.moveCells(e.destinationLeftCorner,e.width,e.height,e.sourceLeftCorner),this.restoreOperationOldContent(e.overwrittenCellsData),this.restoreOldDataFromVersion(e.version-1);for(const t of e.addedGlobalNamedExpressions)this.operations.removeNamedExpression(t)}undoAddSheet(e){const{sheetName:t}=e;this.operations.removeSheetByName(t)}undoRemoveSheet(e){this.operations.forceApplyPostponedTransformations();const{oldSheetContent:t,sheetId:r}=e;this.operations.addSheet(e.sheetName);for(let e=0;e<t.length;e++){const o=t[e];for(let t=0;t<o.length;t++){const s=o[t],i=(0,n.simpleCellAddress)(r,t,e);this.operations.restoreCell(i,s)}}for(const[t,n]of e.scopedNamedExpressions)this.operations.restoreNamedExpression(t,n,r);this.restoreOldDataFromVersion(e.version-1)}undoRenameSheet(e){this.operations.renameSheet(e.sheetId,e.oldName)}undoClearSheet(e){const{oldSheetContent:t,sheetId:r}=e;for(let e=0;e<t.length;e++){const o=t[e];for(let t=0;t<o.length;t++){const s=o[t],i=(0,n.simpleCellAddress)(r,t,e);this.operations.restoreCell(i,s)}}}undoSetSheetContent(e){const{oldSheetContent:t,sheetId:r}=e;this.operations.clearSheet(r);for(let e=0;e<t.length;e++){const o=t[e];for(let t=0;t<o.length;t++){const s=o[t],i=(0,n.simpleCellAddress)(r,t,e);this.operations.restoreCell(i,s)}}}undoAddNamedExpression(e){this.operations.removeNamedExpression(e.name,e.scope)}undoRemoveNamedExpression(e){this.operations.restoreNamedExpression(e.namedExpression,e.content,e.scope)}undoChangeNamedExpression(e){this.operations.restoreNamedExpression(e.namedExpression,e.oldContent,e.scope)}undoSetRowOrder(e){this.restoreOperationOldContent(e.oldContent)}undoSetColumnOrder(e){this.restoreOperationOldContent(e.oldContent)}redo(){const e=this.redoStack.pop();if(!e)throw Error("Attempted to redo without operation on stack");this.redoEntry(e),this.undoStack.push(e)}redoBatch(e){for(const t of e.operations)this.redoEntry(t)}redoRemoveRows(e){this.operations.removeRows(e.command)}redoMoveCells(e){this.operations.moveCells(e.sourceLeftCorner,e.width,e.height,e.destinationLeftCorner)}redoRemoveColumns(e){this.operations.removeColumns(e.command)}redoPaste(e){const{targetLeftCorner:t,newContent:r}=e,o=r.length,s=r[0].length;for(let e=0;e<o;++e)for(let o=0;o<s;++o){const s=(0,n.simpleCellAddress)(t.sheet,t.col+o,t.row+e);this.operations.restoreCell(s,r[e][o])}}redoSetCellContents(e){for(const t of e.cellContents)this.operations.setCellContent(t.address,t.newContent)}redoAddRows(e){this.operations.addRows(e.command)}redoAddColumns(e){this.operations.addColumns(e.command)}redoRemoveSheet(e){this.operations.removeSheetByName(e.sheetName)}redoAddSheet(e){this.operations.addSheet(e.sheetName)}redoRenameSheet(e){this.operations.renameSheet(e.sheetId,e.newName)}redoMoveRows(e){this.operations.moveRows(e.sheet,e.startRow,e.numberOfRows,e.targetRow)}redoMoveColumns(e){this.operations.moveColumns(e.sheet,e.startColumn,e.numberOfColumns,e.targetColumn)}redoClearSheet(e){this.operations.clearSheet(e.sheetId)}redoSetSheetContent(e){const{sheetId:t,newSheetContent:r}=e;this.operations.setSheetContent(t,r)}redoAddNamedExpression(e){this.operations.addNamedExpression(e.name,e.newContent,e.scope,e.options)}redoRemoveNamedExpression(e){this.operations.removeNamedExpression(e.namedExpression.displayName,e.scope)}redoChangeNamedExpression(e){this.operations.changeNamedExpressionExpression(e.namedExpression.displayName,e.newContent,e.scope,e.options)}redoSetRowOrder(e){this.operations.setRowOrder(e.sheetId,e.rowMapping)}redoSetColumnOrder(e){this.operations.setColumnOrder(e.sheetId,e.columnMapping)}addUndoEntry(e){this.undoStack.push(e),this.undoStack.splice(0,Math.max(0,this.undoStack.length-this.undoLimit))}undoEntry(e){e.doUndo(this)}restoreOperationOldContent(e){for(const[t,r]of e)this.operations.restoreCell(t,r)}redoEntry(e){e.doRedo(this)}restoreOldDataFromVersion(e){const t=this.oldData.get(e)||[];for(const e of t){const[t,r]=e;this.operations.setFormulaToCellFromCache(r,t)}}}},function(e,t,r){"use strict";t.__esModule=!0,t.Evaluator=void 0,r(2);var n=r(72),o=r(76),s=r(73),i=r(138),a=r(74),u=r(150),c=r(165),l=r(140),h=r(139),d=r(142);t.Evaluator=
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
class{constructor(e,t,r,n,o,s){this.config=e,this.stats=t,this.interpreter=r,this.lazilyTransformingAstService=n,this.dependencyGraph=o,this.columnSearch=s}run(){this.stats.start(d.StatType.TOP_SORT);const{sorted:e,cycled:t}=this.dependencyGraph.topSortWithScc();this.stats.end(d.StatType.TOP_SORT),this.stats.measure(d.StatType.EVALUATION,()=>{this.recomputeFormulas(t,e)})}partialRun(e){const t=i.ContentChanges.empty();return this.stats.measure(d.StatType.EVALUATION,()=>{this.dependencyGraph.graph.getTopSortedWithSccSubgraphFrom(e,e=>{if(e instanceof u.FormulaVertex){const r=e.isComputed()?e.getCellValue():void 0,n=this.recomputeFormulaVertexValue(e);if(n!==r){const o=e.getAddress(this.lazilyTransformingAstService);return t.addChange(n,o),this.columnSearch.change((0,l.getRawValue)(r),(0,l.getRawValue)(n),o),!0}return!1}return!(e instanceof a.RangeVertex&&(e.clearCache(),0))},e=>{if(e instanceof a.RangeVertex)e.clearCache();else if(e instanceof u.FormulaVertex){const r=e.getAddress(this.lazilyTransformingAstService);this.columnSearch.remove((0,l.getRawValue)(e.valueOrUndef()),r);const n=new s.CellError(s.ErrorType.CYCLE,void 0,e);e.setCellValue(n),t.addChange(n,r)}})}),t}runAndForget(e,t,r){const s=[];for(const e of(0,o.absolutizeDependencies)(r,t))if(e instanceof n.AbsoluteCellRange){const t=e;if(void 0===this.dependencyGraph.getRange(t.start,t.end)){const e=new a.RangeVertex(t);this.dependencyGraph.rangeMapping.setRange(e),s.push(e)}}const i=this.evaluateAstToCellValue(e,new c.InterpreterState(t,this.config.useArrayArithmetic));return s.forEach(e=>{this.dependencyGraph.rangeMapping.removeRange(e)}),i}recomputeFormulas(e,t){e.forEach(e=>{e instanceof u.FormulaVertex&&e.setCellValue(new s.CellError(s.ErrorType.CYCLE,void 0,e))}),t.forEach(e=>{if(e instanceof u.FormulaVertex){const t=this.recomputeFormulaVertexValue(e),r=e.getAddress(this.lazilyTransformingAstService);this.columnSearch.add((0,l.getRawValue)(t),r)}else e instanceof a.RangeVertex&&e.clearCache()})}recomputeFormulaVertexValue(e){const t=e.getAddress(this.lazilyTransformingAstService);if(e instanceof a.ArrayVertex&&(e.array.size.isRef||!this.dependencyGraph.isThereSpaceForArray(e)))return e.setNoSpace();{const r=e.getFormula(this.lazilyTransformingAstService),n=this.evaluateAstToCellValue(r,new c.InterpreterState(t,this.config.useArrayArithmetic,e));return e.setCellValue(n)}}evaluateAstToCellValue(e,t){const r=this.interpreter.evaluateAst(e,t);return r instanceof h.SimpleRangeValue?r:r===l.EmptyValue&&this.config.evaluateNullToZero?0:r}}},function(e,t,r){"use strict";t.__esModule=!0,t.Exporter=t.ExportedNamedExpressionChange=t.ExportedCellChange=void 0,r(2);var n=r(73),o=r(170),s=r(131),i=r(140),a=r(139),u=r(185),c=r(78);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
class l{constructor(e,t){this.address=e,this.newValue=t}get col(){return this.address.col}get row(){return this.address.row}get sheet(){return this.address.sheet}get value(){return this.newValue}}t.ExportedCellChange=l;class h{constructor(e,t){this.name=e,this.newValue=t}}t.ExportedNamedExpressionChange=h,t.Exporter=class{constructor(e,t,r,n){this.config=e,this.namedExpressions=t,this.sheetIndexMapping=r,this.lazilyTransformingService=n}exportChange(e){const t=e.value,r=e.address;if(r.sheet===u.NamedExpressions.SHEET_FOR_WORKBOOK_EXPRESSIONS){const e=this.namedExpressions.namedExpressionInAddress(r.row);if(!e)throw new Error("Missing named expression");return new h(e.displayName,this.exportScalarOrRange(t))}if(t instanceof a.SimpleRangeValue){const e=[];for(const[n,o]of t.entriesFromTopLeftCorner(r))e.push(new l(o,this.exportValue(n)));return e}return new l(r,this.exportValue(t))}exportValue(e){return e instanceof a.SimpleRangeValue?this.detailedError(new n.CellError(n.ErrorType.VALUE,s.ErrorMessage.ScalarExpected)):this.config.smartRounding&&(0,i.isExtendedNumber)(e)?this.cellValueRounding((0,i.getRawValue)(e)):e instanceof n.CellError?this.detailedError(e):e===i.EmptyValue?null:(0,i.getRawValue)(e)}exportScalarOrRange(e){return e instanceof a.SimpleRangeValue?e.rawData().map(e=>e.map(e=>this.exportValue(e))):this.exportValue(e)}detailedError(e){var t,r;let n=void 0;const s=null===(t=e.root)||void 0===t?void 0:t.getAddress(this.lazilyTransformingService);return void 0!==s&&(n=s.sheet===u.NamedExpressions.SHEET_FOR_WORKBOOK_EXPRESSIONS?null===(r=this.namedExpressions.namedExpressionInAddress(s.row))||void 0===r?void 0:r.displayName:(0,c.simpleCellAddressToString)(this.sheetIndexMapping,s,-1)),new o.DetailedCellError(e,this.config.translationPackage.getErrorTranslation(e.type),n)}cellValueRounding(e){if(0===e)return e;const t=Math.floor(Math.log10(Math.abs(e))),r=Math.pow(10,this.config.precisionRounding-t);return e<0?-Math.round(-e*r)/r:Math.round(e*r)/r}}},function(e,t,r){"use strict";t.__esModule=!0,t.SimpleStrategy=t.GraphBuilder=void 0;var n=r(76),o=r(1),s=r(73),i=r(182),a=r(74),u=r(140),c=r(142);t.GraphBuilder=
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
class{constructor(e,t,r,n,o,s){this.dependencyGraph=e,this.columnSearch=t,this.parser=r,this.cellContentParser=n,this.stats=o,this.arraySizePredictor=s,this.buildStrategy=new l(e,t,r,o,n,s)}buildGraph(e,t){const r=t.measure(c.StatType.COLLECT_DEPENDENCIES,()=>this.buildStrategy.run(e));this.dependencyGraph.getAndClearContentChanges(),t.measure(c.StatType.PROCESS_DEPENDENCIES,()=>this.processDependencies(r))}processDependencies(e){e.forEach((e,t)=>{this.dependencyGraph.processCellDependencies(e,t)})}};class l{constructor(e,t,r,n,o,s){this.dependencyGraph=e,this.columnIndex=t,this.parser=r,this.stats=n,this.cellContentParser=o,this.arraySizePredictor=s}run(e){const t=new Map;for(const r in e){const l=this.dependencyGraph.getSheetId(r),h=e[r];for(let e=0;e<h.length;++e){const r=h[e];for(let h=0;h<r.length;++h){const d=r[h],p=(0,s.simpleCellAddress)(l,h,e),m=this.cellContentParser.parse(d);if(m instanceof i.CellContent.Formula){const e=this.stats.measure(c.StatType.PARSER,()=>this.parser.parse(m.formula,p));if(e.errors.length>0){this.shrinkArrayIfNeeded(p);const t=new a.ParsingErrorVertex(e.errors,m.formula);this.dependencyGraph.addVertex(p,t)}else{this.shrinkArrayIfNeeded(p);const r=this.arraySizePredictor.checkArraySize(e.ast,p);if(r.isScalar()){const r=new a.FormulaCellVertex(e.ast,p,0);t.set(r,(0,n.absolutizeDependencies)(e.dependencies,p)),this.dependencyGraph.addVertex(p,r),e.hasVolatileFunction&&this.dependencyGraph.markAsVolatile(r),e.hasStructuralChangeFunction&&this.dependencyGraph.markAsDependentOnStructureChange(r)}else{const s=new a.ArrayVertex(e.ast,p,new o.ArraySize(r.width,r.height));t.set(s,(0,n.absolutizeDependencies)(e.dependencies,p)),this.dependencyGraph.addArrayVertex(p,s)}}}else if(m instanceof i.CellContent.Empty);else{this.shrinkArrayIfNeeded(p);const e=new a.ValueCellVertex(m.value,d);this.columnIndex.add((0,u.getRawValue)(m.value),p),this.dependencyGraph.addVertex(p,e)}}}}return t}shrinkArrayIfNeeded(e){const t=this.dependencyGraph.getCell(e);t instanceof a.ArrayVertex&&this.dependencyGraph.shrinkArrayToCorner(t)}}t.SimpleStrategy=l},function(e,t,r){"use strict";t.__esModule=!0,t.FunctionRegistry=void 0,r(2);var n=r(147),o=r(180),s=r(201);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
function i(e,t){var r;let o=t.implementedFunctions[e];const s=null===(r=t.aliases)||void 0===r?void 0:r[e];if(void 0!==s){if(void 0!==o)throw new n.AliasAlreadyExisting(e,t.name);o=t.implementedFunctions[s]}if(void 0===o)throw n.FunctionPluginValidationError.functionNotDeclaredInPlugin(e,t.name);return o}class a{constructor(e){if(this.config=e,this.functions=new Map,this.arraySizeFunctions=new Map,this.volatileFunctions=new Set,this.arrayFunctions=new Set,this.structuralChangeFunctions=new Set,this.functionsWhichDoesNotNeedArgumentsToBeComputed=new Set,this.functionsMetadata=new Map,this.doesFunctionNeedArgumentToBeComputed=e=>this.functionsWhichDoesNotNeedArgumentsToBeComputed.has(e),this.isFunctionVolatile=e=>this.volatileFunctions.has(e),this.isArrayFunction=e=>this.arrayFunctions.has(e),this.isFunctionDependentOnSheetStructureChange=e=>this.structuralChangeFunctions.has(e),e.functionPlugins.length>0){this.instancePlugins=new Map;for(const t of e.functionPlugins)a.loadPluginFunctions(t,this.instancePlugins)}else this.instancePlugins=new Map(a.plugins);for(const[e,t]of a.protectedFunctions())a.loadFunctionUnprotected(t,e,this.instancePlugins);for(const[e,t]of this.instancePlugins.entries())this.categorizeFunction(e,i(e,t))}static registerFunctionPlugin(e,t){this.loadPluginFunctions(e,this.plugins),void 0!==t&&this.loadTranslations(t)}static registerFunction(e,t,r){this.loadPluginFunction(t,e,this.plugins),void 0!==r&&this.loadTranslations(r)}static unregisterFunction(e){if(this.functionIsProtected(e))throw n.ProtectedFunctionError.cannotUnregisterFunctionWithId(e);this.plugins.delete(e)}static unregisterFunctionPlugin(e){for(const t of this.protectedPlugins())if(t===e)throw n.ProtectedFunctionError.cannotUnregisterProtectedPlugin();for(const[t,r]of this.plugins.entries())r===e&&this.plugins.delete(t)}static unregisterAll(){this.plugins.clear()}static getRegisteredFunctionIds(){return[...Array.from(this.plugins.keys()),...Array.from(this._protectedPlugins.keys())]}static getPlugins(){return Array.from(new Set(this.plugins.values()).values())}static getFunctionPlugin(e){return this.functionIsProtected(e)?void 0:this.plugins.get(e)}static functionIsProtected(e){return this._protectedPlugins.has(e)}static loadTranslations(e){const t=new Set(o.HyperFormula.getRegisteredLanguagesCodes());Object.keys(e).forEach(r=>{t.has(r)&&o.HyperFormula.getLanguage(r).extendFunctions(e[r])})}static loadPluginFunctions(e,t){Object.keys(e.implementedFunctions).forEach(r=>{this.loadPluginFunction(e,r,t)}),void 0!==e.aliases&&Object.keys(e.aliases).forEach(r=>{this.loadPluginFunction(e,r,t)})}static loadPluginFunction(e,t,r){if(this.functionIsProtected(t))throw n.ProtectedFunctionError.cannotRegisterFunctionWithId(t);this.loadFunctionUnprotected(e,t,r)}static loadFunctionUnprotected(e,t,r){const o=i(t,e).method;if(!Object.prototype.hasOwnProperty.call(e.prototype,o))throw n.FunctionPluginValidationError.functionMethodNotFound(o,e.name);r.set(t,e)}static*protectedFunctions(){for(const[e,t]of this._protectedPlugins)void 0!==t&&(yield[e,t])}static*protectedPlugins(){for(const[,e]of this._protectedPlugins)void 0!==e&&(yield e)}initializePlugins(e){const t=[];for(const[r,n]of this.instancePlugins.entries()){let o=t.find(e=>e instanceof n);void 0===o&&(o=new n(e),t.push(o));const s=i(r,n),a=s.method;this.functions.set(r,[a,o]);const u=s.arraySizeMethod;void 0!==u&&this.arraySizeFunctions.set(r,[u,o])}}getFunctionPlugin(e){if(!a.functionIsProtected(e))return this.instancePlugins.get(e)}getFunction(e){const t=this.functions.get(e);if(void 0!==t&&this.config.translationPackage.isFunctionTranslated(e)){const[e,r]=t;return(t,n)=>r[e](t,n)}}getArraySizeFunction(e){const t=this.arraySizeFunctions.get(e);if(void 0!==t&&this.config.translationPackage.isFunctionTranslated(e)){const[e,r]=t;return(t,n)=>r[e](t,n)}}getMetadata(e){return this.functionsMetadata.get(e)}getPlugins(){const e=new Set;for(const[t,r]of this.instancePlugins)a.functionIsProtected(t)||e.add(r);return Array.from(e)}getRegisteredFunctionIds(){return Array.from(this.functions.keys())}categorizeFunction(e,t){t.isVolatile&&this.volatileFunctions.add(e),t.arrayFunction&&this.arrayFunctions.add(e),t.doesNotNeedArgumentsToBeComputed&&this.functionsWhichDoesNotNeedArgumentsToBeComputed.add(e),t.isDependentOnSheetStructureChange&&this.structuralChangeFunctions.add(e),this.functionsMetadata.set(e,t)}}t.FunctionRegistry=a,a.plugins=new Map,a._protectedPlugins=new Map([["VERSION",s.VersionPlugin],["OFFSET",void 0]])},function(e,t,r){"use strict";t.__esModule=!0,t.VersionPlugin=void 0;var n=r(180),o=r(167);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
const s=new Map([["gpl-v3",1],["missing",2],["invalid",3],["expired",4]]);class i extends o.FunctionPlugin{version(e,t){return this.runFunction(e.args,t,this.metadata("VERSION"),()=>{const{licenseKeyValidityState:e,licenseKey:t}=this.config;let r;return s.has(t)?r=s.get(t):s.has(e)?r=s.get(e):"valid"===e&&(r=t.slice(-5)),`HyperFormula v${n.HyperFormula.version}, ${r}`})}}t.VersionPlugin=i,i.implementedFunctions={VERSION:{method:"version",parameters:[]}}},function(e,t,r){"use strict";t.__esModule=!0,t.Interpreter=void 0,r(2);var n=r(72),o=r(151),s=r(73),i=r(131),a=r(127),u=r(168),c=r(203),l=r(200),h=r(165),d=r(140),p=r(139);function m(e,t){return t instanceof s.CellError?t:e(t)}function g(e,t,r){return t instanceof s.CellError?t:r instanceof s.CellError?r:e(t,r)}t.Interpreter=
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
class{constructor(e,t,r,n,o,s,i,a,l,h){this.config=e,this.dependencyGraph=t,this.columnSearch=r,this.stats=n,this.arithmeticHelper=o,this.functionRegistry=s,this.namedExpressions=i,this.serialization=a,this.arraySizePredictor=l,this.dateTimeHelper=h,this.equalOp=(e,t)=>g(this.arithmeticHelper.eq,e,t),this.notEqualOp=(e,t)=>g(this.arithmeticHelper.neq,e,t),this.greaterThanOp=(e,t)=>g(this.arithmeticHelper.gt,e,t),this.lessThanOp=(e,t)=>g(this.arithmeticHelper.lt,e,t),this.greaterThanOrEqualOp=(e,t)=>g(this.arithmeticHelper.geq,e,t),this.lessThanOrEqualOp=(e,t)=>g(this.arithmeticHelper.leq,e,t),this.concatOp=(e,t)=>g(this.arithmeticHelper.concat,(0,u.coerceScalarToString)(e),(0,u.coerceScalarToString)(t)),this.plusOp=(e,t)=>g(this.arithmeticHelper.addWithEpsilon,this.arithmeticHelper.coerceScalarToNumberOrError(e),this.arithmeticHelper.coerceScalarToNumberOrError(t)),this.minusOp=(e,t)=>g(this.arithmeticHelper.subtract,this.arithmeticHelper.coerceScalarToNumberOrError(e),this.arithmeticHelper.coerceScalarToNumberOrError(t)),this.timesOp=(e,t)=>g(this.arithmeticHelper.multiply,this.arithmeticHelper.coerceScalarToNumberOrError(e),this.arithmeticHelper.coerceScalarToNumberOrError(t)),this.powerOp=(e,t)=>g(this.arithmeticHelper.pow,this.arithmeticHelper.coerceScalarToNumberOrError(e),this.arithmeticHelper.coerceScalarToNumberOrError(t)),this.divOp=(e,t)=>g(this.arithmeticHelper.divide,this.arithmeticHelper.coerceScalarToNumberOrError(e),this.arithmeticHelper.coerceScalarToNumberOrError(t)),this.unaryMinusOp=e=>m(this.arithmeticHelper.unaryMinus,this.arithmeticHelper.coerceScalarToNumberOrError(e)),this.percentOp=e=>m(this.arithmeticHelper.unaryPercent,this.arithmeticHelper.coerceScalarToNumberOrError(e)),this.unaryPlusOp=e=>this.arithmeticHelper.unaryPlus(e),this.functionRegistry.initializePlugins(this),this.criterionBuilder=new c.CriterionBuilder(e)}evaluateAst(e,t){let r=this.evaluateAstWithoutPostprocessing(e,t);if((0,d.isExtendedNumber)(r)){if((0,u.isNumberOverflow)((0,d.getRawValue)(r)))return new s.CellError(s.ErrorType.NUM,i.ErrorMessage.NaN);r=(0,d.cloneNumber)(r,(0,u.fixNegativeZero)((0,d.getRawValue)(r)))}return r instanceof p.SimpleRangeValue&&1===r.height()&&1===r.width()&&([[r]]=r.data),function(e,t){return e instanceof s.CellError&&void 0!==t?e.attachRootVertex(t):e}(r,t.formulaVertex)}evaluateAstWithoutPostprocessing(e,t){switch(e.type){case a.AstNodeType.EMPTY:return d.EmptyValue;case a.AstNodeType.CELL_REFERENCE:{const r=e.reference.toSimpleCellAddress(t.formulaAddress);return(0,s.invalidSimpleCellAddress)(r)?new s.CellError(s.ErrorType.REF,i.ErrorMessage.BadRef):this.dependencyGraph.getCellValue(r)}case a.AstNodeType.NUMBER:case a.AstNodeType.STRING:return e.value;case a.AstNodeType.CONCATENATE_OP:{const r=this.evaluateAst(e.left,t),n=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.concatOp,r,n,t)}case a.AstNodeType.EQUALS_OP:{const r=this.evaluateAst(e.left,t),n=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.equalOp,r,n,t)}case a.AstNodeType.NOT_EQUAL_OP:{const r=this.evaluateAst(e.left,t),n=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.notEqualOp,r,n,t)}case a.AstNodeType.GREATER_THAN_OP:{const r=this.evaluateAst(e.left,t),n=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.greaterThanOp,r,n,t)}case a.AstNodeType.LESS_THAN_OP:{const r=this.evaluateAst(e.left,t),n=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.lessThanOp,r,n,t)}case a.AstNodeType.GREATER_THAN_OR_EQUAL_OP:{const r=this.evaluateAst(e.left,t),n=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.greaterThanOrEqualOp,r,n,t)}case a.AstNodeType.LESS_THAN_OR_EQUAL_OP:{const r=this.evaluateAst(e.left,t),n=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.lessThanOrEqualOp,r,n,t)}case a.AstNodeType.PLUS_OP:{const r=this.evaluateAst(e.left,t),n=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.plusOp,r,n,t)}case a.AstNodeType.MINUS_OP:{const r=this.evaluateAst(e.left,t),n=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.minusOp,r,n,t)}case a.AstNodeType.TIMES_OP:{const r=this.evaluateAst(e.left,t),n=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.timesOp,r,n,t)}case a.AstNodeType.POWER_OP:{const r=this.evaluateAst(e.left,t),n=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.powerOp,r,n,t)}case a.AstNodeType.DIV_OP:{const r=this.evaluateAst(e.left,t),n=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.divOp,r,n,t)}case a.AstNodeType.PLUS_UNARY_OP:{const r=this.evaluateAst(e.value,t);return this.unaryRangeWrapper(this.unaryPlusOp,r,t)}case a.AstNodeType.MINUS_UNARY_OP:{const r=this.evaluateAst(e.value,t);return this.unaryRangeWrapper(this.unaryMinusOp,r,t)}case a.AstNodeType.PERCENT_OP:{const r=this.evaluateAst(e.value,t);return this.unaryRangeWrapper(this.percentOp,r,t)}case a.AstNodeType.FUNCTION_CALL:{if("valid"!==this.config.licenseKeyValidityState&&!l.FunctionRegistry.functionIsProtected(e.procedureName))return new s.CellError(s.ErrorType.LIC,i.ErrorMessage.LicenseKey(this.config.licenseKeyValidityState));const r=this.functionRegistry.getFunction(e.procedureName);return void 0!==r?r(e,new h.InterpreterState(t.formulaAddress,t.arraysFlag||this.functionRegistry.isArrayFunction(e.procedureName),t.formulaVertex)):new s.CellError(s.ErrorType.NAME,i.ErrorMessage.FunctionName(e.procedureName))}case a.AstNodeType.NAMED_EXPRESSION:{const r=this.namedExpressions.nearestNamedExpression(e.expressionName,t.formulaAddress.sheet);return r?this.dependencyGraph.getCellValue(r.address):new s.CellError(s.ErrorType.NAME,i.ErrorMessage.NamedExpressionName(e.expressionName))}case a.AstNodeType.CELL_RANGE:{if(!this.rangeSpansOneSheet(e))return new s.CellError(s.ErrorType.REF,i.ErrorMessage.RangeManySheets);const r=n.AbsoluteCellRange.fromCellRange(e,t.formulaAddress),a=this.dependencyGraph.getArray(r);if(a){const e=a.array;if(e instanceof o.NotComputedArray)throw new Error("Array should be already computed");if(e instanceof s.CellError)return e;if(e instanceof o.ArrayValue)return p.SimpleRangeValue.fromRange(e.raw(),r,this.dependencyGraph);throw new Error("Unknown array")}return p.SimpleRangeValue.onlyRange(r,this.dependencyGraph)}case a.AstNodeType.COLUMN_RANGE:{if(!this.rangeSpansOneSheet(e))return new s.CellError(s.ErrorType.REF,i.ErrorMessage.RangeManySheets);const r=n.AbsoluteColumnRange.fromColumnRange(e,t.formulaAddress);return p.SimpleRangeValue.onlyRange(r,this.dependencyGraph)}case a.AstNodeType.ROW_RANGE:{if(!this.rangeSpansOneSheet(e))return new s.CellError(s.ErrorType.REF,i.ErrorMessage.RangeManySheets);const r=n.AbsoluteRowRange.fromRowRangeAst(e,t.formulaAddress);return p.SimpleRangeValue.onlyRange(r,this.dependencyGraph)}case a.AstNodeType.PARENTHESIS:return this.evaluateAst(e.expression,t);case a.AstNodeType.ARRAY:{let r=void 0;const n=[];for(const o of e.args){let e=void 0;const a=[];for(const r of o){const n=(0,u.coerceToRange)(this.evaluateAst(r,t)),o=n.height();if(void 0===e)e=o,a.push(...n.data);else{if(e!==o)return new s.CellError(s.ErrorType.REF,i.ErrorMessage.SizeMismatch);for(let e=0;e<o;e++)a[e].push(...n.data[e])}}const c=a[0].length;if(void 0===r)r=c,n.push(...a);else{if(r!==c)return new s.CellError(s.ErrorType.REF,i.ErrorMessage.SizeMismatch);n.push(...a)}}return p.SimpleRangeValue.onlyValues(n)}case a.AstNodeType.ERROR_WITH_RAW_INPUT:case a.AstNodeType.ERROR:return e.error}}rangeSpansOneSheet(e){return e.start.sheet===e.end.sheet}unaryRangeWrapper(e,t,r){var n;if(t instanceof p.SimpleRangeValue&&!r.arraysFlag&&(t=null!==(n=(0,u.coerceRangeToScalar)(t,r))&&void 0!==n?n:new s.CellError(s.ErrorType.VALUE,i.ErrorMessage.ScalarExpected)),t instanceof s.CellError)return t;if(t instanceof p.SimpleRangeValue){const r=t.data.map(t=>t.map(e));return p.SimpleRangeValue.onlyValues(r)}return e(t)}binaryRangeWrapper(e,t,r,n){var o,a;if(t instanceof p.SimpleRangeValue&&!n.arraysFlag&&(t=null!==(o=(0,u.coerceRangeToScalar)(t,n))&&void 0!==o?o:new s.CellError(s.ErrorType.VALUE,i.ErrorMessage.ScalarExpected)),t instanceof s.CellError)return t;if(r instanceof p.SimpleRangeValue&&!n.arraysFlag&&(r=null!==(a=(0,u.coerceRangeToScalar)(r,n))&&void 0!==a?a:new s.CellError(s.ErrorType.VALUE,i.ErrorMessage.ScalarExpected)),r instanceof s.CellError)return r;if(t instanceof p.SimpleRangeValue||r instanceof p.SimpleRangeValue){if(!(t instanceof p.SimpleRangeValue)){if(r.isAdHoc()){const n=r.data;for(let r=0;r<n.length;r++)for(let o=0;o<n[0].length;o++)n[r][o]=e(t,n[r][o]);return p.SimpleRangeValue.onlyValues(n)}t=p.SimpleRangeValue.fromScalar(t)}if(!(r instanceof p.SimpleRangeValue)){if(t.isAdHoc()){const n=t.data;for(let t=0;t<n.length;t++)for(let o=0;o<n[0].length;o++)n[t][o]=e(n[t][o],r);return p.SimpleRangeValue.onlyValues(n)}r=p.SimpleRangeValue.fromScalar(r)}if(t.width()===r.width()&&t.height()===r.height()){if(t.isAdHoc()){const n=t.data,o=r.data;for(let t=0;t<n.length;t++)for(let r=0;r<n[0].length;r++)n[t][r]=e(n[t][r],o[t][r]);return p.SimpleRangeValue.onlyValues(n)}if(r.isAdHoc()){const n=t.data,o=r.data;for(let t=0;t<n.length;t++)for(let r=0;r<n[0].length;r++)o[t][r]=e(n[t][r],o[t][r]);return p.SimpleRangeValue.onlyValues(o)}}const n=Math.max(t.width(),r.width()),o=Math.max(t.height(),r.height()),i=Array(o);for(let e=0;e<o;e++)i[e]=Array(n);for(let a=0;a<o;a++){const o=1!==t.height()?a:0,u=1!==r.height()?a:0;for(let c=0;c<n;c++){const n=1!==t.width()?c:0,l=1!==r.width()?c:0;o<t.height()&&u<r.height()&&n<t.width()&&l<r.width()?i[a][c]=e(t.data[o][n],r.data[u][l]):i[a][c]=new s.CellError(s.ErrorType.NA)}}return p.SimpleRangeValue.onlyValues(i)}return e(t,r)}}},function(e,t,r){"use strict";t.__esModule=!0,t.buildCriterionLambda=t.buildCriterion=t.CriterionType=t.CriterionBuilder=void 0;var n,o=r(140);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */!function(e){e.GREATER_THAN="GREATER_THAN",e.GREATER_THAN_OR_EQUAL="GREATER_THAN_OR_EQUAL",e.LESS_THAN="LESS_THAN",e.LESS_THAN_OR_EQUAL="LESS_THAN_OR_EQUAL",e.NOT_EQUAL="NOT_EQUAL",e.EQUAL="EQUAL"}(n||(t.CriterionType=n={}));const s=(e,t)=>({operator:e,value:t});t.buildCriterion=s,t.CriterionBuilder=class{constructor(e){var t,r,n,o;this.trueString=null!==(r=null===(t=e.translationPackage.getMaybeFunctionTranslation("TRUE"))||void 0===t?void 0:t.toLowerCase())&&void 0!==r?r:"true",this.falseString=null!==(o=null===(n=e.translationPackage.getMaybeFunctionTranslation("FALSE"))||void 0===n?void 0:n.toLowerCase())&&void 0!==o?o:"false"}fromCellValue(e,t){if("string"!=typeof e&&"boolean"!=typeof e&&"number"!=typeof e)return;const r=this.parseCriterion(e,t);return void 0!==r?{raw:e,lambda:a(r,t)}:void 0}parseCriterion(e,t){if("number"==typeof e||"boolean"==typeof e)return s(n.EQUAL,e);if("string"==typeof e){const r=i.exec(e);let a,u;r?(u=function(e){switch(e){case">":return n.GREATER_THAN;case">=":return n.GREATER_THAN_OR_EQUAL;case"<":return n.LESS_THAN;case"<=":return n.LESS_THAN_OR_EQUAL;case"<>":return n.NOT_EQUAL;case"=":return n.EQUAL;default:return}}(r[1]),a=r[2]):(u=n.EQUAL,a=e);const c=t.coerceToMaybeNumber(a),l=a.toLowerCase()===this.trueString||a.toLowerCase()!==this.falseString&&void 0;if(void 0===u)return;if(""===a)return s(u,null);if(void 0!==c)return s(u,(0,o.getRawValue)(c));if(u===n.EQUAL||u===n.NOT_EQUAL)return s(u,null!=l?l:a)}}};const i=/([<>=]+)(.*)/,a=(e,t)=>{switch(e.operator){case n.GREATER_THAN:return"number"==typeof e.value?r=>"number"==typeof r&&t.floatCmp(r,e.value)>0:e=>!1;case n.GREATER_THAN_OR_EQUAL:return"number"==typeof e.value?r=>"number"==typeof r&&t.floatCmp(r,e.value)>=0:e=>!1;case n.LESS_THAN:return"number"==typeof e.value?r=>"number"==typeof r&&t.floatCmp(r,e.value)<0:e=>!1;case n.LESS_THAN_OR_EQUAL:return"number"==typeof e.value?r=>"number"==typeof r&&t.floatCmp(r,e.value)<=0:e=>!1;case n.EQUAL:return"number"==typeof e.value?r=>{if("number"==typeof r)return 0===t.floatCmp(r,e.value);if("string"==typeof r){if(""===r)return!1;const n=t.coerceToMaybeNumber(r);return void 0!==n&&0===t.floatCmp(n,e.value)}return!1}:"string"==typeof e.value?t.eqMatcherFunction(e.value):"boolean"==typeof e.value?t=>"boolean"==typeof t&&t===e.value:e=>e===o.EmptyValue;case n.NOT_EQUAL:return"number"==typeof e.value?r=>{if("number"==typeof r)return 0!==t.floatCmp(r,e.value);if("string"==typeof r){if(""===r)return!0;const n=t.coerceToMaybeNumber(r);return void 0===n||0!==t.floatCmp(n,e.value)}return!0}:"string"==typeof e.value?t.neqMatcherFunction(e.value):"boolean"==typeof e.value?t=>"boolean"!=typeof t||t!==e.value:e=>e!==o.EmptyValue}};t.buildCriterionLambda=a},function(e,t,r){"use strict";t.__esModule=!0,t.LazilyTransformingAstService=void 0,r(2);var n=r(205),o=r(142);t.LazilyTransformingAstService=
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
class{constructor(e){this.stats=e,this.transformations=[]}version(){return this.transformations.length}addTransformation(e){return void 0!==this.combinedTransformer?this.combinedTransformer.add(e):this.transformations.push(e),this.version()}beginCombinedMode(e){this.combinedTransformer=new n.CombinedTransformer(e)}commitCombinedMode(){if(void 0===this.combinedTransformer)throw Error("Combined mode wasn't started");return this.transformations.push(this.combinedTransformer),this.combinedTransformer=void 0,this.version()}applyTransformations(e,t,r){this.stats.start(o.StatType.TRANSFORM_ASTS_POSTPONED);for(let n=r;n<this.transformations.length;n++){const r=this.transformations[n];r.isIrreversible()&&(this.undoRedo.storeDataForVersion(n,t,this.parser.computeHashFromAst(e)),this.parser.rememberNewAst(e));const[o,s]=r.transformSingleAst(e,t);e=o,t=s}const n=this.parser.rememberNewAst(e);return this.stats.end(o.StatType.TRANSFORM_ASTS_POSTPONED),[n,t,this.transformations.length]}*getTransformationsFrom(e,t){for(let r=e;r<this.transformations.length;r++){const e=this.transformations[r];t&&!t(e)||(yield e)}}}},function(e,t,r){"use strict";t.__esModule=!0,t.CombinedTransformer=void 0,r(2),t.CombinedTransformer=
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
class{constructor(e){this.sheet=e,this.transformations=[]}add(e){this.transformations.push(e)}performEagerTransformations(e,t){this.transformations.forEach(r=>r.performEagerTransformations(e,t))}transformSingleAst(e,t){let[r,n]=[e,t];return this.transformations.forEach(e=>{[r,n]=e.transformSingleAst(r,n)}),[r,n]}isIrreversible(){return!0}}},function(e,t,r){"use strict";t.__esModule=!0,t.buildColumnSearchStrategy=
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
function(e,t,r){return t.useColumnIndex?new o.ColumnIndex(e,t,r):new n.ColumnBinarySearch(e)};var n=r(207),o=r(210)},function(e,t,r){"use strict";t.__esModule=!0,t.ColumnBinarySearch=void 0;var n=r(208);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class o extends n.AdvancedFind{constructor(e){super(e),this.dependencyGraph=e}add(e,t){}remove(e,t){}change(e,t,r){}applyChanges(e){}addColumns(e){}removeColumns(e){}removeSheet(e){}moveValues(e,t,r,n){}removeValues(e){}find(e,t,r){return this.basicFind(e,t,"row",r)}}t.ColumnBinarySearch=o},function(e,t,r){"use strict";t.__esModule=!0,t.AdvancedFind=void 0;var n=r(140),o=r(168),s=r(209);t.AdvancedFind=
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
class{constructor(e){this.dependencyGraph=e}advancedFind(e,t){let r;const o=t.range;r=void 0===o?t.valuesFromTopLeftCorner():this.dependencyGraph.computeListOfValuesInRange(o);for(let t=0;t<r.length;t++)if(e((0,n.getRawValue)(r[t])))return t;return-1}basicFind(e,t,r,{ordering:n,matchExactly:i}){const a="string"==typeof e?(0,o.forceNormalizeString)(e):e,u=t.range;return void 0===u?this.findNormalizedValue(a,t.valuesFromTopLeftCorner()):"none"===n?this.findNormalizedValue(a,this.dependencyGraph.computeListOfValuesInRange(u)):(0,s.findLastOccurrenceInOrderedRange)(a,u,{searchCoordinate:r,orderingDirection:n,matchExactly:i},this.dependencyGraph)}findNormalizedValue(e,t){return t.map(n.getRawValue).map(e=>"string"==typeof e?(0,o.forceNormalizeString)(e):e).indexOf(e)}}},function(e,t,r){"use strict";t.__esModule=!0,t.compare=i,t.findLastMatchingIndex=s,t.findLastOccurrenceInOrderedArray=function(e,t,r="asc"){return s("asc"===r?r=>i(e,t[r])>=0:r=>-i(e,t[r])>=0,0,t.length-1)},t.findLastOccurrenceInOrderedRange=function(e,t,{searchCoordinate:r,orderingDirection:a,matchExactly:u},c){const l=t.start[r],h="col"===r?t.effectiveEndColumn(c):t.effectiveEndRow(c),d="col"===r?e=>(0,o.getRawValue)(c.getCellValue((0,n.simpleCellAddress)(t.sheet,e,t.start.row))):e=>(0,o.getRawValue)(c.getCellValue((0,n.simpleCellAddress)(t.sheet,t.start.col,e))),p="asc"===a?(e,t)=>i(e,t):(e,t)=>-i(e,t),m=s(t=>p(e,d(t))>=0,l,h),g=d(m);return-1===m||typeof g!=typeof e||u&&g!==e?-1:m-l};var n=r(73),o=r(140);function s(e,t,r){let n=t,o=r;for(;n<o;){const t=Math.ceil((n+o)/2);e(t)?n=t:o=t-1}return n===o&&e(n)?n:-1}function i(e,t){return typeof e==typeof t?e===o.EmptyValue?0:e<t?-1:e>t?1:0:e===o.EmptyValue?-1:t===o.EmptyValue?1:t instanceof n.CellError||"number"==typeof e&&"string"==typeof t||"number"==typeof e&&"boolean"==typeof t?-1:"string"==typeof e&&"number"==typeof t?1:"string"==typeof e&&"boolean"==typeof t?-1:1}},function(e,t,r){"use strict";t.__esModule=!0,t.ColumnIndex=void 0,t.findInOrderedArray=d;var n=r(73),o=r(189),s=r(193),i=r(168),a=r(140),u=r(139),c=r(142),l=r(207);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
class h{constructor(e,t,r){this.dependencyGraph=e,this.config=t,this.stats=r,this.index=new Map,this.transformingService=this.dependencyGraph.lazilyTransformingAstService,this.binarySearchStrategy=new l.ColumnBinarySearch(e)}add(e,t){if(!(e===a.EmptyValue||e instanceof n.CellError))if(e instanceof u.SimpleRangeValue)for(const[r,n]of e.entriesFromTopLeftCorner(t))this.addSingleCellValue((0,a.getRawValue)(r),n);else this.addSingleCellValue(e,t)}remove(e,t){if(void 0!==e)if(e instanceof u.SimpleRangeValue)for(const[r,n]of e.entriesFromTopLeftCorner(t))this.removeSingleValue((0,a.getRawValue)(r),n);else this.removeSingleValue(e,t)}change(e,t,r){e!==t&&(this.remove(e,r),this.add(t,r))}applyChanges(e){for(const t of e)void 0!==t.oldValue&&this.change((0,a.getRawValue)(t.oldValue),(0,a.getRawValue)(t.value),t.address)}moveValues(e,t,r,o){for(const[s,i]of e){const e=(0,n.movedSimpleCellAddress)(i,o,t,r);this.remove(s,i),this.add(s,e)}}removeValues(e){for(const[t,r]of e)this.remove(t,r)}find(e,t,{ordering:r,matchExactly:n}){const o=!0===n?"findFirst":"findLast",s=this.findUsingColumnIndex(e,t,o);return void 0!==s?s:this.binarySearchStrategy.find(e,t,{ordering:r,matchExactly:n})}findUsingColumnIndex(e,t,r){const n=t.range;if(void 0===n)return;this.ensureRecentData(n.sheet,n.start.col,e);const o=this.getColumnMap(n.sheet,n.start.col);if(!o)return-1;const s="string"==typeof e?(0,i.forceNormalizeString)(e):e,a=o.get(s);if(!a||!a.index||0===a.index.length)return;const u=h.findRowBelongingToRange(a,n,r);return void 0!==u?u-n.start.row:void 0}static findRowBelongingToRange(e,t,r){const n=t.start.row,o=t.end.row,s="findFirst"===r?d(n,e.index,"upperBound"):d(o,e.index,"lowerBound");if(-1===s)return;const i=e.index[s];return i>=n&&i<=o?i:void 0}advancedFind(e,t){return this.binarySearchStrategy.advancedFind(e,t)}addColumns(e){const t=this.index.get(e.sheet);t&&t.splice(e.columnStart,0,...Array(e.numberOfColumns))}removeColumns(e){const t=this.index.get(e.sheet);t&&t.splice(e.columnStart,e.numberOfColumns)}removeSheet(e){this.index.delete(e)}getColumnMap(e,t){this.index.has(e)||this.index.set(e,[]);const r=this.index.get(e);let n=r[t];return n||(n=new Map,r[t]=n),n}getValueIndex(e,t,r){const n=this.getColumnMap(e,t);let o=this.getColumnMap(e,t).get(r);return o||(o={version:this.transformingService.version(),index:[]},n.set(r,o)),o}ensureRecentData(e,t,r){const n=this.getValueIndex(e,t,r),i=this.transformingService.version();if(n.version===i)return;const a=this.transformingService.getTransformationsFrom(n.version,t=>t.sheet===e&&(t instanceof o.AddRowsTransformer||t instanceof s.RemoveRowsTransformer));for(const e of a)e instanceof o.AddRowsTransformer?this.addRows(t,e.rowsSpan,r):e instanceof s.RemoveRowsTransformer&&this.removeRows(t,e.rowsSpan,r);n.version=i}addSingleCellValue(e,t){this.stats.measure(c.StatType.BUILD_COLUMN_INDEX,()=>{this.ensureRecentData(t.sheet,t.col,e),"string"==typeof e&&(e=(0,i.forceNormalizeString)(e));const r=this.getValueIndex(t.sheet,t.col,e);h.addValue(r,t.row)})}removeSingleValue(e,t){this.stats.measure(c.StatType.BUILD_COLUMN_INDEX,()=>{this.ensureRecentData(t.sheet,t.col,e);const r=this.getColumnMap(t.sheet,t.col);"string"==typeof e&&(e=(0,i.forceNormalizeString)(e));const n=r.get(e);if(!n)return;const o=d(t.row,n.index);o>-1&&n.index.splice(o,1),0===n.index.length&&r.delete(e),0===r.size&&delete this.index.get(t.sheet)[t.col]})}addRows(e,t,r){const n=this.getValueIndex(t.sheet,e,r);h.shiftRows(n,t.rowStart,t.numberOfRows)}removeRows(e,t,r){const n=this.getValueIndex(t.sheet,e,r);h.removeRowsFromValues(n,t),h.shiftRows(n,t.rowEnd+1,-t.numberOfRows)}static addValue(e,t){const r=d(t,e.index,"lowerBound");e.index[r]===t||e.index.splice(r+1,0,t)}static removeRowsFromValues(e,t){const r=d(t.rowStart,e.index,"upperBound"),n=d(t.rowEnd,e.index,"lowerBound");r>-1&&n>-1&&r<=n&&e.index[r]<=t.rowEnd&&e.index.splice(r,n-r+1)}static shiftRows(e,t,r){const n=d(t,e.index,"upperBound");if(-1!==n)for(let t=n;t<e.index.length;++t)e.index[t]+=r}}function d(e,t,r="upperBound"){let n=0,o=t.length-1;for(;n<=o;){const r=Math.floor((n+o)/2);if(e>t[r])n=r+1;else{if(!(e<t[r]))return r;o=r-1}}const s="lowerBound"===r?o:n;return s>=0&&s<=t.length?s:-1}t.ColumnIndex=h},function(e,t,r){"use strict";t.__esModule=!0,t.NumberLiteralHelper=void 0,t.NumberLiteralHelper=
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
class{constructor(e){this.config=e;const t="."===this.config.thousandSeparator?"\\"+this.config.thousandSeparator:this.config.thousandSeparator,r="."===this.config.decimalSeparator?"\\"+this.config.decimalSeparator:this.config.decimalSeparator;this.numberPattern=new RegExp(`^([+-]?((${r}\\d+)|(\\d+(${t}\\d{3,})*(${r}\\d*)?)))(e[+-]?\\d+)?$`),this.allThousandSeparatorsRegex=new RegExp(""+t,"g")}numericStringToMaybeNumber(e){if(this.numberPattern.test(e)){const t=this.numericStringToNumber(e);if(isNaN(t))return;return t}}numericStringToNumber(e){const t=e.replace(this.allThousandSeparatorsRegex,"").replace(this.config.decimalSeparator,".");return Number(t)}}},function(e,t,r){"use strict";t.__esModule=!0,t.Serialization=void 0;var n=r(73),o=r(74),s=r(77);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
class i{constructor(e,t,r){this.dependencyGraph=e,this.unparser=t,this.exporter=r}getCellHyperlink(e){const t=this.dependencyGraph.getCell(e);if(t instanceof o.FormulaCellVertex){const e=t.getFormula(this.dependencyGraph.lazilyTransformingAstService);if("HYPERLINK"===e.procedureName)return e.hyperlink}}getCellFormula(e,t){const r=this.dependencyGraph.getCell(e);if(r instanceof o.FormulaCellVertex){const n=r.getFormula(this.dependencyGraph.lazilyTransformingAstService);return t=null!=t?t:e,this.unparser.unparse(n,t)}if(r instanceof o.ArrayVertex){const n=r.getAddress(this.dependencyGraph.lazilyTransformingAstService);if(n.row!==e.row||n.col!==e.col||n.sheet!==e.sheet)return;t=null!=t?t:e;const o=r.getFormula(this.dependencyGraph.lazilyTransformingAstService);if(void 0!==o)return this.unparser.unparse(o,t)}else if(r instanceof o.ParsingErrorVertex)return r.getFormula()}getCellSerialized(e,t){var r;return null!==(r=this.getCellFormula(e,t))&&void 0!==r?r:this.getRawValue(e)}getCellValue(e){return this.exporter.exportValue(this.dependencyGraph.getScalarValue(e))}getRawValue(e){return this.dependencyGraph.getRawValue(e)}getSheetValues(e){return this.genericSheetGetter(e,e=>this.getCellValue(e))}getSheetFormulas(e){return this.genericSheetGetter(e,e=>this.getCellFormula(e))}genericSheetGetter(e,t){const r=this.dependencyGraph.getSheetHeight(e),o=this.dependencyGraph.getSheetWidth(e),s=new Array(r);for(let i=0;i<r;i++){s[i]=new Array(o);for(let r=0;r<o;r++){const o=(0,n.simpleCellAddress)(e,r,i);s[i][r]=t(o)}for(let e=o-1;e>=0&&(null===s[i][e]||void 0===s[i][e]);e--)s[i].pop()}for(let e=r-1;e>=0&&0===s[e].length;e--)s.pop();return s}genericAllSheetsGetter(e){const t={};for(const r of this.dependencyGraph.sheetMapping.displayNames()){const n=this.dependencyGraph.sheetMapping.fetch(r);t[r]=e(n)}return t}getSheetSerialized(e){return this.genericSheetGetter(e,e=>this.getCellSerialized(e))}getAllSheetsValues(){return this.genericAllSheetsGetter(e=>this.getSheetValues(e))}getAllSheetsFormulas(){return this.genericAllSheetsGetter(e=>this.getSheetFormulas(e))}getAllSheetsSerialized(){return this.genericAllSheetsGetter(e=>this.getSheetSerialized(e))}getAllNamedExpressionsSerialized(){const e=[];let t=0;for(const r of this.dependencyGraph.sheetMapping.displayNames()){const n=this.dependencyGraph.sheetMapping.fetch(r);e[n]=t,t++}return this.dependencyGraph.namedExpressions.getAllNamedExpressions().map(t=>({name:t.expression.displayName,expression:this.getCellSerialized(t.expression.address),scope:void 0!==t.scope?e[t.scope]:void 0,options:t.expression.options}))}withNewConfig(e,t){const r=new s.Unparser(e,(0,s.buildLexerConfig)(e),this.dependencyGraph.sheetMapping.fetchDisplayName,t);return new i(this.dependencyGraph,r,this.exporter)}}t.Serialization=i},function(e,t,r){"use strict";function n(e){return()=>{throw new Error(`The "${e}" method cannot be called because this HyperFormula instance has been destroyed`)}}t.__esModule=!0,t.objectDestroy=
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
function(e){for(const[t,r]of Object.entries(e))r instanceof Function?e[t]=n(r):delete e[t]}},function(e,t,r){"use strict";t.__esModule=!0,t.Events=t.Emitter=void 0;var n,o=r(215);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */!function(e){e.SheetAdded="sheetAdded",e.SheetRemoved="sheetRemoved",e.SheetRenamed="sheetRenamed",e.NamedExpressionAdded="namedExpressionAdded",e.NamedExpressionRemoved="namedExpressionRemoved",e.ValuesUpdated="valuesUpdated",e.EvaluationSuspended="evaluationSuspended",e.EvaluationResumed="evaluationResumed"}(n||(t.Events=n={}));class s extends o.TinyEmitter{emit(e,...t){return super.emit(e,...t),this}}t.Emitter=s},function(e,t){function r(){}r.prototype={on:function(e,t,r){var n=this.e||(this.e={});return(n[e]||(n[e]=[])).push({fn:t,ctx:r}),this},once:function(e,t,r){var n=this;function o(){n.off(e,o),t.apply(r,arguments)}return o._=t,this.on(e,o,r)},emit:function(e){for(var t=[].slice.call(arguments,1),r=((this.e||(this.e={}))[e]||[]).slice(),n=0,o=r.length;n<o;n++)r[n].fn.apply(r[n].ctx,t);return this},off:function(e,t){var r=this.e||(this.e={}),n=r[e],o=[];if(n&&t)for(var s=0,i=n.length;s<i;s++)n[s].fn!==t&&n[s].fn._!==t&&o.push(n[s]);return o.length?r[e]=o:delete r[e],this}},e.exports=r,e.exports.TinyEmitter=r},function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0,t.default={errors:{CYCLE:"#CYCLE!",DIV_BY_ZERO:"#DIV/0!",ERROR:"#ERROR!",NA:"#N/A",NAME:"#NAME?",NUM:"#NUM!",REF:"#REF!",SPILL:"#SPILL!",VALUE:"#VALUE!"},functions:{FILTER:"FILTER",ADDRESS:"ADDRESS",ARRAY_CONSTRAIN:"ARRAY_CONSTRAIN",ARRAYFORMULA:"ARRAYFORMULA",ABS:"ABS",ACOS:"ACOS",ACOSH:"ACOSH",ACOT:"ACOT",ACOTH:"ACOTH",AND:"AND",ARABIC:"ARABIC",ASIN:"ASIN",ASINH:"ASINH",ATAN2:"ATAN2",ATAN:"ATAN",ATANH:"ATANH",AVERAGE:"AVERAGE",AVERAGEA:"AVERAGEA",AVERAGEIF:"AVERAGEIF",BASE:"BASE",BIN2DEC:"BIN2DEC",BIN2HEX:"BIN2HEX",BIN2OCT:"BIN2OCT",BITAND:"BITAND",BITLSHIFT:"BITLSHIFT",BITOR:"BITOR",BITRSHIFT:"BITRSHIFT",BITXOR:"BITXOR",CEILING:"CEILING",CHAR:"CHAR",CHOOSE:"CHOOSE",CLEAN:"CLEAN",CODE:"CODE",COLUMN:"COLUMN",COLUMNS:"COLUMNS",CONCATENATE:"CONCATENATE",CORREL:"CORREL",COS:"COS",COSH:"COSH",COT:"COT",COTH:"COTH",COUNT:"COUNT",COUNTA:"COUNTA",COUNTBLANK:"COUNTBLANK",COUNTIF:"COUNTIF",COUNTIFS:"COUNTIFS",COUNTUNIQUE:"COUNTUNIQUE",CSC:"CSC",CSCH:"CSCH",CUMIPMT:"CUMIPMT",CUMPRINC:"CUMPRINC",DATE:"DATE",DATEDIF:"DATEDIF",DATEVALUE:"DATEVALUE",DAY:"DAY",DAYS360:"DAYS360",DAYS:"DAYS",DB:"DB",DDB:"DDB",DEC2BIN:"DEC2BIN",DEC2HEX:"DEC2HEX",DEC2OCT:"DEC2OCT",DECIMAL:"DECIMAL",DEGREES:"DEGREES",DELTA:"DELTA",DOLLARDE:"DOLLARDE",DOLLARFR:"DOLLARFR",EDATE:"EDATE",EFFECT:"EFFECT",EOMONTH:"EOMONTH",ERF:"ERF",ERFC:"ERFC",EVEN:"EVEN",EXACT:"EXACT",EXP:"EXP",FALSE:"FALSE",FIND:"FIND",FORMULATEXT:"FORMULATEXT",FV:"FV",FVSCHEDULE:"FVSCHEDULE",HEX2BIN:"HEX2BIN",HEX2DEC:"HEX2DEC",HEX2OCT:"HEX2OCT",HLOOKUP:"HLOOKUP",HOUR:"HOUR",HYPERLINK:"HYPERLINK",IF:"IF",IFERROR:"IFERROR",IFNA:"IFNA",IFS:"IFS",INDEX:"INDEX",INT:"INT",INTERVAL:"INTERVAL",IPMT:"IPMT",ISBINARY:"ISBINARY",ISBLANK:"ISBLANK",ISERR:"ISERR",ISERROR:"ISERROR",ISEVEN:"ISEVEN",ISFORMULA:"ISFORMULA",ISLOGICAL:"ISLOGICAL",ISNA:"ISNA",ISNONTEXT:"ISNONTEXT",ISNUMBER:"ISNUMBER",ISODD:"ISODD",ISOWEEKNUM:"ISOWEEKNUM",ISPMT:"ISPMT",ISREF:"ISREF",ISTEXT:"ISTEXT",LEFT:"LEFT",LEN:"LEN",LN:"LN",LOG10:"LOG10",LOG:"LOG",LOWER:"LOWER",MATCH:"MATCH",MAX:"MAX",MAXA:"MAXA",MAXIFS:"MAXIFS",MAXPOOL:"MAXPOOL",MEDIAN:"MEDIAN",MEDIANPOOL:"MEDIANPOOL",MID:"MID",MIN:"MIN",MINA:"MINA",MINIFS:"MINIFS",MINUTE:"MINUTE",MIRR:"MIRR",MMULT:"MMULT",MOD:"MOD",MONTH:"MONTH",NA:"NA",NETWORKDAYS:"NETWORKDAYS","NETWORKDAYS.INTL":"NETWORKDAYS.INTL",NOMINAL:"NOMINAL",NOT:"NOT",NOW:"NOW",NPER:"NPER",NPV:"NPV",OCT2BIN:"OCT2BIN",OCT2DEC:"OCT2DEC",OCT2HEX:"OCT2HEX",ODD:"ODD",OFFSET:"OFFSET",OR:"OR",PI:"PI",PMT:"PMT",PDURATION:"PDURATION",PRODUCT:"PRODUCT",POWER:"POWER",PPMT:"PPMT",PROPER:"PROPER",PV:"PV",RADIANS:"RADIANS",RAND:"RAND",RATE:"RATE",REPLACE:"REPLACE",REPT:"REPT",RIGHT:"RIGHT",ROMAN:"ROMAN",ROUND:"ROUND",ROUNDDOWN:"ROUNDDOWN",ROUNDUP:"ROUNDUP",ROW:"ROW",ROWS:"ROWS",RRI:"RRI",SEARCH:"SEARCH",SEC:"SEC",SECH:"SECH",SECOND:"SECOND",SHEET:"SHEET",SHEETS:"SHEETS",SIN:"SIN",SINH:"SINH",SLN:"SLN",SPLIT:"SPLIT",SQRT:"SQRT",STDEVA:"STDEVA","STDEV.P":"STDEV.P",STDEVPA:"STDEVPA","STDEV.S":"STDEV.S",SUBSTITUTE:"SUBSTITUTE",SUBTOTAL:"SUBTOTAL",SUM:"SUM",SUMIF:"SUMIF",SUMIFS:"SUMIFS",SUMPRODUCT:"SUMPRODUCT",SUMSQ:"SUMSQ",SWITCH:"SWITCH",SYD:"SYD",T:"T",TAN:"TAN",TANH:"TANH",TBILLEQ:"TBILLEQ",TBILLPRICE:"TBILLPRICE",TBILLYIELD:"TBILLYIELD",TEXT:"TEXT",TIME:"TIME",TIMEVALUE:"TIMEVALUE",TODAY:"TODAY",TRANSPOSE:"TRANSPOSE",TRIM:"TRIM",TRUE:"TRUE",TRUNC:"TRUNC",UNICHAR:"UNICHAR",UNICODE:"UNICODE",UPPER:"UPPER",VARA:"VARA","VAR.P":"VAR.P",VARPA:"VARPA","VAR.S":"VAR.S",VLOOKUP:"VLOOKUP",WEEKDAY:"WEEKDAY",WEEKNUM:"WEEKNUM",WORKDAY:"WORKDAY","WORKDAY.INTL":"WORKDAY.INTL",XNPV:"XNPV",XOR:"XOR",YEAR:"YEAR",YEARFRAC:"YEARFRAC","HF.ADD":"HF.ADD","HF.CONCAT":"HF.CONCAT","HF.DIVIDE":"HF.DIVIDE","HF.EQ":"HF.EQ","HF.GT":"HF.GT","HF.GTE":"HF.GTE","HF.LT":"HF.LT","HF.LTE":"HF.LTE","HF.MINUS":"HF.MINUS","HF.MULTIPLY":"HF.MULTIPLY","HF.NE":"HF.NE","HF.POW":"HF.POW","HF.UMINUS":"HF.UMINUS","HF.UNARY_PERCENT":"HF.UNARY_PERCENT","HF.UPLUS":"HF.UPLUS",VARP:"VARP",VAR:"VAR",STDEVP:"STDEVP",STDEV:"STDEV","EXPON.DIST":"EXPON.DIST",FISHER:"FISHER",FISHERINV:"FISHERINV",GAMMA:"GAMMA","GAMMA.DIST":"GAMMA.DIST",GAMMALN:"GAMMALN","GAMMALN.PRECISE":"GAMMALN.PRECISE","GAMMA.INV":"GAMMA.INV",GAUSS:"GAUSS",FACT:"FACT",FACTDOUBLE:"FACTDOUBLE",COMBIN:"COMBIN",COMBINA:"COMBINA",GCD:"GCD",LCM:"LCM",MROUND:"MROUND",MULTINOMIAL:"MULTINOMIAL",QUOTIENT:"QUOTIENT",RANDBETWEEN:"RANDBETWEEN",SERIESSUM:"SERIESSUM",SIGN:"SIGN",SQRTPI:"SQRTPI",SUMX2MY2:"SUMX2MY2",SUMX2PY2:"SUMX2PY2",SUMXMY2:"SUMXMY2",EXPONDIST:"EXPONDIST",GAMMADIST:"GAMMADIST",GAMMAINV:"GAMMAINV","BETA.DIST":"BETA.DIST",BETADIST:"BETADIST","BETA.INV":"BETA.INV",BETAINV:"BETAINV","BINOM.DIST":"BINOM.DIST",BINOMDIST:"BINOMDIST","BINOM.INV":"BINOM.INV",BESSELI:"BESSELI",BESSELJ:"BESSELJ",BESSELK:"BESSELK",BESSELY:"BESSELY","CHISQ.DIST":"CHISQ.DIST","CHISQ.DIST.RT":"CHISQ.DIST.RT","CHISQ.INV":"CHISQ.INV","CHISQ.INV.RT":"CHISQ.INV.RT",CHIDIST:"CHIDIST",CHIINV:"CHIINV","F.DIST":"F.DIST","F.DIST.RT":"F.DIST.RT","F.INV":"F.INV","F.INV.RT":"F.INV.RT",FDIST:"FDIST",FINV:"FINV",WEIBULL:"WEIBULL","WEIBULL.DIST":"WEIBULL.DIST",POISSON:"POISSON","POISSON.DIST":"POISSON.DIST","HYPGEOM.DIST":"HYPGEOM.DIST",HYPGEOMDIST:"HYPGEOMDIST","T.DIST":"T.DIST","T.DIST.2T":"T.DIST.2T","T.DIST.RT":"T.DIST.RT","T.INV":"T.INV","T.INV.2T":"T.INV.2T",TDIST:"TDIST",TINV:"TINV",LOGINV:"LOGINV","LOGNORM.DIST":"LOGNORM.DIST","LOGNORM.INV":"LOGNORM.INV",LOGNORMDIST:"LOGNORMDIST","NORM.DIST":"NORM.DIST","NORM.INV":"NORM.INV","NORM.S.DIST":"NORM.S.DIST","NORM.S.INV":"NORM.S.INV",NORMDIST:"NORMDIST",NORMINV:"NORMINV",NORMSDIST:"NORMSDIST",NORMSINV:"NORMSINV",PHI:"PHI","NEGBINOM.DIST":"NEGBINOM.DIST",NEGBINOMDIST:"NEGBINOMDIST",COMPLEX:"COMPLEX",IMABS:"IMABS",IMAGINARY:"IMAGINARY",IMARGUMENT:"IMARGUMENT",IMCONJUGATE:"IMCONJUGATE",IMCOS:"IMCOS",IMCOSH:"IMCOSH",IMCOT:"IMCOT",IMCSC:"IMCSC",IMCSCH:"IMCSCH",IMDIV:"IMDIV",IMEXP:"IMEXP",IMLN:"IMLN",IMLOG10:"IMLOG10",IMLOG2:"IMLOG2",IMPOWER:"IMPOWER",IMPRODUCT:"IMPRODUCT",IMREAL:"IMREAL",IMSEC:"IMSEC",IMSECH:"IMSECH",IMSIN:"IMSIN",IMSINH:"IMSINH",IMSQRT:"IMSQRT",IMSUB:"IMSUB",IMSUM:"IMSUM",IMTAN:"IMTAN",LARGE:"LARGE",SMALL:"SMALL",AVEDEV:"AVEDEV",CONFIDENCE:"CONFIDENCE","CONFIDENCE.NORM":"CONFIDENCE.NORM","CONFIDENCE.T":"CONFIDENCE.T",DEVSQ:"DEVSQ",GEOMEAN:"GEOMEAN",HARMEAN:"HARMEAN",CRITBINOM:"CRITBINOM","COVARIANCE.P":"COVARIANCE.P","COVARIANCE.S":"COVARIANCE.S",COVAR:"COVAR",PEARSON:"PEARSON",RSQ:"RSQ",STANDARDIZE:"STANDARDIZE","Z.TEST":"Z.TEST",ZTEST:"ZTEST","F.TEST":"F.TEST",FTEST:"FTEST",STEYX:"STEYX",SLOPE:"SLOPE","CHISQ.TEST":"CHISQ.TEST",CHITEST:"CHITEST","T.TEST":"T.TEST",TTEST:"TTEST",SKEW:"SKEW","SKEW.P":"SKEW.P",WEIBULLDIST:"WEIBULLDIST",VARS:"VARS",TINV2T:"TINV2T",TDISTRT:"TDISTRT",TDIST2T:"TDIST2T",STDEVS:"STDEVS",FINVRT:"FINVRT",FDISTRT:"FDISTRT",CHIDISTRT:"CHIDISTRT",CHIINVRT:"CHIINVRT",COVARIANCEP:"COVARIANCEP",COVARIANCES:"COVARIANCES",LOGNORMINV:"LOGNORMINV",POISSONDIST:"POISSONDIST",SKEWP:"SKEWP","CEILING.MATH":"CEILING.MATH",FLOOR:"FLOOR","FLOOR.MATH":"FLOOR.MATH","CEILING.PRECISE":"CEILING.PRECISE","FLOOR.PRECISE":"FLOOR.PRECISE","ISO.CEILING":"ISO.CEILING"},langCode:"enGB",ui:{NEW_SHEET_PREFIX:"Sheet"}}},function(e,t,r){"use strict";t.__esModule=!0,t.TrigonometryPlugin=t.TextPlugin=t.SumprodPlugin=t.StatisticalPlugin=t.StatisticalAggregationPlugin=t.SqrtPlugin=t.SimpleArithmerticPlugin=t.RoundingPlugin=t.RomanPlugin=t.RandomPlugin=t.RadixConversionPlugin=t.RadiansPlugin=t.PowerPlugin=t.NumericAggregationPlugin=t.ModuloPlugin=t.MedianPlugin=t.MatrixPlugin=t.MathPlugin=t.MathConstantsPlugin=t.LookupPlugin=t.LogarithmPlugin=t.IsOddPlugin=t.IsEvenPlugin=t.InformationPlugin=t.HyperlinkPlugin=t.FormulaTextPlugin=t.FinancialPlugin=t.ExpPlugin=t.DeltaPlugin=t.DegreesPlugin=t.DateTimePlugin=t.CountUniquePlugin=t.CountBlankPlugin=t.ConditionalAggregationPlugin=t.ComplexPlugin=t.CodePlugin=t.CharPlugin=t.BooleanPlugin=t.BitwiseLogicOperationsPlugin=t.BitShiftPlugin=t.ArrayPlugin=t.AddressPlugin=t.AbsPlugin=void 0;var n=r(218);t.AddressPlugin=n.AddressPlugin;var o=r(219);t.ArrayPlugin=o.ArrayPlugin;var s=r(220);t.AbsPlugin=s.AbsPlugin;var i=r(221);t.BitShiftPlugin=i.BitShiftPlugin;var a=r(222);t.BitwiseLogicOperationsPlugin=a.BitwiseLogicOperationsPlugin;var u=r(223);t.BooleanPlugin=u.BooleanPlugin;var c=r(224);t.CharPlugin=c.CharPlugin;var l=r(225);t.CodePlugin=l.CodePlugin;var h=r(226);t.CountBlankPlugin=h.CountBlankPlugin;var d=r(227);t.CountUniquePlugin=d.CountUniquePlugin;var p=r(228);t.DateTimePlugin=p.DateTimePlugin;var m=r(229);t.DegreesPlugin=m.DegreesPlugin;var g=r(230);t.DeltaPlugin=g.DeltaPlugin;var f=r(231);t.ExpPlugin=f.ExpPlugin;var E=r(232);t.FinancialPlugin=E.FinancialPlugin;var T=r(233);t.FormulaTextPlugin=T.FormulaTextPlugin;var y=r(234);t.HyperlinkPlugin=y.HyperlinkPlugin;var A=r(235);t.InformationPlugin=A.InformationPlugin;var R=r(236);t.IsEvenPlugin=R.IsEvenPlugin;var N=r(237);t.IsOddPlugin=N.IsOddPlugin;var S=r(238);t.LogarithmPlugin=S.LogarithmPlugin;var C=r(239);t.MathConstantsPlugin=C.MathConstantsPlugin;var v=r(240);t.MatrixPlugin=v.MatrixPlugin;var O=r(241);t.MedianPlugin=O.MedianPlugin;var I=r(242);t.ModuloPlugin=I.ModuloPlugin;var M=r(243);t.NumericAggregationPlugin=M.NumericAggregationPlugin;var b=r(244);t.PowerPlugin=b.PowerPlugin;var F=r(245);t.RadiansPlugin=F.RadiansPlugin;var w=r(246);t.RadixConversionPlugin=w.RadixConversionPlugin;var _=r(247);t.RandomPlugin=_.RandomPlugin;var L=r(248);t.RoundingPlugin=L.RoundingPlugin;var x=r(249);t.SqrtPlugin=x.SqrtPlugin;var P=r(250);t.ConditionalAggregationPlugin=P.ConditionalAggregationPlugin;var U=r(253);t.SumprodPlugin=U.SumprodPlugin;var V=r(254);t.TextPlugin=V.TextPlugin;var D=r(255);t.TrigonometryPlugin=D.TrigonometryPlugin;var B=r(256);t.LookupPlugin=B.LookupPlugin;var k=r(258);t.RomanPlugin=k.RomanPlugin;var G=r(259);t.SimpleArithmerticPlugin=G.SimpleArithmerticPlugin;var j=r(260);t.StatisticalPlugin=j.StatisticalPlugin;var W=r(263);t.MathPlugin=W.MathPlugin;var H=r(264);t.ComplexPlugin=H.ComplexPlugin;var z=r(265);t.StatisticalAggregationPlugin=z.StatisticalAggregationPlugin},function(e,t,r){"use strict";t.__esModule=!0,t.AddressPlugin=void 0;var n,o=r(78),s=r(167),i=r(73),a=r(131);!function(e){e[e.FullyAbsolute=1]="FullyAbsolute",e[e.RowAbsoluteColRelative=2]="RowAbsoluteColRelative",e[e.RowRelativeColAbsolute=3]="RowRelativeColAbsolute",e[e.FullyRelative=4]="FullyRelative"}(n||(n={}));class u extends s.FunctionPlugin{verifyAddressArguments(e,t,r,o){if(o){if(e<1||t<1)return new i.CellError(i.ErrorType.VALUE,a.ErrorMessage.LessThanOne)}else if(n.FullyAbsolute==r){if(e<1||t<1)return new i.CellError(i.ErrorType.VALUE,a.ErrorMessage.LessThanOne)}else if(n.RowAbsoluteColRelative==r){if(e<1)return new i.CellError(i.ErrorType.VALUE,a.ErrorMessage.LessThanOne)}else if(n.RowRelativeColAbsolute==r&&t<1)return new i.CellError(i.ErrorType.VALUE,a.ErrorMessage.LessThanOne)}address(e,t){return this.runFunction(e.args,t,this.metadata("ADDRESS"),(e,t,r,s,i)=>{const a=this.verifyAddressArguments(e,t,r,s);if(void 0!==a)return a;const u=(0,o.columnIndexToLabel)(t-1);let c="";null!=i&&(c=i+"!");const l=0==t?"C":`C[${t}]`,h=0==e?"R":`R[${e}]`;return n.FullyRelative==r?s?`${c}${u}${e}`:`${c}${h}${l}`:n.RowRelativeColAbsolute==r?s?`${c}$${u}${e}`:`${c}${h}C${t}`:n.RowAbsoluteColRelative==r?s?`${c}${u}$${e}`:`${c}R${e}${l}`:s?`${c}$${u}$${e}`:`${c}R${e}C${t}`})}}t.AddressPlugin=u,u.implementedFunctions={ADDRESS:{method:"address",parameters:[{argumentType:s.FunctionArgumentType.NUMBER},{argumentType:s.FunctionArgumentType.NUMBER},{argumentType:s.FunctionArgumentType.NUMBER,optionalArg:!0,defaultValue:1,minValue:1,maxValue:4},{argumentType:s.FunctionArgumentType.BOOLEAN,optionalArg:!0,defaultValue:!0},{argumentType:s.FunctionArgumentType.STRING,optionalArg:!0}]}}},function(e,t,r){"use strict";t.__esModule=!0,t.ArrayPlugin=void 0,r(2);var n=r(1),o=r(73),s=r(131),i=r(77),a=r(168),u=r(165),c=r(139),l=r(167);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
class h extends l.FunctionPlugin{arrayformula(e,t){return this.runFunction(e.args,t,this.metadata("ARRAYFORMULA"),e=>e)}arrayformulaArraySize(e,t){if(1!==e.args.length)return n.ArraySize.error();const r=this.metadata("ARRAYFORMULA");return e.args.map(e=>{var n;return this.arraySizeForAst(e,new u.InterpreterState(t.formulaAddress,t.arraysFlag||null!==(n=null==r?void 0:r.arrayFunction)&&void 0!==n&&n))})[0]}arrayconstrain(e,t){return this.runFunction(e.args,t,this.metadata("ARRAY_CONSTRAIN"),(e,t,r)=>{t=Math.min(t,e.height()),r=Math.min(r,e.width());const n=e.data,o=[];for(let e=0;e<t;e++)o.push(n[e].slice(0,r));return c.SimpleRangeValue.onlyValues(o)})}arrayconstrainArraySize(e,t){if(3!==e.args.length)return n.ArraySize.error();const r=this.metadata("ARRAY_CONSTRAIN"),o=e.args.map(e=>{var n;return this.arraySizeForAst(e,new u.InterpreterState(t.formulaAddress,t.arraysFlag||null!==(n=null==r?void 0:r.arrayFunction)&&void 0!==n&&n))});let{height:s,width:a}=o[0];return e.args[1].type===i.AstNodeType.NUMBER&&(s=Math.min(s,e.args[1].value)),e.args[2].type===i.AstNodeType.NUMBER&&(a=Math.min(a,e.args[2].value)),s<1||a<1||!Number.isInteger(s)||!Number.isInteger(a)?n.ArraySize.error():new n.ArraySize(a,s)}filter(e,t){return this.runFunction(e.args,t,this.metadata("FILTER"),(e,...t)=>{for(const r of t)if(e.width()!==r.width()||e.height()!==r.height())return new o.CellError(o.ErrorType.NA,s.ErrorMessage.EqualLength);if(e.width()>1&&e.height()>1)return new o.CellError(o.ErrorType.NA,s.ErrorMessage.WrongDimension);const r=e.data,n=[];for(let o=0;o<e.height();o++){const s=[];for(let n=0;n<e.width();n++){let e=!0;for(const r of t)if(!0!==(0,a.coerceScalarToBoolean)(r.data[o][n])){e=!1;break}e&&s.push(r[o][n])}s.length>0&&n.push(s)}return n.length>0?c.SimpleRangeValue.onlyValues(n):new o.CellError(o.ErrorType.NA,s.ErrorMessage.EmptyRange)})}filterArraySize(e,t){if(e.args.length<=1)return n.ArraySize.error();const r=this.metadata("FILTER"),o=e.args.map(e=>{var n;return this.arraySizeForAst(e,new u.InterpreterState(t.formulaAddress,t.arraysFlag||null!==(n=null==r?void 0:r.arrayFunction)&&void 0!==n&&n))}),s=Math.max(...o.map(e=>e.width)),i=Math.max(...o.map(e=>e.height));return new n.ArraySize(s,i)}}t.ArrayPlugin=h,h.implementedFunctions={ARRAYFORMULA:{method:"arrayformula",arraySizeMethod:"arrayformulaArraySize",arrayFunction:!0,parameters:[{argumentType:l.FunctionArgumentType.ANY}]},ARRAY_CONSTRAIN:{method:"arrayconstrain",arraySizeMethod:"arrayconstrainArraySize",parameters:[{argumentType:l.FunctionArgumentType.RANGE},{argumentType:l.FunctionArgumentType.INTEGER,minValue:1},{argumentType:l.FunctionArgumentType.INTEGER,minValue:1}],vectorizationForbidden:!0},FILTER:{method:"filter",arraySizeMethod:"filterArraySize",arrayFunction:!0,parameters:[{argumentType:l.FunctionArgumentType.RANGE},{argumentType:l.FunctionArgumentType.RANGE}],repeatLastArgs:1}}},function(e,t,r){"use strict";t.__esModule=!0,t.AbsPlugin=void 0;var n=r(167);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class o extends n.FunctionPlugin{abs(e,t){return this.runFunction(e.args,t,this.metadata("ABS"),Math.abs)}}t.AbsPlugin=o,o.implementedFunctions={ABS:{method:"abs",parameters:[{argumentType:n.FunctionArgumentType.NUMBER}]}}},function(e,t,r){"use strict";t.__esModule=!0,t.BitShiftPlugin=void 0;var n=r(73),o=r(131),s=r(167);class i extends s.FunctionPlugin{bitlshift(e,t){return this.runFunction(e.args,t,this.metadata("BITLSHIFT"),a)}bitrshift(e,t){return this.runFunction(e.args,t,this.metadata("BITRSHIFT"),u)}}function a(e,t){return t<0?u(e,-t):c(e*Math.pow(2,t))}function u(e,t){return t<0?a(e,-t):c(Math.floor(e/Math.pow(2,t)))}function c(e){return e>0xffffffffffff?new n.CellError(n.ErrorType.NUM,o.ErrorMessage.BitshiftLong):e}t.BitShiftPlugin=i,i.implementedFunctions={BITLSHIFT:{method:"bitlshift",parameters:[{argumentType:s.FunctionArgumentType.INTEGER,minValue:0},{argumentType:s.FunctionArgumentType.INTEGER,minValue:-53,maxValue:53}]},BITRSHIFT:{method:"bitrshift",parameters:[{argumentType:s.FunctionArgumentType.INTEGER,minValue:0},{argumentType:s.FunctionArgumentType.INTEGER,minValue:-53,maxValue:53}]}}},function(e,t,r){"use strict";t.__esModule=!0,t.BitwiseLogicOperationsPlugin=void 0;var n=r(167);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class o extends n.FunctionPlugin{bitand(e,t){return this.runFunction(e.args,t,this.metadata("BITAND"),(e,t)=>e&t)}bitor(e,t){return this.runFunction(e.args,t,this.metadata("BITOR"),(e,t)=>e|t)}bitxor(e,t){return this.runFunction(e.args,t,this.metadata("BITXOR"),(e,t)=>e^t)}}t.BitwiseLogicOperationsPlugin=o,o.implementedFunctions={BITAND:{method:"bitand",parameters:[{argumentType:n.FunctionArgumentType.INTEGER,minValue:0},{argumentType:n.FunctionArgumentType.INTEGER,minValue:0}]},BITOR:{method:"bitor",parameters:[{argumentType:n.FunctionArgumentType.INTEGER,minValue:0},{argumentType:n.FunctionArgumentType.INTEGER,minValue:0}]},BITXOR:{method:"bitxor",parameters:[{argumentType:n.FunctionArgumentType.INTEGER,minValue:0},{argumentType:n.FunctionArgumentType.INTEGER,minValue:0}]}}},function(e,t,r){"use strict";t.__esModule=!0,t.BooleanPlugin=void 0;var n=r(73),o=r(131),s=r(167);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
class i extends s.FunctionPlugin{literalTrue(e,t){return this.runFunction(e.args,t,this.metadata("TRUE"),()=>!0)}literalFalse(e,t){return this.runFunction(e.args,t,this.metadata("FALSE"),()=>!1)}conditionalIf(e,t){return this.runFunction(e.args,t,this.metadata("IF"),(e,t,r)=>e?t:r)}ifs(e,t){return this.runFunction(e.args,t,this.metadata("IFS"),(...e)=>{for(let t=0;t<e.length;t+=2)if(e[t])return e[t+1];return new n.CellError(n.ErrorType.NA,o.ErrorMessage.NoConditionMet)})}and(e,t){return this.runFunction(e.args,t,this.metadata("AND"),(...e)=>e.filter(e=>void 0!==e).every(e=>!!e))}or(e,t){return this.runFunction(e.args,t,this.metadata("OR"),(...e)=>e.filter(e=>void 0!==e).some(e=>e))}not(e,t){return this.runFunction(e.args,t,this.metadata("NOT"),e=>!e)}xor(e,t){return this.runFunction(e.args,t,this.metadata("XOR"),(...e)=>{let t=0;return e.filter(e=>void 0!==e).forEach(e=>{e&&t++}),t%2==1})}switch(e,t){return this.runFunction(e.args,t,this.metadata("SWITCH"),(e,...t)=>{const r=t.length;let s=0;for(;s+1<r;s+=2)if(!(t[s]instanceof n.CellError)&&this.arithmeticHelper.eq(e,t[s]))return t[s+1];return s<r?t[s]:new n.CellError(n.ErrorType.NA,o.ErrorMessage.NoDefault)})}iferror(e,t){return this.runFunction(e.args,t,this.metadata("IFERROR"),(e,t)=>e instanceof n.CellError?t:e)}ifna(e,t){return this.runFunction(e.args,t,this.metadata("IFNA"),(e,t)=>e instanceof n.CellError&&e.type===n.ErrorType.NA?t:e)}choose(e,t){return this.runFunction(e.args,t,this.metadata("CHOOSE"),(e,...t)=>e>t.length?new n.CellError(n.ErrorType.NUM,o.ErrorMessage.Selector):t[e-1])}}t.BooleanPlugin=i,i.implementedFunctions={TRUE:{method:"literalTrue",parameters:[]},FALSE:{method:"literalFalse",parameters:[]},IF:{method:"conditionalIf",parameters:[{argumentType:s.FunctionArgumentType.BOOLEAN},{argumentType:s.FunctionArgumentType.SCALAR,passSubtype:!0},{argumentType:s.FunctionArgumentType.SCALAR,defaultValue:!1,passSubtype:!0}]},IFS:{method:"ifs",parameters:[{argumentType:s.FunctionArgumentType.BOOLEAN},{argumentType:s.FunctionArgumentType.SCALAR,passSubtype:!0}],repeatLastArgs:2},AND:{method:"and",parameters:[{argumentType:s.FunctionArgumentType.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},OR:{method:"or",parameters:[{argumentType:s.FunctionArgumentType.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},XOR:{method:"xor",parameters:[{argumentType:s.FunctionArgumentType.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},NOT:{method:"not",parameters:[{argumentType:s.FunctionArgumentType.BOOLEAN}]},SWITCH:{method:"switch",parameters:[{argumentType:s.FunctionArgumentType.NOERROR},{argumentType:s.FunctionArgumentType.SCALAR,passSubtype:!0},{argumentType:s.FunctionArgumentType.SCALAR,passSubtype:!0}],repeatLastArgs:1},IFERROR:{method:"iferror",parameters:[{argumentType:s.FunctionArgumentType.SCALAR,passSubtype:!0},{argumentType:s.FunctionArgumentType.SCALAR,passSubtype:!0}]},IFNA:{method:"ifna",parameters:[{argumentType:s.FunctionArgumentType.SCALAR,passSubtype:!0},{argumentType:s.FunctionArgumentType.SCALAR,passSubtype:!0}]},CHOOSE:{method:"choose",parameters:[{argumentType:s.FunctionArgumentType.INTEGER,minValue:1},{argumentType:s.FunctionArgumentType.SCALAR,passSubtype:!0}],repeatLastArgs:1}}},function(e,t,r){"use strict";t.__esModule=!0,t.CharPlugin=void 0;var n=r(73),o=r(131),s=r(167);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
class i extends s.FunctionPlugin{char(e,t){return this.runFunction(e.args,t,this.metadata("CHAR"),e=>e<1||e>=256?new n.CellError(n.ErrorType.VALUE,o.ErrorMessage.CharacterCodeBounds):String.fromCharCode(Math.trunc(e)))}unichar(e,t){return this.runFunction(e.args,t,this.metadata("CHAR"),e=>e<1||e>=1114112?new n.CellError(n.ErrorType.VALUE,o.ErrorMessage.CharacterCodeBounds):String.fromCodePoint(Math.trunc(e)))}}t.CharPlugin=i,i.implementedFunctions={CHAR:{method:"char",parameters:[{argumentType:s.FunctionArgumentType.NUMBER}]},UNICHAR:{method:"unichar",parameters:[{argumentType:s.FunctionArgumentType.NUMBER}]}}},function(e,t,r){"use strict";t.__esModule=!0,t.CodePlugin=void 0;var n=r(73),o=r(131),s=r(167);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
class i extends s.FunctionPlugin{code(e,t){return this.runFunction(e.args,t,this.metadata("CODE"),e=>0===e.length?new n.CellError(n.ErrorType.VALUE,o.ErrorMessage.EmptyString):e.charCodeAt(0))}unicode(e,t){return this.runFunction(e.args,t,this.metadata("UNICODE"),e=>{var t;return null!==(t=e.codePointAt(0))&&void 0!==t?t:new n.CellError(n.ErrorType.VALUE,o.ErrorMessage.EmptyString)})}}t.CodePlugin=i,i.implementedFunctions={CODE:{method:"code",parameters:[{argumentType:s.FunctionArgumentType.STRING}]},UNICODE:{method:"unicode",parameters:[{argumentType:s.FunctionArgumentType.STRING}]}}},function(e,t,r){"use strict";t.__esModule=!0,t.CountBlankPlugin=void 0;var n=r(140),o=r(167);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
class s extends o.FunctionPlugin{countblank(e,t){return this.runFunction(e.args,t,this.metadata("COUNTBLANK"),(...e)=>{let t=0;return e.forEach(e=>{e===n.EmptyValue&&t++}),t})}}t.CountBlankPlugin=s,s.implementedFunctions={COUNTBLANK:{method:"countblank",parameters:[{argumentType:o.FunctionArgumentType.SCALAR}],repeatLastArgs:1,expandRanges:!0}}},function(e,t,r){"use strict";t.__esModule=!0,t.CountUniquePlugin=void 0;var n=r(73),o=r(167);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
class s extends o.FunctionPlugin{countunique(e,t){return this.runFunction(e.args,t,this.metadata("COUNTUNIQUE"),(...e)=>{const t=new Set,r=new Set;for(const o of e)o instanceof n.CellError?r.add(o.type):""!==o&&t.add(o);return t.size+r.size})}}t.CountUniquePlugin=s,s.implementedFunctions={COUNTUNIQUE:{method:"countunique",parameters:[{argumentType:o.FunctionArgumentType.SCALAR}],repeatLastArgs:1,expandRanges:!0}}},function(e,t,r){"use strict";t.__esModule=!0,t.DateTimePlugin=void 0,r(2);var n=r(73),o=r(174),s=r(131),i=r(176),a=r(140),u=r(167);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
class c extends u.FunctionPlugin{constructor(){super(...arguments),this.isoweeknumCore=e=>{const t=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(e)),r=this.dateTimeHelper.numberToSimpleDate(e),n=this.dateTimeHelper.dateToNumber({year:r.year,month:1,day:1}),o=this.dateTimeHelper.relativeNumberToAbsoluteNumber(n),s=o+((4-o)%7+7)%7,i=Math.floor((t-1)/7)-Math.floor((s-1)/7)+1;return 0===i?this.isoweeknumCore(e-7)+1:i},this.days360Core=(e,t,r)=>{const n=this.dateTimeHelper.numberToSimpleDate(e),s=this.dateTimeHelper.numberToSimpleDate(t);let i,a;return r?(i=(0,o.toBasisEU)(n),a=(0,o.toBasisEU)(s)):[i,a]=this.dateTimeHelper.toBasisUS(n,s),360*(a.year-i.year)+30*(a.month-i.month)+a.day-i.day}}date(e,t){return this.runFunction(e.args,t,this.metadata("DATE"),(e,t,r)=>{const o=Math.trunc(r);let i=Math.trunc(t),a=Math.trunc(e);a<this.dateTimeHelper.getEpochYearZero()&&(a+=this.dateTimeHelper.getEpochYearZero());const u=Math.floor((i-1)/12);a+=u,i-=12*u;const c={year:a,month:i,day:1};if(this.dateTimeHelper.isValidDate(c)){let e=this.dateTimeHelper.dateToNumber(c)+(o-1);return e=this.dateTimeHelper.getWithinBounds(e),void 0===e?new n.CellError(n.ErrorType.NUM,s.ErrorMessage.DateBounds):e}return new n.CellError(n.ErrorType.VALUE,s.ErrorMessage.InvalidDate)})}time(e,t){return this.runFunction(e.args,t,this.metadata("TIME"),(e,t,r)=>{const i=(0,o.timeToNumber)({hours:Math.trunc(e),minutes:Math.trunc(t),seconds:Math.trunc(r)});return i<0?new n.CellError(n.ErrorType.NUM,s.ErrorMessage.NegativeTime):i%1})}eomonth(e,t){return this.runFunction(e.args,t,this.metadata("EOMONTH"),(e,t)=>{const r=this.dateTimeHelper.numberToSimpleDate(e);let i=this.dateTimeHelper.dateToNumber(this.dateTimeHelper.endOfMonth((0,o.offsetMonth)(r,t)));return i=this.dateTimeHelper.getWithinBounds(i),void 0===i?new n.CellError(n.ErrorType.NUM,s.ErrorMessage.DateBounds):i})}day(e,t){return this.runFunction(e.args,t,this.metadata("DAY"),e=>this.dateTimeHelper.numberToSimpleDate(e).day)}days(e,t){return this.runFunction(e.args,t,this.metadata("DAYS"),(e,t)=>Math.trunc(e)-Math.trunc(t))}month(e,t){return this.runFunction(e.args,t,this.metadata("MONTH"),e=>this.dateTimeHelper.numberToSimpleDate(e).month)}year(e,t){return this.runFunction(e.args,t,this.metadata("YEAR"),e=>this.dateTimeHelper.numberToSimpleDate(e).year)}hour(e,t){return this.runFunction(e.args,t,this.metadata("HOUR"),e=>(0,o.numberToSimpleTime)((0,o.roundToNearestSecond)(e)%1).hours)}minute(e,t){return this.runFunction(e.args,t,this.metadata("MINUTE"),e=>(0,o.numberToSimpleTime)((0,o.roundToNearestSecond)(e)%1).minutes)}second(e,t){return this.runFunction(e.args,t,this.metadata("SECOND"),e=>(0,o.numberToSimpleTime)((0,o.roundToNearestSecond)(e)%1).seconds)}text(e,t){return this.runFunction(e.args,t,this.metadata("TEXT"),(e,t)=>(0,i.format)(e,t,this.config,this.dateTimeHelper))}weekday(e,t){return this.runFunction(e.args,t,this.metadata("WEEKDAY"),(e,t)=>{const r=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(e));if(3===t)return(r-1)%7;const o=d.get(t);return void 0===o?new n.CellError(n.ErrorType.NUM,s.ErrorMessage.BadMode):(r-o)%7+1})}weeknum(e,t){return this.runFunction(e.args,t,this.metadata("WEEKNUM"),(e,t)=>{const r=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(e)),o=this.dateTimeHelper.numberToSimpleDate(e),i=this.dateTimeHelper.dateToNumber({year:o.year,month:1,day:1}),a=this.dateTimeHelper.relativeNumberToAbsoluteNumber(i);if(21===t)return this.isoweeknumCore(e);const u=d.get(t);return void 0===u?new n.CellError(n.ErrorType.NUM,s.ErrorMessage.BadMode):Math.floor((r-u)/7)-Math.floor((a-u)/7)+1})}isoweeknum(e,t){return this.runFunction(e.args,t,this.metadata("ISOWEEKNUM"),this.isoweeknumCore)}datevalue(e,t){return this.runFunction(e.args,t,this.metadata("DATEVALUE"),e=>{const{dateTime:t}=this.dateTimeHelper.parseDateTimeFromConfigFormats(e);return void 0===t?new n.CellError(n.ErrorType.VALUE,s.ErrorMessage.IncorrectDateTime):(0,o.instanceOfSimpleDate)(t)?((0,o.instanceOfSimpleTime)(t)?Math.trunc((0,o.timeToNumber)(t)):0)+this.dateTimeHelper.dateToNumber(t):0})}timevalue(e,t){return this.runFunction(e.args,t,this.metadata("TIMEVALUE"),e=>{const t=this.dateTimeHelper.dateStringToDateNumber(e);return void 0===t?new n.CellError(n.ErrorType.VALUE,s.ErrorMessage.IncorrectDateTime):(0,a.getRawValue)(t)%1})}now(e,t){return this.runFunction(e.args,t,this.metadata("NOW"),()=>{const e=new Date(Date.now());return(0,o.timeToNumber)({hours:e.getHours(),minutes:e.getMinutes(),seconds:e.getSeconds()})+this.dateTimeHelper.dateToNumber({year:e.getFullYear(),month:e.getMonth()+1,day:e.getDate()})})}today(e,t){return this.runFunction(e.args,t,this.metadata("TODAY"),()=>{const e=new Date(Date.now());return this.dateTimeHelper.dateToNumber({year:e.getFullYear(),month:e.getMonth()+1,day:e.getDate()})})}edate(e,t){return this.runFunction(e.args,t,this.metadata("EDATE"),(e,t)=>{const r=this.dateTimeHelper.numberToSimpleDate(e),i=(0,o.truncateDayInMonth)((0,o.offsetMonth)(r,t));let a=this.dateTimeHelper.dateToNumber(i);return a=this.dateTimeHelper.getWithinBounds(a),void 0===a?new n.CellError(n.ErrorType.NUM,s.ErrorMessage.DateBounds):a})}datedif(e,t){return this.runFunction(e.args,t,this.metadata("DATEDIF"),(e,t,r)=>{if(e>t)return new n.CellError(n.ErrorType.NUM,s.ErrorMessage.StartEndDate);if("D"===r)return Math.floor(t)-Math.floor(e);const o=this.dateTimeHelper.numberToSimpleDate(e),i=this.dateTimeHelper.numberToSimpleDate(t);switch(r){case"M":return 12*(i.year-o.year)+(i.month-o.month)-(i.day<o.day?1:0);case"YM":return(i.month-o.month+12-(i.day<o.day?1:0))%12;case"Y":return i.month>o.month||i.month===o.month&&i.day>=o.day?i.year-o.year:i.year-o.year-1;case"MD":if(i.day>=o.day)return i.day-o.day;{const e=1===i.month?12:i.month-1,t=1===i.month?i.year-1:i.year;return this.dateTimeHelper.daysInMonth(t,e)+i.day-o.day}case"YD":return i.month>o.month||i.month===o.month&&i.day>=o.day?Math.floor(t)-this.dateTimeHelper.dateToNumber({year:i.year,month:o.month,day:o.day}):Math.floor(t)-Math.floor(e)-365*(i.year-o.year-1)-this.dateTimeHelper.leapYearsCount(i.year-1)+this.dateTimeHelper.leapYearsCount(o.year);default:return new n.CellError(n.ErrorType.NUM,s.ErrorMessage.BadMode)}})}days360(e,t){return this.runFunction(e.args,t,this.metadata("DAYS360"),this.days360Core)}yearfrac(e,t){return this.runFunction(e.args,t,this.metadata("YEARFRAC"),(e,t,r)=>{switch((e=Math.trunc(e))>(t=Math.trunc(t))&&([e,t]=[t,e]),r){case 0:return this.days360Core(e,t,!1)/360;case 1:return(t-e)/this.dateTimeHelper.yearLengthForBasis(this.dateTimeHelper.numberToSimpleDate(e),this.dateTimeHelper.numberToSimpleDate(t));case 2:return(t-e)/360;case 3:return(t-e)/365;case 4:return this.days360Core(e,t,!0)/360}throw new Error("Should not be reachable.")})}interval(e,t){return this.runFunction(e.args,t,this.metadata("INTERVAL"),e=>{const t=(e=Math.trunc(e))%60,r=(e=Math.trunc(e/60))%60,n=(e=Math.trunc(e/60))%24,o=(e=Math.trunc(e/24))%30,s=(e=Math.trunc(e/30))%12,i=Math.trunc(e/12);return"P"+(i>0?i+"Y":"")+(s>0?s+"M":"")+(o>0?o+"D":"")+"T"+(n>0?n+"H":"")+(r>0?r+"M":"")+(t>0?t+"S":"")})}networkdays(e,t){return this.runFunction(e.args,t,this.metadata("NETWORKDAYS"),(e,t,r)=>this.networkdayscore(e,t,1,r))}networkdaysintl(e,t){return this.runFunction(e.args,t,this.metadata("NETWORKDAYS.INTL"),(e,t,r,n)=>this.networkdayscore(e,t,r,n))}workday(e,t){return this.runFunction(e.args,t,this.metadata("WORKDAY"),(e,t,r)=>this.workdaycore(e,t,1,r))}workdayintl(e,t){return this.runFunction(e.args,t,this.metadata("WORKDAY.INTL"),(e,t,r,n)=>this.workdaycore(e,t,r,n))}networkdayscore(e,t,r,o){let s=1;(e=Math.trunc(e))>(t=Math.trunc(t))&&([e,t]=[t,e],s=-1);const i=h(r);if(i instanceof n.CellError)return i;const a=this.simpleRangeToFilteredHolidays(i,o);return a instanceof n.CellError?a:s*this.countWorkdays(e,t,i,a)}workdaycore(e,t,r,o){e=Math.trunc(e),t=Math.trunc(t);const s=h(r);if(s instanceof n.CellError)return s;const i=this.simpleRangeToFilteredHolidays(s,o);if(i instanceof n.CellError)return i;if(t>0){let r=1;for(;this.countWorkdays(e+1,e+r,s,i)<t;)r*=2;let n=1;for(;n+1<r;){const o=Math.trunc((n+r)/2);this.countWorkdays(e+1,e+o,s,i)<t?n=o:r=o}return e+r}if(t<0){t*=-1;let r=1;for(;this.countWorkdays(e-r,e-1,s,i)<t;)r*=2;let n=1;for(;n+1<r;){const o=Math.trunc((n+r)/2);this.countWorkdays(e-o,e-1,s,i)<t?n=o:r=o}return e-r}return e}countWorkdays(e,t,r,n){const o=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(t)),s=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(e));let i=0;for(let e=0;e<7;e++)"0"===r.charAt(e)&&(i+=Math.floor((o+6-e)/7),i-=Math.floor((s-1+6-e)/7));return i-=l(t+1,n)-l(e,n),i}simpleRangeToFilteredHolidays(e,t){var r;const o=null!==(r=null==t?void 0:t.valuesFromTopLeftCorner())&&void 0!==r?r:[];for(const e of o)if(e instanceof n.CellError)return e;const i=[];for(const e of o)if(e!==a.EmptyValue){if(!(0,a.isExtendedNumber)(e))return new n.CellError(n.ErrorType.VALUE,s.ErrorMessage.WrongType);i.push(Math.trunc((0,a.getRawValue)(e)))}return[...new Set(i)].sort((e,t)=>e-t).filter(t=>{const r=(this.dateTimeHelper.relativeNumberToAbsoluteNumber(t)-1)%7;return"0"===e.charAt(r)})}}function l(e,t){if(0===t.length)return 0;if(e<=t[0])return 0;if(t[t.length-1]<e)return t.length;let r=0,n=t.length-1;for(;r+1<n;){const o=Math.floor((n+r)/2);t[o]>=e?n=o:r=o}return n}function h(e){var t;return"number"!=typeof e&&"string"!=typeof e?new n.CellError(n.ErrorType.VALUE,s.ErrorMessage.WrongType):"string"==typeof e?7===e.length&&/^(0|1)*$/.test(e)&&"1111111"!==e?e:new n.CellError(n.ErrorType.NUM,s.ErrorMessage.WeekendString):null!==(t=p.get(e))&&void 0!==t?t:new n.CellError(n.ErrorType.NUM,s.ErrorMessage.BadMode)}t.DateTimePlugin=c,c.implementedFunctions={DATE:{method:"date",parameters:[{argumentType:u.FunctionArgumentType.NUMBER},{argumentType:u.FunctionArgumentType.NUMBER},{argumentType:u.FunctionArgumentType.NUMBER}],returnNumberType:a.NumberType.NUMBER_DATE},TIME:{method:"time",parameters:[{argumentType:u.FunctionArgumentType.NUMBER},{argumentType:u.FunctionArgumentType.NUMBER},{argumentType:u.FunctionArgumentType.NUMBER}],returnNumberType:a.NumberType.NUMBER_TIME},MONTH:{method:"month",parameters:[{argumentType:u.FunctionArgumentType.NUMBER,minValue:0}]},YEAR:{method:"year",parameters:[{argumentType:u.FunctionArgumentType.NUMBER,minValue:0}]},HOUR:{method:"hour",parameters:[{argumentType:u.FunctionArgumentType.NUMBER,minValue:0}]},MINUTE:{method:"minute",parameters:[{argumentType:u.FunctionArgumentType.NUMBER,minValue:0}]},SECOND:{method:"second",parameters:[{argumentType:u.FunctionArgumentType.NUMBER,minValue:0}]},TEXT:{method:"text",parameters:[{argumentType:u.FunctionArgumentType.NUMBER},{argumentType:u.FunctionArgumentType.STRING}]},EOMONTH:{method:"eomonth",parameters:[{argumentType:u.FunctionArgumentType.NUMBER,minValue:0},{argumentType:u.FunctionArgumentType.NUMBER}],returnNumberType:a.NumberType.NUMBER_DATE},DAY:{method:"day",parameters:[{argumentType:u.FunctionArgumentType.NUMBER,minValue:0}]},DAYS:{method:"days",parameters:[{argumentType:u.FunctionArgumentType.NUMBER,minValue:0},{argumentType:u.FunctionArgumentType.NUMBER,minValue:0}]},WEEKDAY:{method:"weekday",parameters:[{argumentType:u.FunctionArgumentType.NUMBER,minValue:0},{argumentType:u.FunctionArgumentType.NUMBER,defaultValue:1}]},WEEKNUM:{method:"weeknum",parameters:[{argumentType:u.FunctionArgumentType.NUMBER,minValue:0},{argumentType:u.FunctionArgumentType.NUMBER,defaultValue:1}]},ISOWEEKNUM:{method:"isoweeknum",parameters:[{argumentType:u.FunctionArgumentType.NUMBER,minValue:0}]},DATEVALUE:{method:"datevalue",parameters:[{argumentType:u.FunctionArgumentType.STRING}],returnNumberType:a.NumberType.NUMBER_DATE},TIMEVALUE:{method:"timevalue",parameters:[{argumentType:u.FunctionArgumentType.STRING}],returnNumberType:a.NumberType.NUMBER_TIME},NOW:{method:"now",parameters:[],isVolatile:!0,returnNumberType:a.NumberType.NUMBER_DATETIME},TODAY:{method:"today",parameters:[],isVolatile:!0,returnNumberType:a.NumberType.NUMBER_DATE},EDATE:{method:"edate",parameters:[{argumentType:u.FunctionArgumentType.NUMBER,minValue:0},{argumentType:u.FunctionArgumentType.NUMBER}],returnNumberType:a.NumberType.NUMBER_DATE},DAYS360:{method:"days360",parameters:[{argumentType:u.FunctionArgumentType.NUMBER,minValue:0},{argumentType:u.FunctionArgumentType.NUMBER,minValue:0},{argumentType:u.FunctionArgumentType.BOOLEAN,defaultValue:!1}]},DATEDIF:{method:"datedif",parameters:[{argumentType:u.FunctionArgumentType.NUMBER,minValue:0},{argumentType:u.FunctionArgumentType.NUMBER,minValue:0},{argumentType:u.FunctionArgumentType.STRING}]},YEARFRAC:{method:"yearfrac",parameters:[{argumentType:u.FunctionArgumentType.NUMBER,minValue:0},{argumentType:u.FunctionArgumentType.NUMBER,minValue:0},{argumentType:u.FunctionArgumentType.INTEGER,defaultValue:0,minValue:0,maxValue:4}]},INTERVAL:{method:"interval",parameters:[{argumentType:u.FunctionArgumentType.NUMBER,minValue:0}]},NETWORKDAYS:{method:"networkdays",parameters:[{argumentType:u.FunctionArgumentType.NUMBER,minValue:0},{argumentType:u.FunctionArgumentType.NUMBER,minValue:0},{argumentType:u.FunctionArgumentType.RANGE,optionalArg:!0}]},"NETWORKDAYS.INTL":{method:"networkdaysintl",parameters:[{argumentType:u.FunctionArgumentType.NUMBER,minValue:0},{argumentType:u.FunctionArgumentType.NUMBER,minValue:0},{argumentType:u.FunctionArgumentType.NOERROR,defaultValue:1},{argumentType:u.FunctionArgumentType.RANGE,optionalArg:!0}]},WORKDAY:{method:"workday",parameters:[{argumentType:u.FunctionArgumentType.NUMBER,minValue:0},{argumentType:u.FunctionArgumentType.NUMBER},{argumentType:u.FunctionArgumentType.RANGE,optionalArg:!0}]},"WORKDAY.INTL":{method:"workdayintl",parameters:[{argumentType:u.FunctionArgumentType.NUMBER,minValue:0},{argumentType:u.FunctionArgumentType.NUMBER},{argumentType:u.FunctionArgumentType.NOERROR,defaultValue:1},{argumentType:u.FunctionArgumentType.RANGE,optionalArg:!0}]}};const d=new Map([[1,0],[2,1],[11,1],[12,2],[13,3],[14,4],[15,5],[16,6],[17,0]]),p=new Map([[1,"0000011"],[2,"1000001"],[3,"1100000"],[4,"0110000"],[5,"0011000"],[6,"0001100"],[7,"0000110"],[11,"0000001"],[12,"1000000"],[13,"0100000"],[14,"0010000"],[15,"0001000"],[16,"0000100"],[17,"0000010"]])},function(e,t,r){"use strict";t.__esModule=!0,t.DegreesPlugin=void 0;var n=r(167);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class o extends n.FunctionPlugin{degrees(e,t){return this.runFunction(e.args,t,this.metadata("DEGREES"),e=>e*(180/Math.PI))}}t.DegreesPlugin=o,o.implementedFunctions={DEGREES:{method:"degrees",parameters:[{argumentType:n.FunctionArgumentType.NUMBER}]}}},function(e,t,r){"use strict";t.__esModule=!0,t.DeltaPlugin=void 0;var n=r(167);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class o extends n.FunctionPlugin{delta(e,t){return this.runFunction(e.args,t,this.metadata("DELTA"),(e,t)=>e===t?1:0)}}t.DeltaPlugin=o,o.implementedFunctions={DELTA:{method:"delta",parameters:[{argumentType:n.FunctionArgumentType.NUMBER},{argumentType:n.FunctionArgumentType.NUMBER,defaultValue:0}]}}},function(e,t,r){"use strict";t.__esModule=!0,t.ExpPlugin=void 0;var n=r(167);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class o extends n.FunctionPlugin{exp(e,t){return this.runFunction(e.args,t,this.metadata("EXP"),Math.exp)}}t.ExpPlugin=o,o.implementedFunctions={EXP:{method:"exp",parameters:[{argumentType:n.FunctionArgumentType.NUMBER}]}}},function(e,t,r){"use strict";t.__esModule=!0,t.FinancialPlugin=void 0,r(2);var n=r(73),o=r(131),s=r(140),i=r(167);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
class a extends i.FunctionPlugin{pmt(e,t){return this.runFunction(e.args,t,this.metadata("PMT"),u)}ipmt(e,t){return this.runFunction(e.args,t,this.metadata("IPMT"),c)}ppmt(e,t){return this.runFunction(e.args,t,this.metadata("PPMT"),h)}fv(e,t){return this.runFunction(e.args,t,this.metadata("FV"),l)}cumipmt(e,t){return this.runFunction(e.args,t,this.metadata("CUMIPMT"),(e,t,r,s,i,a)=>{if(s>i)return new n.CellError(n.ErrorType.NUM,o.ErrorMessage.EndStartPeriod);let u=0;for(let n=s;n<=i;n++)u+=c(e,n,t,r,0,a);return u})}cumprinc(e,t){return this.runFunction(e.args,t,this.metadata("CUMPRINC"),(e,t,r,s,i,a)=>{if(s>i)return new n.CellError(n.ErrorType.NUM,o.ErrorMessage.EndStartPeriod);let u=0;for(let n=s;n<=i;n++)u+=h(e,n,t,r,0,a);return u})}db(e,t){return this.runFunction(e.args,t,this.metadata("DB"),(e,t,r,s,i)=>{if(12===i&&s>r||s>r+1)return new n.CellError(n.ErrorType.NUM,o.ErrorMessage.PeriodLong);if(t>=e)return 0;const a=Math.round(1e3*(1-Math.pow(t/e,1/r)))/1e3,u=e*a*i/12;if(1===s)return u;let c=u;for(let t=0;t<s-2;t++)c+=(e-c)*a;return s===r+1?(e-c)*a*(12-i)/12:(e-c)*a})}ddb(e,t){return this.runFunction(e.args,t,this.metadata("DDB"),(e,t,r,o,s)=>{if(o>r)return new n.CellError(n.ErrorType.NUM);let i,a=s/r;a>=1?(a=1,i=1===o?e:0):i=e*Math.pow(1-a,o-1);const u=e*Math.pow(1-a,o);return Math.max(i-Math.max(t,u),0)})}dollarde(e,t){return this.runFunction(e.args,t,this.metadata("DOLLARDE"),(e,t)=>{if(t<1)return new n.CellError(n.ErrorType.DIV_BY_ZERO);for(t=Math.trunc(t);t>10;)t/=10;return Math.trunc(e)+10*(e-Math.trunc(e))/t})}dollarfr(e,t){return this.runFunction(e.args,t,this.metadata("DOLLARFR"),(e,t)=>{if(t<1)return new n.CellError(n.ErrorType.DIV_BY_ZERO);for(t=Math.trunc(t);t>10;)t/=10;return Math.trunc(e)+(e-Math.trunc(e))*t/10})}effect(e,t){return this.runFunction(e.args,t,this.metadata("EFFECT"),(e,t)=>(t=Math.trunc(t),Math.pow(1+e/t,t)-1))}ispmt(e,t){return this.runFunction(e.args,t,this.metadata("ISPMT"),(e,t,r,o)=>0===r?new n.CellError(n.ErrorType.DIV_BY_ZERO):o*e*(t/r-1))}nominal(e,t){return this.runFunction(e.args,t,this.metadata("NOMINAL"),(e,t)=>(t=Math.trunc(t),(Math.pow(e+1,1/t)-1)*t))}nper(e,t){return this.runFunction(e.args,t,this.metadata("NPER"),(e,t,r,o,s)=>0===e?0===t?new n.CellError(n.ErrorType.DIV_BY_ZERO):(-r-o)/t:(s&&(t*=1+e),Math.log((t-o*e)/(r*e+t))/Math.log(1+e)))}rate(e,t){return this.runFunction(e.args,t,this.metadata("RATE"),(e,t,r,o,s,i)=>{if(i<=-1)return new n.CellError(n.ErrorType.VALUE);let a=i;s=s?1:0;for(let i=0;i<50;i++){if(a<=-1)return new n.CellError(n.ErrorType.NUM);let i,u;if(Math.abs(a)<1e-7)i=r*(1+e*a)+t*(1+a*s)*e+o;else{const n=Math.pow(1+a,e);i=r*n+t*(1/a+s)*(n-1)+o}if(Math.abs(i)<1e-7)return a;if(Math.abs(a)<1e-7)u=r*e+t*s*e;else{const n=Math.pow(1+a,e),o=e*Math.pow(1+a,e-1);u=r*o+t*(1/a+s)*o+t*(-1/(a*a))*(n-1)}a-=i/u}return new n.CellError(n.ErrorType.NUM)})}pv(e,t){return this.runFunction(e.args,t,this.metadata("PV"),(e,t,r,o,s)=>(s=s?1:0,-1===e?0===t?new n.CellError(n.ErrorType.NUM):new n.CellError(n.ErrorType.DIV_BY_ZERO):0===e?-r*t-o:((1-Math.pow(1+e,t))*r*(1+e*s)/e-o)/Math.pow(1+e,t)))}rri(e,t){return this.runFunction(e.args,t,this.metadata("RRI"),(e,t,r)=>0===t||r<0&&t>0||r>0&&t<0?new n.CellError(n.ErrorType.NUM):Math.pow(r/t,1/e)-1)}sln(e,t){return this.runFunction(e.args,t,this.metadata("SLN"),(e,t,r)=>0===r?new n.CellError(n.ErrorType.DIV_BY_ZERO):(e-t)/r)}syd(e,t){return this.runFunction(e.args,t,this.metadata("SYD"),(e,t,r,o)=>o>r?new n.CellError(n.ErrorType.NUM):(e-t)*(r-o+1)*2/(r*(r+1)))}tbilleq(e,t){return this.runFunction(e.args,t,this.metadata("TBILLEQ"),(e,t,r)=>{if((e=Math.round(e))>=(t=Math.round(t)))return new n.CellError(n.ErrorType.NUM);const o=this.dateTimeHelper.numberToSimpleDate(e),s=this.dateTimeHelper.numberToSimpleDate(t);if(s.year>o.year+1||s.year===o.year+1&&(s.month>o.month||s.month===o.month&&s.day>o.day))return new n.CellError(n.ErrorType.NUM);const i=360-r*(t-e);return 0===i?0:i<0?new n.CellError(n.ErrorType.NUM):365*r/i})}tbillprice(e,t){return this.runFunction(e.args,t,this.metadata("TBILLPRICE"),(e,t,r)=>{if((e=Math.round(e))>=(t=Math.round(t)))return new n.CellError(n.ErrorType.NUM);const o=this.dateTimeHelper.numberToSimpleDate(e),s=this.dateTimeHelper.numberToSimpleDate(t);if(s.year>o.year+1||s.year===o.year+1&&(s.month>o.month||s.month===o.month&&s.day>o.day))return new n.CellError(n.ErrorType.NUM);const i=360-r*(t-e);return 0===i?0:i<0?new n.CellError(n.ErrorType.NUM):100*(1-r*(t-e)/360)})}tbillyield(e,t){return this.runFunction(e.args,t,this.metadata("TBILLYIELD"),(e,t,r)=>{if((e=Math.round(e))>=(t=Math.round(t)))return new n.CellError(n.ErrorType.NUM);const o=this.dateTimeHelper.numberToSimpleDate(e),s=this.dateTimeHelper.numberToSimpleDate(t);return s.year>o.year+1||s.year===o.year+1&&(s.month>o.month||s.month===o.month&&s.day>o.day)?new n.CellError(n.ErrorType.NUM):360*(100-r)/(r*(t-e))})}fvschedule(e,t){return this.runFunction(e.args,t,this.metadata("FVSCHEDULE"),(e,t)=>{const r=t.valuesFromTopLeftCorner();for(const e of r)if(e instanceof n.CellError)return e;for(const t of r)if((0,s.isExtendedNumber)(t))e*=1+(0,s.getRawValue)(t);else if(t!==s.EmptyValue)return new n.CellError(n.ErrorType.VALUE,o.ErrorMessage.NumberExpected);return e})}npv(e,t){return this.runFunction(e.args,t,this.metadata("NPV"),(e,...t)=>{const r=this.arithmeticHelper.coerceNumbersExactRanges(t);return r instanceof n.CellError?r:d(e,r)})}mirr(e,t){return this.runFunction(e.args,t,this.metadata("MIRR"),(e,t,r)=>{const o=this.arithmeticHelper.manyToExactNumbers(e.valuesFromTopLeftCorner());if(o instanceof n.CellError)return o;let s=!1,i=!1;const a=[],u=[];for(const e of o)e>0?(s=!0,a.push(e),u.push(0)):e<0?(i=!0,u.push(e),a.push(0)):(u.push(0),a.push(0));if(!s||!i)return new n.CellError(n.ErrorType.DIV_BY_ZERO);const c=o.length,l=d(r,a);if(l instanceof n.CellError)return l;const h=d(t,u);return h instanceof n.CellError?h:Math.pow(-l*Math.pow(1+r,c)/h/(1+t),1/(c-1))-1})}pduration(e,t){return this.runFunction(e.args,t,this.metadata("PDURATION"),(e,t,r)=>(Math.log(r)-Math.log(t))/Math.log(1+e))}xnpv(e,t){return this.runFunction(e.args,t,this.metadata("XNPV"),(e,t,r)=>{const s=t.valuesFromTopLeftCorner();for(const e of s)if("number"!=typeof e)return new n.CellError(n.ErrorType.VALUE,o.ErrorMessage.NumberExpected);const i=s,a=r.valuesFromTopLeftCorner();for(const e of a)if("number"!=typeof e)return new n.CellError(n.ErrorType.VALUE,o.ErrorMessage.NumberExpected);const u=a;if(u.length!==i.length)return new n.CellError(n.ErrorType.NUM,o.ErrorMessage.EqualLength);const c=u.length;let l=0;if(u[0]<0)return new n.CellError(n.ErrorType.NUM,o.ErrorMessage.ValueSmall);for(let t=0;t<c;t++){if(u[t]=Math.floor(u[t]),u[t]<u[0])return new n.CellError(n.ErrorType.NUM,o.ErrorMessage.ValueSmall);l+=i[t]/Math.pow(1+e,(u[t]-u[0])/365)}return l})}}function u(e,t,r,n,o){if(0===e)return(-r-n)/t;{const s=Math.pow(1+e,t);return(n*e+r*e*s)*(o?1/(1+e):1)/(1-s)}}function c(e,t,r,n,o,s){const i=u(e,r,n,o,s);return 1===t?e*(s?0:-n):e*(s?l(e,t-2,i,n,s)-i:l(e,t-1,i,n,s))}function l(e,t,r,n,o){if(0===e)return-n-r*t;{const s=Math.pow(1+e,t);return r*(o?1+e:1)*(1-s)/e-n*s}}function h(e,t,r,n,o,s){return u(e,r,n,o,s)-c(e,t,r,n,o,s)}function d(e,t){let r=0;for(let o=t.length-1;o>=0;o--){if(r+=t[o],-1===e){if(0===r)continue;return new n.CellError(n.ErrorType.DIV_BY_ZERO)}r/=1+e}return r}t.FinancialPlugin=a,a.implementedFunctions={PMT:{method:"pmt",parameters:[{argumentType:i.FunctionArgumentType.NUMBER},{argumentType:i.FunctionArgumentType.NUMBER},{argumentType:i.FunctionArgumentType.NUMBER},{argumentType:i.FunctionArgumentType.NUMBER,defaultValue:0},{argumentType:i.FunctionArgumentType.NUMBER,defaultValue:0}],returnNumberType:s.NumberType.NUMBER_CURRENCY},IPMT:{method:"ipmt",parameters:[{argumentType:i.FunctionArgumentType.NUMBER},{argumentType:i.FunctionArgumentType.NUMBER},{argumentType:i.FunctionArgumentType.NUMBER},{argumentType:i.FunctionArgumentType.NUMBER},{argumentType:i.FunctionArgumentType.NUMBER,defaultValue:0},{argumentType:i.FunctionArgumentType.NUMBER,defaultValue:0}],returnNumberType:s.NumberType.NUMBER_CURRENCY},PPMT:{method:"ppmt",parameters:[{argumentType:i.FunctionArgumentType.NUMBER},{argumentType:i.FunctionArgumentType.NUMBER},{argumentType:i.FunctionArgumentType.NUMBER},{argumentType:i.FunctionArgumentType.NUMBER},{argumentType:i.FunctionArgumentType.NUMBER,defaultValue:0},{argumentType:i.FunctionArgumentType.NUMBER,defaultValue:0}],returnNumberType:s.NumberType.NUMBER_CURRENCY},FV:{method:"fv",parameters:[{argumentType:i.FunctionArgumentType.NUMBER},{argumentType:i.FunctionArgumentType.NUMBER},{argumentType:i.FunctionArgumentType.NUMBER},{argumentType:i.FunctionArgumentType.NUMBER,defaultValue:0},{argumentType:i.FunctionArgumentType.NUMBER,defaultValue:0}],returnNumberType:s.NumberType.NUMBER_CURRENCY},CUMIPMT:{method:"cumipmt",parameters:[{argumentType:i.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:i.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:i.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:i.FunctionArgumentType.INTEGER,minValue:1},{argumentType:i.FunctionArgumentType.INTEGER,minValue:1},{argumentType:i.FunctionArgumentType.INTEGER,minValue:0,maxValue:1}],returnNumberType:s.NumberType.NUMBER_CURRENCY},CUMPRINC:{method:"cumprinc",parameters:[{argumentType:i.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:i.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:i.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:i.FunctionArgumentType.INTEGER,minValue:1},{argumentType:i.FunctionArgumentType.INTEGER,minValue:1},{argumentType:i.FunctionArgumentType.INTEGER,minValue:0,maxValue:1}],returnNumberType:s.NumberType.NUMBER_CURRENCY},DB:{method:"db",parameters:[{argumentType:i.FunctionArgumentType.NUMBER,minValue:0},{argumentType:i.FunctionArgumentType.NUMBER,minValue:0},{argumentType:i.FunctionArgumentType.INTEGER,minValue:0},{argumentType:i.FunctionArgumentType.INTEGER,minValue:0},{argumentType:i.FunctionArgumentType.INTEGER,minValue:1,maxValue:12,defaultValue:12}],returnNumberType:s.NumberType.NUMBER_CURRENCY},DDB:{method:"ddb",parameters:[{argumentType:i.FunctionArgumentType.NUMBER,minValue:0},{argumentType:i.FunctionArgumentType.NUMBER,minValue:0},{argumentType:i.FunctionArgumentType.INTEGER,minValue:0},{argumentType:i.FunctionArgumentType.NUMBER,minValue:0},{argumentType:i.FunctionArgumentType.NUMBER,greaterThan:0,defaultValue:2}],returnNumberType:s.NumberType.NUMBER_CURRENCY},DOLLARDE:{method:"dollarde",parameters:[{argumentType:i.FunctionArgumentType.NUMBER},{argumentType:i.FunctionArgumentType.NUMBER,minValue:0}]},DOLLARFR:{method:"dollarfr",parameters:[{argumentType:i.FunctionArgumentType.NUMBER},{argumentType:i.FunctionArgumentType.NUMBER,minValue:0}]},EFFECT:{method:"effect",parameters:[{argumentType:i.FunctionArgumentType.NUMBER,minValue:0},{argumentType:i.FunctionArgumentType.NUMBER,minValue:1}],returnNumberType:s.NumberType.NUMBER_PERCENT},ISPMT:{method:"ispmt",parameters:[{argumentType:i.FunctionArgumentType.NUMBER},{argumentType:i.FunctionArgumentType.NUMBER},{argumentType:i.FunctionArgumentType.NUMBER},{argumentType:i.FunctionArgumentType.NUMBER}]},NOMINAL:{method:"nominal",parameters:[{argumentType:i.FunctionArgumentType.NUMBER,minValue:0},{argumentType:i.FunctionArgumentType.NUMBER,minValue:1}],returnNumberType:s.NumberType.NUMBER_PERCENT},NPER:{method:"nper",parameters:[{argumentType:i.FunctionArgumentType.NUMBER},{argumentType:i.FunctionArgumentType.NUMBER},{argumentType:i.FunctionArgumentType.NUMBER},{argumentType:i.FunctionArgumentType.NUMBER,defaultValue:0},{argumentType:i.FunctionArgumentType.NUMBER,defaultValue:0}]},PV:{method:"pv",parameters:[{argumentType:i.FunctionArgumentType.NUMBER},{argumentType:i.FunctionArgumentType.NUMBER},{argumentType:i.FunctionArgumentType.NUMBER},{argumentType:i.FunctionArgumentType.NUMBER,defaultValue:0},{argumentType:i.FunctionArgumentType.NUMBER,defaultValue:0}],returnNumberType:s.NumberType.NUMBER_CURRENCY},RATE:{method:"rate",parameters:[{argumentType:i.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:i.FunctionArgumentType.NUMBER},{argumentType:i.FunctionArgumentType.NUMBER},{argumentType:i.FunctionArgumentType.NUMBER,defaultValue:0},{argumentType:i.FunctionArgumentType.NUMBER,defaultValue:0},{argumentType:i.FunctionArgumentType.NUMBER,defaultValue:.1}],returnNumberType:s.NumberType.NUMBER_PERCENT},RRI:{method:"rri",parameters:[{argumentType:i.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:i.FunctionArgumentType.NUMBER},{argumentType:i.FunctionArgumentType.NUMBER}],returnNumberType:s.NumberType.NUMBER_PERCENT},SLN:{method:"sln",parameters:[{argumentType:i.FunctionArgumentType.NUMBER},{argumentType:i.FunctionArgumentType.NUMBER},{argumentType:i.FunctionArgumentType.NUMBER}],returnNumberType:s.NumberType.NUMBER_CURRENCY},SYD:{method:"syd",parameters:[{argumentType:i.FunctionArgumentType.NUMBER},{argumentType:i.FunctionArgumentType.NUMBER},{argumentType:i.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:i.FunctionArgumentType.NUMBER,greaterThan:0}],returnNumberType:s.NumberType.NUMBER_CURRENCY},TBILLEQ:{method:"tbilleq",parameters:[{argumentType:i.FunctionArgumentType.NUMBER,minValue:0},{argumentType:i.FunctionArgumentType.NUMBER,minValue:0},{argumentType:i.FunctionArgumentType.NUMBER,greaterThan:0}],returnNumberType:s.NumberType.NUMBER_PERCENT},TBILLPRICE:{method:"tbillprice",parameters:[{argumentType:i.FunctionArgumentType.NUMBER,minValue:0},{argumentType:i.FunctionArgumentType.NUMBER,minValue:0},{argumentType:i.FunctionArgumentType.NUMBER,greaterThan:0}],returnNumberType:s.NumberType.NUMBER_CURRENCY},TBILLYIELD:{method:"tbillyield",parameters:[{argumentType:i.FunctionArgumentType.NUMBER,minValue:0},{argumentType:i.FunctionArgumentType.NUMBER,minValue:0},{argumentType:i.FunctionArgumentType.NUMBER,greaterThan:0}],returnNumberType:s.NumberType.NUMBER_PERCENT},FVSCHEDULE:{method:"fvschedule",parameters:[{argumentType:i.FunctionArgumentType.NUMBER},{argumentType:i.FunctionArgumentType.RANGE}],returnNumberType:s.NumberType.NUMBER_CURRENCY},NPV:{method:"npv",parameters:[{argumentType:i.FunctionArgumentType.NUMBER},{argumentType:i.FunctionArgumentType.ANY}],repeatLastArgs:1,returnNumberType:s.NumberType.NUMBER_CURRENCY},MIRR:{method:"mirr",parameters:[{argumentType:i.FunctionArgumentType.RANGE},{argumentType:i.FunctionArgumentType.NUMBER},{argumentType:i.FunctionArgumentType.NUMBER}],returnNumberType:s.NumberType.NUMBER_PERCENT},PDURATION:{method:"pduration",parameters:[{argumentType:i.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:i.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:i.FunctionArgumentType.NUMBER,greaterThan:0}]},XNPV:{method:"xnpv",parameters:[{argumentType:i.FunctionArgumentType.NUMBER,greaterThan:-1},{argumentType:i.FunctionArgumentType.RANGE},{argumentType:i.FunctionArgumentType.RANGE}]}}},function(e,t,r){"use strict";t.__esModule=!0,t.FormulaTextPlugin=void 0;var n=r(73),o=r(131),s=r(166),i=r(167);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
class a extends s.FunctionPlugin{formulatext(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("FORMULATEXT"),()=>new n.CellError(n.ErrorType.NA,o.ErrorMessage.WrongArgNumber),e=>{var t;return null!==(t=this.serialization.getCellFormula(e))&&void 0!==t?t:new n.CellError(n.ErrorType.NA,o.ErrorMessage.Formula)})}}t.FormulaTextPlugin=a,a.implementedFunctions={FORMULATEXT:{method:"formulatext",parameters:[{argumentType:i.FunctionArgumentType.NOERROR}],doesNotNeedArgumentsToBeComputed:!0,isDependentOnSheetStructureChange:!0,vectorizationForbidden:!0}}},function(e,t,r){"use strict";t.__esModule=!0,t.HyperlinkPlugin=void 0;var n=r(167);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class o extends n.FunctionPlugin{hyperlink(e,t){return this.runFunction(e.args,t,this.metadata("HYPERLINK"),(t,r)=>(e.hyperlink=t,null!=r?r:t))}}t.HyperlinkPlugin=o,o.implementedFunctions={HYPERLINK:{method:"hyperlink",parameters:[{argumentType:n.FunctionArgumentType.STRING},{argumentType:n.FunctionArgumentType.STRING,optionalArg:!0}]}}},function(e,t,r){"use strict";t.__esModule=!0,t.InformationPlugin=void 0;var n=r(73),o=r(150),s=r(131),i=r(77),a=r(140),u=r(139),c=r(167);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
class l extends c.FunctionPlugin{isbinary(e,t){return this.runFunction(e.args,t,this.metadata("ISBINARY"),e=>/^[01]{1,10}$/.test(e))}iserr(e,t){return this.runFunction(e.args,t,this.metadata("ISERR"),e=>e instanceof n.CellError&&e.type!==n.ErrorType.NA)}iserror(e,t){return this.runFunction(e.args,t,this.metadata("ISERROR"),e=>e instanceof n.CellError)}isformula(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("ISFORMULA"),()=>new n.CellError(n.ErrorType.NA,s.ErrorMessage.WrongArgNumber),e=>this.dependencyGraph.addressMapping.getCell(e)instanceof o.FormulaVertex)}isblank(e,t){return this.runFunction(e.args,t,this.metadata("ISBLANK"),e=>e===a.EmptyValue)}isna(e,t){return this.runFunction(e.args,t,this.metadata("ISNA"),e=>e instanceof n.CellError&&e.type==n.ErrorType.NA)}isnumber(e,t){return this.runFunction(e.args,t,this.metadata("ISNUMBER"),a.isExtendedNumber)}islogical(e,t){return this.runFunction(e.args,t,this.metadata("ISLOGICAL"),e=>"boolean"==typeof e)}isref(e,t){return this.runFunction(e.args,t,this.metadata("ISREF"),e=>e instanceof n.CellError&&(e.type==n.ErrorType.REF||e.type==n.ErrorType.CYCLE))}istext(e,t){return this.runFunction(e.args,t,this.metadata("ISTEXT"),e=>"string"==typeof e)}isnontext(e,t){return this.runFunction(e.args,t,this.metadata("ISNONTEXT"),e=>!("string"==typeof e))}column(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("COLUMN"),()=>t.formulaAddress.col+1,e=>e.col+1)}columns(e,t){if(1!==e.args.length)return new n.CellError(n.ErrorType.NA,s.ErrorMessage.WrongArgNumber);if(e.args.some(e=>e.type===i.AstNodeType.EMPTY))return new n.CellError(n.ErrorType.NUM,s.ErrorMessage.EmptyArg);let r=e.args[0];for(;r.type===i.AstNodeType.PARENTHESIS;)r=r.expression;if(r.type===i.AstNodeType.CELL_RANGE||r.type===i.AstNodeType.COLUMN_RANGE)return r.end.col-r.start.col+1;if(r.type===i.AstNodeType.CELL_REFERENCE)return 1;if(r.type===i.AstNodeType.ROW_RANGE)return this.config.maxColumns;{const e=this.evaluateAst(r,t);return e instanceof u.SimpleRangeValue?e.width():e instanceof n.CellError?e:1}}row(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("ROW"),()=>t.formulaAddress.row+1,e=>e.row+1)}rows(e,t){if(1!==e.args.length)return new n.CellError(n.ErrorType.NA,s.ErrorMessage.WrongArgNumber);if(e.args.some(e=>e.type===i.AstNodeType.EMPTY))return new n.CellError(n.ErrorType.NUM,s.ErrorMessage.EmptyArg);let r=e.args[0];for(;r.type===i.AstNodeType.PARENTHESIS;)r=r.expression;if(r.type===i.AstNodeType.CELL_RANGE||r.type===i.AstNodeType.ROW_RANGE)return r.end.row-r.start.row+1;if(r.type===i.AstNodeType.CELL_REFERENCE)return 1;if(r.type===i.AstNodeType.COLUMN_RANGE)return this.config.maxRows;{const e=this.evaluateAst(r,t);return e instanceof u.SimpleRangeValue?e.height():e instanceof n.CellError?e:1}}index(e,t){return this.runFunction(e.args,t,this.metadata("INDEX"),(e,t,r)=>{var o,i,a,u,c,l;return r<1||t<1?new n.CellError(n.ErrorType.VALUE,s.ErrorMessage.LessThanOne):r>e.width()||t>e.height()?new n.CellError(n.ErrorType.NUM,s.ErrorMessage.ValueLarge):null!==(l=null!==(a=null===(i=null===(o=null==e?void 0:e.data)||void 0===o?void 0:o[t-1])||void 0===i?void 0:i[r-1])&&void 0!==a?a:null===(c=null===(u=null==e?void 0:e.data)||void 0===u?void 0:u[0])||void 0===c?void 0:c[0])&&void 0!==l?l:new n.CellError(n.ErrorType.VALUE,s.ErrorMessage.CellRangeExpected)})}na(e,t){return new n.CellError(n.ErrorType.NA)}sheet(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("SHEET"),()=>t.formulaAddress.sheet+1,e=>e.sheet+1,e=>{const t=this.dependencyGraph.sheetMapping.get(e);return void 0!==t?t+1:new n.CellError(n.ErrorType.NA,s.ErrorMessage.SheetRef)})}sheets(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("SHEETS"),()=>this.dependencyGraph.sheetMapping.numberOfSheets(),()=>1,()=>new n.CellError(n.ErrorType.VALUE,s.ErrorMessage.CellRefExpected))}}t.InformationPlugin=l,l.implementedFunctions={COLUMN:{method:"column",parameters:[{argumentType:c.FunctionArgumentType.NOERROR,optionalArg:!0}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},COLUMNS:{method:"columns",parameters:[{argumentType:c.FunctionArgumentType.RANGE}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},ISBINARY:{method:"isbinary",parameters:[{argumentType:c.FunctionArgumentType.STRING}]},ISERR:{method:"iserr",parameters:[{argumentType:c.FunctionArgumentType.SCALAR}]},ISFORMULA:{method:"isformula",parameters:[{argumentType:c.FunctionArgumentType.NOERROR}],doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},ISNA:{method:"isna",parameters:[{argumentType:c.FunctionArgumentType.SCALAR}]},ISREF:{method:"isref",parameters:[{argumentType:c.FunctionArgumentType.SCALAR}],vectorizationForbidden:!0},ISERROR:{method:"iserror",parameters:[{argumentType:c.FunctionArgumentType.SCALAR}]},ISBLANK:{method:"isblank",parameters:[{argumentType:c.FunctionArgumentType.SCALAR}]},ISNUMBER:{method:"isnumber",parameters:[{argumentType:c.FunctionArgumentType.SCALAR}]},ISLOGICAL:{method:"islogical",parameters:[{argumentType:c.FunctionArgumentType.SCALAR}]},ISTEXT:{method:"istext",parameters:[{argumentType:c.FunctionArgumentType.SCALAR}]},ISNONTEXT:{method:"isnontext",parameters:[{argumentType:c.FunctionArgumentType.SCALAR}]},INDEX:{method:"index",parameters:[{argumentType:c.FunctionArgumentType.RANGE},{argumentType:c.FunctionArgumentType.NUMBER},{argumentType:c.FunctionArgumentType.NUMBER,defaultValue:1}]},NA:{method:"na",parameters:[]},ROW:{method:"row",parameters:[{argumentType:c.FunctionArgumentType.NOERROR,optionalArg:!0}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},ROWS:{method:"rows",parameters:[{argumentType:c.FunctionArgumentType.RANGE}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},SHEET:{method:"sheet",parameters:[{argumentType:c.FunctionArgumentType.STRING}],doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},SHEETS:{method:"sheets",parameters:[{argumentType:c.FunctionArgumentType.STRING}],doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0}}},function(e,t,r){"use strict";t.__esModule=!0,t.IsEvenPlugin=void 0;var n=r(167);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class o extends n.FunctionPlugin{iseven(e,t){return this.runFunction(e.args,t,this.metadata("ISEVEN"),e=>e%2==0)}}t.IsEvenPlugin=o,o.implementedFunctions={ISEVEN:{method:"iseven",parameters:[{argumentType:n.FunctionArgumentType.NUMBER}]}}},function(e,t,r){"use strict";t.__esModule=!0,t.IsOddPlugin=void 0;var n=r(167);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class o extends n.FunctionPlugin{isodd(e,t){return this.runFunction(e.args,t,this.metadata("ISODD"),e=>e%2==1)}}t.IsOddPlugin=o,o.implementedFunctions={ISODD:{method:"isodd",parameters:[{argumentType:n.FunctionArgumentType.NUMBER}]}}},function(e,t,r){"use strict";t.__esModule=!0,t.LogarithmPlugin=void 0;var n=r(167);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class o extends n.FunctionPlugin{log10(e,t){return this.runFunction(e.args,t,this.metadata("LOG10"),Math.log10)}log(e,t){return this.runFunction(e.args,t,this.metadata("LOG"),(e,t)=>Math.log(e)/Math.log(t))}ln(e,t){return this.runFunction(e.args,t,this.metadata("LN"),Math.log)}}t.LogarithmPlugin=o,o.implementedFunctions={LOG10:{method:"log10",parameters:[{argumentType:n.FunctionArgumentType.NUMBER}]},LOG:{method:"log",parameters:[{argumentType:n.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:n.FunctionArgumentType.NUMBER,defaultValue:10,greaterThan:0}]},LN:{method:"ln",parameters:[{argumentType:n.FunctionArgumentType.NUMBER}]}}},function(e,t,r){"use strict";t.__esModule=!0,t.PI=t.MathConstantsPlugin=void 0;var n=r(167);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const o=t.PI=parseFloat(Math.PI.toFixed(14));class s extends n.FunctionPlugin{pi(e,t){return this.runFunction(e.args,t,this.metadata("PI"),()=>o)}sqrtpi(e,t){return this.runFunction(e.args,t,this.metadata("SQRTPI"),e=>Math.sqrt(o*e))}}t.MathConstantsPlugin=s,s.implementedFunctions={PI:{method:"pi",parameters:[]},SQRTPI:{method:"sqrtpi",parameters:[{argumentType:n.FunctionArgumentType.NUMBER,minValue:0}]}}},function(e,t,r){"use strict";t.__esModule=!0,t.MatrixPlugin=void 0,r(2);var n=r(1),o=r(73),s=r(131),i=r(77),a=r(165),u=r(139),c=r(167);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
function l(e,t){return new n.ArraySize(t.width,e.height)}function h(e,t,r){return new n.ArraySize(1+(e.width-t)/r,1+(e.height-t)/r)}class d extends c.FunctionPlugin{mmult(e,t){return this.runFunction(e.args,t,this.metadata("MMULT"),(e,t)=>{if(!e.hasOnlyNumbers()||!t.hasOnlyNumbers())return new o.CellError(o.ErrorType.VALUE,s.ErrorMessage.NumberRange);if(t.height()!==e.width())return new o.CellError(o.ErrorType.VALUE,s.ErrorMessage.ArrayDimensions);const r=l(e.size,t.size),n=this.createKernel((function(e,t,r){let n=0;for(let o=0;o<r;++o)n+=e[this.thread.y][o]*t[o][this.thread.x];return n}),r)(e.rawNumbers(),t.rawNumbers(),e.width());return u.SimpleRangeValue.onlyNumbers(n)})}mmultArraySize(e,t){if(2!==e.args.length)return n.ArraySize.error();const r=this.metadata("MMULT"),o=e.args.map(e=>{var n;return this.arraySizeForAst(e,new a.InterpreterState(t.formulaAddress,t.arraysFlag||null!==(n=null==r?void 0:r.arrayFunction)&&void 0!==n&&n))}),[s,i]=o;return l(s,i)}maxpool(e,t){return this.runFunction(e.args,t,this.metadata("MAXPOOL"),(e,t,r=t)=>{if(!e.hasOnlyNumbers())return new o.CellError(o.ErrorType.VALUE,s.ErrorMessage.NumberRange);const n=h(e.size,t,r),i=this.createKernel((function(e,t,r){const n=this.thread.x*r,o=this.thread.y*r;let s=e[o][n];for(let r=0;r<t;r++)for(let i=0;i<t;i++)s=Math.max(s,e[o+r][n+i]);return s}),n)(e.rawNumbers(),t,r);return u.SimpleRangeValue.onlyNumbers(i)})}medianpool(e,t){return this.runFunction(e.args,t,this.metadata("MEDIANPOOL"),(e,t,r=t)=>{if(!e.hasOnlyNumbers())return new o.CellError(o.ErrorType.VALUE,s.ErrorMessage.NumberRange);const n=h(e.size,t,r),i=this.createKernel((function(e,t,r){const n=this.thread.x*r,o=this.thread.y*r;let s=e[o][n];for(let r=0;r<t;r++)for(let i=0;i<t;i++)s=Math.max(s,e[o+r][n+i]);let i=e[o][n];for(let r=0;r<t;r++)for(let s=0;s<t;s++)i=Math.min(i,e[o+r][n+s]);const a=t*t;let u=i,c=s,l=42;for(let r=0;r<32;r++){const r=(u+c)/2;let s=0;for(let i=0;i<t;i++)for(let a=0;a<t;a++)e[o+i][n+a]>r&&s++;if(t%2==0){if(s===a/2){l=r;break}s>a/2?u=r:c=r}else{if(s===(a-1)/2){l=r;break}s>(a-1)/2?u=r:c=r}}return l}),n)(e.rawNumbers(),t,r);return u.SimpleRangeValue.onlyNumbers(i)})}maxpoolArraySize(e,t){if(e.args.length<2||e.args.length>3)return n.ArraySize.error();const r=this.metadata("MAXPOOL"),o=e.args.map(e=>{var n;return this.arraySizeForAst(e,new a.InterpreterState(t.formulaAddress,t.arraysFlag||null!==(n=null==r?void 0:r.arrayFunction)&&void 0!==n&&n))})[0],s=e.args[1];let u;u=s.type===i.AstNodeType.NUMBER?s.value:1;let c=u;if(3===e.args.length){const t=e.args[2];c=t.type===i.AstNodeType.NUMBER?t.value:1}return u>o.width||u>o.height||c>u||(o.width-u)%c!=0||(o.height-u)%c!=0?n.ArraySize.error():h(o,u,c)}medianpoolArraySize(e,t){return this.maxpoolArraySize(e,t)}transpose(e,t){return this.runFunction(e.args,t,this.metadata("TRANSPOSE"),e=>{const t=e.rawData(),r=e.size,n=[];for(let e=0;e<r.width;++e){n[e]=[];for(let o=0;o<r.height;++o)n[e][o]=t[o][e]}return u.SimpleRangeValue.onlyValues(n)})}transposeArraySize(e,t){if(1!==e.args.length)return n.ArraySize.error();const r=this.metadata("TRANSPOSE"),o=e.args.map(e=>{var n;return this.arraySizeForAst(e,new a.InterpreterState(t.formulaAddress,t.arraysFlag||null!==(n=null==r?void 0:r.arrayFunction)&&void 0!==n&&n))}),[s]=o;return new n.ArraySize(s.height,s.width)}createKernel(e,t){return function(...r){const n=[];for(let o=0;o<t.height;++o){n.push([]);for(let s=0;s<t.width;++s)n[o][s]=e.apply({thread:{x:s,y:o}},r)}return n}}}t.MatrixPlugin=d,d.implementedFunctions={MMULT:{method:"mmult",arraySizeMethod:"mmultArraySize",parameters:[{argumentType:c.FunctionArgumentType.RANGE},{argumentType:c.FunctionArgumentType.RANGE}],vectorizationForbidden:!0},TRANSPOSE:{method:"transpose",arraySizeMethod:"transposeArraySize",parameters:[{argumentType:c.FunctionArgumentType.RANGE}],vectorizationForbidden:!0},MAXPOOL:{method:"maxpool",arraySizeMethod:"maxpoolArraySize",parameters:[{argumentType:c.FunctionArgumentType.RANGE},{argumentType:c.FunctionArgumentType.NUMBER},{argumentType:c.FunctionArgumentType.NUMBER,optionalArg:!0}],vectorizationForbidden:!0},MEDIANPOOL:{method:"medianpool",arraySizeMethod:"medianpoolArraySize",parameters:[{argumentType:c.FunctionArgumentType.RANGE},{argumentType:c.FunctionArgumentType.NUMBER},{argumentType:c.FunctionArgumentType.NUMBER,optionalArg:!0}],vectorizationForbidden:!0}}},function(e,t,r){"use strict";t.__esModule=!0,t.MedianPlugin=void 0;var n=r(73),o=r(131),s=r(167);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
class i extends s.FunctionPlugin{median(e,t){return this.runFunction(e.args,t,this.metadata("MEDIAN"),(...e)=>{const t=this.arithmeticHelper.coerceNumbersExactRanges(e);return t instanceof n.CellError?t:0===t.length?new n.CellError(n.ErrorType.NUM,o.ErrorMessage.OneValue):(t.sort((e,t)=>e-t),t.length%2==0?(t[t.length/2-1]+t[t.length/2])/2:t[Math.floor(t.length/2)])})}large(e,t){return this.runFunction(e.args,t,this.metadata("LARGE"),(e,t)=>{const r=this.arithmeticHelper.manyToExactNumbers(e.valuesFromTopLeftCorner());return r instanceof n.CellError?r:(r.sort((e,t)=>e-t),(t=Math.trunc(t))>r.length?new n.CellError(n.ErrorType.NUM,o.ErrorMessage.ValueLarge):r[r.length-t])})}small(e,t){return this.runFunction(e.args,t,this.metadata("SMALL"),(e,t)=>{const r=this.arithmeticHelper.manyToExactNumbers(e.valuesFromTopLeftCorner());return r instanceof n.CellError?r:(r.sort((e,t)=>e-t),(t=Math.trunc(t))>r.length?new n.CellError(n.ErrorType.NUM,o.ErrorMessage.ValueLarge):r[t-1])})}}t.MedianPlugin=i,i.implementedFunctions={MEDIAN:{method:"median",parameters:[{argumentType:s.FunctionArgumentType.ANY}],repeatLastArgs:1},LARGE:{method:"large",parameters:[{argumentType:s.FunctionArgumentType.RANGE},{argumentType:s.FunctionArgumentType.NUMBER,minValue:1}]},SMALL:{method:"small",parameters:[{argumentType:s.FunctionArgumentType.RANGE},{argumentType:s.FunctionArgumentType.NUMBER,minValue:1}]}}},function(e,t,r){"use strict";t.__esModule=!0,t.ModuloPlugin=void 0;var n=r(73),o=r(167);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
class s extends o.FunctionPlugin{mod(e,t){return this.runFunction(e.args,t,this.metadata("MOD"),(e,t)=>0===t?new n.CellError(n.ErrorType.DIV_BY_ZERO):e%t)}}t.ModuloPlugin=s,s.implementedFunctions={MOD:{method:"mod",parameters:[{argumentType:o.FunctionArgumentType.NUMBER},{argumentType:o.FunctionArgumentType.NUMBER}]}}},function(e,t,r){"use strict";t.__esModule=!0,t.NumericAggregationPlugin=void 0,r(2);var n=r(72),o=r(73),s=r(131),i=r(147),a=r(77),u=r(168),c=r(140),l=r(139),h=r(167);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
function d(e){return(0,c.isExtendedNumber)(e)&&!Number.isFinite((0,c.getRawValue)(e))?0:e}class p{constructor(e,t,r){this.sumsq=e,this.sum=t,this.count=r}static single(e){return new p(e*e,e,1)}compose(e){return new p(this.sumsq+e.sumsq,this.sum+e.sum,this.count+e.count)}averageValue(){return this.count>0?this.sum/this.count:void 0}varSValue(){return this.count>1?(this.sumsq-this.sum*this.sum/this.count)/(this.count-1):void 0}varPValue(){return this.count>0?(this.sumsq-this.sum*this.sum/this.count)/this.count:void 0}}p.empty=new p(0,0,0);class m extends h.FunctionPlugin{constructor(){super(...arguments),this.addWithEpsilonRaw=(e,t)=>this.arithmeticHelper.addWithEpsilonRaw(e,t)}sum(e,t){return this.doSum(e.args,t)}sumsq(e,t){return this.reduce(e.args,t,0,"SUMSQ",this.addWithEpsilonRaw,e=>Math.pow((0,c.getRawValue)(e),2),g)}max(e,t){return this.doMax(e.args,t)}maxa(e,t){return d(this.reduce(e.args,t,Number.NEGATIVE_INFINITY,"MAXA",(e,t)=>Math.max(e,t),c.getRawValue,f))}min(e,t){return this.doMin(e.args,t)}mina(e,t){return d(this.reduce(e.args,t,Number.POSITIVE_INFINITY,"MINA",(e,t)=>Math.min(e,t),c.getRawValue,f))}count(e,t){return this.doCount(e.args,t)}counta(e,t){return this.doCounta(e.args,t)}average(e,t){return this.doAverage(e.args,t)}averagea(e,t){var r;const n=this.reduce(e.args,t,p.empty,"_AGGREGATE_A",(e,t)=>e.compose(t),e=>p.single((0,c.getRawValue)(e)),f);return n instanceof o.CellError?n:null!==(r=n.averageValue())&&void 0!==r?r:new o.CellError(o.ErrorType.DIV_BY_ZERO)}vars(e,t){return this.doVarS(e.args,t)}varp(e,t){return this.doVarP(e.args,t)}vara(e,t){var r;const n=this.reduceAggregateA(e.args,t);return n instanceof o.CellError?n:null!==(r=n.varSValue())&&void 0!==r?r:new o.CellError(o.ErrorType.DIV_BY_ZERO)}varpa(e,t){var r;const n=this.reduceAggregateA(e.args,t);return n instanceof o.CellError?n:null!==(r=n.varPValue())&&void 0!==r?r:new o.CellError(o.ErrorType.DIV_BY_ZERO)}stdevs(e,t){return this.doStdevS(e.args,t)}stdevp(e,t){return this.doStdevP(e.args,t)}stdeva(e,t){const r=this.reduceAggregateA(e.args,t);if(r instanceof o.CellError)return r;{const e=r.varSValue();return void 0===e?new o.CellError(o.ErrorType.DIV_BY_ZERO):Math.sqrt(e)}}stdevpa(e,t){const r=this.reduceAggregateA(e.args,t);if(r instanceof o.CellError)return r;{const e=r.varPValue();return void 0===e?new o.CellError(o.ErrorType.DIV_BY_ZERO):Math.sqrt(e)}}product(e,t){return this.doProduct(e.args,t)}subtotal(e,t){if(e.args.length<2)return new o.CellError(o.ErrorType.NA,s.ErrorMessage.WrongArgNumber);const r=this.coerceToType(this.evaluateAst(e.args[0],t),{argumentType:h.FunctionArgumentType.NUMBER},t),n=e.args.slice(1);switch(r){case 1:case 101:return this.doAverage(n,t);case 2:case 102:return this.doCount(n,t);case 3:case 103:return this.doCounta(n,t);case 4:case 104:return this.doMax(n,t);case 5:case 105:return this.doMin(n,t);case 6:case 106:return this.doProduct(n,t);case 7:case 107:return this.doStdevS(n,t);case 8:case 108:return this.doStdevP(n,t);case 9:case 109:return this.doSum(n,t);case 10:case 110:return this.doVarS(n,t);case 11:case 111:return this.doVarP(n,t);default:return new o.CellError(o.ErrorType.VALUE,s.ErrorMessage.BadMode)}}reduceAggregate(e,t){return this.reduce(e,t,p.empty,"_AGGREGATE",(e,t)=>e.compose(t),e=>p.single((0,c.getRawValue)(e)),g)}reduceAggregateA(e,t){return this.reduce(e,t,p.empty,"_AGGREGATE_A",(e,t)=>e.compose(t),e=>p.single((0,c.getRawValue)(e)),f)}doAverage(e,t){var r;const n=this.reduceAggregate(e,t);return n instanceof o.CellError?n:null!==(r=n.averageValue())&&void 0!==r?r:new o.CellError(o.ErrorType.DIV_BY_ZERO)}doVarS(e,t){var r;const n=this.reduceAggregate(e,t);return n instanceof o.CellError?n:null!==(r=n.varSValue())&&void 0!==r?r:new o.CellError(o.ErrorType.DIV_BY_ZERO)}doVarP(e,t){var r;const n=this.reduceAggregate(e,t);return n instanceof o.CellError?n:null!==(r=n.varPValue())&&void 0!==r?r:new o.CellError(o.ErrorType.DIV_BY_ZERO)}doStdevS(e,t){const r=this.reduceAggregate(e,t);if(r instanceof o.CellError)return r;{const e=r.varSValue();return void 0===e?new o.CellError(o.ErrorType.DIV_BY_ZERO):Math.sqrt(e)}}doStdevP(e,t){const r=this.reduceAggregate(e,t);if(r instanceof o.CellError)return r;{const e=r.varPValue();return void 0===e?new o.CellError(o.ErrorType.DIV_BY_ZERO):Math.sqrt(e)}}doCount(e,t){return this.reduce(e,t,0,"COUNT",(e,t)=>e+t,c.getRawValue,e=>(0,c.isExtendedNumber)(e)?1:0)}doCounta(e,t){return this.reduce(e,t,0,"COUNTA",(e,t)=>e+t,c.getRawValue,e=>e===c.EmptyValue?0:1)}doMax(e,t){return d(this.reduce(e,t,Number.NEGATIVE_INFINITY,"MAX",(e,t)=>Math.max(e,t),c.getRawValue,g))}doMin(e,t){return d(this.reduce(e,t,Number.POSITIVE_INFINITY,"MIN",(e,t)=>Math.min(e,t),c.getRawValue,g))}doSum(e,t){return this.reduce(e,t,0,"SUM",this.addWithEpsilonRaw,c.getRawValue,g)}doProduct(e,t){return this.reduce(e,t,1,"PRODUCT",(e,t)=>e*t,c.getRawValue,g)}reduce(e,t,r,n,i,u,c){return e.length<1?new o.CellError(o.ErrorType.NA,s.ErrorMessage.WrongArgNumber):e.reduce((e,s)=>{if(e instanceof o.CellError)return e;if(s.type===a.AstNodeType.CELL_RANGE||s.type===a.AstNodeType.COLUMN_RANGE||s.type===a.AstNodeType.ROW_RANGE){const a=this.evaluateRange(s,t,r,n,i,u,c);return a instanceof o.CellError?a:i(a,e)}let h;if(h=this.evaluateAst(s,t),h instanceof l.SimpleRangeValue)return Array.from(h.valuesFromTopLeftCorner()).map(c).filter(e=>void 0!==e).map(e=>e instanceof o.CellError?e:u(e)).reduce((e,t)=>e instanceof o.CellError?e:t instanceof o.CellError?t:i(e,t),e);if(s.type===a.AstNodeType.CELL_REFERENCE){if(h=c(h),void 0===h)return e}else if(h=this.coerceScalarToNumberOrError(h),h=c(h),void 0===h)return e;return h instanceof o.CellError?h:i(e,u(h))},r)}evaluateRange(e,t,r,a,u,c,l){let h;try{h=n.AbsoluteCellRange.fromAst(e,t.formulaAddress)}catch(e){if(e instanceof i.SheetsNotEqual)return new o.CellError(o.ErrorType.REF,s.ErrorMessage.RangeManySheets);throw e}const d=this.dependencyGraph.getRange(h.start,h.end);if(void 0===d)throw new Error("Range does not exists in graph");let p=d.getFunctionValue(a);return void 0===p&&(p=this.getRangeValues(a,h,d,c,l).reduce((e,t)=>e instanceof o.CellError?e:t instanceof o.CellError?t:u(e,t),r),d.setFunctionValue(a,p)),p}getRangeValues(e,t,r,n,s){const i=[],{smallerRangeVertex:a,restRange:u}=this.dependencyGraph.rangeMapping.findSmallerRange(t);let c;if(void 0!==a&&this.dependencyGraph.existsEdge(a,r)){const t=a.getFunctionValue(e);if(void 0!==t)i.push(t);else for(const e of a.range.addresses(this.dependencyGraph)){const t=s(this.dependencyGraph.getScalarValue(e));t instanceof o.CellError?i.push(t):void 0!==t&&i.push(n(t))}c=u}else c=t;for(const e of c.addresses(this.dependencyGraph)){const t=s(this.dependencyGraph.getScalarValue(e));t instanceof o.CellError?i.push(t):void 0!==t&&i.push(n(t))}return i}}function g(e){return(0,c.isExtendedNumber)(e)||e instanceof o.CellError?e:void 0}function f(e){return"boolean"==typeof e?(0,u.coerceBooleanToNumber)(e):(0,c.isExtendedNumber)(e)||e instanceof o.CellError?e:"string"==typeof e?0:void 0}t.NumericAggregationPlugin=m,m.implementedFunctions={SUM:{method:"sum",parameters:[{argumentType:h.FunctionArgumentType.ANY}],repeatLastArgs:1},SUMSQ:{method:"sumsq",parameters:[{argumentType:h.FunctionArgumentType.ANY}],repeatLastArgs:1},MAX:{method:"max",parameters:[{argumentType:h.FunctionArgumentType.ANY}],repeatLastArgs:1},MIN:{method:"min",parameters:[{argumentType:h.FunctionArgumentType.ANY}],repeatLastArgs:1},MAXA:{method:"maxa",parameters:[{argumentType:h.FunctionArgumentType.ANY}],repeatLastArgs:1},MINA:{method:"mina",parameters:[{argumentType:h.FunctionArgumentType.ANY}],repeatLastArgs:1},COUNT:{method:"count",parameters:[{argumentType:h.FunctionArgumentType.ANY}],repeatLastArgs:1},COUNTA:{method:"counta",parameters:[{argumentType:h.FunctionArgumentType.ANY}],repeatLastArgs:1},AVERAGE:{method:"average",parameters:[{argumentType:h.FunctionArgumentType.ANY}],repeatLastArgs:1},AVERAGEA:{method:"averagea",parameters:[{argumentType:h.FunctionArgumentType.ANY}],repeatLastArgs:1},PRODUCT:{method:"product",parameters:[{argumentType:h.FunctionArgumentType.ANY}],repeatLastArgs:1},"VAR.S":{method:"vars",parameters:[{argumentType:h.FunctionArgumentType.ANY}],repeatLastArgs:1},"VAR.P":{method:"varp",parameters:[{argumentType:h.FunctionArgumentType.ANY}],repeatLastArgs:1},VARA:{method:"vara",parameters:[{argumentType:h.FunctionArgumentType.ANY}],repeatLastArgs:1},VARPA:{method:"varpa",parameters:[{argumentType:h.FunctionArgumentType.ANY}],repeatLastArgs:1},"STDEV.S":{method:"stdevs",parameters:[{argumentType:h.FunctionArgumentType.ANY}],repeatLastArgs:1},"STDEV.P":{method:"stdevp",parameters:[{argumentType:h.FunctionArgumentType.ANY}],repeatLastArgs:1},STDEVA:{method:"stdeva",parameters:[{argumentType:h.FunctionArgumentType.ANY}],repeatLastArgs:1},STDEVPA:{method:"stdevpa",parameters:[{argumentType:h.FunctionArgumentType.ANY}],repeatLastArgs:1},SUBTOTAL:{method:"subtotal",parameters:[{argumentType:h.FunctionArgumentType.NUMBER},{argumentType:h.FunctionArgumentType.ANY}],repeatLastArgs:1}},m.aliases={VAR:"VAR.S",VARP:"VAR.P",STDEV:"STDEV.S",STDEVP:"STDEV.P",VARS:"VAR.S",STDEVS:"STDEV.S"}},function(e,t,r){"use strict";t.__esModule=!0,t.PowerPlugin=void 0;var n=r(167);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class o extends n.FunctionPlugin{power(e,t){return this.runFunction(e.args,t,this.metadata("POWER"),Math.pow)}}t.PowerPlugin=o,o.implementedFunctions={POWER:{method:"power",parameters:[{argumentType:n.FunctionArgumentType.NUMBER},{argumentType:n.FunctionArgumentType.NUMBER}]}}},function(e,t,r){"use strict";t.__esModule=!0,t.RadiansPlugin=void 0;var n=r(167);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class o extends n.FunctionPlugin{radians(e,t){return this.runFunction(e.args,t,this.metadata("RADIANS"),e=>e*(Math.PI/180))}}t.RadiansPlugin=o,o.implementedFunctions={RADIANS:{method:"radians",parameters:[{argumentType:n.FunctionArgumentType.NUMBER}]}}},function(e,t,r){"use strict";t.__esModule=!0,t.RadixConversionPlugin=void 0;var n=r(73),o=r(131),s=r(176),i=r(167);class a extends i.FunctionPlugin{dec2bin(e,t){return this.runFunction(e.args,t,this.metadata("DEC2BIN"),(e,t)=>c(e,2,t))}dec2oct(e,t){return this.runFunction(e.args,t,this.metadata("DEC2OCT"),(e,t)=>c(e,8,t))}dec2hex(e,t){return this.runFunction(e.args,t,this.metadata("DEC2HEX"),(e,t)=>c(e,16,t))}bin2dec(e,t){return this.runFunction(e.args,t,this.metadata("BIN2DEC"),e=>{const t=u(e,2,10);return void 0===t?new n.CellError(n.ErrorType.NUM,o.ErrorMessage.NotBinary):p(t,2)})}bin2oct(e,t){return this.runFunction(e.args,t,this.metadata("BIN2OCT"),(e,t)=>{const r=u(e,2,10);return void 0===r?new n.CellError(n.ErrorType.NUM,o.ErrorMessage.NotBinary):c(p(r,2),8,t)})}bin2hex(e,t){return this.runFunction(e.args,t,this.metadata("BIN2HEX"),(e,t)=>{const r=u(e,2,10);return void 0===r?new n.CellError(n.ErrorType.NUM,o.ErrorMessage.NotBinary):c(p(r,2),16,t)})}oct2dec(e,t){return this.runFunction(e.args,t,this.metadata("OCT2DEC"),e=>{const t=u(e,8,10);return void 0===t?new n.CellError(n.ErrorType.NUM,o.ErrorMessage.NotOctal):p(t,8)})}oct2bin(e,t){return this.runFunction(e.args,t,this.metadata("OCT2BIN"),(e,t)=>{const r=u(e,8,10);return void 0===r?new n.CellError(n.ErrorType.NUM,o.ErrorMessage.NotOctal):c(p(r,8),2,t)})}oct2hex(e,t){return this.runFunction(e.args,t,this.metadata("OCT2HEX"),(e,t)=>{const r=u(e,8,10);return void 0===r?new n.CellError(n.ErrorType.NUM,o.ErrorMessage.NotOctal):c(p(r,8),16,t)})}hex2dec(e,t){return this.runFunction(e.args,t,this.metadata("HEX2DEC"),e=>{const t=u(e,16,10);return void 0===t?new n.CellError(n.ErrorType.NUM,o.ErrorMessage.NotHex):p(t,16)})}hex2bin(e,t){return this.runFunction(e.args,t,this.metadata("HEX2BIN"),(e,t)=>{const r=u(e,16,10);return void 0===r?new n.CellError(n.ErrorType.NUM,o.ErrorMessage.NotHex):c(p(r,16),2,t)})}hex2oct(e,t){return this.runFunction(e.args,t,this.metadata("HEX2OCT"),(e,t)=>{const r=u(e,16,10);return void 0===r?new n.CellError(n.ErrorType.NUM,o.ErrorMessage.NotHex):c(p(r,16),8,t)})}base(e,t){return this.runFunction(e.args,t,this.metadata("BASE"),h)}decimal(e,t){return this.runFunction(e.args,t,this.metadata("DECIMAL"),(e,t)=>{const r=u(e,t,255);return void 0===r?new n.CellError(n.ErrorType.NUM,o.ErrorMessage.NotHex):parseInt(r,t)})}}function u(e,t,r){const n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ".substr(0,t),o=new RegExp(`^[${n}]+$`);if(!(e.length>r)&&o.test(e))return e}function c(e,t,r){if(e>function(e){return-l(e)-1}(t))return new n.CellError(n.ErrorType.NUM,o.ErrorMessage.ValueBaseLarge);if(e<l(t))return new n.CellError(n.ErrorType.NUM,o.ErrorMessage.ValueBaseSmall);const i=d(e,t);return void 0===r||e<0?i:i.length>r?new n.CellError(n.ErrorType.NUM,o.ErrorMessage.ValueBaseLong):(0,s.padLeft)(i,r)}function l(e){return-Math.pow(e,10)/2}function h(e,t,r){const n=d(e,t);return void 0!==r&&r>n.length?(0,s.padLeft)(n,r):n}function d(e,t){return(e+(e<0?Math.pow(t,10):0)).toString(t).toUpperCase()}function p(e,t){const r=parseInt(e,t),n=Math.pow(t,10);return r>=n/2?r-n:r}t.RadixConversionPlugin=a,a.implementedFunctions={DEC2BIN:{method:"dec2bin",parameters:[{argumentType:i.FunctionArgumentType.NUMBER},{argumentType:i.FunctionArgumentType.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},DEC2OCT:{method:"dec2oct",parameters:[{argumentType:i.FunctionArgumentType.NUMBER},{argumentType:i.FunctionArgumentType.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},DEC2HEX:{method:"dec2hex",parameters:[{argumentType:i.FunctionArgumentType.NUMBER},{argumentType:i.FunctionArgumentType.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},BIN2DEC:{method:"bin2dec",parameters:[{argumentType:i.FunctionArgumentType.STRING}]},BIN2OCT:{method:"bin2oct",parameters:[{argumentType:i.FunctionArgumentType.STRING},{argumentType:i.FunctionArgumentType.NUMBER,optionalArg:!0,minValue:0,maxValue:10}]},BIN2HEX:{method:"bin2hex",parameters:[{argumentType:i.FunctionArgumentType.STRING},{argumentType:i.FunctionArgumentType.NUMBER,optionalArg:!0,minValue:0,maxValue:10}]},OCT2DEC:{method:"oct2dec",parameters:[{argumentType:i.FunctionArgumentType.STRING}]},OCT2BIN:{method:"oct2bin",parameters:[{argumentType:i.FunctionArgumentType.STRING},{argumentType:i.FunctionArgumentType.NUMBER,optionalArg:!0,minValue:0,maxValue:10}]},OCT2HEX:{method:"oct2hex",parameters:[{argumentType:i.FunctionArgumentType.STRING},{argumentType:i.FunctionArgumentType.NUMBER,optionalArg:!0,minValue:0,maxValue:10}]},HEX2DEC:{method:"hex2dec",parameters:[{argumentType:i.FunctionArgumentType.STRING}]},HEX2BIN:{method:"hex2bin",parameters:[{argumentType:i.FunctionArgumentType.STRING},{argumentType:i.FunctionArgumentType.NUMBER,optionalArg:!0,minValue:0,maxValue:10}]},HEX2OCT:{method:"hex2oct",parameters:[{argumentType:i.FunctionArgumentType.STRING},{argumentType:i.FunctionArgumentType.NUMBER,optionalArg:!0,minValue:0,maxValue:10}]},DECIMAL:{method:"decimal",parameters:[{argumentType:i.FunctionArgumentType.STRING},{argumentType:i.FunctionArgumentType.NUMBER,minValue:2,maxValue:36}]},BASE:{method:"base",parameters:[{argumentType:i.FunctionArgumentType.NUMBER,minValue:0},{argumentType:i.FunctionArgumentType.NUMBER,minValue:2,maxValue:36},{argumentType:i.FunctionArgumentType.NUMBER,optionalArg:!0,minValue:0,maxValue:255}]}}},function(e,t,r){"use strict";t.__esModule=!0,t.RandomPlugin=void 0;var n=r(73),o=r(131),s=r(167);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
class i extends s.FunctionPlugin{rand(e,t){return this.runFunction(e.args,t,this.metadata("RAND"),Math.random)}randbetween(e,t){return this.runFunction(e.args,t,this.metadata("RANDBETWEEN"),(e,t)=>t<e?new n.CellError(n.ErrorType.NUM,o.ErrorMessage.WrongOrder):((e=Math.ceil(e))===(t=Math.floor(t)+1)&&(t+=1),e+Math.floor(Math.random()*(t-e))))}}t.RandomPlugin=i,i.implementedFunctions={RAND:{method:"rand",parameters:[],isVolatile:!0},RANDBETWEEN:{method:"randbetween",parameters:[{argumentType:s.FunctionArgumentType.NUMBER},{argumentType:s.FunctionArgumentType.NUMBER}],isVolatile:!0}}},function(e,t,r){"use strict";t.__esModule=!0,t.RoundingPlugin=void 0,t.findNextEvenNumber=a,t.findNextOddNumber=i;var n=r(73),o=r(131),s=r(167);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
function i(e){const t=Math.ceil(e);return t%2==1?t:t+1}function a(e){const t=Math.ceil(e);return t%2==0?t:t+1}class u extends s.FunctionPlugin{roundup(e,t){return this.runFunction(e.args,t,this.metadata("ROUNDDOWN"),(e,t)=>{const r=Math.pow(10,t);return e<0?-Math.ceil(-e*r)/r:Math.ceil(e*r)/r})}rounddown(e,t){return this.runFunction(e.args,t,this.metadata("ROUNDDOWN"),(e,t)=>{const r=Math.pow(10,t);return e<0?-Math.floor(-e*r)/r:Math.floor(e*r)/r})}round(e,t){return this.runFunction(e.args,t,this.metadata("ROUND"),(e,t)=>{const r=Math.pow(10,t);return e<0?-Math.round(-e*r)/r:Math.round(e*r)/r})}intFunc(e,t){return this.runFunction(e.args,t,this.metadata("INT"),e=>e<0?-Math.floor(-e):Math.floor(e))}even(e,t){return this.runFunction(e.args,t,this.metadata("EVEN"),e=>e<0?-a(-e):a(e))}odd(e,t){return this.runFunction(e.args,t,this.metadata("ODD"),e=>e<0?-i(-e):i(e))}ceilingmath(e,t){return this.runFunction(e.args,t,this.metadata("CEILING.MATH"),(e,t,r)=>0===t||0===e?0:(t=Math.abs(t),1===r&&e<0&&(t=-t),Math.ceil(e/t)*t))}ceiling(e,t){return this.runFunction(e.args,t,this.metadata("CEILING"),(e,t)=>0===e?0:0===t?new n.CellError(n.ErrorType.DIV_BY_ZERO):e>0&&t<0?new n.CellError(n.ErrorType.NUM,o.ErrorMessage.DistinctSigns):Math.ceil(e/t)*t)}ceilingprecise(e,t){return this.runFunction(e.args,t,this.metadata("CEILING.PRECISE"),(e,t)=>0===t||0===e?0:(t=Math.abs(t),Math.ceil(e/t)*t))}floormath(e,t){return this.runFunction(e.args,t,this.metadata("FLOOR.MATH"),(e,t,r)=>0===t||0===e?0:(t=Math.abs(t),1===r&&e<0&&(t*=-1),Math.floor(e/t)*t))}floor(e,t){return this.runFunction(e.args,t,this.metadata("FLOOR"),(e,t)=>0===e?0:0===t?new n.CellError(n.ErrorType.DIV_BY_ZERO):e>0&&t<0?new n.CellError(n.ErrorType.NUM,o.ErrorMessage.DistinctSigns):Math.floor(e/t)*t)}floorprecise(e,t){return this.runFunction(e.args,t,this.metadata("FLOOR.PRECISE"),(e,t)=>0===t||0===e?0:(t=Math.abs(t),Math.floor(e/t)*t))}}t.RoundingPlugin=u,u.implementedFunctions={ROUNDUP:{method:"roundup",parameters:[{argumentType:s.FunctionArgumentType.NUMBER},{argumentType:s.FunctionArgumentType.NUMBER,defaultValue:0}]},ROUNDDOWN:{method:"rounddown",parameters:[{argumentType:s.FunctionArgumentType.NUMBER},{argumentType:s.FunctionArgumentType.NUMBER,defaultValue:0}]},ROUND:{method:"round",parameters:[{argumentType:s.FunctionArgumentType.NUMBER},{argumentType:s.FunctionArgumentType.NUMBER,defaultValue:0}]},INT:{method:"intFunc",parameters:[{argumentType:s.FunctionArgumentType.NUMBER}]},EVEN:{method:"even",parameters:[{argumentType:s.FunctionArgumentType.NUMBER}]},ODD:{method:"odd",parameters:[{argumentType:s.FunctionArgumentType.NUMBER}]},"CEILING.MATH":{method:"ceilingmath",parameters:[{argumentType:s.FunctionArgumentType.NUMBER},{argumentType:s.FunctionArgumentType.NUMBER,defaultValue:1},{argumentType:s.FunctionArgumentType.NUMBER,defaultValue:0}]},CEILING:{method:"ceiling",parameters:[{argumentType:s.FunctionArgumentType.NUMBER},{argumentType:s.FunctionArgumentType.NUMBER}]},"CEILING.PRECISE":{method:"ceilingprecise",parameters:[{argumentType:s.FunctionArgumentType.NUMBER},{argumentType:s.FunctionArgumentType.NUMBER,defaultValue:1}]},"FLOOR.MATH":{method:"floormath",parameters:[{argumentType:s.FunctionArgumentType.NUMBER},{argumentType:s.FunctionArgumentType.NUMBER,defaultValue:1},{argumentType:s.FunctionArgumentType.NUMBER,defaultValue:0}]},FLOOR:{method:"floor",parameters:[{argumentType:s.FunctionArgumentType.NUMBER},{argumentType:s.FunctionArgumentType.NUMBER}]},"FLOOR.PRECISE":{method:"floorprecise",parameters:[{argumentType:s.FunctionArgumentType.NUMBER},{argumentType:s.FunctionArgumentType.NUMBER,defaultValue:1}]}},u.aliases={"ISO.CEILING":"CEILING.PRECISE",TRUNC:"ROUNDDOWN"}},function(e,t,r){"use strict";t.__esModule=!0,t.SqrtPlugin=void 0;var n=r(167);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class o extends n.FunctionPlugin{sqrt(e,t){return this.runFunction(e.args,t,this.metadata("SQRT"),Math.sqrt)}}t.SqrtPlugin=o,o.implementedFunctions={SQRT:{method:"sqrt",parameters:[{argumentType:n.FunctionArgumentType.NUMBER}]}}},function(e,t,r){"use strict";t.__esModule=!0,t.ConditionalAggregationPlugin=void 0,r(2);var n=r(73),o=r(131),s=r(251),i=r(140),a=r(167);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
class u{constructor(e,t){this.sum=e,this.count=t}static single(e){return new u(e,1)}compose(e){return new u(this.sum+e.sum,this.count+e.count)}averageValue(){return this.count>0?this.sum/this.count:void 0}}function c(e){return(0,i.isExtendedNumber)(e)&&!Number.isFinite((0,i.getRawValue)(e))?0:e}function l(e){return e instanceof n.CellError?e:(0,i.isExtendedNumber)(e)?(0,i.getRawValue)(e):void 0}u.empty=new u(0,0);class h extends a.FunctionPlugin{sumif(e,t){return this.runFunction(e.args,t,this.metadata("SUMIF"),(e,t,r)=>this.computeConditionalAggregationFunction(null!=r?r:e,[e,t],"SUMIF",0,(e,t)=>this.arithmeticHelper.nonstrictadd(e,t),l))}sumifs(e,t){return this.runFunction(e.args,t,this.metadata("SUMIFS"),(e,...t)=>this.computeConditionalAggregationFunction(e,t,"SUMIFS",0,(e,t)=>this.arithmeticHelper.nonstrictadd(e,t),l))}averageif(e,t){return this.runFunction(e.args,t,this.metadata("AVERAGEIF"),(e,t,r)=>{const o=this.computeConditionalAggregationFunction(null!=r?r:e,[e,t],"AVERAGEIF",u.empty,(e,t)=>e.compose(t),e=>(0,i.isExtendedNumber)(e)?u.single((0,i.getRawValue)(e)):u.empty);return o instanceof n.CellError?o:o.averageValue()||new n.CellError(n.ErrorType.DIV_BY_ZERO)})}countif(e,t){return this.runFunction(e.args,t,this.metadata("COUNTIF"),(e,t)=>this.computeConditionalAggregationFunction(e,[e,t],"COUNTIF",0,(e,t)=>e+t,()=>1))}countifs(e,t){return this.runFunction(e.args,t,this.metadata("COUNTIFS"),(...e)=>this.computeConditionalAggregationFunction(e[0],e,"COUNTIFS",0,(e,t)=>e+t,()=>1))}minifs(e,t){const r=(e,t)=>void 0===t||void 0===e?void 0===t?e:t:Math.min(e,t);return this.runFunction(e.args,t,this.metadata("MINIFS"),(e,...t)=>c(this.computeConditionalAggregationFunction(e,t,"MINIFS",Number.POSITIVE_INFINITY,r,l)))}maxifs(e,t){const r=(e,t)=>void 0===t||void 0===e?void 0===t?e:t:Math.max(e,t);return this.runFunction(e.args,t,this.metadata("MAXIFS"),(e,...t)=>c(this.computeConditionalAggregationFunction(e,t,"MAXIFS",Number.NEGATIVE_INFINITY,r,l)))}computeConditionalAggregationFunction(e,t,r,i,a,u){const c=[];for(let e=0;e<t.length;e+=2){const r=t[e],i=this.interpreter.criterionBuilder.fromCellValue(t[e+1],this.arithmeticHelper);if(void 0===i)return new n.CellError(n.ErrorType.VALUE,o.ErrorMessage.BadCriterion);c.push(new s.Condition(r,i))}return new s.CriterionFunctionCompute(this.interpreter,function(e){return t=>{const r=t.map(e=>`${e.conditionRange.range.sheet},${e.conditionRange.range.start.col},${e.conditionRange.range.start.row}`);return[e,...r].join(",")}}(r),i,a,u).compute(e,c)}}t.ConditionalAggregationPlugin=h,h.implementedFunctions={SUMIF:{method:"sumif",parameters:[{argumentType:a.FunctionArgumentType.RANGE},{argumentType:a.FunctionArgumentType.NOERROR},{argumentType:a.FunctionArgumentType.RANGE,optionalArg:!0}]},COUNTIF:{method:"countif",parameters:[{argumentType:a.FunctionArgumentType.RANGE},{argumentType:a.FunctionArgumentType.NOERROR}]},AVERAGEIF:{method:"averageif",parameters:[{argumentType:a.FunctionArgumentType.RANGE},{argumentType:a.FunctionArgumentType.NOERROR},{argumentType:a.FunctionArgumentType.RANGE,optionalArg:!0}]},SUMIFS:{method:"sumifs",parameters:[{argumentType:a.FunctionArgumentType.RANGE},{argumentType:a.FunctionArgumentType.RANGE},{argumentType:a.FunctionArgumentType.NOERROR}],repeatLastArgs:2},COUNTIFS:{method:"countifs",parameters:[{argumentType:a.FunctionArgumentType.RANGE},{argumentType:a.FunctionArgumentType.NOERROR}],repeatLastArgs:2},MINIFS:{method:"minifs",parameters:[{argumentType:a.FunctionArgumentType.RANGE},{argumentType:a.FunctionArgumentType.RANGE},{argumentType:a.FunctionArgumentType.NOERROR}],repeatLastArgs:2},MAXIFS:{method:"maxifs",parameters:[{argumentType:a.FunctionArgumentType.RANGE},{argumentType:a.FunctionArgumentType.RANGE},{argumentType:a.FunctionArgumentType.NOERROR}],repeatLastArgs:2}}},function(e,t,r){"use strict";t.__esModule=!0,t.CriterionFunctionCompute=t.Condition=void 0,r(2);var n=r(73),o=r(131),s=r(252),i=r(140);function*a(e,t){for(const r of t.addresses(e))yield(0,i.getRawValue)(e.getScalarValue(r))}function*u(e,t,r){for(const n of r){const r=t.map(e=>(0,s.split)(e));if(!r.every(e=>Object.prototype.hasOwnProperty.call(e,"value")))return;c(r.map(e=>(0,i.getRawValue)(e.value)),e).every(([e,t])=>t(e))&&(yield n),t=r.map(e=>e.rest)}}function c(e,t){const r=[];for(let n=0;n<Math.min(e.length,t.length);n++)r.push([e[n],t[n]]);return r}t.CriterionFunctionCompute=class{constructor(e,t,r,n,o){this.interpreter=e,this.cacheKey=t,this.reduceInitialValue=r,this.composeFunction=n,this.mapFunction=o,this.dependencyGraph=this.interpreter.dependencyGraph}compute(e,t){for(const r of t)if(!r.conditionRange.sameDimensionsAs(e))return new n.CellError(n.ErrorType.VALUE,o.ErrorMessage.EqualLength);const r=this.tryToGetRangeVertexForRangeValue(e),s=t.map(e=>this.tryToGetRangeVertexForRangeValue(e.conditionRange));if(r&&s.every(e=>void 0!==e)){const n=t.map(e=>e.criterionPackage.raw).join(","),o=this.findAlreadyComputedValueInCache(r,this.cacheKey(t),n);if(void 0!==o)return this.interpreter.stats.incrementCriterionFunctionFullCacheUsed(),o;const i=this.buildNewCriterionCache(this.cacheKey(t),t.map(e=>e.conditionRange.range),e.range);return i.has(n)||i.set(n,[this.evaluateRangeValue(e,t),t.map(e=>e.criterionPackage.lambda)]),r.setCriterionFunctionValues(this.cacheKey(t),i),s.forEach(e=>{void 0!==e&&e.addDependentCacheRange(r)}),i.get(n)[0]}return this.evaluateRangeValue(e,t)}tryToGetRangeVertexForRangeValue(e){const t=e.range;return void 0===t?void 0:this.dependencyGraph.getRange(t.start,t.end)}reduceFunction(e){let t=this.reduceInitialValue;for(const r of e)t=this.composeFunction(t,r);return t}findAlreadyComputedValueInCache(e,t,r){return e.getCriterionFunctionValue(t,r)}evaluateRangeValue(e,t){const r=t.map(e=>e.criterionPackage.lambda),n=Array.from(e.valuesFromTopLeftCorner()).map(this.mapFunction)[Symbol.iterator](),o=u(r,t.map(e=>e.conditionRange.iterateValuesFromTopLeftCorner()),n);return this.reduceFunction(o)}buildNewCriterionCache(e,t,r){const o=this.dependencyGraph.getRange(r.start,r.end),{smallerRangeVertex:s,restConditionRanges:i,restValuesRange:c}=((e,t,r)=>{if(r.end.row>r.start.row){const o=(0,n.simpleCellAddress)(r.end.sheet,r.end.col,r.end.row-1),s=e.getRange(r.start,o);if(void 0!==s)return{smallerRangeVertex:s,restValuesRange:r.withStart((0,n.simpleCellAddress)(r.start.sheet,r.start.col,r.end.row)),restConditionRanges:t.map(e=>e.withStart((0,n.simpleCellAddress)(e.start.sheet,e.start.col,e.end.row)))}}return{restValuesRange:r,restConditionRanges:t}})(this.dependencyGraph,t,r);let l;l=void 0!==s&&this.dependencyGraph.existsEdge(s,o)?s.getCriterionFunctionValues(e):new Map;const h=new Map;return l.forEach(([e,t],r)=>{const n=u(t,i.map(e=>a(this.dependencyGraph,e)),Array.from(a(this.dependencyGraph,c)).map(this.mapFunction)[Symbol.iterator]()),o=this.composeFunction(e,this.reduceFunction(n));this.interpreter.stats.incrementCriterionFunctionPartialCacheUsed(),h.set(r,[o,t])}),h}},t.Condition=class{constructor(e,t){this.conditionRange=e,this.criterionPackage=t}}},function(e,t,r){"use strict";
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
function*n(){}t.__esModule=!0,t.empty=n,t.first=function(e){const t=e[Symbol.iterator](),{done:r,value:n}=t.next();if(!r)return n},t.split=function(e){const t=e[Symbol.iterator](),{done:r,value:o}=t.next();return r?{rest:n()}:{value:o,rest:t}}},function(e,t,r){"use strict";t.__esModule=!0,t.SumprodPlugin=void 0;var n=r(73),o=r(131),s=r(140),i=r(167);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
class a extends i.FunctionPlugin{sumproduct(e,t){return this.runFunction(e.args,t,this.metadata("SUMPRODUCT"),(...e)=>{const t=e[0].width(),r=e[0].height();for(const s of e)if(s.width()!==t||s.height()!==r)return new n.CellError(n.ErrorType.VALUE,o.ErrorMessage.EqualLength);let i=0;const a=e.map(e=>e.iterateValuesFromTopLeftCorner());for(let e=0;e<t*r;e++){let e=1;for(const t of a){const r=t.next().value;if(r instanceof n.CellError)return r;const o=this.coerceScalarToNumberOrError(r);(0,s.isExtendedNumber)(o)?e*=(0,s.getRawValue)(o):e=0}i+=e}return i})}}t.SumprodPlugin=a,a.implementedFunctions={SUMPRODUCT:{method:"sumproduct",parameters:[{argumentType:i.FunctionArgumentType.RANGE}],repeatLastArgs:1}}},function(e,t,r){"use strict";t.__esModule=!0,t.TextPlugin=void 0;var n=r(73),o=r(131),s=r(167);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
class i extends s.FunctionPlugin{concatenate(e,t){return this.runFunction(e.args,t,this.metadata("CONCATENATE"),(...e)=>"".concat(...e))}split(e,t){return this.runFunction(e.args,t,this.metadata("SPLIT"),(e,t)=>{const r=e.split(" ");return t>=r.length||t<0?new n.CellError(n.ErrorType.VALUE,o.ErrorMessage.IndexBounds):r[t]})}len(e,t){return this.runFunction(e.args,t,this.metadata("LEN"),e=>e.length)}lower(e,t){return this.runFunction(e.args,t,this.metadata("LOWER"),e=>e.toLowerCase())}trim(e,t){return this.runFunction(e.args,t,this.metadata("TRIM"),e=>e.replace(/^ +| +$/g,"").replace(/ +/g," "))}proper(e,t){return this.runFunction(e.args,t,this.metadata("PROPER"),e=>e.replace(/\p{L}+/gu,e=>e.charAt(0).toUpperCase()+e.substring(1).toLowerCase()))}clean(e,t){return this.runFunction(e.args,t,this.metadata("CLEAN"),e=>e.replace(/[\u0000-\u001F]/g,""))}exact(e,t){return this.runFunction(e.args,t,this.metadata("EXACT"),(e,t)=>e===t)}rept(e,t){return this.runFunction(e.args,t,this.metadata("REPT"),(e,t)=>t<0?new n.CellError(n.ErrorType.VALUE,o.ErrorMessage.NegativeCount):e.repeat(t))}right(e,t){return this.runFunction(e.args,t,this.metadata("RIGHT"),(e,t)=>t<0?new n.CellError(n.ErrorType.VALUE,o.ErrorMessage.NegativeLength):0===t?"":e.slice(-t))}left(e,t){return this.runFunction(e.args,t,this.metadata("LEFT"),(e,t)=>t<0?new n.CellError(n.ErrorType.VALUE,o.ErrorMessage.NegativeLength):e.slice(0,t))}mid(e,t){return this.runFunction(e.args,t,this.metadata("MID"),(e,t,r)=>t<1?new n.CellError(n.ErrorType.VALUE,o.ErrorMessage.LessThanOne):r<0?new n.CellError(n.ErrorType.VALUE,o.ErrorMessage.NegativeLength):e.substring(t-1,t+r-1))}replace(e,t){return this.runFunction(e.args,t,this.metadata("REPLACE"),(e,t,r,s)=>t<1?new n.CellError(n.ErrorType.VALUE,o.ErrorMessage.LessThanOne):r<0?new n.CellError(n.ErrorType.VALUE,o.ErrorMessage.NegativeLength):e.substring(0,t-1)+s+e.substring(t+r-1))}search(e,t){return this.runFunction(e.args,t,this.metadata("SEARCH"),(e,t,r)=>{if(r<1||r>t.length)return new n.CellError(n.ErrorType.VALUE,o.ErrorMessage.LengthBounds);const s=e.toLowerCase(),i=t.substring(r-1).toLowerCase(),a=this.arithmeticHelper.requiresRegex(s)?this.arithmeticHelper.searchString(s,i):i.indexOf(s);return a>-1?a+r:new n.CellError(n.ErrorType.VALUE,o.ErrorMessage.PatternNotFound)})}substitute(e,t){return this.runFunction(e.args,t,this.metadata("SUBSTITUTE"),(e,t,r,s)=>{const i=this.escapeRegExpSpecialCharacters(t),a=new RegExp(i,"g");if(void 0===s)return e.replace(a,r);if(s<1)return new n.CellError(n.ErrorType.VALUE,o.ErrorMessage.LessThanOne);let u,c=0;for(;null!==(u=a.exec(e));)if(s===++c)return e.substring(0,u.index)+r+e.substring(a.lastIndex);return e})}find(e,t){return this.runFunction(e.args,t,this.metadata("FIND"),(e,t,r)=>{if(r<1||r>t.length)return new n.CellError(n.ErrorType.VALUE,o.ErrorMessage.IndexBounds);const s=t.substring(r-1).indexOf(e)+r;return s>0?s:new n.CellError(n.ErrorType.VALUE,o.ErrorMessage.PatternNotFound)})}t(e,t){return this.runFunction(e.args,t,this.metadata("T"),e=>e instanceof n.CellError||"string"==typeof e?e:"")}upper(e,t){return this.runFunction(e.args,t,this.metadata("UPPER"),e=>e.toUpperCase())}escapeRegExpSpecialCharacters(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}}t.TextPlugin=i,i.implementedFunctions={CONCATENATE:{method:"concatenate",parameters:[{argumentType:s.FunctionArgumentType.STRING}],repeatLastArgs:1,expandRanges:!0},EXACT:{method:"exact",parameters:[{argumentType:s.FunctionArgumentType.STRING},{argumentType:s.FunctionArgumentType.STRING}]},SPLIT:{method:"split",parameters:[{argumentType:s.FunctionArgumentType.STRING},{argumentType:s.FunctionArgumentType.NUMBER}]},LEN:{method:"len",parameters:[{argumentType:s.FunctionArgumentType.STRING}]},LOWER:{method:"lower",parameters:[{argumentType:s.FunctionArgumentType.STRING}]},MID:{method:"mid",parameters:[{argumentType:s.FunctionArgumentType.STRING},{argumentType:s.FunctionArgumentType.NUMBER},{argumentType:s.FunctionArgumentType.NUMBER}]},TRIM:{method:"trim",parameters:[{argumentType:s.FunctionArgumentType.STRING}]},T:{method:"t",parameters:[{argumentType:s.FunctionArgumentType.SCALAR}]},PROPER:{method:"proper",parameters:[{argumentType:s.FunctionArgumentType.STRING}]},CLEAN:{method:"clean",parameters:[{argumentType:s.FunctionArgumentType.STRING}]},REPT:{method:"rept",parameters:[{argumentType:s.FunctionArgumentType.STRING},{argumentType:s.FunctionArgumentType.NUMBER}]},RIGHT:{method:"right",parameters:[{argumentType:s.FunctionArgumentType.STRING},{argumentType:s.FunctionArgumentType.NUMBER,defaultValue:1}]},LEFT:{method:"left",parameters:[{argumentType:s.FunctionArgumentType.STRING},{argumentType:s.FunctionArgumentType.NUMBER,defaultValue:1}]},REPLACE:{method:"replace",parameters:[{argumentType:s.FunctionArgumentType.STRING},{argumentType:s.FunctionArgumentType.NUMBER},{argumentType:s.FunctionArgumentType.NUMBER},{argumentType:s.FunctionArgumentType.STRING}]},SEARCH:{method:"search",parameters:[{argumentType:s.FunctionArgumentType.STRING},{argumentType:s.FunctionArgumentType.STRING},{argumentType:s.FunctionArgumentType.NUMBER,defaultValue:1}]},SUBSTITUTE:{method:"substitute",parameters:[{argumentType:s.FunctionArgumentType.STRING},{argumentType:s.FunctionArgumentType.STRING},{argumentType:s.FunctionArgumentType.STRING},{argumentType:s.FunctionArgumentType.NUMBER,optionalArg:!0}]},FIND:{method:"find",parameters:[{argumentType:s.FunctionArgumentType.STRING},{argumentType:s.FunctionArgumentType.STRING},{argumentType:s.FunctionArgumentType.NUMBER,defaultValue:1}]},UPPER:{method:"upper",parameters:[{argumentType:s.FunctionArgumentType.STRING}]}}},function(e,t,r){"use strict";t.__esModule=!0,t.TrigonometryPlugin=void 0;var n=r(73),o=r(131),s=r(167),i=r(239);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
class a extends s.FunctionPlugin{acos(e,t){return this.runFunction(e.args,t,this.metadata("ACOS"),Math.acos)}asin(e,t){return this.runFunction(e.args,t,this.metadata("ASIN"),Math.asin)}cos(e,t){return this.runFunction(e.args,t,this.metadata("COS"),Math.cos)}sin(e,t){return this.runFunction(e.args,t,this.metadata("SIN"),Math.sin)}tan(e,t){return this.runFunction(e.args,t,this.metadata("TAN"),Math.tan)}atan(e,t){return this.runFunction(e.args,t,this.metadata("ATAN"),Math.atan)}atan2(e,t){return this.runFunction(e.args,t,this.metadata("ATAN2"),(e,t)=>0===e&&0===t?new n.CellError(n.ErrorType.DIV_BY_ZERO):Math.atan2(t,e))}cot(e,t){return this.runFunction(e.args,t,this.metadata("COT"),e=>0===e?new n.CellError(n.ErrorType.DIV_BY_ZERO):1/Math.tan(e))}acot(e,t){return this.runFunction(e.args,t,this.metadata("ACOT"),e=>0===e?i.PI/2:Math.atan(1/e))}sec(e,t){return this.runFunction(e.args,t,this.metadata("SEC"),e=>1/Math.cos(e))}csc(e,t){return this.runFunction(e.args,t,this.metadata("CSC"),e=>0===e?new n.CellError(n.ErrorType.DIV_BY_ZERO):1/Math.sin(e))}sinh(e,t){return this.runFunction(e.args,t,this.metadata("SINH"),Math.sinh)}asinh(e,t){return this.runFunction(e.args,t,this.metadata("ASINH"),Math.asinh)}cosh(e,t){return this.runFunction(e.args,t,this.metadata("COSH"),Math.cosh)}acosh(e,t){return this.runFunction(e.args,t,this.metadata("ACOSH"),Math.acosh)}tanh(e,t){return this.runFunction(e.args,t,this.metadata("TANH"),Math.tanh)}atanh(e,t){return this.runFunction(e.args,t,this.metadata("ATANH"),Math.atanh)}coth(e,t){return this.runFunction(e.args,t,this.metadata("COTH"),e=>0===e?new n.CellError(n.ErrorType.DIV_BY_ZERO):1/Math.tanh(e))}acoth(e,t){return this.runFunction(e.args,t,this.metadata("ACOTH"),e=>0===e?new n.CellError(n.ErrorType.NUM,o.ErrorMessage.NonZero):Math.atanh(1/e))}sech(e,t){return this.runFunction(e.args,t,this.metadata("SECH"),e=>1/Math.cosh(e))}csch(e,t){return this.runFunction(e.args,t,this.metadata("CSCH"),e=>0===e?new n.CellError(n.ErrorType.DIV_BY_ZERO):1/Math.sinh(e))}}t.TrigonometryPlugin=a,a.implementedFunctions={ACOS:{method:"acos",parameters:[{argumentType:s.FunctionArgumentType.NUMBER}]},ASIN:{method:"asin",parameters:[{argumentType:s.FunctionArgumentType.NUMBER}]},COS:{method:"cos",parameters:[{argumentType:s.FunctionArgumentType.NUMBER}]},SIN:{method:"sin",parameters:[{argumentType:s.FunctionArgumentType.NUMBER}]},TAN:{method:"tan",parameters:[{argumentType:s.FunctionArgumentType.NUMBER}]},ATAN:{method:"atan",parameters:[{argumentType:s.FunctionArgumentType.NUMBER}]},ATAN2:{method:"atan2",parameters:[{argumentType:s.FunctionArgumentType.NUMBER},{argumentType:s.FunctionArgumentType.NUMBER}]},COT:{method:"cot",parameters:[{argumentType:s.FunctionArgumentType.NUMBER}]},SEC:{method:"sec",parameters:[{argumentType:s.FunctionArgumentType.NUMBER}]},CSC:{method:"csc",parameters:[{argumentType:s.FunctionArgumentType.NUMBER}]},SINH:{method:"sinh",parameters:[{argumentType:s.FunctionArgumentType.NUMBER}]},COSH:{method:"cosh",parameters:[{argumentType:s.FunctionArgumentType.NUMBER}]},TANH:{method:"tanh",parameters:[{argumentType:s.FunctionArgumentType.NUMBER}]},COTH:{method:"coth",parameters:[{argumentType:s.FunctionArgumentType.NUMBER}]},SECH:{method:"sech",parameters:[{argumentType:s.FunctionArgumentType.NUMBER}]},CSCH:{method:"csch",parameters:[{argumentType:s.FunctionArgumentType.NUMBER}]},ACOT:{method:"acot",parameters:[{argumentType:s.FunctionArgumentType.NUMBER}]},ASINH:{method:"asinh",parameters:[{argumentType:s.FunctionArgumentType.NUMBER}]},ACOSH:{method:"acosh",parameters:[{argumentType:s.FunctionArgumentType.NUMBER}]},ATANH:{method:"atanh",parameters:[{argumentType:s.FunctionArgumentType.NUMBER}]},ACOTH:{method:"acoth",parameters:[{argumentType:s.FunctionArgumentType.NUMBER}]}}},function(e,t,r){"use strict";t.__esModule=!0,t.LookupPlugin=void 0;var n=r(72),o=r(73),s=r(131),i=r(257),a=r(142),u=r(168),c=r(139),l=r(167);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
class h extends l.FunctionPlugin{constructor(){super(...arguments),this.rowSearch=new i.RowSearchStrategy(this.dependencyGraph)}vlookup(e,t){return this.runFunction(e.args,t,this.metadata("VLOOKUP"),(e,t,r,n)=>{const i=t.range;return void 0===i?new o.CellError(o.ErrorType.VALUE,s.ErrorMessage.WrongType):r<1?new o.CellError(o.ErrorType.VALUE,s.ErrorMessage.LessThanOne):r>i.width()?new o.CellError(o.ErrorType.REF,s.ErrorMessage.IndexLarge):this.doVlookup((0,u.zeroIfEmpty)(e),t,r-1,n)})}hlookup(e,t){return this.runFunction(e.args,t,this.metadata("HLOOKUP"),(e,t,r,n)=>{const i=t.range;return void 0===i?new o.CellError(o.ErrorType.VALUE,s.ErrorMessage.WrongType):r<1?new o.CellError(o.ErrorType.VALUE,s.ErrorMessage.LessThanOne):r>i.height()?new o.CellError(o.ErrorType.REF,s.ErrorMessage.IndexLarge):this.doHlookup((0,u.zeroIfEmpty)(e),t,r-1,n)})}match(e,t){return this.runFunction(e.args,t,this.metadata("MATCH"),(e,t,r)=>this.doMatch((0,u.zeroIfEmpty)(e),t,r))}searchInRange(e,t,r,n){if(!r&&"string"==typeof e&&this.arithmeticHelper.requiresRegex(e))return n.advancedFind(this.arithmeticHelper.eqMatcherFunction(e),t);{const o=r?{ordering:"asc"}:{ordering:"none",matchExactly:!0};return n.find(e,t,o)}}doVlookup(e,t,r,i){this.dependencyGraph.stats.start(a.StatType.VLOOKUP);const u=t.range;let l;l=void 0===u?c.SimpleRangeValue.onlyValues(t.data.map(e=>[e[0]])):c.SimpleRangeValue.onlyRange(n.AbsoluteCellRange.spanFrom(u.start,1,u.height()),this.dependencyGraph);const h=this.searchInRange(e,l,i,this.columnSearch);if(this.dependencyGraph.stats.end(a.StatType.VLOOKUP),-1===h)return new o.CellError(o.ErrorType.NA,s.ErrorMessage.ValueNotFound);let d;if(void 0===u)d=t.data[h][r];else{const e=(0,o.simpleCellAddress)(u.sheet,u.start.col+r,u.start.row+h);d=this.dependencyGraph.getCellValue(e)}return d instanceof c.SimpleRangeValue?new o.CellError(o.ErrorType.VALUE,s.ErrorMessage.WrongType):d}doHlookup(e,t,r,i){const a=t.range;let u;u=void 0===a?c.SimpleRangeValue.onlyValues([t.data[0]]):c.SimpleRangeValue.onlyRange(n.AbsoluteCellRange.spanFrom(a.start,a.width(),1),this.dependencyGraph);const l=this.searchInRange(e,u,i,this.rowSearch);if(-1===l)return new o.CellError(o.ErrorType.NA,s.ErrorMessage.ValueNotFound);let h;if(void 0===a)h=t.data[r][l];else{const e=(0,o.simpleCellAddress)(a.sheet,a.start.col+l,a.start.row+r);h=this.dependencyGraph.getCellValue(e)}return h instanceof c.SimpleRangeValue?new o.CellError(o.ErrorType.VALUE,s.ErrorMessage.WrongType):h}doMatch(e,t,r){if(![-1,0,1].includes(r))return new o.CellError(o.ErrorType.VALUE,s.ErrorMessage.BadMode);if(t.width()>1&&t.height()>1)return new o.CellError(o.ErrorType.NA);const n=0===r?{ordering:"none",matchExactly:!0}:{ordering:-1===r?"desc":"asc"},i=(1===t.width()?this.columnSearch:this.rowSearch).find(e,t,n);return-1===i?new o.CellError(o.ErrorType.NA,s.ErrorMessage.ValueNotFound):i+1}}t.LookupPlugin=h,h.implementedFunctions={VLOOKUP:{method:"vlookup",parameters:[{argumentType:l.FunctionArgumentType.NOERROR},{argumentType:l.FunctionArgumentType.RANGE},{argumentType:l.FunctionArgumentType.NUMBER},{argumentType:l.FunctionArgumentType.BOOLEAN,defaultValue:!0}]},HLOOKUP:{method:"hlookup",parameters:[{argumentType:l.FunctionArgumentType.NOERROR},{argumentType:l.FunctionArgumentType.RANGE},{argumentType:l.FunctionArgumentType.NUMBER},{argumentType:l.FunctionArgumentType.BOOLEAN,defaultValue:!0}]},MATCH:{method:"match",parameters:[{argumentType:l.FunctionArgumentType.NOERROR},{argumentType:l.FunctionArgumentType.RANGE},{argumentType:l.FunctionArgumentType.NUMBER,defaultValue:1}]}}},function(e,t,r){"use strict";t.__esModule=!0,t.RowSearchStrategy=void 0;var n=r(208);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class o extends n.AdvancedFind{constructor(e){super(e),this.dependencyGraph=e}find(e,t,r){return this.basicFind(e,t,"col",r)}}t.RowSearchStrategy=o},function(e,t,r){"use strict";t.__esModule=!0,t.RomanPlugin=void 0;var n=r(73),o=r(131),s=r(140),i=r(167);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
class a extends i.FunctionPlugin{roman(e,t){return this.runFunction(e.args,t,this.metadata("ROMAN"),(e,t)=>(e=Math.trunc(e),!1===t?t=4:!0===t&&(t=0),(t=(0,s.getRawValue)(this.coerceScalarToNumberOrError(t)))instanceof n.CellError?t:(t=Math.trunc(t))<0?new n.CellError(n.ErrorType.VALUE,o.ErrorMessage.ValueSmall):t>4?new n.CellError(n.ErrorType.VALUE,o.ErrorMessage.ValueLarge):function(e,t){const r={val:e%1e3,acc:"M".repeat(Math.floor(e/1e3))};return 4===t&&(c(r,"IM",999,1e3),c(r,"ID",499,500)),t>=3&&(c(r,"VM",995,1e3),c(r,"VD",495,500)),t>=2&&(c(r,"XM",990,1e3),c(r,"XD",490,500)),t>=1&&(c(r,"LM",950,1e3),c(r,"LD",450,500)),c(r,"CM",900,1e3),c(r,"CD",400,500),c(r,"D",500,900),r.acc+="C".repeat(Math.floor(r.val/100)),r.val%=100,t>=2&&(c(r,"IC",99,100),c(r,"IL",49,50)),t>=1&&(c(r,"VC",95,100),c(r,"VL",45,50)),c(r,"XC",90,100),c(r,"XL",40,50),c(r,"L",50,90),r.acc+="X".repeat(Math.floor(r.val/10)),r.val%=10,c(r,"IX",9,10),c(r,"IV",4,5),c(r,"V",5,9),r.acc+="I".repeat(r.val),r.acc}(e,t)))}arabic(e,t){return this.runFunction(e.args,t,this.metadata("ARABIC"),e=>{let t=!1;if((e=e.trim().toUpperCase()).startsWith("-")&&(t=!0,""===(e=e.slice(1))))return new n.CellError(n.ErrorType.VALUE,o.ErrorMessage.InvalidRoman);const r={input:e,acc:0};return u(r,{token:"MMM",val:3e3},{token:"MM",val:2e3},{token:"M",val:1e3}),u(r,{token:"IM",val:999},{token:"VM",val:995},{token:"XM",val:990},{token:"LM",val:950},{token:"CM",val:900}),u(r,{token:"D",val:500},{token:"ID",val:499},{token:"VD",val:495},{token:"XD",val:490},{token:"LD",val:450},{token:"CD",val:400}),u(r,{token:"CCC",val:300},{token:"CC",val:200},{token:"C",val:100}),u(r,{token:"IC",val:99},{token:"VC",val:95},{token:"XC",val:90}),u(r,{token:"L",val:50},{token:"IL",val:49},{token:"VL",val:45},{token:"XL",val:40}),u(r,{token:"XXX",val:30},{token:"XX",val:20},{token:"X",val:10}),u(r,{token:"IX",val:9}),u(r,{token:"V",val:5},{token:"IV",val:4}),u(r,{token:"III",val:3},{token:"II",val:2},{token:"I",val:1}),""!==r.input?new n.CellError(n.ErrorType.VALUE,o.ErrorMessage.InvalidRoman):t?-r.acc:r.acc})}}function u(e,...t){for(const r of t)if(e.input.startsWith(r.token)){e.input=e.input.slice(r.token.length),e.acc+=r.val;break}}function c(e,t,r,n){e.val>=r&&e.val<n&&(e.val-=r,e.acc+=t)}t.RomanPlugin=a,a.implementedFunctions={ROMAN:{method:"roman",parameters:[{argumentType:i.FunctionArgumentType.NUMBER,minValue:1,lessThan:4e3},{argumentType:i.FunctionArgumentType.NOERROR,optionalArg:!0,defaultValue:0}]},ARABIC:{method:"arabic",parameters:[{argumentType:i.FunctionArgumentType.STRING}]}}},function(e,t,r){"use strict";t.__esModule=!0,t.SimpleArithmerticPlugin=void 0;var n=r(167);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class o extends n.FunctionPlugin{add(e,t){return this.runFunction(e.args,t,this.metadata("HF.ADD"),this.arithmeticHelper.addWithEpsilon)}concat(e,t){return this.runFunction(e.args,t,this.metadata("HF.CONCAT"),this.arithmeticHelper.concat)}divide(e,t){return this.runFunction(e.args,t,this.metadata("HF.DIVIDE"),this.arithmeticHelper.divide)}eq(e,t){return this.runFunction(e.args,t,this.metadata("HF.EQ"),this.arithmeticHelper.eq)}gt(e,t){return this.runFunction(e.args,t,this.metadata("HF.GT"),this.arithmeticHelper.gt)}gte(e,t){return this.runFunction(e.args,t,this.metadata("HF.GTE"),this.arithmeticHelper.geq)}lt(e,t){return this.runFunction(e.args,t,this.metadata("HF.LT"),this.arithmeticHelper.lt)}lte(e,t){return this.runFunction(e.args,t,this.metadata("HF.LTE"),this.arithmeticHelper.leq)}minus(e,t){return this.runFunction(e.args,t,this.metadata("HF.MINUS"),this.arithmeticHelper.subtract)}multiply(e,t){return this.runFunction(e.args,t,this.metadata("HF.MULTIPLY"),this.arithmeticHelper.multiply)}ne(e,t){return this.runFunction(e.args,t,this.metadata("HF.NE"),this.arithmeticHelper.neq)}pow(e,t){return this.runFunction(e.args,t,this.metadata("HF.POW"),this.arithmeticHelper.pow)}uminus(e,t){return this.runFunction(e.args,t,this.metadata("HF.UMINUS"),this.arithmeticHelper.unaryMinus)}upercent(e,t){return this.runFunction(e.args,t,this.metadata("HF.UNARY_PERCENT"),this.arithmeticHelper.unaryPercent)}uplus(e,t){return this.runFunction(e.args,t,this.metadata("HF.UPLUS"),this.arithmeticHelper.unaryPlus)}}t.SimpleArithmerticPlugin=o,o.implementedFunctions={"HF.ADD":{method:"add",parameters:[{argumentType:n.FunctionArgumentType.NUMBER,passSubtype:!0},{argumentType:n.FunctionArgumentType.NUMBER,passSubtype:!0}]},"HF.CONCAT":{method:"concat",parameters:[{argumentType:n.FunctionArgumentType.STRING,passSubtype:!0},{argumentType:n.FunctionArgumentType.STRING,passSubtype:!0}]},"HF.DIVIDE":{method:"divide",parameters:[{argumentType:n.FunctionArgumentType.NUMBER,passSubtype:!0},{argumentType:n.FunctionArgumentType.NUMBER,passSubtype:!0}]},"HF.EQ":{method:"eq",parameters:[{argumentType:n.FunctionArgumentType.NOERROR,passSubtype:!0},{argumentType:n.FunctionArgumentType.NOERROR,passSubtype:!0}]},"HF.GT":{method:"gt",parameters:[{argumentType:n.FunctionArgumentType.NOERROR,passSubtype:!0},{argumentType:n.FunctionArgumentType.NOERROR,passSubtype:!0}]},"HF.GTE":{method:"gte",parameters:[{argumentType:n.FunctionArgumentType.NOERROR,passSubtype:!0},{argumentType:n.FunctionArgumentType.NOERROR,passSubtype:!0}]},"HF.LT":{method:"lt",parameters:[{argumentType:n.FunctionArgumentType.NOERROR,passSubtype:!0},{argumentType:n.FunctionArgumentType.NOERROR,passSubtype:!0}]},"HF.LTE":{method:"lte",parameters:[{argumentType:n.FunctionArgumentType.NOERROR,passSubtype:!0},{argumentType:n.FunctionArgumentType.NOERROR,passSubtype:!0}]},"HF.MINUS":{method:"minus",parameters:[{argumentType:n.FunctionArgumentType.NUMBER,passSubtype:!0},{argumentType:n.FunctionArgumentType.NUMBER,passSubtype:!0}]},"HF.MULTIPLY":{method:"multiply",parameters:[{argumentType:n.FunctionArgumentType.NUMBER,passSubtype:!0},{argumentType:n.FunctionArgumentType.NUMBER,passSubtype:!0}]},"HF.NE":{method:"ne",parameters:[{argumentType:n.FunctionArgumentType.NOERROR,passSubtype:!0},{argumentType:n.FunctionArgumentType.NOERROR,passSubtype:!0}]},"HF.POW":{method:"pow",parameters:[{argumentType:n.FunctionArgumentType.NUMBER,passSubtype:!0},{argumentType:n.FunctionArgumentType.NUMBER,passSubtype:!0}]},"HF.UMINUS":{method:"uminus",parameters:[{argumentType:n.FunctionArgumentType.NUMBER,passSubtype:!0}]},"HF.UNARY_PERCENT":{method:"upercent",parameters:[{argumentType:n.FunctionArgumentType.NUMBER,passSubtype:!0}]},"HF.UPLUS":{method:"uplus",parameters:[{argumentType:n.FunctionArgumentType.NUMBER,passSubtype:!0}]}}},function(e,t,r){"use strict";t.__esModule=!0,t.StatisticalPlugin=void 0;var n=r(73),o=r(131),s=r(261),i=r(262),a=r(167);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
class u extends a.FunctionPlugin{erf(e,t){return this.runFunction(e.args,t,this.metadata("ERF"),(e,t)=>void 0===t?(0,i.erf)(e):(0,i.erf)(t)-(0,i.erf)(e))}erfc(e,t){return this.runFunction(e.args,t,this.metadata("ERFC"),i.erfc)}expondist(e,t){return this.runFunction(e.args,t,this.metadata("EXPON.DIST"),(e,t,r)=>r?i.exponential.cdf(e,t):i.exponential.pdf(e,t))}fisher(e,t){return this.runFunction(e.args,t,this.metadata("FISHER"),e=>Math.log((1+e)/(1-e))/2)}fisherinv(e,t){return this.runFunction(e.args,t,this.metadata("FISHERINV"),e=>1-2/(Math.exp(2*e)+1))}gamma(e,t){return this.runFunction(e.args,t,this.metadata("GAMMA"),i.gammafn)}gammadist(e,t){return this.runFunction(e.args,t,this.metadata("GAMMA.DIST"),(e,t,r,n)=>n?i.gamma.cdf(e,t,r):i.gamma.pdf(e,t,r))}gammaln(e,t){return this.runFunction(e.args,t,this.metadata("GAMMALN"),i.gammaln)}gammainv(e,t){return this.runFunction(e.args,t,this.metadata("GAMMA.INV"),i.gamma.inv)}gauss(e,t){return this.runFunction(e.args,t,this.metadata("GAUSS"),e=>i.normal.cdf(e,0,1)-.5)}betadist(e,t){return this.runFunction(e.args,t,this.metadata("BETA.DIST"),(e,t,r,s,a,u)=>e<=a?new n.CellError(n.ErrorType.NUM,o.ErrorMessage.ValueSmall):e>=u?new n.CellError(n.ErrorType.NUM,o.ErrorMessage.ValueLarge):(e=(e-a)/(u-a),s?i.beta.cdf(e,t,r):i.beta.pdf(e,t,r)))}betainv(e,t){return this.runFunction(e.args,t,this.metadata("BETA.INV"),(e,t,r,s,a)=>s>=a?new n.CellError(n.ErrorType.NUM,o.ErrorMessage.WrongOrder):i.beta.inv(e,t,r)*(a-s)+s)}binomialdist(e,t){return this.runFunction(e.args,t,this.metadata("BINOM.DIST"),(e,t,r,s)=>e>t?new n.CellError(n.ErrorType.NUM,o.ErrorMessage.WrongOrder):(e=Math.trunc(e),t=Math.trunc(t),s?i.binomial.cdf(e,t,r):i.binomial.pdf(e,t,r)))}binomialinv(e,t){return this.runFunction(e.args,t,this.metadata("BINOM.INV"),(e,t,r)=>{let n=-1,o=e=Math.trunc(e);for(;o>n+1;){const s=Math.trunc((n+o)/2);i.binomial.cdf(s,e,t)>=r?o=s:n=s}return o})}besselifn(e,t){return this.runFunction(e.args,t,this.metadata("BESSELI"),(e,t)=>(0,s.besseli)(e,Math.trunc(t)))}besseljfn(e,t){return this.runFunction(e.args,t,this.metadata("BESSELJ"),(e,t)=>(0,s.besselj)(e,Math.trunc(t)))}besselkfn(e,t){return this.runFunction(e.args,t,this.metadata("BESSELK"),(e,t)=>(0,s.besselk)(e,Math.trunc(t)))}besselyfn(e,t){return this.runFunction(e.args,t,this.metadata("BESSELY"),(e,t)=>(0,s.bessely)(e,Math.trunc(t)))}chisqdist(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.DIST"),(e,t,r)=>(t=Math.trunc(t),r?i.chisquare.cdf(e,t):i.chisquare.pdf(e,t)))}chisqdistrt(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.DIST.RT"),(e,t)=>1-i.chisquare.cdf(e,Math.trunc(t)))}chisqinv(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.INV"),(e,t)=>i.chisquare.inv(e,Math.trunc(t)))}chisqinvrt(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.INV.RT"),(e,t)=>i.chisquare.inv(1-e,Math.trunc(t)))}fdist(e,t){return this.runFunction(e.args,t,this.metadata("F.DIST"),(e,t,r,n)=>(t=Math.trunc(t),r=Math.trunc(r),n?i.centralF.cdf(e,t,r):i.centralF.pdf(e,t,r)))}fdistrt(e,t){return this.runFunction(e.args,t,this.metadata("F.DIST.RT"),(e,t,r)=>1-i.centralF.cdf(e,Math.trunc(t),Math.trunc(r)))}finv(e,t){return this.runFunction(e.args,t,this.metadata("F.INV"),(e,t,r)=>i.centralF.inv(e,Math.trunc(t),Math.trunc(r)))}finvrt(e,t){return this.runFunction(e.args,t,this.metadata("F.INV.RT"),(e,t,r)=>i.centralF.inv(1-e,Math.trunc(t),Math.trunc(r)))}weibulldist(e,t){return this.runFunction(e.args,t,this.metadata("WEIBULL.DIST"),(e,t,r,n)=>n?i.weibull.cdf(e,r,t):i.weibull.pdf(e,r,t))}poissondist(e,t){return this.runFunction(e.args,t,this.metadata("POISSON.DIST"),(e,t,r)=>(e=Math.trunc(e),r?i.poisson.cdf(e,t):i.poisson.pdf(e,t)))}hypgeomdist(e,t){return this.runFunction(e.args,t,this.metadata("HYPGEOM.DIST"),(e,t,r,s,a)=>e>t||e>r||t>s||r>s||e+s<r+t?new n.CellError(n.ErrorType.NUM,o.ErrorMessage.ValueLarge):(e=Math.trunc(e),t=Math.trunc(t),r=Math.trunc(r),s=Math.trunc(s),a?i.hypgeom.cdf(e,s,r,t):i.hypgeom.pdf(e,s,r,t)))}tdist(e,t){return this.runFunction(e.args,t,this.metadata("T.DIST"),(e,t,r)=>(t=Math.trunc(t),r?i.studentt.cdf(e,t):i.studentt.pdf(e,t)))}tdist2t(e,t){return this.runFunction(e.args,t,this.metadata("T.DIST.2T"),(e,t)=>2*(1-i.studentt.cdf(e,Math.trunc(t))))}tdistrt(e,t){return this.runFunction(e.args,t,this.metadata("T.DIST.RT"),(e,t)=>1-i.studentt.cdf(e,Math.trunc(t)))}tdistold(e,t){return this.runFunction(e.args,t,this.metadata("TDIST"),(e,t,r)=>r*(1-i.studentt.cdf(e,Math.trunc(t))))}tinv(e,t){return this.runFunction(e.args,t,this.metadata("T.INV"),(e,t)=>i.studentt.inv(e,Math.trunc(t)))}tinv2t(e,t){return this.runFunction(e.args,t,this.metadata("T.INV.2T"),(e,t)=>i.studentt.inv(1-e/2,Math.trunc(t)))}lognormdist(e,t){return this.runFunction(e.args,t,this.metadata("LOGNORM.DIST"),(e,t,r,n)=>n?i.lognormal.cdf(e,t,r):i.lognormal.pdf(e,t,r))}lognorminv(e,t){return this.runFunction(e.args,t,this.metadata("LOGNORM.INV"),(e,t,r)=>i.lognormal.inv(e,t,r))}normdist(e,t){return this.runFunction(e.args,t,this.metadata("NORM.DIST"),(e,t,r,n)=>n?i.normal.cdf(e,t,r):i.normal.pdf(e,t,r))}norminv(e,t){return this.runFunction(e.args,t,this.metadata("NORM.INV"),(e,t,r)=>i.normal.inv(e,t,r))}normsdist(e,t){return this.runFunction(e.args,t,this.metadata("NORM.S.DIST"),(e,t)=>t?i.normal.cdf(e,0,1):i.normal.pdf(e,0,1))}normsinv(e,t){return this.runFunction(e.args,t,this.metadata("NORM.S.INV"),e=>i.normal.inv(e,0,1))}phi(e,t){return this.runFunction(e.args,t,this.metadata("PHI"),e=>i.normal.pdf(e,0,1))}negbinomdist(e,t){return this.runFunction(e.args,t,this.metadata("NEGBINOM.DIST"),(e,t,r,n)=>(e=Math.trunc(e),t=Math.trunc(t),n?i.negbin.cdf(e,t,r):i.negbin.pdf(e,t,r)))}confidencenorm(e,t){return this.runFunction(e.args,t,this.metadata("CONFIDENCE.NORM"),(e,t,r)=>(0,i.normalci)(1,e,t,Math.trunc(r))[1]-1)}confidencet(e,t){return this.runFunction(e.args,t,this.metadata("CONFIDENCE.T"),(e,t,r)=>1===(r=Math.trunc(r))?new n.CellError(n.ErrorType.DIV_BY_ZERO):(0,i.tci)(1,e,t,r)[1]-1)}standardize(e,t){return this.runFunction(e.args,t,this.metadata("STANDARDIZE"),(e,t,r)=>(e-t)/r)}}t.StatisticalPlugin=u,u.implementedFunctions={ERF:{method:"erf",parameters:[{argumentType:a.FunctionArgumentType.NUMBER},{argumentType:a.FunctionArgumentType.NUMBER,optionalArg:!0}]},ERFC:{method:"erfc",parameters:[{argumentType:a.FunctionArgumentType.NUMBER}]},"EXPON.DIST":{method:"expondist",parameters:[{argumentType:a.FunctionArgumentType.NUMBER,minValue:0},{argumentType:a.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:a.FunctionArgumentType.BOOLEAN}]},FISHER:{method:"fisher",parameters:[{argumentType:a.FunctionArgumentType.NUMBER,greaterThan:-1,lessThan:1}]},FISHERINV:{method:"fisherinv",parameters:[{argumentType:a.FunctionArgumentType.NUMBER}]},GAMMA:{method:"gamma",parameters:[{argumentType:a.FunctionArgumentType.NUMBER}]},"GAMMA.DIST":{method:"gammadist",parameters:[{argumentType:a.FunctionArgumentType.NUMBER,minValue:0},{argumentType:a.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:a.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:a.FunctionArgumentType.BOOLEAN}]},GAMMALN:{method:"gammaln",parameters:[{argumentType:a.FunctionArgumentType.NUMBER,greaterThan:0}]},"GAMMA.INV":{method:"gammainv",parameters:[{argumentType:a.FunctionArgumentType.NUMBER,minValue:0,lessThan:1},{argumentType:a.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:a.FunctionArgumentType.NUMBER,greaterThan:0}]},GAUSS:{method:"gauss",parameters:[{argumentType:a.FunctionArgumentType.NUMBER}]},"BETA.DIST":{method:"betadist",parameters:[{argumentType:a.FunctionArgumentType.NUMBER},{argumentType:a.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:a.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:a.FunctionArgumentType.BOOLEAN},{argumentType:a.FunctionArgumentType.NUMBER,defaultValue:0},{argumentType:a.FunctionArgumentType.NUMBER,defaultValue:1}]},"BETA.INV":{method:"betainv",parameters:[{argumentType:a.FunctionArgumentType.NUMBER,greaterThan:0,maxValue:1},{argumentType:a.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:a.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:a.FunctionArgumentType.NUMBER,defaultValue:0},{argumentType:a.FunctionArgumentType.NUMBER,defaultValue:1}]},"BINOM.DIST":{method:"binomialdist",parameters:[{argumentType:a.FunctionArgumentType.NUMBER,minValue:0},{argumentType:a.FunctionArgumentType.NUMBER,minValue:0},{argumentType:a.FunctionArgumentType.NUMBER,minValue:0,maxValue:1},{argumentType:a.FunctionArgumentType.BOOLEAN}]},"BINOM.INV":{method:"binomialinv",parameters:[{argumentType:a.FunctionArgumentType.NUMBER,minValue:0},{argumentType:a.FunctionArgumentType.NUMBER,minValue:0,maxValue:1},{argumentType:a.FunctionArgumentType.NUMBER,greaterThan:0,lessThan:1}]},BESSELI:{method:"besselifn",parameters:[{argumentType:a.FunctionArgumentType.NUMBER},{argumentType:a.FunctionArgumentType.NUMBER,minValue:0}]},BESSELJ:{method:"besseljfn",parameters:[{argumentType:a.FunctionArgumentType.NUMBER},{argumentType:a.FunctionArgumentType.NUMBER,minValue:0}]},BESSELK:{method:"besselkfn",parameters:[{argumentType:a.FunctionArgumentType.NUMBER},{argumentType:a.FunctionArgumentType.NUMBER,minValue:0}]},BESSELY:{method:"besselyfn",parameters:[{argumentType:a.FunctionArgumentType.NUMBER},{argumentType:a.FunctionArgumentType.NUMBER,minValue:0}]},"CHISQ.DIST":{method:"chisqdist",parameters:[{argumentType:a.FunctionArgumentType.NUMBER},{argumentType:a.FunctionArgumentType.NUMBER,minValue:1,maxValue:1e10},{argumentType:a.FunctionArgumentType.BOOLEAN}]},"CHISQ.DIST.RT":{method:"chisqdistrt",parameters:[{argumentType:a.FunctionArgumentType.NUMBER},{argumentType:a.FunctionArgumentType.NUMBER,minValue:1,maxValue:1e10}]},"CHISQ.INV":{method:"chisqinv",parameters:[{argumentType:a.FunctionArgumentType.NUMBER,minValue:0,maxValue:1},{argumentType:a.FunctionArgumentType.NUMBER,minValue:1,maxValue:1e10}]},"CHISQ.INV.RT":{method:"chisqinvrt",parameters:[{argumentType:a.FunctionArgumentType.NUMBER,minValue:0,maxValue:1},{argumentType:a.FunctionArgumentType.NUMBER,minValue:1}]},"F.DIST":{method:"fdist",parameters:[{argumentType:a.FunctionArgumentType.NUMBER,minValue:0},{argumentType:a.FunctionArgumentType.NUMBER,minValue:1},{argumentType:a.FunctionArgumentType.NUMBER,minValue:1},{argumentType:a.FunctionArgumentType.BOOLEAN}]},"F.DIST.RT":{method:"fdistrt",parameters:[{argumentType:a.FunctionArgumentType.NUMBER,minValue:0},{argumentType:a.FunctionArgumentType.NUMBER,minValue:1},{argumentType:a.FunctionArgumentType.NUMBER,minValue:1}]},"F.INV":{method:"finv",parameters:[{argumentType:a.FunctionArgumentType.NUMBER,minValue:0,maxValue:1},{argumentType:a.FunctionArgumentType.NUMBER,minValue:1},{argumentType:a.FunctionArgumentType.NUMBER,minValue:1}]},"F.INV.RT":{method:"finvrt",parameters:[{argumentType:a.FunctionArgumentType.NUMBER,minValue:0,maxValue:1},{argumentType:a.FunctionArgumentType.NUMBER,minValue:1},{argumentType:a.FunctionArgumentType.NUMBER,minValue:1}]},"WEIBULL.DIST":{method:"weibulldist",parameters:[{argumentType:a.FunctionArgumentType.NUMBER,minValue:0},{argumentType:a.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:a.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:a.FunctionArgumentType.BOOLEAN}]},"POISSON.DIST":{method:"poissondist",parameters:[{argumentType:a.FunctionArgumentType.NUMBER,minValue:0},{argumentType:a.FunctionArgumentType.NUMBER,minValue:0},{argumentType:a.FunctionArgumentType.BOOLEAN}]},"HYPGEOM.DIST":{method:"hypgeomdist",parameters:[{argumentType:a.FunctionArgumentType.NUMBER,minValue:0},{argumentType:a.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:a.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:a.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:a.FunctionArgumentType.BOOLEAN}]},"T.DIST":{method:"tdist",parameters:[{argumentType:a.FunctionArgumentType.NUMBER},{argumentType:a.FunctionArgumentType.NUMBER,minValue:1},{argumentType:a.FunctionArgumentType.BOOLEAN}]},"T.DIST.2T":{method:"tdist2t",parameters:[{argumentType:a.FunctionArgumentType.NUMBER,minValue:0},{argumentType:a.FunctionArgumentType.NUMBER,minValue:1}]},"T.DIST.RT":{method:"tdistrt",parameters:[{argumentType:a.FunctionArgumentType.NUMBER},{argumentType:a.FunctionArgumentType.NUMBER,minValue:1}]},TDIST:{method:"tdistold",parameters:[{argumentType:a.FunctionArgumentType.NUMBER,minValue:0},{argumentType:a.FunctionArgumentType.NUMBER,minValue:1},{argumentType:a.FunctionArgumentType.INTEGER,minValue:1,maxValue:2}]},"T.INV":{method:"tinv",parameters:[{argumentType:a.FunctionArgumentType.NUMBER,greaterThan:0,lessThan:1},{argumentType:a.FunctionArgumentType.NUMBER,minValue:1}]},"T.INV.2T":{method:"tinv2t",parameters:[{argumentType:a.FunctionArgumentType.NUMBER,greaterThan:0,maxValue:1},{argumentType:a.FunctionArgumentType.NUMBER,minValue:1}]},"LOGNORM.DIST":{method:"lognormdist",parameters:[{argumentType:a.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:a.FunctionArgumentType.NUMBER},{argumentType:a.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:a.FunctionArgumentType.BOOLEAN}]},"LOGNORM.INV":{method:"lognorminv",parameters:[{argumentType:a.FunctionArgumentType.NUMBER,greaterThan:0,lessThan:1},{argumentType:a.FunctionArgumentType.NUMBER},{argumentType:a.FunctionArgumentType.NUMBER,greaterThan:0}]},"NORM.DIST":{method:"normdist",parameters:[{argumentType:a.FunctionArgumentType.NUMBER},{argumentType:a.FunctionArgumentType.NUMBER},{argumentType:a.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:a.FunctionArgumentType.BOOLEAN}]},"NORM.INV":{method:"norminv",parameters:[{argumentType:a.FunctionArgumentType.NUMBER,greaterThan:0,lessThan:1},{argumentType:a.FunctionArgumentType.NUMBER},{argumentType:a.FunctionArgumentType.NUMBER,greaterThan:0}]},"NORM.S.DIST":{method:"normsdist",parameters:[{argumentType:a.FunctionArgumentType.NUMBER},{argumentType:a.FunctionArgumentType.BOOLEAN}]},"NORM.S.INV":{method:"normsinv",parameters:[{argumentType:a.FunctionArgumentType.NUMBER,greaterThan:0,lessThan:1}]},PHI:{method:"phi",parameters:[{argumentType:a.FunctionArgumentType.NUMBER}]},"NEGBINOM.DIST":{method:"negbinomdist",parameters:[{argumentType:a.FunctionArgumentType.NUMBER,minValue:0},{argumentType:a.FunctionArgumentType.NUMBER,minValue:1},{argumentType:a.FunctionArgumentType.NUMBER,minValue:0,maxValue:1},{argumentType:a.FunctionArgumentType.BOOLEAN}]},"CONFIDENCE.NORM":{method:"confidencenorm",parameters:[{argumentType:a.FunctionArgumentType.NUMBER,greaterThan:0,lessThan:1},{argumentType:a.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:a.FunctionArgumentType.NUMBER,minValue:1}]},"CONFIDENCE.T":{method:"confidencet",parameters:[{argumentType:a.FunctionArgumentType.NUMBER,greaterThan:0,lessThan:1},{argumentType:a.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:a.FunctionArgumentType.NUMBER,minValue:1}]},STANDARDIZE:{method:"standardize",parameters:[{argumentType:a.FunctionArgumentType.NUMBER},{argumentType:a.FunctionArgumentType.NUMBER},{argumentType:a.FunctionArgumentType.NUMBER,greaterThan:0}]}},u.aliases={NEGBINOMDIST:"NEGBINOM.DIST",EXPONDIST:"EXPON.DIST",BETADIST:"BETA.DIST",NORMDIST:"NORM.DIST",NORMINV:"NORM.INV",NORMSDIST:"NORM.S.DIST",NORMSINV:"NORM.S.INV",LOGNORMDIST:"LOGNORM.DIST",LOGINV:"LOGNORM.INV",TINV:"T.INV.2T",HYPGEOMDIST:"HYPGEOM.DIST",POISSON:"POISSON.DIST",WEIBULL:"WEIBULL.DIST",FINV:"F.INV.RT",FDIST:"F.DIST.RT",CHIDIST:"CHISQ.DIST.RT",CHIINV:"CHISQ.INV.RT",GAMMADIST:"GAMMA.DIST","GAMMALN.PRECISE":"GAMMALN",GAMMAINV:"GAMMA.INV",BETAINV:"BETA.INV",BINOMDIST:"BINOM.DIST",CONFIDENCE:"CONFIDENCE.NORM",CRITBINOM:"BINOM.INV",WEIBULLDIST:"WEIBULL.DIST",TINV2T:"T.INV.2T",TDISTRT:"T.DIST.RT",TDIST2T:"T.DIST.2T",FINVRT:"F.INV.RT",FDISTRT:"F.DIST.RT",CHIDISTRT:"CHISQ.DIST.RT",CHIINVRT:"CHISQ.INV.RT",LOGNORMINV:"LOGNORM.INV",POISSONDIST:"POISSON.DIST"}},function(e,t,r){"use strict";t.__esModule=!0,t.bessely=t.besselk=t.besselj=t.besseli=void 0;
/**
 * @license
 bessel.js (C) 2013-present SheetJS -- http://sheetjs.com

 Apache License
 Version 2.0, January 2004
 http://www.apache.org/licenses/

 TERMS AND CONDITIONS FOR USE, REPRODUCTION, AND DISTRIBUTION

 1. Definitions.

 "License" shall mean the terms and conditions for use, reproduction,
 and distribution as defined by Sections 1 through 9 of this document.

 "Licensor" shall mean the copyright owner or entity authorized by
 the copyright owner that is granting the License.

 "Legal Entity" shall mean the union of the acting entity and all
 other entities that control, are controlled by, or are under common
 control with that entity. For the purposes of this definition,
 "control" means (i) the power, direct or indirect, to cause the
 direction or management of such entity, whether by contract or
 otherwise, or (ii) ownership of fifty percent (50%) or more of the
 outstanding shares, or (iii) beneficial ownership of such entity.

 "You" (or "Your") shall mean an individual or Legal Entity
 exercising permissions granted by this License.

 "Source" form shall mean the preferred form for making modifications,
 including but not limited to software source code, documentation
 source, and configuration files.

 "Object" form shall mean any form resulting from mechanical
 transformation or translation of a Source form, including but
 not limited to compiled object code, generated documentation,
 and conversions to other media types.

 "Work" shall mean the work of authorship, whether in Source or
 Object form, made available under the License, as indicated by a
 copyright notice that is included in or attached to the work
 (an example is provided in the Appendix below).

 "Derivative Works" shall mean any work, whether in Source or Object
 form, that is based on (or derived from) the Work and for which the
 editorial revisions, annotations, elaborations, or other modifications
 represent, as a whole, an original work of authorship. For the purposes
 of this License, Derivative Works shall not include works that remain
 separable from, or merely link (or bind by name) to the interfaces of,
 the Work and Derivative Works thereof.

 "Contribution" shall mean any work of authorship, including
 the original version of the Work and any modifications or additions
 to that Work or Derivative Works thereof, that is intentionally
 submitted to Licensor for inclusion in the Work by the copyright owner
 or by an individual or Legal Entity authorized to submit on behalf of
 the copyright owner. For the purposes of this definition, "submitted"
 means any form of electronic, verbal, or written communication sent
 to the Licensor or its representatives, including but not limited to
 communication on electronic mailing lists, source code control systems,
 and issue tracking systems that are managed by, or on behalf of, the
 Licensor for the purpose of discussing and improving the Work, but
 excluding communication that is conspicuously marked or otherwise
 designated in writing by the copyright owner as "Not a Contribution."

 "Contributor" shall mean Licensor and any individual or Legal Entity
 on behalf of whom a Contribution has been received by Licensor and
 subsequently incorporated within the Work.

 2. Grant of Copyright License. Subject to the terms and conditions of
 this License, each Contributor hereby grants to You a perpetual,
 worldwide, non-exclusive, no-charge, royalty-free, irrevocable
 copyright license to reproduce, prepare Derivative Works of,
 publicly display, publicly perform, sublicense, and distribute the
 Work and such Derivative Works in Source or Object form.

 3. Grant of Patent License. Subject to the terms and conditions of
 this License, each Contributor hereby grants to You a perpetual,
 worldwide, non-exclusive, no-charge, royalty-free, irrevocable
 (except as stated in this section) patent license to make, have made,
 use, offer to sell, sell, import, and otherwise transfer the Work,
 where such license applies only to those patent claims licensable
 by such Contributor that are necessarily infringed by their
 Contribution(s) alone or by combination of their Contribution(s)
 with the Work to which such Contribution(s) was submitted. If You
 institute patent litigation against any entity (including a
 cross-claim or counterclaim in a lawsuit) alleging that the Work
 or a Contribution incorporated within the Work constitutes direct
 or contributory patent infringement, then any patent licenses
 granted to You under this License for that Work shall terminate
 as of the date such litigation is filed.

 4. Redistribution. You may reproduce and distribute copies of the
 Work or Derivative Works thereof in any medium, with or without
 modifications, and in Source or Object form, provided that You
 meet the following conditions:

 (a) You must give any other recipients of the Work or
 Derivative Works a copy of this License; and

 (b) You must cause any modified files to carry prominent notices
 stating that You changed the files; and

 (c) You must retain, in the Source form of any Derivative Works
 that You distribute, all copyright, patent, trademark, and
 attribution notices from the Source form of the Work,
 excluding those notices that do not pertain to any part of
 the Derivative Works; and

 (d) If the Work includes a "NOTICE" text file as part of its
 distribution, then any Derivative Works that You distribute must
 include a readable copy of the attribution notices contained
 within such NOTICE file, excluding those notices that do not
 pertain to any part of the Derivative Works, in at least one
 of the following places: within a NOTICE text file distributed
 as part of the Derivative Works; within the Source form or
 documentation, if provided along with the Derivative Works; or,
 within a display generated by the Derivative Works, if and
 wherever such third-party notices normally appear. The contents
 of the NOTICE file are for informational purposes only and
 do not modify the License. You may add Your own attribution
 notices within Derivative Works that You distribute, alongside
 or as an addendum to the NOTICE text from the Work, provided
 that such additional attribution notices cannot be construed
 as modifying the License.

 You may add Your own copyright statement to Your modifications and
 may provide additional or different license terms and conditions
 for use, reproduction, or distribution of Your modifications, or
 for any such Derivative Works as a whole, provided Your use,
 reproduction, and distribution of the Work otherwise complies with
 the conditions stated in this License.

 5. Submission of Contributions. Unless You explicitly state otherwise,
 any Contribution intentionally submitted for inclusion in the Work
 by You to the Licensor shall be under the terms and conditions of
 this License, without any additional terms or conditions.
 Notwithstanding the above, nothing herein shall supersede or modify
 the terms of any separate license agreement you may have executed
 with Licensor regarding such Contributions.

 6. Trademarks. This License does not grant permission to use the trade
 names, trademarks, service marks, or product names of the Licensor,
 except as required for reasonable and customary use in describing the
 origin of the Work and reproducing the content of the NOTICE file.

 7. Disclaimer of Warranty. Unless required by applicable law or
 agreed to in writing, Licensor provides the Work (and each
 Contributor provides its Contributions) on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
 implied, including, without limitation, any warranties or conditions
 of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A
 PARTICULAR PURPOSE. You are solely responsible for determining the
 appropriateness of using or redistributing the Work and assume any
 risks associated with Your exercise of permissions under this License.

 8. Limitation of Liability. In no event and under no legal theory,
 whether in tort (including negligence), contract, or otherwise,
 unless required by applicable law (such as deliberate and grossly
 negligent acts) or agreed to in writing, shall any Contributor be
 liable to You for damages, including any direct, indirect, special,
 incidental, or consequential damages of any character arising as a
 result of this License or out of the use or inability to use the
 Work (including but not limited to damages for loss of goodwill,
 work stoppage, computer failure or malfunction, or any and all
 other commercial damages or losses), even if such Contributor
 has been advised of the possibility of such damages.

 9. Accepting Warranty or Additional Liability. While redistributing
 the Work or Derivative Works thereof, You may choose to offer,
 and charge a fee for, acceptance of support, warranty, indemnity,
 or other liability obligations and/or rights consistent with this
 License. However, in accepting such obligations, You may act only
 on Your own behalf and on Your sole responsibility, not on behalf
 of any other Contributor, and only if You agree to indemnify,
 defend, and hold each Contributor harmless for any liability
 incurred by, or claims asserted against, such Contributor by reason
 of your accepting any such warranty or additional liability.

 END OF TERMS AND CONDITIONS

 APPENDIX: How to apply the Apache License to your work.

 To apply the Apache License to your work, attach the following
 boilerplate notice, with the fields enclosed by brackets "{}"
 replaced with your own identifying information. (Don't include
 the brackets!)  The text should be enclosed in the appropriate
 comment syntax for the file format. We also recommend that a
 file or class name and description of purpose be included on the
 same "printed page" as the copyright notice for easier
 identification within third-party archives.

 Copyright (C) 2013-present   SheetJS LLC

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

 http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 */
var n=Math;function o(e,t){for(var r=0,n=0;r<e.length;++r)n=t*n+e[r];return n}function s(e,t,r,n,o){if(0===t)return r;if(1===t)return n;for(var s=2/e,i=n,a=1;a<t;++a)i=n*a*s+o*r,r=n,n=i;return i}function i(e,t,r,n,o){return function(r,i){if(n){if(0===r)return 1==n?-1/0:1/0;if(r<0)return NaN}return 0===i?e(r):1===i?t(r):i<0?NaN:s(r,i|=0,e(r),t(r),o)}}var a,u,c,l,h,d,p,m,g,f,E,T,y,A=t.besselj=function(){var e=.636619772,t=[57568490574,-13362590354,651619640.7,-11214424.18,77392.33017,-184.9052456].reverse(),r=[57568490411,1029532985,9494680.718,59272.64853,267.8532712,1].reverse(),i=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),a=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34935152e-8].reverse();function u(s){var u=0,c=0,l=0,h=s*s;if(s<8)u=(c=o(t,h))/(l=o(r,h));else{var d=s-.785398164;c=o(i,h=64/h),l=o(a,h),u=n.sqrt(e/s)*(n.cos(d)*c-n.sin(d)*l*8/s)}return u}var c=[72362614232,-7895059235,242396853.1,-2972611.439,15704.4826,-30.16036606].reverse(),l=[144725228442,2300535178,18583304.74,99447.43394,376.9991397,1].reverse(),h=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),d=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse();function p(t){var r=0,s=0,i=0,a=t*t,u=n.abs(t)-2.356194491;return Math.abs(t)<8?r=(s=t*o(c,a))/(i=o(l,a)):(s=o(h,a=64/a),i=o(d,a),r=n.sqrt(e/n.abs(t))*(n.cos(u)*s-n.sin(u)*i*8/n.abs(t)),t<0&&(r=-r)),r}return function e(t,r){if(r=Math.round(r),!isFinite(t))return isNaN(t)?t:0;if(r<0)return(r%2?-1:1)*e(t,-r);if(t<0)return(r%2?-1:1)*e(-t,r);if(0===r)return u(t);if(1===r)return p(t);if(0===t)return 0;var o=0;if(t>r)o=s(t,r,u(t),p(t),-1);else{for(var i=!1,a=0,c=0,l=1,h=0,d=2/t,m=2*n.floor((r+n.floor(n.sqrt(40*r)))/2);m>0;m--)h=m*d*l-a,a=l,l=h,n.abs(l)>1e10&&(l*=1e-10,a*=1e-10,o*=1e-10,c*=1e-10),i&&(c+=l),i=!i,m==r&&(o=a);o/=c=2*c-l}return o}}(),R=(t.bessely=(a=.636619772,u=[-2957821389,7062834065,-512359803.6,10879881.29,-86327.92757,228.4622733].reverse(),c=[40076544269,745249964.8,7189466.438,47447.2647,226.1030244,1].reverse(),l=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),h=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34945152e-8].reverse(),d=[-4900604943e3,127527439e4,-51534381390,734926455.1,-4237922.726,8511.937935].reverse(),p=[249958057e5,424441966400,3733650367,22459040.02,102042.605,354.9632885,1].reverse(),m=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),g=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse(),i((function(e){var t=0,r=0,s=0,i=e*e,d=e-.785398164;return e<8?t=(r=o(u,i))/(s=o(c,i))+a*A(e,0)*n.log(e):(r=o(l,i=64/i),s=o(h,i),t=n.sqrt(a/e)*(n.sin(d)*r+n.cos(d)*s*8/e)),t}),(function(e){var t=0,r=0,s=0,i=e*e,u=e-2.356194491;return e<8?t=(r=e*o(d,i))/(s=o(p,i))+a*(A(e,1)*n.log(e)-1/e):(r=o(m,i=64/i),s=o(g,i),t=n.sqrt(a/e)*(n.sin(u)*r+n.cos(u)*s*8/e)),t}),0,1,-1)),t.besseli=(f=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),E=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse(),T=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),y=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse(),function e(t,r){if(0===(r=Math.round(r)))return function(e){return e<=3.75?o(f,e*e/14.0625):n.exp(n.abs(e))/n.sqrt(n.abs(e))*o(E,3.75/n.abs(e))}(t);if(1===r)return function(e){return e<3.75?e*o(T,e*e/14.0625):(e<0?-1:1)*n.exp(n.abs(e))/n.sqrt(n.abs(e))*o(y,3.75/n.abs(e))}(t);if(r<0)return NaN;if(0===n.abs(t))return 0;if(t==1/0)return 1/0;var s,i=0,a=2/n.abs(t),u=0,c=1,l=0;for(s=2*n.round((r+n.round(n.sqrt(40*r)))/2);s>0;s--)l=s*a*c+u,u=c,c=l,n.abs(c)>1e10&&(c*=1e-10,u*=1e-10,i*=1e-10),s==r&&(i=u);return i*=e(t,0)/c,t<0&&r%2?-i:i}));t.besselk=function(){var e=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),t=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse(),r=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),s=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();return i((function(r){return r<=2?-n.log(r/2)*R(r,0)+o(e,r*r/4):n.exp(-r)/n.sqrt(r)*o(t,2/r)}),(function(e){return e<=2?n.log(e/2)*R(e,1)+1/e*o(r,e*e/4):n.exp(-e)/n.sqrt(e)*o(s,2/e)}),0,2,1)}()},function(e,t,r){"use strict";
/**
 * @license
 Copyright (c) 2013 jStat

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to deal
 in the Software without restriction, including without limitation the rights
 to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:

 The above copyright notice and this permission notice shall be included in
 all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 THE SOFTWARE.
 */
function n(e){const t=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,1.5626441722e-8,-8.5238095915e-8,6.529054439e-9,5.059343495e-9,-9.91364156e-10,-2.27365122e-10,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18];let r,n,o,s,i=t.length-1,a=!1,u=0,c=0;if(0===e)return 0;for(e<0&&(e=-e,a=!0),r=2/(2+e),n=4*r-2;i>0;i--)o=u,u=n*u-c+t[i],c=o;return s=r*Math.exp(-e*e+.5*(t[0]+n*u)-c),a?s-1:1-s}function o(e){return 1-n(e)}function s(e){let t,r,n,s,i=0;if(e>=2)return-100;if(e<=0)return 100;for(s=e<1?e:2-e,n=Math.sqrt(-2*Math.log(s/2)),t=-.70711*((2.30753+.27061*n)/(1+n*(.99229+.04481*n))-n);i<2;i++)r=o(t)-s,t+=r/(1.1283791670955126*Math.exp(-t*t)-t*r);return e<1?t:-t}function i(e){const t=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],r=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535];let n,o,s,i,a=!1,u=0,c=0,l=0,h=e;if(e>171.6243769536076)return 1/0;if(h<=0){if(i=h%1,!i)return 1/0;a=(1&h?-1:1)*Math.PI/Math.sin(Math.PI*i),h=1-h}for(s=h,o=h<1?h++:(h-=u=(0|h)-1)-1,n=0;n<8;++n)l=(l+t[n])*o,c=c*o+r[n];if(i=l/c+1,s<h)i/=s;else if(s>h)for(n=0;n<u;++n)i*=h,h++;return a&&(i=a/i),i}function a(e){let t=0;const r=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18];let n,o,s,i=1.000000000190015;for(s=(o=n=e)+5.5,s-=(n+.5)*Math.log(s);t<6;t++)i+=r[t]/++o;return Math.log(2.5066282746310007*i/n)-s}function u(e,t){const r=a(e);let n=e,o=1/e,s=o,i=t+1-e,u=1/1e-30,c=1/i,l=c,h=1;const d=-~(8.5*Math.log(e>=1?e:1/e)+.4*e+17);let p;if(t<0||e<=0)return NaN;if(t<e+1){for(;h<=d;h++)o+=s*=t/++n;return o*Math.exp(-t+e*Math.log(t)-r)}for(;h<=d;h++)p=-h*(h-e),i+=2,c=p*c+i,u=i+p/u,c=1/c,l*=c*u;return 1-l*Math.exp(-t+e*Math.log(t)-r)}function c(e,t){let r=0;const n=t-1,o=a(t);let s,i,c,l,h,d,p;if(e>=1)return Math.max(100,t+100*Math.sqrt(t));if(e<=0)return 0;for(t>1?(d=Math.log(n),p=Math.exp(n*(d-1)-o),h=e<.5?e:1-e,c=Math.sqrt(-2*Math.log(h)),s=(2.30753+.27061*c)/(1+c*(.99229+.04481*c))-c,e<.5&&(s=-s),s=Math.max(.001,t*Math.pow(1-1/(9*t)-s/(3*Math.sqrt(t)),3))):(c=1-t*(.253+.12*t),s=e<c?Math.pow(e/c,1/t):1-Math.log(1-(e-c)/(1-c)));r<12;r++){if(s<=0)return 0;if(i=u(t,s)-e,c=t>1?p*Math.exp(-(s-n)+n*(Math.log(s)-d)):Math.exp(-s+n*Math.log(s)-o),l=i/c,s-=c=l/(1-.5*Math.min(1,l*((t-1)/s-1))),s<=0&&(s=.5*(s+c)),Math.abs(c)<1e-8*s)break}return s}t.__esModule=!0,t.chisquare=t.centralF=t.binomial=t.beta=void 0,t.corrcoeff=function(e,t){return F(e,t)/b(e,1)/b(t,1)},t.covariance=F,t.erf=n,t.erfc=o,t.exponential=void 0,t.factorial=A,t.factorialln=y,t.gamma=void 0,t.gammafn=i,t.gammaln=a,t.geomean=function(e){return Math.pow(function(e){for(var t=1,r=e.length;--r>=0;)t*=e[r];return t}(e),1/e.length)},t.lognormal=t.hypgeom=void 0,t.mean=O,t.normal=t.negbin=void 0,t.normalci=function(){var e,t=[].slice.call(arguments),r=new Array(2);return e=4===t.length?Math.abs(l.inv(t[1]/2,0,1)*t[2]/Math.sqrt(t[3])):Math.abs(l.inv(t[1]/2,0,1)*b(t[2])/Math.sqrt(t[2].length)),r[0]=t[0]-e,r[1]=t[0]+e,r},t.poisson=void 0,t.stdev=b,t.studentt=void 0,t.sumsqerr=I,t.tci=function(){var e,t=[].slice.call(arguments),r=new Array(2);return e=4===t.length?Math.abs(S.inv(t[1]/2,t[3]-1)*t[2]/Math.sqrt(t[3])):Math.abs(S.inv(t[1]/2,t[2].length-1)*b(t[2],!0)/Math.sqrt(t[2].length)),r[0]=t[0]-e,r[1]=t[0]+e,r},t.variance=M,t.weibull=void 0,t.exponential={pdf:(e,t)=>e<0?0:t*Math.exp(-t*e),cdf:(e,t)=>e<0?0:1-Math.exp(-t*e)},t.gamma={pdf:function(e,t,r){return e<0?0:0===e&&1===t?1/r:Math.exp((t-1)*Math.log(e)-e/r-a(t)-t*Math.log(r))},cdf:function(e,t,r){return e<0?0:u(t,e/r)},inv:function(e,t,r){return c(e,t)*r}};const l=t.normal={pdf:function(e,t,r){return Math.exp(-.5*Math.log(2*Math.PI)-Math.log(r)-Math.pow(e-t,2)/(2*r*r))},cdf:function(e,t,r){return.5*(1+n((e-t)/Math.sqrt(2*r*r)))},inv:function(e,t,r){return-1.4142135623730951*r*s(2*e)+t}};function h(e,t){if(!(e<=0||t<=0))return e+t>170?Math.exp(d(e,t)):i(e)*i(t)/i(e+t)}function d(e,t){return a(e)+a(t)-a(e+t)}function p(e,t,r){var n,o,s,i,u,c,l,h,d,p,g=t-1,f=r-1,E=0;if(e<=0)return 0;if(e>=1)return 1;for(t>=1&&r>=1?(s=e<.5?e:1-e,c=(2.30753+.27061*(i=Math.sqrt(-2*Math.log(s))))/(1+i*(.99229+.04481*i))-i,e<.5&&(c=-c),l=(c*c-3)/6,h=2/(1/(2*t-1)+1/(2*r-1)),d=c*Math.sqrt(l+h)/h-(1/(2*r-1)-1/(2*t-1))*(l+5/6-2/(3*h)),c=t/(t+r*Math.exp(2*d))):(n=Math.log(t/(t+r)),o=Math.log(r/(t+r)),c=e<(i=Math.exp(t*n)/t)/(d=i+(u=Math.exp(r*o)/r))?Math.pow(t*d*e,1/t):1-Math.pow(r*d*(1-e),1/r)),p=-a(t)-a(r)+a(t+r);E<10;E++){if(0===c||1===c)return c;if((c-=i=(u=(m(c,t,r)-e)/(i=Math.exp(g*Math.log(c)+f*Math.log(1-c)+p)))/(1-.5*Math.min(1,u*(g/c-f/(1-c)))))<=0&&(c=.5*(c+i)),c>=1&&(c=.5*(c+i+1)),Math.abs(i)<1e-8*c&&E>0)break}return c}function m(e,t,r){var n=0===e||1===e?0:Math.exp(a(t+r)-a(t)-a(r)+t*Math.log(e)+r*Math.log(1-e));return!(e<0||e>1)&&(e<(t+1)/(t+r+2)?n*g(e,t,r)/t:1-n*g(1-e,r,t)/r)}function g(e,t,r){var n,o,s,i,a=1,u=t+r,c=t+1,l=t-1,h=1,d=1-u*e/c;for(Math.abs(d)<1e-30&&(d=1e-30),i=d=1/d;a<=100&&(d=1+(o=a*(r-a)*e/((l+(n=2*a))*(t+n)))*d,Math.abs(d)<1e-30&&(d=1e-30),h=1+o/h,Math.abs(h)<1e-30&&(h=1e-30),i*=(d=1/d)*h,d=1+(o=-(t+a)*(u+a)*e/((t+n)*(c+n)))*d,Math.abs(d)<1e-30&&(d=1e-30),h=1+o/h,Math.abs(h)<1e-30&&(h=1e-30),i*=s=(d=1/d)*h,!(Math.abs(s-1)<3e-7));a++);return i}t.beta={pdf:function(e,t,r){return e>1||e<0?0:1==t&&1==r?1:t<512&&r<512?Math.pow(e,t-1)*Math.pow(1-e,r-1)/h(t,r):Math.exp((t-1)*Math.log(e)+(r-1)*Math.log(1-e)-d(t,r))},cdf:function(e,t,r){return e>1||e<0?+(e>1):m(e,t,r)},inv:function(e,t,r){return p(e,t,r)}};const f=t.binomial={pdf:function(e,t,r){return 0===r||1===r?t*r===e?1:0:T(t,e)*Math.pow(r,e)*Math.pow(1-r,t-e)},cdf:function(e,t,r){var n;if(e<0)return 0;if(e>=t)return 1;if(r<0||r>1||t<=0)return NaN;var o=r,s=(e=Math.floor(e))+1,i=t-e,u=s+i,c=Math.exp(a(u)-a(i)-a(s)+s*Math.log(o)+i*Math.log(1-o));return n=o<(s+1)/(u+2)?c*E(o,s,i,1e-10):1-c*E(1-o,i,s,1e-10),Math.round(1/1e-10*(1-n))/(1/1e-10)}};function E(e,t,r,n){for(var o,s=0,i=1,a=1,u=1,c=0,l=0;Math.abs((a-l)/a)>n;)l=a,i=u+(o=-(t+c)*(t+r+c)*e/(t+2*c)/(t+2*c+1))*i,a=(s=a+o*s)+(o=(c+=1)*(r-c)*e/(t+2*c-1)/(t+2*c))*a,s/=u=i+o*u,i/=u,a/=u,u=1;return a/t}function T(e,t){return e>170||t>170?Math.exp(function(e,t){return y(e)-y(t)-y(e-t)}(e,t)):A(e)/A(t)/A(e-t)}function y(e){return e<0?NaN:a(e+1)}function A(e){return e<0?NaN:i(e+1)}t.chisquare={pdf:function(e,t){return e<0?0:0===e&&2===t?.5:Math.exp((t/2-1)*Math.log(e)-e/2-t/2*Math.log(2)-a(t/2))},cdf:function(e,t){return e<0?0:u(t/2,e/2)},inv:function(e,t){return 2*c(e,.5*t)}},t.centralF={pdf:function(e,t,r){var n;return e<0?0:t<=2?0===e&&t<2?1/0:0===e&&2===t?1:1/h(t/2,r/2)*Math.pow(t/r,t/2)*Math.pow(e,t/2-1)*Math.pow(1+t/r*e,-(t+r)/2):(n=t*e/(r+e*t),t*(r/(r+e*t))/2*f.pdf((t-2)/2,(t+r-2)/2,n))},cdf:function(e,t,r){return e<0?0:m(t*e/(t*e+r),t/2,r/2)},inv:function(e,t,r){return r/(t*(1/p(e,t/2,r/2)-1))}},t.weibull={pdf:function(e,t,r){return e<0||t<0||r<0?0:r/t*Math.pow(e/t,r-1)*Math.exp(-Math.pow(e/t,r))},cdf:function(e,t,r){return e<0?0:1-Math.exp(-Math.pow(e/t,r))}};const R=t.poisson={pdf:function(e,t){return t<0||e%1!=0||e<0?0:Math.pow(t,e)*Math.exp(-t)/A(e)},cdf:function(e,t){var r=0;if(e<0)return 0;for(var n=0;r<=e;r++)n+=R.pdf(r,t);return n}},N=t.hypgeom={pdf:function(e,t,r,n){if(e<0||e<r-(t-n))return 0;if(e>n||e>r)return 0;if(2*r>t)return 2*n>t?N.pdf(t-r-n+e,t,t-r,t-n):N.pdf(n-e,t,t-r,n);if(2*n>t)return N.pdf(r-e,t,r,t-n);if(r<n)return N.pdf(e,t,n,r);for(var o=1,s=0,i=0;i<e;i++){for(;o>1&&s<n;)o*=1-r/(t-s),s++;o*=(n-i)*(r-i)/((i+1)*(t-r-n+i+1))}for(;s<n;s++)o*=1-r/(t-s);return Math.min(1,Math.max(0,o))},cdf:function e(t,r,n,o){if(t<0||t<n-(r-o))return 0;if(t>=o||t>=n)return 1;if(2*n>r)return 2*o>r?e(r-n-o+t,r,r-n,r-o):1-N.cdf(o-t-1,r,r-n,o);if(2*o>r)return 1-N.cdf(n-t-1,r,n,r-o);if(n<o)return N.cdf(t,r,o,n);for(var s=1,i=1,a=0,u=0;u<t;u++){for(;s>1&&a<o;){var c=1-n/(r-a);i*=c,s*=c,a++}s+=i*=(o-u)*(n-u)/((u+1)*(r-n-o+u+1))}for(;a<o;a++)s*=1-n/(r-a);return Math.min(1,Math.max(0,s))}},S=t.studentt={pdf:function(e,t){return t=t>1e100?1e100:t,1/(Math.sqrt(t)*h(.5,t/2))*Math.pow(1+e*e/t,-(t+1)/2)},cdf:function(e,t){var r=t/2;return m((e+Math.sqrt(e*e+t))/(2*Math.sqrt(e*e+t)),r,r)},inv:function(e,t){var r=p(2*Math.min(e,1-e),.5*t,.5);return r=Math.sqrt(t*(1-r)/r),e>.5?r:-r}},C=(t.lognormal={pdf:function(e,t,r){return e<=0?0:Math.exp(-Math.log(e)-.5*Math.log(2*Math.PI)-Math.log(r)-Math.pow(Math.log(e)-t,2)/(2*r*r))},cdf:function(e,t,r){return e<0?0:.5+.5*n((Math.log(e)-t)/Math.sqrt(2*r*r))},inv:function(e,t,r){return Math.exp(-1.4142135623730951*r*s(2*e)+t)}},t.negbin={pdf:function(e,t,r){return e===e>>>0&&(e<0?0:T(e+t-1,t-1)*Math.pow(1-r,e)*Math.pow(r,t))},cdf:function(e,t,r){var n=0,o=0;if(e<0)return 0;for(;o<=e;o++)n+=C.pdf(o,t,r);return n}});function v(e){for(var t=0,r=e.length;--r>=0;)t+=e[r];return t}function O(e){return v(e)/e.length}function I(e){for(var t,r=O(e),n=0,o=e.length;--o>=0;)n+=(t=e[o]-r)*t;return n}function M(e,t){return I(e)/(e.length-(t?1:0))}function b(e,t){return Math.sqrt(M(e,t))}function F(e,t){var r,n=O(e),o=O(t),s=e.length,i=new Array(s);for(r=0;r<s;r++)i[r]=(e[r]-n)*(t[r]-o);return v(i)/(s-1)}},function(e,t,r){"use strict";t.__esModule=!0,t.MathPlugin=void 0;var n=r(73),o=r(131),s=r(167);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
class i extends s.FunctionPlugin{fact(e,t){return this.runFunction(e.args,t,this.metadata("FACT"),e=>{e=Math.trunc(e);let t=1;for(let r=1;r<=e;r++)t*=r;return t})}factdouble(e,t){return this.runFunction(e.args,t,this.metadata("FACTDOUBLE"),e=>{let t=1;for(let r=e=Math.trunc(e);r>=1;r-=2)t*=r;return t})}combin(e,t){return this.runFunction(e.args,t,this.metadata("COMBIN"),(e,t)=>t>e?new n.CellError(n.ErrorType.NUM,o.ErrorMessage.WrongOrder):a(e=Math.trunc(e),t=Math.trunc(t)))}combina(e,t){return this.runFunction(e.args,t,this.metadata("COMBINA"),(e,t)=>(e=Math.trunc(e))+(t=Math.trunc(t))-1>=1030?new n.CellError(n.ErrorType.NUM,o.ErrorMessage.ValueLarge):0===e&&0===t?1:a(e+t-1,t))}gcd(e,t){return this.runFunction(e.args,t,this.metadata("GCD"),(...e)=>{const t=this.arithmeticHelper.coerceNumbersCoerceRangesDropNulls(e);if(t instanceof n.CellError)return t;let r=0;for(const e of t){if(e<0)return new n.CellError(n.ErrorType.NUM,o.ErrorMessage.ValueSmall);r=u(r,Math.trunc(e))}return r>Number.MAX_SAFE_INTEGER?new n.CellError(n.ErrorType.NUM,o.ErrorMessage.ValueLarge):r})}lcm(e,t){return this.runFunction(e.args,t,this.metadata("LCM"),(...e)=>{const t=this.arithmeticHelper.coerceNumbersCoerceRangesDropNulls(e);if(t instanceof n.CellError)return t;let r=1;for(const e of t){if(e<0)return new n.CellError(n.ErrorType.NUM,o.ErrorMessage.ValueSmall);s=r,i=Math.trunc(e),r=0===s||0===i?0:s*(i/u(s,i))}var s,i;return r>Number.MAX_SAFE_INTEGER?new n.CellError(n.ErrorType.NUM,o.ErrorMessage.ValueLarge):r})}mround(e,t){return this.runFunction(e.args,t,this.metadata("MROUND"),(e,t)=>0===t?0:e>0&&t<0||e<0&&t>0?new n.CellError(n.ErrorType.NUM,o.ErrorMessage.DistinctSigns):Math.round(e/t)*t)}multinomial(e,t){return this.runFunction(e.args,t,this.metadata("MULTINOMIAL"),(...e)=>{let t=0,r=1;for(let s of e){if(s<0)return new n.CellError(n.ErrorType.NUM,o.ErrorMessage.ValueSmall);s=Math.trunc(s);for(let e=1;e<=s;e++)r*=(t+e)/e;t+=s}return Math.round(r)})}quotient(e,t){return this.runFunction(e.args,t,this.metadata("QUOTIENT"),(e,t)=>0===t?new n.CellError(n.ErrorType.DIV_BY_ZERO):Math.trunc(e/t))}seriessum(e,t){return this.runFunction(e.args,t,this.metadata("SERIESSUM"),(e,t,r,o)=>{const s=this.arithmeticHelper.manyToOnlyNumbersDropNulls(o.valuesFromTopLeftCorner());if(s instanceof n.CellError)return s;let i=0;s.reverse();for(const t of s)i*=Math.pow(e,r),i+=t;return i*Math.pow(e,t)})}sign(e,t){return this.runFunction(e.args,t,this.metadata("SIGN"),e=>e>0?1:e<0?-1:0)}sumx2my2(e,t){return this.runFunction(e.args,t,this.metadata("SUMX2MY2"),(e,t)=>{const r=e.valuesFromTopLeftCorner(),s=t.valuesFromTopLeftCorner();if(r.length!==s.length)return new n.CellError(n.ErrorType.NA,o.ErrorMessage.EqualLength);const i=r.length;let a=0;for(let e=0;e<i;e++){const t=r[e],o=s[e];if(t instanceof n.CellError)return t;if(o instanceof n.CellError)return o;"number"==typeof t&&"number"==typeof o&&(a+=Math.pow(t,2)-Math.pow(o,2))}return a})}sumx2py2(e,t){return this.runFunction(e.args,t,this.metadata("SUMX2PY2"),(e,t)=>{const r=e.valuesFromTopLeftCorner(),s=t.valuesFromTopLeftCorner();if(r.length!==s.length)return new n.CellError(n.ErrorType.NA,o.ErrorMessage.EqualLength);const i=r.length;let a=0;for(let e=0;e<i;e++){const t=r[e],o=s[e];if(t instanceof n.CellError)return t;if(o instanceof n.CellError)return o;"number"==typeof t&&"number"==typeof o&&(a+=Math.pow(t,2)+Math.pow(o,2))}return a})}sumxmy2(e,t){return this.runFunction(e.args,t,this.metadata("SUMXMY2"),(e,t)=>{const r=e.valuesFromTopLeftCorner(),s=t.valuesFromTopLeftCorner();if(r.length!==s.length)return new n.CellError(n.ErrorType.NA,o.ErrorMessage.EqualLength);const i=r.length;let a=0;for(let e=0;e<i;e++){const t=r[e],o=s[e];if(t instanceof n.CellError)return t;if(o instanceof n.CellError)return o;"number"==typeof t&&"number"==typeof o&&(a+=Math.pow(t-o,2))}return a})}}function a(e,t){2*t>e&&(t=e-t);let r=1;for(let n=1;n<=t;n++)r*=(e-t+n)/n;return Math.round(r)}function u(e,t){for(e<t&&([e,t]=[t,e]);t>0;)[e,t]=[t,e%t];return e}t.MathPlugin=i,i.implementedFunctions={FACT:{method:"fact",parameters:[{argumentType:s.FunctionArgumentType.NUMBER,minValue:0,maxValue:170}]},FACTDOUBLE:{method:"factdouble",parameters:[{argumentType:s.FunctionArgumentType.NUMBER,minValue:0,maxValue:288}]},COMBIN:{method:"combin",parameters:[{argumentType:s.FunctionArgumentType.NUMBER,minValue:0,lessThan:1030},{argumentType:s.FunctionArgumentType.NUMBER,minValue:0}]},COMBINA:{method:"combina",parameters:[{argumentType:s.FunctionArgumentType.NUMBER,minValue:0},{argumentType:s.FunctionArgumentType.NUMBER,minValue:0}]},GCD:{method:"gcd",parameters:[{argumentType:s.FunctionArgumentType.ANY}],repeatLastArgs:1},LCM:{method:"lcm",parameters:[{argumentType:s.FunctionArgumentType.ANY}],repeatLastArgs:1},MROUND:{method:"mround",parameters:[{argumentType:s.FunctionArgumentType.NUMBER},{argumentType:s.FunctionArgumentType.NUMBER}]},MULTINOMIAL:{method:"multinomial",parameters:[{argumentType:s.FunctionArgumentType.NUMBER}],repeatLastArgs:1,expandRanges:!0},QUOTIENT:{method:"quotient",parameters:[{argumentType:s.FunctionArgumentType.NUMBER},{argumentType:s.FunctionArgumentType.NUMBER}]},SERIESSUM:{method:"seriessum",parameters:[{argumentType:s.FunctionArgumentType.NUMBER},{argumentType:s.FunctionArgumentType.NUMBER},{argumentType:s.FunctionArgumentType.NUMBER},{argumentType:s.FunctionArgumentType.RANGE}]},SIGN:{method:"sign",parameters:[{argumentType:s.FunctionArgumentType.NUMBER}]},SUMX2MY2:{method:"sumx2my2",parameters:[{argumentType:s.FunctionArgumentType.RANGE},{argumentType:s.FunctionArgumentType.RANGE}]},SUMX2PY2:{method:"sumx2py2",parameters:[{argumentType:s.FunctionArgumentType.RANGE},{argumentType:s.FunctionArgumentType.RANGE}]},SUMXMY2:{method:"sumxmy2",parameters:[{argumentType:s.FunctionArgumentType.RANGE},{argumentType:s.FunctionArgumentType.RANGE}]}}},function(e,t,r){"use strict";t.__esModule=!0,t.ComplexPlugin=void 0;var n=r(73),o=r(131),s=r(168),i=r(167);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
class a extends i.FunctionPlugin{complex(e,t){return this.runFunction(e.args,t,this.metadata("COMPLEX"),(e,t,r)=>"i"!==r&&"j"!==r?new n.CellError(n.ErrorType.VALUE,o.ErrorMessage.ShouldBeIorJ):(0,s.coerceComplexToString)([e,t],r))}imabs(e,t){return this.runFunction(e.args,t,this.metadata("IMABS"),f)}imaginary(e,t){return this.runFunction(e.args,t,this.metadata("IMAGINARY"),([e,t])=>t)}imreal(e,t){return this.runFunction(e.args,t,this.metadata("IMREAL"),([e,t])=>e)}imargument(e,t){return this.runFunction(e.args,t,this.metadata("IMARGUMENT"),([e,t])=>0===e&&0===t?new n.CellError(n.ErrorType.DIV_BY_ZERO):Math.atan2(t,e))}imconjugate(e,t){return this.runFunction(e.args,t,this.metadata("IMCONJUGATE"),([e,t])=>(0,s.coerceComplexToString)([e,-t]))}imcos(e,t){return this.runFunction(e.args,t,this.metadata("IMCOS"),e=>(0,s.coerceComplexToString)(h(e)))}imcosh(e,t){return this.runFunction(e.args,t,this.metadata("IMCOSH"),e=>(0,s.coerceComplexToString)(d(e)))}imcot(e,t){return this.runFunction(e.args,t,this.metadata("IMCOT"),e=>(0,s.coerceComplexToString)(l(h(e),p(e))))}imcsc(e,t){return this.runFunction(e.args,t,this.metadata("IMCSC"),e=>(0,s.coerceComplexToString)(l([1,0],p(e))))}imcsch(e,t){return this.runFunction(e.args,t,this.metadata("IMCSCH"),e=>(0,s.coerceComplexToString)(l([1,0],m(e))))}imsec(e,t){return this.runFunction(e.args,t,this.metadata("IMSEC"),e=>(0,s.coerceComplexToString)(l([1,0],h(e))))}imsech(e,t){return this.runFunction(e.args,t,this.metadata("IMSECH"),e=>(0,s.coerceComplexToString)(l([1,0],d(e))))}imsin(e,t){return this.runFunction(e.args,t,this.metadata("IMSIN"),e=>(0,s.coerceComplexToString)(p(e)))}imsinh(e,t){return this.runFunction(e.args,t,this.metadata("IMSINH"),e=>(0,s.coerceComplexToString)(m(e)))}imtan(e,t){return this.runFunction(e.args,t,this.metadata("IMTAN"),e=>(0,s.coerceComplexToString)(l(p(e),h(e))))}imdiv(e,t){return this.runFunction(e.args,t,this.metadata("IMDIV"),(e,t)=>(0,s.coerceComplexToString)(l(e,t)))}improduct(e,t){return this.runFunction(e.args,t,this.metadata("IMPRODUCT"),(...e)=>{const t=this.arithmeticHelper.coerceComplexExactRanges(e);if(t instanceof n.CellError)return t;let r=[1,0];for(const e of t)r=c(r,e);return(0,s.coerceComplexToString)(r)})}imsum(e,t){return this.runFunction(e.args,t,this.metadata("IMSUM"),(...e)=>{const t=this.arithmeticHelper.coerceComplexExactRanges(e);if(t instanceof n.CellError)return t;let r=[0,0];for(const e of t)r=u(r,e);return(0,s.coerceComplexToString)(r)})}imsub(e,t){return this.runFunction(e.args,t,this.metadata("IMSUB"),(e,t)=>(0,s.coerceComplexToString)(function([e,t],[r,n]){return[e-r,t-n]}(e,t)))}imexp(e,t){return this.runFunction(e.args,t,this.metadata("IMEXP"),e=>(0,s.coerceComplexToString)(g(e)))}imln(e,t){return this.runFunction(e.args,t,this.metadata("IMLN"),e=>(0,s.coerceComplexToString)(E(e)))}imlog10(e,t){return this.runFunction(e.args,t,this.metadata("IMLOG10"),e=>{const[t,r]=E(e),n=Math.log(10);return(0,s.coerceComplexToString)([t/n,r/n])})}imlog2(e,t){return this.runFunction(e.args,t,this.metadata("IMLOG2"),e=>{const[t,r]=E(e),n=Math.log(2);return(0,s.coerceComplexToString)([t/n,r/n])})}impower(e,t){return this.runFunction(e.args,t,this.metadata("IMPOWER"),(e,t)=>(0,s.coerceComplexToString)(T(e,t)))}imsqrt(e,t){return this.runFunction(e.args,t,this.metadata("IMSQRT"),e=>(0,s.coerceComplexToString)(T(e,.5)))}}function u([e,t],[r,n]){return[e+r,t+n]}function c([e,t],[r,n]){return[e*r-t*n,e*n+r*t]}function l([e,t],[r,n]){const o=Math.pow(r,2)+Math.pow(n,2),[s,i]=c([e,t],[r,-n]);return[s/o,i/o]}function h([e,t]){return[Math.cos(e)*Math.cosh(t),-Math.sin(e)*Math.sinh(t)]}function d([e,t]){return[Math.cosh(e)*Math.cos(t),Math.sinh(e)*Math.sin(t)]}function p([e,t]){return[Math.sin(e)*Math.cosh(t),Math.cos(e)*Math.sinh(t)]}function m([e,t]){return[Math.sinh(e)*Math.cos(t),Math.cosh(e)*Math.sin(t)]}function g([e,t]){return[Math.exp(e)*Math.cos(t),Math.exp(e)*Math.sin(t)]}function f([e,t]){return Math.sqrt(e*e+t*t)}function E([e,t]){return[Math.log(f([e,t])),Math.atan2(t,e)]}function T(e,t){const[r,n]=E(e);return g([t*r,t*n])}t.ComplexPlugin=a,a.implementedFunctions={COMPLEX:{method:"complex",parameters:[{argumentType:i.FunctionArgumentType.NUMBER},{argumentType:i.FunctionArgumentType.NUMBER},{argumentType:i.FunctionArgumentType.STRING,defaultValue:"i"}]},IMABS:{method:"imabs",parameters:[{argumentType:i.FunctionArgumentType.COMPLEX}]},IMAGINARY:{method:"imaginary",parameters:[{argumentType:i.FunctionArgumentType.COMPLEX}]},IMREAL:{method:"imreal",parameters:[{argumentType:i.FunctionArgumentType.COMPLEX}]},IMARGUMENT:{method:"imargument",parameters:[{argumentType:i.FunctionArgumentType.COMPLEX}]},IMCONJUGATE:{method:"imconjugate",parameters:[{argumentType:i.FunctionArgumentType.COMPLEX}]},IMCOS:{method:"imcos",parameters:[{argumentType:i.FunctionArgumentType.COMPLEX}]},IMCOSH:{method:"imcosh",parameters:[{argumentType:i.FunctionArgumentType.COMPLEX}]},IMCOT:{method:"imcot",parameters:[{argumentType:i.FunctionArgumentType.COMPLEX}]},IMCSC:{method:"imcsc",parameters:[{argumentType:i.FunctionArgumentType.COMPLEX}]},IMCSCH:{method:"imcsch",parameters:[{argumentType:i.FunctionArgumentType.COMPLEX}]},IMSEC:{method:"imsec",parameters:[{argumentType:i.FunctionArgumentType.COMPLEX}]},IMSECH:{method:"imsech",parameters:[{argumentType:i.FunctionArgumentType.COMPLEX}]},IMSIN:{method:"imsin",parameters:[{argumentType:i.FunctionArgumentType.COMPLEX}]},IMSINH:{method:"imsinh",parameters:[{argumentType:i.FunctionArgumentType.COMPLEX}]},IMTAN:{method:"imtan",parameters:[{argumentType:i.FunctionArgumentType.COMPLEX}]},IMDIV:{method:"imdiv",parameters:[{argumentType:i.FunctionArgumentType.COMPLEX},{argumentType:i.FunctionArgumentType.COMPLEX}]},IMPRODUCT:{method:"improduct",parameters:[{argumentType:i.FunctionArgumentType.ANY}],repeatLastArgs:1},IMSUM:{method:"imsum",parameters:[{argumentType:i.FunctionArgumentType.ANY}],repeatLastArgs:1},IMSUB:{method:"imsub",parameters:[{argumentType:i.FunctionArgumentType.COMPLEX},{argumentType:i.FunctionArgumentType.COMPLEX}]},IMEXP:{method:"imexp",parameters:[{argumentType:i.FunctionArgumentType.COMPLEX}]},IMLN:{method:"imln",parameters:[{argumentType:i.FunctionArgumentType.COMPLEX}]},IMLOG10:{method:"imlog10",parameters:[{argumentType:i.FunctionArgumentType.COMPLEX}]},IMLOG2:{method:"imlog2",parameters:[{argumentType:i.FunctionArgumentType.COMPLEX}]},IMPOWER:{method:"impower",parameters:[{argumentType:i.FunctionArgumentType.COMPLEX},{argumentType:i.FunctionArgumentType.NUMBER}]},IMSQRT:{method:"imsqrt",parameters:[{argumentType:i.FunctionArgumentType.COMPLEX}]}}},function(e,t,r){"use strict";t.__esModule=!0,t.StatisticalAggregationPlugin=void 0,r(2);var n=r(73),o=r(131),s=r(140),i=r(262),a=r(167);
/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */
class u extends a.FunctionPlugin{avedev(e,t){return this.runFunction(e.args,t,this.metadata("AVEDEV"),(...e)=>{const t=this.arithmeticHelper.coerceNumbersExactRanges(e);if(t instanceof n.CellError)return t;if(0===t.length)return new n.CellError(n.ErrorType.DIV_BY_ZERO);const r=(0,i.mean)(t);return t.reduce((e,t)=>e+Math.abs(t-r),0)/t.length})}devsq(e,t){return this.runFunction(e.args,t,this.metadata("DEVSQ"),(...e)=>{const t=this.arithmeticHelper.coerceNumbersExactRanges(e);return t instanceof n.CellError?t:0===t.length?0:(0,i.sumsqerr)(t)})}geomean(e,t){return this.runFunction(e.args,t,this.metadata("GEOMEAN"),(...e)=>{const t=this.arithmeticHelper.coerceNumbersExactRanges(e);if(t instanceof n.CellError)return t;if(0===t.length)return new n.CellError(n.ErrorType.NUM,o.ErrorMessage.OneValue);for(const e of t)if(e<=0)return new n.CellError(n.ErrorType.NUM,o.ErrorMessage.ValueSmall);return(0,i.geomean)(t)})}harmean(e,t){return this.runFunction(e.args,t,this.metadata("HARMEAN"),(...e)=>{const t=this.arithmeticHelper.coerceNumbersExactRanges(e);if(t instanceof n.CellError)return t;if(0===t.length)return new n.CellError(n.ErrorType.NUM,o.ErrorMessage.OneValue);for(const e of t)if(e<=0)return new n.CellError(n.ErrorType.NUM,o.ErrorMessage.ValueSmall);return t.length/t.reduce((e,t)=>e+1/t,0)})}correl(e,t){return this.runFunction(e.args,t,this.metadata("CORREL"),(e,t)=>{if(e.numberOfElements()!==t.numberOfElements())return new n.CellError(n.ErrorType.NA,o.ErrorMessage.EqualLength);const r=c(e,t);return r instanceof n.CellError?r:r[0].length<=1?new n.CellError(n.ErrorType.DIV_BY_ZERO,o.ErrorMessage.TwoValues):(0,i.corrcoeff)(r[0],r[1])})}rsq(e,t){return this.runFunction(e.args,t,this.metadata("RSQ"),(e,t)=>{if(e.numberOfElements()!==t.numberOfElements())return new n.CellError(n.ErrorType.NA,o.ErrorMessage.EqualLength);const r=c(e,t);return r instanceof n.CellError?r:r[0].length<=1?new n.CellError(n.ErrorType.DIV_BY_ZERO,o.ErrorMessage.TwoValues):Math.pow((0,i.corrcoeff)(r[0],r[1]),2)})}covariancep(e,t){return this.runFunction(e.args,t,this.metadata("COVARIANCE.P"),(e,t)=>{if(e.numberOfElements()!==t.numberOfElements())return new n.CellError(n.ErrorType.NA,o.ErrorMessage.EqualLength);const r=c(e,t);if(r instanceof n.CellError)return r;const s=r[0].length;return s<1?new n.CellError(n.ErrorType.DIV_BY_ZERO,o.ErrorMessage.OneValue):1===s?0:(0,i.covariance)(r[0],r[1])*(s-1)/s})}covariances(e,t){return this.runFunction(e.args,t,this.metadata("COVARIANCE.S"),(e,t)=>{if(e.numberOfElements()!==t.numberOfElements())return new n.CellError(n.ErrorType.NA,o.ErrorMessage.EqualLength);const r=c(e,t);return r instanceof n.CellError?r:r[0].length<=1?new n.CellError(n.ErrorType.DIV_BY_ZERO,o.ErrorMessage.TwoValues):(0,i.covariance)(r[0],r[1])})}ztest(e,t){return this.runFunction(e.args,t,this.metadata("Z.TEST"),(e,t,r)=>{const s=this.arithmeticHelper.manyToExactNumbers(e.valuesFromTopLeftCorner());if(s instanceof n.CellError)return s;const a=s.length;if(void 0===r){if(a<2)return new n.CellError(n.ErrorType.DIV_BY_ZERO,o.ErrorMessage.TwoValues);r=(0,i.stdev)(s,!0)}return a<1?new n.CellError(n.ErrorType.NA,o.ErrorMessage.OneValue):0===r?new n.CellError(n.ErrorType.DIV_BY_ZERO):1-i.normal.cdf(((0,i.mean)(s)-t)/(r/Math.sqrt(a)),0,1)})}ftest(e,t){return this.runFunction(e.args,t,this.metadata("F.TEST"),(e,t)=>{const r=this.arithmeticHelper.manyToExactNumbers(e.valuesFromTopLeftCorner()),o=this.arithmeticHelper.manyToExactNumbers(t.valuesFromTopLeftCorner());if(r instanceof n.CellError)return r;if(o instanceof n.CellError)return o;if(r.length<=1||o.length<=1)return new n.CellError(n.ErrorType.DIV_BY_ZERO);const s=(0,i.variance)(r,!0),a=(0,i.variance)(o,!0);if(0===s||0===a)return new n.CellError(n.ErrorType.DIV_BY_ZERO);const u=s/a,c=i.centralF.cdf(u,r.length-1,o.length-1);return 2*Math.min(c,1-c)})}steyx(e,t){return this.runFunction(e.args,t,this.metadata("STEYX"),(e,t)=>{if(e.numberOfElements()!==t.numberOfElements())return new n.CellError(n.ErrorType.NA,o.ErrorMessage.EqualLength);const r=c(e,t);if(r instanceof n.CellError)return r;const s=r[0].length;return s<=2?new n.CellError(n.ErrorType.DIV_BY_ZERO,o.ErrorMessage.ThreeValues):Math.sqrt(((0,i.sumsqerr)(r[0])-Math.pow((0,i.covariance)(r[0],r[1])*(s-1),2)/(0,i.sumsqerr)(r[1]))/(s-2))})}slope(e,t){return this.runFunction(e.args,t,this.metadata("SLOPE"),(e,t)=>{if(e.numberOfElements()!==t.numberOfElements())return new n.CellError(n.ErrorType.NA,o.ErrorMessage.EqualLength);const r=c(e,t);if(r instanceof n.CellError)return r;const s=r[0].length;return s<=1?new n.CellError(n.ErrorType.DIV_BY_ZERO,o.ErrorMessage.TwoValues):(0,i.covariance)(r[0],r[1])*(s-1)/(0,i.sumsqerr)(r[1])})}chisqtest(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.TEST"),(e,t)=>{const r=e.height(),s=e.width();if(t.height()!==r||t.width()!==s)return new n.CellError(n.ErrorType.NA,o.ErrorMessage.EqualLength);const a=c(e,t);if(a instanceof n.CellError)return a;if(a[0].length<=1)return new n.CellError(n.ErrorType.DIV_BY_ZERO,o.ErrorMessage.TwoValues);let u=0;for(let e=0;e<a[0].length;e++){if(0===a[1][e])return new n.CellError(n.ErrorType.DIV_BY_ZERO);u+=Math.pow(a[0][e]-a[1][e],2)/a[1][e]}return u<0?new n.CellError(n.ErrorType.NUM,o.ErrorMessage.NaN):1-i.chisquare.cdf(u,r>1&&s>1?(r-1)*(s-1):r*s-1)})}ttest(e,t){return this.runFunction(e.args,t,this.metadata("T.TEST"),(e,t,r,s)=>{const a=this.arithmeticHelper.manyToExactNumbers(e.valuesFromTopLeftCorner()),u=this.arithmeticHelper.manyToExactNumbers(t.valuesFromTopLeftCorner());if(a instanceof n.CellError)return a;if(u instanceof n.CellError)return u;const c=a.length,l=u.length;if(1===s){if(l!==c)return new n.CellError(n.ErrorType.NA,o.ErrorMessage.EqualLength);if(c<=1)return new n.CellError(n.ErrorType.DIV_BY_ZERO,o.ErrorMessage.TwoValues);const e=Array(c);for(let t=0;t<c;t++)e[t]=a[t]-u[t];const t=(0,i.stdev)(e,!0);if(0===t)return new n.CellError(n.ErrorType.DIV_BY_ZERO);const s=Math.abs(Math.sqrt(c)*(0,i.mean)(e)/t);return r*(1-i.studentt.cdf(s,c-1))}if(2===s){if(c<=1||l<=1)return new n.CellError(n.ErrorType.DIV_BY_ZERO,o.ErrorMessage.TwoValues);const e=((0,i.sumsqerr)(a)+(0,i.sumsqerr)(u))/(c+l-2);if(0===e)return new n.CellError(n.ErrorType.DIV_BY_ZERO);const t=Math.abs(((0,i.mean)(a)-(0,i.mean)(u))/Math.sqrt(e*(1/c+1/l)));return r*(1-i.studentt.cdf(t,c+l-2))}{if(c<=1||l<=1)return new n.CellError(n.ErrorType.DIV_BY_ZERO,o.ErrorMessage.TwoValues);const e=(0,i.variance)(a,!0),t=(0,i.variance)(u,!0);if(0===e&&0===t)return new n.CellError(n.ErrorType.DIV_BY_ZERO);const s=Math.abs(((0,i.mean)(a)-(0,i.mean)(u))/Math.sqrt(e/c+t/l)),h=Math.pow(e/c+t/l,2)/(Math.pow(e/c,2)/(c-1)+Math.pow(t/l,2)/(l-1));return r*(1-i.studentt.cdf(s,h))}})}skew(e,t){return this.runFunction(e.args,t,this.metadata("SKEW"),(...e)=>{const t=this.arithmeticHelper.coerceNumbersExactRanges(e);if(t instanceof n.CellError)return t;const r=t.length;if(r<3)return new n.CellError(n.ErrorType.DIV_BY_ZERO,o.ErrorMessage.ThreeValues);const s=(0,i.mean)(t),a=(0,i.stdev)(t,!0);return 0===a?new n.CellError(n.ErrorType.DIV_BY_ZERO):t.reduce((e,t)=>e+Math.pow((t-s)/a,3),0)*r/(r-1)/(r-2)})}skewp(e,t){return this.runFunction(e.args,t,this.metadata("SKEW.P"),(...e)=>{const t=this.arithmeticHelper.coerceNumbersExactRanges(e);if(t instanceof n.CellError)return t;const r=t.length;if(r<3)return new n.CellError(n.ErrorType.DIV_BY_ZERO,o.ErrorMessage.ThreeValues);const s=(0,i.mean)(t),a=(0,i.stdev)(t,!1);return 0===a?new n.CellError(n.ErrorType.DIV_BY_ZERO):t.reduce((e,t)=>e+Math.pow((t-s)/a,3),0)/r})}}function c(e,t){const r=e.iterateValuesFromTopLeftCorner(),o=t.iterateValuesFromTopLeftCorner();let i,a;const u=[],c=[];for(;i=r.next(),a=o.next(),!i.done&&!a.done;){const e=i.value,t=a.value;if(e instanceof n.CellError)return e;if(t instanceof n.CellError)return t;(0,s.isExtendedNumber)(e)&&(0,s.isExtendedNumber)(t)&&(u.push((0,s.getRawValue)(e)),c.push((0,s.getRawValue)(t)))}return[u,c]}t.StatisticalAggregationPlugin=u,u.implementedFunctions={AVEDEV:{method:"avedev",parameters:[{argumentType:a.FunctionArgumentType.ANY}],repeatLastArgs:1},DEVSQ:{method:"devsq",parameters:[{argumentType:a.FunctionArgumentType.ANY}],repeatLastArgs:1},GEOMEAN:{method:"geomean",parameters:[{argumentType:a.FunctionArgumentType.ANY}],repeatLastArgs:1},HARMEAN:{method:"harmean",parameters:[{argumentType:a.FunctionArgumentType.ANY}],repeatLastArgs:1},CORREL:{method:"correl",parameters:[{argumentType:a.FunctionArgumentType.RANGE},{argumentType:a.FunctionArgumentType.RANGE}]},RSQ:{method:"rsq",parameters:[{argumentType:a.FunctionArgumentType.RANGE},{argumentType:a.FunctionArgumentType.RANGE}]},"COVARIANCE.P":{method:"covariancep",parameters:[{argumentType:a.FunctionArgumentType.RANGE},{argumentType:a.FunctionArgumentType.RANGE}]},"COVARIANCE.S":{method:"covariances",parameters:[{argumentType:a.FunctionArgumentType.RANGE},{argumentType:a.FunctionArgumentType.RANGE}]},"Z.TEST":{method:"ztest",parameters:[{argumentType:a.FunctionArgumentType.RANGE},{argumentType:a.FunctionArgumentType.NUMBER},{argumentType:a.FunctionArgumentType.NUMBER,optionalArg:!0}]},"F.TEST":{method:"ftest",parameters:[{argumentType:a.FunctionArgumentType.RANGE},{argumentType:a.FunctionArgumentType.RANGE}]},STEYX:{method:"steyx",parameters:[{argumentType:a.FunctionArgumentType.RANGE},{argumentType:a.FunctionArgumentType.RANGE}]},SLOPE:{method:"slope",parameters:[{argumentType:a.FunctionArgumentType.RANGE},{argumentType:a.FunctionArgumentType.RANGE}]},"CHISQ.TEST":{method:"chisqtest",parameters:[{argumentType:a.FunctionArgumentType.RANGE},{argumentType:a.FunctionArgumentType.RANGE}]},"T.TEST":{method:"ttest",parameters:[{argumentType:a.FunctionArgumentType.RANGE},{argumentType:a.FunctionArgumentType.RANGE},{argumentType:a.FunctionArgumentType.INTEGER,minValue:1,maxValue:2},{argumentType:a.FunctionArgumentType.INTEGER,minValue:1,maxValue:3}]},SKEW:{method:"skew",parameters:[{argumentType:a.FunctionArgumentType.ANY}],repeatLastArgs:1},"SKEW.P":{method:"skewp",parameters:[{argumentType:a.FunctionArgumentType.ANY}],repeatLastArgs:1}},u.aliases={COVAR:"COVARIANCE.P",FTEST:"F.TEST",PEARSON:"CORREL",ZTEST:"Z.TEST",CHITEST:"CHISQ.TEST",TTEST:"T.TEST",COVARIANCEP:"COVARIANCE.P",COVARIANCES:"COVARIANCE.S",SKEWP:"SKEW.P"}}]).default},e.exports=n()},337:function(e,t,r){"use strict";r(294)},346:function(e,t,r){"use strict";r.r(t);var n=r(306),o=r.n(n),s=r(333),i=r.n(s),a=r(334),u=r.n(a);const c=o.a.buildEmpty().parser.getSerializedGastProductions();var l={data:()=>({diagram:u.a.buildSyntaxDiagramsText(c)}),mounted(){i.a.initDiagramsBehavior()}},h=(r(336),r(337),r(14)),d=Object(h.a)(l,(function(){var e=this._self._c;return e("div",[e("div",{staticClass:"diagram",domProps:{innerHTML:this._s(this.diagram)}})])}),[],!1,null,null,null);t.default=d.exports}}]);