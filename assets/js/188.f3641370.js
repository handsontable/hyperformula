(window.webpackJsonp=window.webpackJsonp||[]).push([[188],{550:function(t,e,n){"use strict";n.r(e);var a=n(28),s=Object(a.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"batch-operations"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#batch-operations"}},[t._v("#")]),t._v(" Batch operations")]),t._v(" "),e("p",[t._v("HyperFormula offers a built-in feature for doing batch operations.\nIt allows you to combine multiple data modification actions into a single operation.")]),t._v(" "),e("p",[t._v("In some cases, batch operations can result in better performance,\nespecially when your app requires doing a large number of operations.")]),t._v(" "),e("h2",{attrs:{id:"how-to-batch"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#how-to-batch"}},[t._v("#")]),t._v(" How to batch")]),t._v(" "),e("h3",{attrs:{id:"using-the-batch-method"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#using-the-batch-method"}},[t._v("#")]),t._v(" Using the "),e("RouterLink",{attrs:{to:"/api/classes/hyperformula.html#batch"}},[e("code",[t._v("batch")])]),t._v(" method")],1),t._v(" "),e("p",[t._v("You can use the "),e("RouterLink",{attrs:{to:"/api/classes/hyperformula.html#batch"}},[e("code",[t._v("batch")])]),t._v(" method to batch operations. This method accepts\njust one parameter: a callback function that stacks the selected\noperations into one. It performs the cumulative operation at the end.")],1),t._v(" "),e("p",[t._v("This method returns a list of cells whose values were affected by this\noperation together with their absolute addresses and new values.")]),t._v(" "),e("div",{staticClass:"language-javascript extra-class"},[e("pre",{pre:!0,attrs:{class:"language-javascript"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" hfInstance "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" HyperFormula"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("buildFromSheets")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("MySheet1")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'1'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("MySheet2")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'10'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// multiple operations in a single callback will trigger evaluation only once")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// and only one set of changes will be returned as a combined result of all")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// the operations that were triggered within the callback")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" changes "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" hfInstance"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("batch")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  hfInstance"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("setCellContents")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("col")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("row")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("sheet")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'=B1'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  hfInstance"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("setCellContents")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("col")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("row")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("sheet")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'=A1'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  \n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// and numerous others")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("h3",{attrs:{id:"using-the-suspendevaluation-and-resumeevaluation-methods"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#using-the-suspendevaluation-and-resumeevaluation-methods"}},[t._v("#")]),t._v(" Using the "),e("RouterLink",{attrs:{to:"/api/classes/hyperformula.html#suspendevaluation"}},[e("code",[t._v("suspendEvaluation")])]),t._v(" and "),e("RouterLink",{attrs:{to:"/api/classes/hyperformula.html#resumeevaluation"}},[e("code",[t._v("resumeEvaluation")])]),t._v(" methods")],1),t._v(" "),e("p",[t._v("The same result can be achieved by suspending and resuming the\nevaluation.")]),t._v(" "),e("p",[t._v("To do that you need to explicitly suspend the evaluation, then do the\noperations one by one, and then resume the evaluation.")]),t._v(" "),e("p",[t._v("This method returns a list of cells which values were affected by the\noperation together with their absolute addresses and new values.")]),t._v(" "),e("div",{staticClass:"language-javascript extra-class"},[e("pre",{pre:!0,attrs:{class:"language-javascript"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" hfInstance "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" HyperFormula"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("buildFromSheets")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("MySheet1")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'1'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("MySheet2")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'10'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// suspend the evaluation")]),t._v("\nhfInstance"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("suspendEvaluation")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// perform operations")]),t._v("\nhfInstance"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("setCellContents")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("col")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("row")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("sheet")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'=B1'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nhfInstance"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("setSheetContent")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'50'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'60'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// resume the evaluation")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" changes "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" hfInstance"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("resumeEvaluation")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("p",[t._v("You can resume the evaluation by calling the "),e("RouterLink",{attrs:{to:"/api/classes/hyperformula.html#resumeevaluation"}},[e("code",[t._v("resumeEvaluation")])]),t._v(" method\nwhich triggers the recalculation. Just like in the case of the "),e("RouterLink",{attrs:{to:"/api/classes/hyperformula.html#batch"}},[e("code",[t._v("batch")])]),t._v("\nmethod, it returns a list of cells which values changed after the\noperation, together with their absolute addresses, and new values.")],1),t._v(" "),e("h3",{attrs:{id:"checking-the-evaluation-suspension-state"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#checking-the-evaluation-suspension-state"}},[t._v("#")]),t._v(" Checking the evaluation suspension state")]),t._v(" "),e("p",[t._v("When you need to check if the evaluation is suspended you can\ncall the "),e("RouterLink",{attrs:{to:"/api/classes/hyperformula.html#isevaluationsuspended"}},[e("code",[t._v("isEvaluationSuspended")])]),t._v(" method.")],1),t._v(" "),e("div",{staticClass:"language-javascript extra-class"},[e("pre",{pre:!0,attrs:{class:"language-javascript"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" hfInstance "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" HyperFormula"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("buildEmpty")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// suspend the evaluation")]),t._v("\nhfInstance"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("suspendEvaluation")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// check if the evaluation is suspended")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// this method returns a simple boolean value")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" isEvaluationSuspended "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" hfInstance"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("isEvaluationSuspended")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// resume evaluation if needed")]),t._v("\nhfInstance"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("resumeEvaluation")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("h2",{attrs:{id:"when-to-batch"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#when-to-batch"}},[t._v("#")]),t._v(" When to batch")]),t._v(" "),e("p",[t._v("You can batch operations anytime you want to stack several actions into\none. However, if you want to see the most amazing benefits of this\nfeature, use batch operations when there are a lot of heavy methods.\nThis will result in better performance. The best candidates to\nbatch in this situation are the following methods:")]),t._v(" "),e("ul",[e("li",[e("code",[t._v("clearSheet")])]),t._v(" "),e("li",[e("code",[t._v("setSheetContent")])]),t._v(" "),e("li",[e("code",[t._v("setCellContents")])]),t._v(" "),e("li",[e("code",[t._v("addNamedExpression")])]),t._v(" "),e("li",[e("code",[t._v("changeNamedExpression")])]),t._v(" "),e("li",[e("code",[t._v("removeNamedExpression")])])]),t._v(" "),e("p",[t._v("These operations have an impact on calculation results and may affect\nthe performance.")]),t._v(" "),e("p",[t._v("Batching can be useful when there is a need for multiple memory-consuming\noperations. In this case, you should consider using it to achieve\nbetter performance in the application you develop; it will result\nin faster calculation across the whole HyperFormula instance.")]),t._v(" "),e("p",[t._v("Batching can also be useful when you decide to use HyperFormula\non the "),e("a",{attrs:{href:"server-side-installation"}},[t._v("server-side")]),t._v(". Several operations\ncan be sent as a single one.")]),t._v(" "),e("h2",{attrs:{id:"what-you-can-t-batch"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#what-you-can-t-batch"}},[t._v("#")]),t._v(" What you can't batch")]),t._v(" "),e("p",[t._v("You can't batch read operations.")]),t._v(" "),e("p",[t._v("Methods such as "),e("RouterLink",{attrs:{to:"/api/classes/hyperformula.html#getcellvalue"}},[e("code",[t._v("getCellValue")])]),t._v(", "),e("RouterLink",{attrs:{to:"/api/classes/hyperformula.html#getsheetserialized"}},[e("code",[t._v("getSheetSerialized")])]),t._v(", or "),e("RouterLink",{attrs:{to:"/api/classes/hyperformula.html#getfillrangedata"}},[e("code",[t._v("getFillRangeData")])]),t._v(" will result in an error when called inside a "),e("a",{attrs:{href:"#using-the-batch-method"}},[t._v("batch callback")]),t._v(" or when the evaluation is "),e("a",{attrs:{href:"#using-the-suspendevaluation-and-resumeevaluation-methods"}},[t._v("suspended")]),t._v(".")],1),t._v(" "),e("p",[t._v("The "),e("RouterLink",{attrs:{to:"/api/classes/hyperformula.html#paste"}},[t._v("paste")]),t._v(" method also can't be called when batching as it reads the contents of the copied cells.")],1),t._v(" "),e("h2",{attrs:{id:"demo"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#demo"}},[t._v("#")]),t._v(" Demo")]),t._v(" "),e("div",{staticClass:"example-container"},[e("style",{pre:!0},[t._v("/* general */\n.example {\n  color: #606c76;\n  font-family: sans-serif;\n  font-size: 14px;\n  font-weight: 400;\n  letter-spacing: .01em;\n  line-height: 1.6;\n  -webkit-box-sizing: border-box;\n  box-sizing: border-box;\n}\n\n.example *,\n.example *::before,\n.example *::after {\n  -webkit-box-sizing: border-box;\n  box-sizing: border-box;\n}\n\n/* buttons */\n\n.example button {\n  border: 0.1em solid #1c49e4;\n  border-radius: .3em;\n  color: #fff;\n  cursor: pointer;\n  display: inline-block;\n  font-size: .85em;\n  font-family: inherit;\n  font-weight: 700;\n  height: 3em;\n  letter-spacing: .1em;\n  line-height: 3em;\n  padding: 0 3em;\n  text-align: center;\n  text-decoration: none;\n  text-transform: uppercase;\n  white-space: nowrap;\n  margin-bottom: 20px;\n  background-color: #1c49e4;\n}\n\n.example button:hover {\n  background-color: #2350ea;\n}\n\n.example button.outline {\n  background-color: transparent;\n  color: #1c49e4;\n}\n\n/* labels */\n\n.example label {\n  display: inline-block;\n  margin-left: 5px;\n}\n\n/* inputs */\n\n.example input:not([type='checkbox']), .example select, .example textarea, .example fieldset {\n  margin-bottom: 1.5em;\n  border: 0.1em solid #d1d1d1;\n  border-radius: .4em;\n  height: 3.8em;\n  width: 12em;\n  padding: 0 .5em;\n}\n\n.example input:focus,\n.example select:focus {\n  outline: none;\n  border-color: #1c49e4;\n}\n\n/* message */\n\n.example .message-box {\n  border: 1px solid #1c49e433;\n  background-color: #1c49e405;\n  border-radius: 0.2em;\n  padding: 10px;\n}\n\n.example .message-box span {\n  animation-name: cell-appear;\n  animation-duration: 0.2s;\n  margin: 0;\n}\n\n/* table */\n\n.example table {\n  table-layout: fixed;\n  border-spacing: 0;\n  overflow-x: auto;\n  text-align: left;\n  width: 100%;\n  counter-reset: row-counter col-counter;\n}\n\n.example table tr:nth-child(2n) {\n  background-color: #f6f8fa;\n}\n\n.example table tr td,\n.example table tr th {\n  overflow: hidden;\n  text-overflow: ellipsis;\n  border-bottom: 0.1em solid #e1e1e1;\n  padding: 0 1em;\n  height: 3.5em;\n}\n\n/* table: header row */\n\n.example table thead tr th span::before {\n  display: inline-block;\n  width: 20px;\n}\n\n.example table.spreadsheet thead tr th span::before {\n  content: counter(col-counter, upper-alpha);\n}\n\n.example table.spreadsheet thead tr th {\n  counter-increment: col-counter;\n}\n\n/* table: first column */\n\n.example table tbody tr td:first-child {\n  text-align: center;\n  padding: 0;\n}\n\n.example table thead tr th:first-child {\n  padding-left: 40px;\n}\n\n.example table tbody tr td:first-child span {\n  width: 100%;\n  display: inline-block;\n  text-align: left;\n  padding-left: 15px;\n  margin-left: 0;\n}\n\n.example table tbody tr td:first-child span::before {\n  content: counter(row-counter);\n  display: inline-block;\n  width: 20px;\n  position: relative;\n  left: -10px;\n}\n\n.example table tbody tr {\n  counter-increment: row-counter;\n}\n\n/* table: summary row */\n\n.example table tbody tr.summary {\n  font-weight: 600;\n}\n\n/* updated-cell animation */\n\n.example table tr td.updated-cell span {\n  animation-name: cell-appear;\n  animation-duration: 0.6s;\n}\n\n@keyframes cell-appear {\n  from {\n    opacity: 0;\n  }\n  to {\n    opacity: 1;\n  }\n}\n")]),t._v(" "),e("div",{pre:!0},[e("div",{pre:!0,attrs:{"data-preset-type":"hot","data-example-id":"example1"}},[e("div",{pre:!0,attrs:{class:"example container"}},[e("div",[e("div",[e("button",{pre:!0,attrs:{id:"run",class:"button run"}},[t._v("\n        Run batch operation\n      ")]),t._v(" "),e("button",{pre:!0,attrs:{id:"reset",class:"button button-outline reset"}},[t._v("\n        Reset\n      ")])])]),t._v(" "),e("div",[e("div",{pre:!0,attrs:{style:"display: flex; align-items: center;"}},[e("input",{pre:!0,attrs:{id:"isCalculated",type:"checkbox",style:"margin: .1em"}}),t._v(" "),e("label",{pre:!0,attrs:{for:"isCalculated"}},[t._v("Calculated")])])]),t._v(" "),e("div",[e("table",[e("colgroup",[e("col",{pre:!0,attrs:{style:"width:25%"}}),t._v(" "),e("col",{pre:!0,attrs:{style:"width:15%"}}),t._v(" "),e("col",{pre:!0,attrs:{style:"width:20%"}}),t._v(" "),e("col",{pre:!0,attrs:{style:"width:20%"}}),t._v(" "),e("col",{pre:!0,attrs:{style:"width:20%"}})]),t._v(" "),e("thead",[e("tr",[e("th",[t._v("Name")]),t._v(" "),e("th",[t._v("Year_1")]),t._v(" "),e("th",[t._v("Year_2")]),t._v(" "),e("th",[t._v("Average")]),t._v(" "),e("th",[t._v("Sum")])])]),t._v(" "),e("tbody")])])])])]),t._v(" "),e("ScriptLoader",{attrs:{code:"%22use%20strict%22;%0A%0A/**%0A%20*%20Initial%20table%20data.%0A%20*/%0Avar%20tableData%20=%20%5B%5B'Greg%20Black',%204.66,%20'=B1*1.3',%20'=AVERAGE(B1:C1)',%20'=SUM(B1:C1)'%5D,%20%5B'Anne%20Carpenter',%205.25,%20'=$B$2*30%25',%20'=AVERAGE(B2:C2)',%20'=SUM(B2:C2)'%5D,%20%5B'Natalie%20Dem',%203.59,%20'=B3*2.7+2+1',%20'=AVERAGE(B3:C3)',%20'=SUM(B3:C3)'%5D,%20%5B'John%20Sieg',%2012.51,%20'=B4*(1.22+1)',%20'=AVERAGE(B4:C4)',%20'=SUM(B4:C4)'%5D,%20%5B'Chris%20Aklips',%207.63,%20'=B5*1.1*SUM(10,20)+1',%20'=AVERAGE(B5:C5)',%20'=SUM(B5:C5)'%5D%5D;%0A%0A//%20Create%20an%20empty%20HyperFormula%20instance.%0Avar%20hf%20=%20HyperFormula.buildEmpty(%7B%0A%20%20licenseKey:%20'gpl-v3'%0A%7D);%0A%0A//%20Add%20a%20new%20sheet%20and%20get%20its%20id.%0Avar%20sheetName%20=%20hf.addSheet('main');%0Avar%20sheetId%20=%20hf.getSheetId(sheetName);%0A%0A//%20Fill%20the%20HyperFormula%20sheet%20with%20data.%0Ahf.setCellContents(%7B%0A%20%20row:%200,%0A%20%20col:%200,%0A%20%20sheet:%20sheetId%0A%7D,%20tableData);%0A//%20Add%20named%20expressions%20for%20the%20%22TOTAL%22%20row.%0Ahf.addNamedExpression('Year_1',%20'=SUM(main!$B$1:main!$B$5)');%0Ahf.addNamedExpression('Year_2',%20'=SUM(main!$C$1:main!$C$5)');%0Avar%20ANIMATION_ENABLED%20=%20true;%0A%0A/**%0A%20*%20Fill%20the%20HTML%20table%20with%20data.%0A%20*%0A%20*%20@param%20%7Bboolean%7D%20calculated%20%60true%60%20if%20it%20should%20render%20calculated%20values,%20%60false%60%20otherwise.%0A%20*/%0Afunction%20renderTable()%20%7B%0A%20%20var%20calculated%20=%20arguments.length%20%3E%200%20&&%20arguments%5B0%5D%20!==%20undefined%20?%20arguments%5B0%5D%20:%20false;%0A%20%20var%20tbodyDOM%20=%20document.querySelector('.example%20tbody');%0A%20%20var%20updatedCellClass%20=%20ANIMATION_ENABLED%20?%20'updated-cell'%20:%20'';%0A%20%20var%20totals%20=%20%5B'=SUM(Year_1)',%20'=SUM(Year_2)'%5D;%0A%20%20var%20_hf$getSheetDimension%20=%20hf.getSheetDimensions(sheetId),%0A%20%20%20%20height%20=%20_hf$getSheetDimension.height,%0A%20%20%20%20width%20=%20_hf$getSheetDimension.width;%0A%20%20var%20newTbodyHTML%20=%20'';%0A%20%20var%20totalRowsHTML%20=%20'';%0A%20%20for%20(var%20row%20=%200;%20row%20%3C%20height;%20row++)%20%7B%0A%20%20%20%20for%20(var%20col%20=%200;%20col%20%3C%20width;%20col++)%20%7B%0A%20%20%20%20%20%20var%20cellAddress%20=%20%7B%0A%20%20%20%20%20%20%20%20sheet:%20sheetId,%0A%20%20%20%20%20%20%20%20col:%20col,%0A%20%20%20%20%20%20%20%20row:%20row%0A%20%20%20%20%20%20%7D;%0A%20%20%20%20%20%20var%20cellHasFormula%20=%20hf.doesCellHaveFormula(cellAddress);%0A%20%20%20%20%20%20var%20showFormula%20=%20calculated%20%7C%7C%20!cellHasFormula;%0A%20%20%20%20%20%20var%20cellValue%20=%20'';%0A%20%20%20%20%20%20if%20(!hf.isCellEmpty(cellAddress)%20&&%20showFormula)%20%7B%0A%20%20%20%20%20%20%20%20cellValue%20=%20hf.getCellValue(cellAddress);%0A%20%20%20%20%20%20%20%20if%20(!isNaN(cellValue))%20%7B%0A%20%20%20%20%20%20%20%20%20%20cellValue%20=%20cellValue.toFixed(2);%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20cellValue%20=%20hf.getCellFormula(cellAddress);%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20newTbodyHTML%20+=%20%22%3Ctd%20class=%5C%22%22.concat(cellHasFormula%20?%20updatedCellClass%20:%20'',%20%22%5C%22%3E%3Cspan%3E%5Cn%20%20%20%20%20%20%22).concat(cellValue,%20%22%5Cn%20%20%20%20%20%20%3C/span%3E%3C/td%3E%22);%0A%20%20%20%20%7D%0A%20%20%20%20newTbodyHTML%20+=%20'%3C/tr%3E';%0A%20%20%7D%0A%20%20totalRowsHTML%20=%20%22%3Ctr%20class=%5C%22summary%5C%22%3E%5Cn%20%20%3Ctd%3ETOTAL%3C/td%3E%5Cn%20%20%3Ctd%20class=%5C%22%22.concat(updatedCellClass,%20%22%5C%22%3E%5Cn%20%20%20%20%3Cspan%3E%22).concat(calculated%20?%20hf.calculateFormula(totals%5B0%5D,%20sheetId).toFixed(2)%20:%20totals%5B0%5D,%20%22%3C/span%3E%5Cn%20%20%3C/td%3E%5Cn%20%20%3Ctd%20class=%5C%22%22).concat(updatedCellClass,%20%22%5C%22%3E%5Cn%20%20%20%20%3Cspan%3E%22).concat(calculated%20?%20hf.calculateFormula(totals%5B1%5D,%20sheetId).toFixed(2)%20:%20totals%5B1%5D,%20%22%3C/span%3E%5Cn%20%20%3C/td%3E%5Cn%20%20%3Ctd%20colspan=%5C%222%5C%22%3E%3C/td%3E%5Cn%20%20%3C/tr%3E%22);%0A%20%20newTbodyHTML%20+=%20totalRowsHTML;%0A%20%20tbodyDOM.innerHTML%20=%20newTbodyHTML;%0A%7D%0Avar%20IS_CALCULATED%20=%20false;%0A%0A/**%0A%20*%20Bind%20the%20events%20to%20the%20buttons.%0A%20*/%0Afunction%20bindEvents()%20%7B%0A%20%20var%20runButton%20=%20document.querySelector('.example%20#run');%0A%20%20var%20resetButton%20=%20document.querySelector('.example%20#reset');%0A%20%20var%20calculatedCheckbox%20=%20document.querySelector('.example%20#isCalculated');%0A%20%20runButton.addEventListener('click',%20function%20()%20%7B%0A%20%20%20%20runBatchOperations();%0A%20%20%7D);%0A%20%20resetButton.addEventListener('click',%20function%20()%20%7B%0A%20%20%20%20resetTableData();%0A%20%20%7D);%0A%20%20calculatedCheckbox.addEventListener('change',%20function%20(e)%20%7B%0A%20%20%20%20if%20(e.target.checked)%20%7B%0A%20%20%20%20%20%20renderTable(true);%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20renderTable();%0A%20%20%20%20%7D%0A%20%20%20%20IS_CALCULATED%20=%20e.target.checked;%0A%20%20%7D);%0A%7D%0A%0A/**%0A%20*%20Reset%20the%20data%20for%20the%20table.%0A%20*/%0Afunction%20resetTableData()%20%7B%0A%20%20hf.setSheetContent(sheetId,%20tableData);%0A%20%20renderTable(IS_CALCULATED);%0A%7D%0A%0A/**%0A%20*%20Run%20batch%20operations.%0A%20*/%0Afunction%20runBatchOperations()%20%7B%0A%20%20hf.batch(function%20()%20%7B%0A%20%20%20%20hf.setCellContents(%7B%0A%20%20%20%20%20%20col:%201,%0A%20%20%20%20%20%20row:%200,%0A%20%20%20%20%20%20sheet:%20sheetId%0A%20%20%20%20%7D,%20%5B%5B'=B4'%5D%5D);%0A%20%20%20%20hf.setCellContents(%7B%0A%20%20%20%20%20%20col:%201,%0A%20%20%20%20%20%20row:%201,%0A%20%20%20%20%20%20sheet:%20sheetId%0A%20%20%20%20%7D,%20%5B%5B'=B4'%5D%5D);%0A%20%20%20%20hf.setCellContents(%7B%0A%20%20%20%20%20%20col:%201,%0A%20%20%20%20%20%20row:%202,%0A%20%20%20%20%20%20sheet:%20sheetId%0A%20%20%20%20%7D,%20%5B%5B'=B4'%5D%5D);%0A%20%20%20%20hf.setCellContents(%7B%0A%20%20%20%20%20%20col:%201,%0A%20%20%20%20%20%20row:%204,%0A%20%20%20%20%20%20sheet:%20sheetId%0A%20%20%20%20%7D,%20%5B%5B'=B4'%5D%5D);%0A%20%20%7D);%0A%20%20renderTable(IS_CALCULATED);%0A%7D%0A%0A//%20Bind%20the%20button%20events.%0AbindEvents();%0A//%20Render%20the%20table.%0ArenderTable();"}})],1),t._v(" "),e("div",{staticClass:"example-controls"},[e("form",{staticClass:"form-stackblitz-external",attrs:{action:"https://stackblitz.com/run",method:"post",target:"_blank"}},[e("textarea",{pre:!0,attrs:{class:"hidden",name:"project[files][package.json]",readOnly:""}},[t._v('{\n  "name": "hyperformula-demo",\n  "version": "1.0.0",\n  "main": "index.html",\n  "dependencies": {\n    "hyperformula": "latest",\n    "moment": "latest"\n  }\n}')]),t._v(" "),e("textarea",{pre:!0,attrs:{class:"hidden",name:"project[files][index.html]",readOnly:""}},[t._v('<!DOCTYPE html>\n<html>\n  <head>\n    <meta charset="utf-8" />\n    <meta name="viewport" content="width=device-width, initial-scale=1.0" />\n    <title>HyperFormula demo</title>\n  </head>\n\n  <body>\n    <div class="example container">\n  <div>\n    <div>\n      <button id="run" class="button run">\n        Run batch operation\n      </button>\n      <button id="reset" class="button button-outline reset">\n        Reset\n      </button>\n    </div>\n  </div>\n  <div>\n    <div style="display: flex; align-items: center;">\n      <input id="isCalculated" type="checkbox" style="margin: .1em"/>\n      <label for="isCalculated">Calculated</label>\n    </div>\n  </div>\n  <div>\n    <table>\n      <colgroup>\n        <col style="width:25%" />\n        <col style="width:15%" />\n        <col style="width:20%" />\n        <col style="width:20%" />\n        <col style="width:20%" />\n      </colgroup>\n      <thead>\n      <tr>\n        <th>Name</th>\n        <th>Year_1</th>\n        <th>Year_2</th>\n        <th>Average</th>\n        <th>Sum</th>\n      </tr>\n      </thead>\n      <tbody></tbody>\n    </table>\n  </div>\n</div>\n  </body>\n</html>')]),t._v(" "),e("textarea",{pre:!0,attrs:{class:"hidden",name:"project[files][styles.css]",readOnly:""}},[t._v("/* general */\n.example {\n  color: #606c76;\n  font-family: sans-serif;\n  font-size: 14px;\n  font-weight: 400;\n  letter-spacing: .01em;\n  line-height: 1.6;\n  -webkit-box-sizing: border-box;\n  box-sizing: border-box;\n}\n\n.example *,\n.example *::before,\n.example *::after {\n  -webkit-box-sizing: border-box;\n  box-sizing: border-box;\n}\n\n/* buttons */\n\n.example button {\n  border: 0.1em solid #1c49e4;\n  border-radius: .3em;\n  color: #fff;\n  cursor: pointer;\n  display: inline-block;\n  font-size: .85em;\n  font-family: inherit;\n  font-weight: 700;\n  height: 3em;\n  letter-spacing: .1em;\n  line-height: 3em;\n  padding: 0 3em;\n  text-align: center;\n  text-decoration: none;\n  text-transform: uppercase;\n  white-space: nowrap;\n  margin-bottom: 20px;\n  background-color: #1c49e4;\n}\n\n.example button:hover {\n  background-color: #2350ea;\n}\n\n.example button.outline {\n  background-color: transparent;\n  color: #1c49e4;\n}\n\n/* labels */\n\n.example label {\n  display: inline-block;\n  margin-left: 5px;\n}\n\n/* inputs */\n\n.example input:not([type='checkbox']), .example select, .example textarea, .example fieldset {\n  margin-bottom: 1.5em;\n  border: 0.1em solid #d1d1d1;\n  border-radius: .4em;\n  height: 3.8em;\n  width: 12em;\n  padding: 0 .5em;\n}\n\n.example input:focus,\n.example select:focus {\n  outline: none;\n  border-color: #1c49e4;\n}\n\n/* message */\n\n.example .message-box {\n  border: 1px solid #1c49e433;\n  background-color: #1c49e405;\n  border-radius: 0.2em;\n  padding: 10px;\n}\n\n.example .message-box span {\n  animation-name: cell-appear;\n  animation-duration: 0.2s;\n  margin: 0;\n}\n\n/* table */\n\n.example table {\n  table-layout: fixed;\n  border-spacing: 0;\n  overflow-x: auto;\n  text-align: left;\n  width: 100%;\n  counter-reset: row-counter col-counter;\n}\n\n.example table tr:nth-child(2n) {\n  background-color: #f6f8fa;\n}\n\n.example table tr td,\n.example table tr th {\n  overflow: hidden;\n  text-overflow: ellipsis;\n  border-bottom: 0.1em solid #e1e1e1;\n  padding: 0 1em;\n  height: 3.5em;\n}\n\n/* table: header row */\n\n.example table thead tr th span::before {\n  display: inline-block;\n  width: 20px;\n}\n\n.example table.spreadsheet thead tr th span::before {\n  content: counter(col-counter, upper-alpha);\n}\n\n.example table.spreadsheet thead tr th {\n  counter-increment: col-counter;\n}\n\n/* table: first column */\n\n.example table tbody tr td:first-child {\n  text-align: center;\n  padding: 0;\n}\n\n.example table thead tr th:first-child {\n  padding-left: 40px;\n}\n\n.example table tbody tr td:first-child span {\n  width: 100%;\n  display: inline-block;\n  text-align: left;\n  padding-left: 15px;\n  margin-left: 0;\n}\n\n.example table tbody tr td:first-child span::before {\n  content: counter(row-counter);\n  display: inline-block;\n  width: 20px;\n  position: relative;\n  left: -10px;\n}\n\n.example table tbody tr {\n  counter-increment: row-counter;\n}\n\n/* table: summary row */\n\n.example table tbody tr.summary {\n  font-weight: 600;\n}\n\n/* updated-cell animation */\n\n.example table tr td.updated-cell span {\n  animation-name: cell-appear;\n  animation-duration: 0.6s;\n}\n\n@keyframes cell-appear {\n  from {\n    opacity: 0;\n  }\n  to {\n    opacity: 1;\n  }\n}\n")]),t._v(" "),e("textarea",{pre:!0,attrs:{class:"hidden",name:"project[files][index.ts]",readOnly:""}},[t._v("import './styles.css'\nimport HyperFormula from 'hyperformula';\n\nconsole.log(\n  `%c Using HyperFormula ${HyperFormula.version}`,\n  'color: blue; font-weight: bold',\n);\n\n/**\n * Initial table data.\n */\nconst tableData = [\n  ['Greg Black', 4.66, '=B1*1.3', '=AVERAGE(B1:C1)', '=SUM(B1:C1)'],\n  ['Anne Carpenter', 5.25, '=$B$2*30%', '=AVERAGE(B2:C2)', '=SUM(B2:C2)'],\n  ['Natalie Dem', 3.59, '=B3*2.7+2+1', '=AVERAGE(B3:C3)', '=SUM(B3:C3)'],\n  ['John Sieg', 12.51, '=B4*(1.22+1)', '=AVERAGE(B4:C4)', '=SUM(B4:C4)'],\n  [\n    'Chris Aklips',\n    7.63,\n    '=B5*1.1*SUM(10,20)+1',\n    '=AVERAGE(B5:C5)',\n    '=SUM(B5:C5)',\n  ],\n];\n\n// Create an empty HyperFormula instance.\nconst hf = HyperFormula.buildEmpty({\n  licenseKey: 'gpl-v3',\n});\n\n// Add a new sheet and get its id.\nconst sheetName = hf.addSheet('main');\nconst sheetId = hf.getSheetId(sheetName);\n\n// Fill the HyperFormula sheet with data.\nhf.setCellContents(\n  {\n    row: 0,\n    col: 0,\n    sheet: sheetId,\n  },\n  tableData,\n);\n\n// Add named expressions for the \"TOTAL\" row.\nhf.addNamedExpression('Year_1', '=SUM(main!$B$1:main!$B$5)');\nhf.addNamedExpression('Year_2', '=SUM(main!$C$1:main!$C$5)');\n\nconst ANIMATION_ENABLED = true;\n\n/**\n * Fill the HTML table with data.\n *\n * @param {boolean} calculated `true` if it should render calculated values, `false` otherwise.\n */\nfunction renderTable(calculated = false) {\n  const tbodyDOM = document.querySelector('.example tbody');\n  const updatedCellClass = ANIMATION_ENABLED ? 'updated-cell' : '';\n  const totals = ['=SUM(Year_1)', '=SUM(Year_2)'];\n  const { height, width } = hf.getSheetDimensions(sheetId);\n  let newTbodyHTML = '';\n  let totalRowsHTML = '';\n\n  for (let row = 0; row < height; row++) {\n    for (let col = 0; col < width; col++) {\n      const cellAddress = { sheet: sheetId, col, row };\n      const cellHasFormula = hf.doesCellHaveFormula(cellAddress);\n      const showFormula = calculated || !cellHasFormula;\n      let cellValue = '';\n\n      if (!hf.isCellEmpty(cellAddress) && showFormula) {\n        cellValue = hf.getCellValue(cellAddress);\n\n        if (!isNaN(cellValue)) {\n          cellValue = cellValue.toFixed(2);\n        }\n      } else {\n        cellValue = hf.getCellFormula(cellAddress);\n      }\n\n      newTbodyHTML += `<td class=\"${\n        cellHasFormula ? updatedCellClass : ''\n      }\"><span>\n      ${cellValue}\n      </span></td>`;\n    }\n\n    newTbodyHTML += '</tr>';\n  }\n\n  totalRowsHTML = `<tr class=\"summary\">\n  <td>TOTAL</td>\n  <td class=\"${updatedCellClass}\">\n    <span>${\n      calculated\n        ? hf.calculateFormula(totals[0], sheetId).toFixed(2)\n        : totals[0]\n    }</span>\n  </td>\n  <td class=\"${updatedCellClass}\">\n    <span>${\n      calculated\n        ? hf.calculateFormula(totals[1], sheetId).toFixed(2)\n        : totals[1]\n    }</span>\n  </td>\n  <td colspan=\"2\"></td>\n  </tr>`;\n\n  newTbodyHTML += totalRowsHTML;\n\n  tbodyDOM.innerHTML = newTbodyHTML;\n}\n\nlet IS_CALCULATED = false;\n\n/**\n * Bind the events to the buttons.\n */\nfunction bindEvents() {\n  const runButton = document.querySelector('.example #run');\n  const resetButton = document.querySelector('.example #reset');\n  const calculatedCheckbox = document.querySelector('.example #isCalculated');\n\n  runButton.addEventListener('click', () => {\n    runBatchOperations();\n  });\n\n  resetButton.addEventListener('click', () => {\n    resetTableData();\n  });\n\n  calculatedCheckbox.addEventListener('change', (e) => {\n    if (e.target.checked) {\n      renderTable(true);\n    } else {\n      renderTable();\n    }\n\n    IS_CALCULATED = e.target.checked;\n  });\n}\n\n/**\n * Reset the data for the table.\n */\nfunction resetTableData() {\n  hf.setSheetContent(sheetId, tableData);\n  renderTable(IS_CALCULATED);\n}\n\n/**\n * Run batch operations.\n */\nfunction runBatchOperations() {\n  hf.batch(() => {\n    hf.setCellContents({ col: 1, row: 0, sheet: sheetId }, [['=B4']]);\n    hf.setCellContents({ col: 1, row: 1, sheet: sheetId }, [['=B4']]);\n    hf.setCellContents({ col: 1, row: 2, sheet: sheetId }, [['=B4']]);\n    hf.setCellContents({ col: 1, row: 4, sheet: sheetId }, [['=B4']]);\n  });\n\n  renderTable(IS_CALCULATED);\n}\n\n// Bind the button events.\nbindEvents();\n\n// Render the table.\nrenderTable();\n")]),t._v(" "),e("input",{attrs:{type:"hidden",name:"project[title]",value:"hyperformula-demo"}}),t._v(" "),e("input",{attrs:{type:"hidden",name:"project[dependencies]",value:'{"hyperformula":"latest", "moment": "latest"}'}}),t._v(" "),e("input",{attrs:{type:"hidden",name:"project[template]",value:"typescript"}}),t._v(" "),e("div",{staticClass:"js-stackblitz-link"},[e("button",{attrs:{type:"submit"}},[e("svg",{staticClass:"icon outbound",attrs:{xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",focusable:"false",width:"10.43",height:"15",preserveAspectRatio:"xMidYMid",viewBox:"0 0 256 368"}},[e("path",{attrs:{fill:"currentColor",d:"M109.586 217.013H0L200.34 0l-53.926 150.233H256L55.645 367.246l53.927-150.233z"}})]),t._v("\n        Open in Stackblitz\n      ")])])])]),t._v(" "),e("div"),e("div")])}),[],!1,null,null,null);e.default=s.exports}}]);