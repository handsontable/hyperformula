(window.webpackJsonp=window.webpackJsonp||[]).push([[72],{431:function(e,t,n){"use strict";n.r(t);var a=n(25),s=Object(a.a)({},(function(){var e=this,t=e._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"named-expressions"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#named-expressions"}},[e._v("#")]),e._v(" Named expressions")]),e._v(" "),t("p",[e._v("An expression can be assigned a human-friendly name. Thanks to this you can\nrefer to that name anywhere across the workbook. Names are especially useful\nwhen you use some references repeatedly. In this case, names simplify the\nformulas and reduce the risk of making a mistake. Such a worksheet is also\neasier to maintain.")]),e._v(" "),t("p",[e._v("You can name a formula, string, number, or any other type of data.")]),e._v(" "),t("p",[e._v("By default, references in named expressions are absolute. Most people use\nabsolute references in spreadsheet software like Excel without even knowing\nabout it. Very few know that references can be relative too. Unfortunately,\nHyperFormula doesn't support relative references inside named expressions at the\nmoment.")]),e._v(" "),t("p",[e._v("Dynamic ranges are supported through functions such as INDEX and OFFSET.")]),e._v(" "),t("p",[e._v("Named ranges can overlap each other, e.g., it is possible to define the names as\nfollows:")]),e._v(" "),t("ul",[t("li",[e._v("rangeOne: Sheet1!$A$1:$D$10")]),e._v(" "),t("li",[e._v("rangeTwo: Sheet1!$A$1:$E$1")])]),e._v(" "),t("h2",{attrs:{id:"examples"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#examples"}},[e._v("#")]),e._v(" Examples")]),e._v(" "),t("table",[t("thead",[t("tr",[t("th",{staticStyle:{"text-align":"left"}},[e._v("Type")]),e._v(" "),t("th",{staticStyle:{"text-align":"left"}},[e._v("Custom name")]),e._v(" "),t("th",{staticStyle:{"text-align":"left"}},[e._v("Example expression")])])]),e._v(" "),t("tbody",[t("tr",[t("td",{staticStyle:{"text-align":"left"}},[e._v("Named cell")]),e._v(" "),t("td",{staticStyle:{"text-align":"left"}},[e._v("myCell")]),e._v(" "),t("td",{staticStyle:{"text-align":"left"}},[e._v("=Sheet1!$A$1")])]),e._v(" "),t("tr",[t("td",{staticStyle:{"text-align":"left"}},[e._v("Named range of cells")]),e._v(" "),t("td",{staticStyle:{"text-align":"left"}},[e._v("myRange")]),e._v(" "),t("td",{staticStyle:{"text-align":"left"}},[e._v("=Sheet1!$A$1:$D$10")])]),e._v(" "),t("tr",[t("td",{staticStyle:{"text-align":"left"}},[e._v("Named constant (number)")]),e._v(" "),t("td",{staticStyle:{"text-align":"left"}},[e._v("myNumber")]),e._v(" "),t("td",{staticStyle:{"text-align":"left"}},[e._v("=10")])]),e._v(" "),t("tr",[t("td",{staticStyle:{"text-align":"left"}},[e._v("Named constant (string)")]),e._v(" "),t("td",{staticStyle:{"text-align":"left"}},[e._v("myText")]),e._v(" "),t("td",{staticStyle:{"text-align":"left"}},[e._v('="One Small Step for Man"')])]),e._v(" "),t("tr",[t("td",{staticStyle:{"text-align":"left"}},[e._v("Named formula")]),e._v(" "),t("td",{staticStyle:{"text-align":"left"}},[e._v("myFormula")]),e._v(" "),t("td",{staticStyle:{"text-align":"left"}},[e._v("=SUM(Sheet1!$A$1:$D$10)")])])])]),e._v(" "),t("h2",{attrs:{id:"naming-rules"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#naming-rules"}},[e._v("#")]),e._v(" Naming rules")]),e._v(" "),t("p",[e._v("Expression names are case-insensitive, and they:")]),e._v(" "),t("ul",[t("li",[e._v("Must start with a Unicode letter or with an underscore ("),t("code",[e._v("_")]),e._v(").")]),e._v(" "),t("li",[e._v("Can contain only Unicode letters, numbers, underscores, and periods ("),t("code",[e._v(".")]),e._v(").")]),e._v(" "),t("li",[e._v("Can't be the same as any possible reference in the A1 notation (for example,\n"),t("code",[e._v("Q4")]),e._v(" or "),t("code",[e._v("YEAR2023")]),e._v(").")]),e._v(" "),t("li",[e._v("Can't be the same as any possible reference in the R1C1 notation (for example,\n"),t("code",[e._v("R4C5")]),e._v(", "),t("code",[e._v("RC")]),e._v(" or "),t("code",[e._v("R0C")]),e._v(").")]),e._v(" "),t("li",[e._v("Must be unique within a given scope.")])]),e._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[e._v("TIP")]),e._v(" "),t("p",[e._v("Expression names must be unique within a given scope, but you can override a\nglobal named-expression with a local one. For example:")]),e._v(" "),t("div",{staticClass:"language-javascript extra-class"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// `MyRevenue` has to be unique within the global scope")]),e._v("\nhfInstance"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("addNamedExpression")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[e._v("'MyRevenue'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v("'=SUM(100+10)'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// but you can still use `MyRevenue` within the local scope of Sheet2 (sheetId = 1)")]),e._v("\nhfInstance"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("addNamedExpression")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[e._v("'MyRevenue'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v("'=Sheet2!$A$1+100'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n")])])])]),e._v(" "),t("p",[e._v("For examples of valid and invalid expression names, see the following table:")]),e._v(" "),t("table",[t("thead",[t("tr",[t("th",{staticStyle:{"text-align":"left"}},[e._v("Name")]),e._v(" "),t("th",{staticStyle:{"text-align":"left"}},[e._v("Validity")])])]),e._v(" "),t("tbody",[t("tr",[t("td",{staticStyle:{"text-align":"left"}},[e._v("my Revenue")]),e._v(" "),t("td",{staticStyle:{"text-align":"left"}},[e._v("Invalid")])]),e._v(" "),t("tr",[t("td",{staticStyle:{"text-align":"left"}},[e._v("myRevenue")]),e._v(" "),t("td",{staticStyle:{"text-align":"left"}},[e._v("Valid")])]),e._v(" "),t("tr",[t("td",{staticStyle:{"text-align":"left"}},[e._v("quarter1")]),e._v(" "),t("td",{staticStyle:{"text-align":"left"}},[e._v("Invalid")])]),e._v(" "),t("tr",[t("td",{staticStyle:{"text-align":"left"}},[e._v("quarter_1")]),e._v(" "),t("td",{staticStyle:{"text-align":"left"}},[e._v("Valid")])]),e._v(" "),t("tr",[t("td",{staticStyle:{"text-align":"left"}},[e._v("1stQuarter")]),e._v(" "),t("td",{staticStyle:{"text-align":"left"}},[e._v("Invalid")])]),e._v(" "),t("tr",[t("td",{staticStyle:{"text-align":"left"}},[e._v("_1stQuarter")]),e._v(" "),t("td",{staticStyle:{"text-align":"left"}},[e._v("Valid")])]),e._v(" "),t("tr",[t("td",{staticStyle:{"text-align":"left"}},[e._v(".NET")]),e._v(" "),t("td",{staticStyle:{"text-align":"left"}},[e._v("Invalid")])]),e._v(" "),t("tr",[t("td",{staticStyle:{"text-align":"left"}},[e._v("ASP.NET")]),e._v(" "),t("td",{staticStyle:{"text-align":"left"}},[e._v("Valid")])]),e._v(" "),t("tr",[t("td",{staticStyle:{"text-align":"left"}},[e._v("A1")]),e._v(" "),t("td",{staticStyle:{"text-align":"left"}},[e._v("Invalid")])]),e._v(" "),t("tr",[t("td",{staticStyle:{"text-align":"left"}},[e._v("$A$1")]),e._v(" "),t("td",{staticStyle:{"text-align":"left"}},[e._v("Invalid")])]),e._v(" "),t("tr",[t("td",{staticStyle:{"text-align":"left"}},[e._v("RC")]),e._v(" "),t("td",{staticStyle:{"text-align":"left"}},[e._v("Invalid")])])])]),e._v(" "),t("h2",{attrs:{id:"available-methods"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#available-methods"}},[e._v("#")]),e._v(" Available methods")]),e._v(" "),t("p",[e._v("These are the basic methods that can be used to add and manipulate named\nexpressions, including the creation and handling of named ranges. The full list\nof methods is available in the "),t("a",{attrs:{href:"../api"}},[e._v("API reference")]),e._v(".")]),e._v(" "),t("h3",{attrs:{id:"adding-a-named-expression"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#adding-a-named-expression"}},[e._v("#")]),e._v(" Adding a named expression")]),e._v(" "),t("p",[e._v("You can add a named expression by using the "),t("code",[e._v("addNamedExpression")]),e._v(" method. It\naccepts name for the expression, the expression as a raw cell content, and\noptionally the scope. If you do not define the scope it will be set to global,\nmeaning the expression name will be valid for the whole workbook. If you want to\nadd many of them, it is advised to do so in a "),t("RouterLink",{attrs:{to:"/guide/batch-operations.html"}},[e._v("batch")]),e._v(".\nThis method returns "),t("RouterLink",{attrs:{to:"/guide/basic-operations.html#changes-array"}},[e._v("an array of changed cells")]),e._v(".")],1),e._v(" "),t("div",{staticClass:"language-javascript extra-class"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// add 'prettyName' expression to the local scope of 'Sheet1' (sheetId = 0)")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("const")]),e._v(" changes "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" hfInstance"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("addNamedExpression")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("\n  "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v("'prettyName'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n  "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v("'=Sheet1!$A$1+100'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n  "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n")])])]),t("h3",{attrs:{id:"changing-a-named-expression"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#changing-a-named-expression"}},[e._v("#")]),e._v(" Changing a named expression")]),e._v(" "),t("p",[e._v("You can change a named expression by using the "),t("code",[e._v("changeNamedExpression")]),e._v(" method.\nSelect the name of an expression to change and pass it as the first parameter,\nthen define the new expression as raw cell content and optionally add the scope.\nIf you do not define the scope it will be set to global, meaning the expression\nwill be valid for the whole workbook. If you want to change many of them, it is\nadvised to do so in a "),t("RouterLink",{attrs:{to:"/guide/batch-operations.html"}},[e._v("batch")]),e._v(".\nThis method returns "),t("RouterLink",{attrs:{to:"/guide/basic-operations.html#changes-array"}},[e._v("an array of changed cells")]),e._v(".")],1),e._v(" "),t("div",{staticClass:"language-javascript extra-class"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// change the named expression")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("const")]),e._v(" changes "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" hfInstance"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("changeNamedExpression")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("\n  "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v("'prettyName'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n  "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v("'=Sheet1!$A$1+200'")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n")])])]),t("h3",{attrs:{id:"removing-a-named-expression"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#removing-a-named-expression"}},[e._v("#")]),e._v(" Removing a named expression")]),e._v(" "),t("p",[e._v("You can remove a named expression by using the "),t("code",[e._v("removeNamedExpression")]),e._v(" method.\nSelect the name of an expression to remove and pass it as the first parameter\nand optionally define the scope. If you do not define the scope it will be\nunderstood as global, meaning, the whole workbook.\nThis method returns "),t("RouterLink",{attrs:{to:"/guide/basic-operations.html#changes-array"}},[e._v("an array of changed cells")]),e._v(".")],1),e._v(" "),t("div",{staticClass:"language-javascript extra-class"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// remove 'prettyName' expression from 'Sheet1' (sheetId=0)")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("const")]),e._v(" changes "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" hfInstance"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("removeNamedExpression")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[e._v("'prettyName'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n")])])]),t("h3",{attrs:{id:"listing-all-named-expressions"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#listing-all-named-expressions"}},[e._v("#")]),e._v(" Listing all named expressions")]),e._v(" "),t("p",[e._v("You can retrieve a whole list of named expressions by using the\n"),t("code",[e._v("listNamedExpressions")]),e._v(" method. It requires no parameters and returns all named\nexpressions as an array of strings.")]),e._v(" "),t("div",{staticClass:"language-javascript extra-class"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// get all named-expression names")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("const")]),e._v(" listOfExpressions "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" hfInstance"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("listNamedExpressions")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n")])])]),t("h2",{attrs:{id:"handling-errors"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#handling-errors"}},[e._v("#")]),e._v(" Handling errors")]),e._v(" "),t("p",[e._v("Operations on named expressions throw errors when something goes wrong. These\nerrors can be "),t("RouterLink",{attrs:{to:"/guide/basic-operations.html#handling-an-error"}},[e._v("handled")]),e._v(" to provide a good\nuser experience in the application. It is also possible to check the\navailability of operations using "),t("code",[e._v("isItPossibleTo*")]),e._v(" methods, which are also\ndescribed in "),t("RouterLink",{attrs:{to:"/guide/basic-operations.html#isitpossibleto-methods"}},[e._v("that section")]),e._v(".")],1),e._v(" "),t("h2",{attrs:{id:"demo"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#demo"}},[e._v("#")]),e._v(" Demo")]),e._v(" "),t("div",{staticClass:"example-container"},[t("style",{pre:!0},[e._v("/* general */\n.example {\n  color: #606c76;\n  font-family: sans-serif;\n  font-size: 14px;\n  font-weight: 400;\n  letter-spacing: .01em;\n  line-height: 1.6;\n  -webkit-box-sizing: border-box;\n  box-sizing: border-box;\n}\n\n.example *,\n.example *::before,\n.example *::after {\n  -webkit-box-sizing: border-box;\n  box-sizing: border-box;\n}\n\n/* buttons */\n\n.example button {\n  border: 0.1em solid #1c49e4;\n  border-radius: .3em;\n  color: #fff;\n  cursor: pointer;\n  display: inline-block;\n  font-size: .85em;\n  font-family: inherit;\n  font-weight: 700;\n  height: 3em;\n  letter-spacing: .1em;\n  line-height: 3em;\n  padding: 0 3em;\n  text-align: center;\n  text-decoration: none;\n  text-transform: uppercase;\n  white-space: nowrap;\n  margin-bottom: 20px;\n  background-color: #1c49e4;\n}\n\n.example button:hover {\n  background-color: #2350ea;\n}\n\n.example button.outline {\n  background-color: transparent;\n  color: #1c49e4;\n}\n\n/* labels */\n\n.example label {\n  display: inline-block;\n  margin-left: 5px;\n}\n\n/* inputs */\n\n.example input:not([type='checkbox']), .example select, .example textarea, .example fieldset {\n  margin-bottom: 1.5em;\n  border: 0.1em solid #d1d1d1;\n  border-radius: .4em;\n  height: 3.8em;\n  width: 12em;\n  padding: 0 .5em;\n}\n\n.example input:focus,\n.example select:focus {\n  outline: none;\n  border-color: #1c49e4;\n}\n\n/* message */\n\n.example .message-box {\n  border: 1px solid #1c49e433;\n  background-color: #1c49e405;\n  border-radius: 0.2em;\n  padding: 10px;\n}\n\n.example .message-box span {\n  animation-name: cell-appear;\n  animation-duration: 0.2s;\n  margin: 0;\n}\n\n/* table */\n\n.example table {\n  table-layout: fixed;\n  border-spacing: 0;\n  overflow-x: auto;\n  text-align: left;\n  width: 100%;\n  counter-reset: row-counter col-counter;\n}\n\n.example table tr:nth-child(2n) {\n  background-color: #f6f8fa;\n}\n\n.example table tr td,\n.example table tr th {\n  overflow: hidden;\n  text-overflow: ellipsis;\n  border-bottom: 0.1em solid #e1e1e1;\n  padding: 0 1em;\n  height: 3.5em;\n}\n\n/* table: header row */\n\n.example table thead tr th span::before {\n  display: inline-block;\n  width: 20px;\n}\n\n.example table.spreadsheet thead tr th span::before {\n  content: counter(col-counter, upper-alpha);\n}\n\n.example table.spreadsheet thead tr th {\n  counter-increment: col-counter;\n}\n\n/* table: first column */\n\n.example table tbody tr td:first-child {\n  text-align: center;\n  padding: 0;\n}\n\n.example table thead tr th:first-child {\n  padding-left: 40px;\n}\n\n.example table tbody tr td:first-child span {\n  width: 100%;\n  display: inline-block;\n  text-align: left;\n  padding-left: 15px;\n  margin-left: 0;\n}\n\n.example table tbody tr td:first-child span::before {\n  content: counter(row-counter);\n  display: inline-block;\n  width: 20px;\n  position: relative;\n  left: -10px;\n}\n\n.example table tbody tr {\n  counter-increment: row-counter;\n}\n\n/* table: summary row */\n\n.example table tbody tr.summary {\n  font-weight: 600;\n}\n\n/* updated-cell animation */\n\n.example table tr td.updated-cell span {\n  animation-name: cell-appear;\n  animation-duration: 0.6s;\n}\n\n@keyframes cell-appear {\n  from {\n    opacity: 0;\n  }\n  to {\n    opacity: 1;\n  }\n}\n")]),e._v(" "),t("div",{pre:!0},[t("div",{pre:!0,attrs:{"data-preset-type":"hot","data-example-id":"example1"}},[t("div",{pre:!0,attrs:{class:"example"}},[t("button",{pre:!0,attrs:{id:"run",class:"button run"}},[e._v("\n    Run calculations\n  ")]),e._v(" "),t("button",{pre:!0,attrs:{id:"reset",class:"button button-outline reset"}},[e._v("\n    Reset\n  ")]),e._v(" "),t("table",[t("thead",[t("tr",[t("th",[e._v("A")]),e._v(" "),t("th",[e._v("B")]),e._v(" "),t("th",[e._v("C")]),e._v(" "),t("th",[e._v("D")])])]),e._v(" "),t("tbody")])])])]),e._v(" "),t("ScriptLoader",{attrs:{code:"%22use%20strict%22;%0A%0A/**%0A%20*%20Initial%20table%20data.%0A%20*/%0Avar%20tableData%20=%20%5B%5B10,%2020,%2020,%2030%5D,%20%5B50,%2060,%2070,%2080%5D,%20%5B90,%20100,%20110,%20120%5D,%20%5B'=myOneCell',%20'=myTwoCells',%20'=myOneColumn',%20'=myTwoColumns'%5D,%20%5B'=myFormula+myNumber+34',%20'=myText',%20'=myOneRow',%20'=myTwoRows'%5D%5D;%0A%0A//%20Create%20an%20empty%20HyperFormula%20instance.%0Avar%20hf%20=%20HyperFormula.buildEmpty(%7B%0A%20%20licenseKey:%20'gpl-v3'%0A%7D);%0A%0A//%20Add%20a%20new%20sheet%20and%20get%20its%20id.%0Avar%20sheetName%20=%20hf.addSheet('main');%0Avar%20sheetId%20=%20hf.getSheetId(sheetName);%0A%0A//%20Fill%20the%20HyperFormula%20sheet%20with%20data.%0Ahf.setCellContents(%7B%0A%20%20row:%200,%0A%20%20col:%200,%0A%20%20sheet:%20sheetId%0A%7D,%20tableData);%0A//%20Add%20named%20expressions%0Ahf.addNamedExpression('myOneCell',%20'=main!$A$1');%0Ahf.addNamedExpression('myTwoCells',%20'=SUM(main!$A$1,%20main!$A$2)');%0Ahf.addNamedExpression('myOneColumn',%20'=SUM(main!$A$1:main!$A$3)');%0Ahf.addNamedExpression('myTwoColumns',%20'=SUM(main!$A$1:main!$B$3)');%0Ahf.addNamedExpression('myOneRow',%20'=SUM(main!$A$1:main!$D$1)');%0Ahf.addNamedExpression('myTwoRows',%20'=SUM(main!$A$1:main!$D$2)');%0Ahf.addNamedExpression('myFormula',%20'=SUM(0,%201,%201,%202,%203,%205,%208,%2013)');%0Ahf.addNamedExpression('myNumber',%20'=21');%0Ahf.addNamedExpression('myText',%20'Apollo%2011');%0A%0A/**%0A%20*%20Fill%20the%20HTML%20table%20with%20data.%0A%20*%0A%20*%20@param%20%7Bboolean%7D%20calculated%20%60true%60%20if%20it%20should%20render%20calculated%20values,%20%60false%60%20otherwise.%0A%20*/%0Afunction%20renderTable()%20%7B%0A%20%20var%20calculated%20=%20arguments.length%20%3E%200%20&&%20arguments%5B0%5D%20!==%20undefined%20?%20arguments%5B0%5D%20:%20false;%0A%20%20var%20tbodyDOM%20=%20document.querySelector('.example%20tbody');%0A%20%20var%20updatedCellClass%20=%20ANIMATION_ENABLED%20?%20'updated-cell'%20:%20'';%0A%20%20var%20_hf$getSheetDimension%20=%20hf.getSheetDimensions(sheetId),%0A%20%20%20%20height%20=%20_hf$getSheetDimension.height,%0A%20%20%20%20width%20=%20_hf$getSheetDimension.width;%0A%20%20var%20newTbodyHTML%20=%20'';%0A%20%20for%20(var%20row%20=%200;%20row%20%3C%20height;%20row++)%20%7B%0A%20%20%20%20for%20(var%20col%20=%200;%20col%20%3C%20width;%20col++)%20%7B%0A%20%20%20%20%20%20var%20cellAddress%20=%20%7B%0A%20%20%20%20%20%20%20%20sheet:%20sheetId,%0A%20%20%20%20%20%20%20%20col:%20col,%0A%20%20%20%20%20%20%20%20row:%20row%0A%20%20%20%20%20%20%7D;%0A%20%20%20%20%20%20var%20cellHasFormula%20=%20hf.doesCellHaveFormula(cellAddress);%0A%20%20%20%20%20%20var%20showFormula%20=%20calculated%20%7C%7C%20!cellHasFormula;%0A%20%20%20%20%20%20var%20cellValue%20=%20'';%0A%20%20%20%20%20%20if%20(!hf.isCellEmpty(cellAddress)%20&&%20showFormula)%20%7B%0A%20%20%20%20%20%20%20%20cellValue%20=%20hf.getCellValue(cellAddress);%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20cellValue%20=%20hf.getCellFormula(cellAddress);%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20newTbodyHTML%20+=%20%22%3Ctd%20class=%5C%22%22.concat(cellHasFormula%20?%20updatedCellClass%20:%20'',%20%22%5C%22%3E%3Cspan%3E%5Cn%20%20%20%20%20%20%22).concat(cellValue,%20%22%5Cn%20%20%20%20%20%20%3C/span%3E%3C/td%3E%22);%0A%20%20%20%20%7D%0A%20%20%20%20newTbodyHTML%20+=%20'%3C/tr%3E';%0A%20%20%7D%0A%20%20tbodyDOM.innerHTML%20=%20newTbodyHTML;%0A%7D%0A%0A/**%0A%20*%20Replace%20formulas%20with%20their%20results.%0A%20*/%0Afunction%20runCalculations()%20%7B%0A%20%20renderTable(true);%0A%7D%0A%0A/**%0A%20*%20Replace%20the%20values%20in%20the%20table%20with%20initial%20data.%0A%20*/%0Afunction%20resetTable()%20%7B%0A%20%20renderTable();%0A%7D%0A%0A/**%0A%20*%20Bind%20the%20events%20to%20the%20buttons.%0A%20*/%0Afunction%20bindEvents()%20%7B%0A%20%20var%20runButton%20=%20document.querySelector('.example%20#run');%0A%20%20var%20resetButton%20=%20document.querySelector('.example%20#reset');%0A%20%20runButton.addEventListener('click',%20function%20()%20%7B%0A%20%20%20%20runCalculations();%0A%20%20%7D);%0A%20%20resetButton.addEventListener('click',%20function%20()%20%7B%0A%20%20%20%20resetTable();%0A%20%20%7D);%0A%7D%0Avar%20ANIMATION_ENABLED%20=%20true;%0A%0A//%20Bind%20the%20button%20events.%0AbindEvents();%0A//%20Render%20the%20table.%0ArenderTable();"}})],1),e._v(" "),t("div",{staticClass:"example-controls"},[t("form",{staticClass:"form-stackblitz-external",attrs:{action:"https://stackblitz.com/run",method:"post",target:"_blank"}},[t("textarea",{pre:!0,attrs:{class:"hidden",name:"project[files][package.json]",readOnly:""}},[e._v('{\n  "name": "hyperformula-demo",\n  "version": "1.0.0",\n  "main": "index.html",\n  "dependencies": {\n    "hyperformula": "latest",\n    "moment": "latest"\n  }\n}')]),e._v(" "),t("textarea",{pre:!0,attrs:{class:"hidden",name:"project[files][index.html]",readOnly:""}},[e._v('<!DOCTYPE html>\n<html>\n  <head>\n    <meta charset="utf-8" />\n    <meta name="viewport" content="width=device-width, initial-scale=1.0" />\n    <title>HyperFormula demo</title>\n  </head>\n\n  <body>\n    <div class="example">\n  <button id="run" class="button run">\n    Run calculations\n  </button>\n  <button id="reset" class="button button-outline reset">\n    Reset\n  </button>\n  <table>\n    <thead>\n    <tr>\n      <th>A</th>\n      <th>B</th>\n      <th>C</th>\n      <th>D</th>\n    </tr>\n    </thead>\n    <tbody></tbody>\n  </table>\n</div>\n\n  </body>\n</html>')]),e._v(" "),t("textarea",{pre:!0,attrs:{class:"hidden",name:"project[files][styles.css]",readOnly:""}},[e._v("/* general */\n.example {\n  color: #606c76;\n  font-family: sans-serif;\n  font-size: 14px;\n  font-weight: 400;\n  letter-spacing: .01em;\n  line-height: 1.6;\n  -webkit-box-sizing: border-box;\n  box-sizing: border-box;\n}\n\n.example *,\n.example *::before,\n.example *::after {\n  -webkit-box-sizing: border-box;\n  box-sizing: border-box;\n}\n\n/* buttons */\n\n.example button {\n  border: 0.1em solid #1c49e4;\n  border-radius: .3em;\n  color: #fff;\n  cursor: pointer;\n  display: inline-block;\n  font-size: .85em;\n  font-family: inherit;\n  font-weight: 700;\n  height: 3em;\n  letter-spacing: .1em;\n  line-height: 3em;\n  padding: 0 3em;\n  text-align: center;\n  text-decoration: none;\n  text-transform: uppercase;\n  white-space: nowrap;\n  margin-bottom: 20px;\n  background-color: #1c49e4;\n}\n\n.example button:hover {\n  background-color: #2350ea;\n}\n\n.example button.outline {\n  background-color: transparent;\n  color: #1c49e4;\n}\n\n/* labels */\n\n.example label {\n  display: inline-block;\n  margin-left: 5px;\n}\n\n/* inputs */\n\n.example input:not([type='checkbox']), .example select, .example textarea, .example fieldset {\n  margin-bottom: 1.5em;\n  border: 0.1em solid #d1d1d1;\n  border-radius: .4em;\n  height: 3.8em;\n  width: 12em;\n  padding: 0 .5em;\n}\n\n.example input:focus,\n.example select:focus {\n  outline: none;\n  border-color: #1c49e4;\n}\n\n/* message */\n\n.example .message-box {\n  border: 1px solid #1c49e433;\n  background-color: #1c49e405;\n  border-radius: 0.2em;\n  padding: 10px;\n}\n\n.example .message-box span {\n  animation-name: cell-appear;\n  animation-duration: 0.2s;\n  margin: 0;\n}\n\n/* table */\n\n.example table {\n  table-layout: fixed;\n  border-spacing: 0;\n  overflow-x: auto;\n  text-align: left;\n  width: 100%;\n  counter-reset: row-counter col-counter;\n}\n\n.example table tr:nth-child(2n) {\n  background-color: #f6f8fa;\n}\n\n.example table tr td,\n.example table tr th {\n  overflow: hidden;\n  text-overflow: ellipsis;\n  border-bottom: 0.1em solid #e1e1e1;\n  padding: 0 1em;\n  height: 3.5em;\n}\n\n/* table: header row */\n\n.example table thead tr th span::before {\n  display: inline-block;\n  width: 20px;\n}\n\n.example table.spreadsheet thead tr th span::before {\n  content: counter(col-counter, upper-alpha);\n}\n\n.example table.spreadsheet thead tr th {\n  counter-increment: col-counter;\n}\n\n/* table: first column */\n\n.example table tbody tr td:first-child {\n  text-align: center;\n  padding: 0;\n}\n\n.example table thead tr th:first-child {\n  padding-left: 40px;\n}\n\n.example table tbody tr td:first-child span {\n  width: 100%;\n  display: inline-block;\n  text-align: left;\n  padding-left: 15px;\n  margin-left: 0;\n}\n\n.example table tbody tr td:first-child span::before {\n  content: counter(row-counter);\n  display: inline-block;\n  width: 20px;\n  position: relative;\n  left: -10px;\n}\n\n.example table tbody tr {\n  counter-increment: row-counter;\n}\n\n/* table: summary row */\n\n.example table tbody tr.summary {\n  font-weight: 600;\n}\n\n/* updated-cell animation */\n\n.example table tr td.updated-cell span {\n  animation-name: cell-appear;\n  animation-duration: 0.6s;\n}\n\n@keyframes cell-appear {\n  from {\n    opacity: 0;\n  }\n  to {\n    opacity: 1;\n  }\n}\n")]),e._v(" "),t("textarea",{pre:!0,attrs:{class:"hidden",name:"project[files][index.ts]",readOnly:""}},[e._v("import './styles.css'\nimport HyperFormula from 'hyperformula';\n\nconsole.log(\n  `%c Using HyperFormula ${HyperFormula.version}`,\n  'color: blue; font-weight: bold',\n);\n\n/**\n * Initial table data.\n */\nconst tableData = [\n  [10, 20, 20, 30],\n  [50, 60, 70, 80],\n  [90, 100, 110, 120],\n  ['=myOneCell', '=myTwoCells', '=myOneColumn', '=myTwoColumns'],\n  ['=myFormula+myNumber+34', '=myText', '=myOneRow', '=myTwoRows'],\n];\n\n// Create an empty HyperFormula instance.\nconst hf = HyperFormula.buildEmpty({\n  licenseKey: 'gpl-v3',\n});\n\n// Add a new sheet and get its id.\nconst sheetName = hf.addSheet('main');\nconst sheetId = hf.getSheetId(sheetName);\n\n// Fill the HyperFormula sheet with data.\nhf.setCellContents(\n  {\n    row: 0,\n    col: 0,\n    sheet: sheetId,\n  },\n  tableData,\n);\n\n// Add named expressions\nhf.addNamedExpression('myOneCell', '=main!$A$1');\nhf.addNamedExpression('myTwoCells', '=SUM(main!$A$1, main!$A$2)');\nhf.addNamedExpression('myOneColumn', '=SUM(main!$A$1:main!$A$3)');\nhf.addNamedExpression('myTwoColumns', '=SUM(main!$A$1:main!$B$3)');\nhf.addNamedExpression('myOneRow', '=SUM(main!$A$1:main!$D$1)');\nhf.addNamedExpression('myTwoRows', '=SUM(main!$A$1:main!$D$2)');\nhf.addNamedExpression('myFormula', '=SUM(0, 1, 1, 2, 3, 5, 8, 13)');\nhf.addNamedExpression('myNumber', '=21');\nhf.addNamedExpression('myText', 'Apollo 11');\n\n/**\n * Fill the HTML table with data.\n *\n * @param {boolean} calculated `true` if it should render calculated values, `false` otherwise.\n */\nfunction renderTable(calculated = false) {\n  const tbodyDOM = document.querySelector('.example tbody');\n  const updatedCellClass = ANIMATION_ENABLED ? 'updated-cell' : '';\n\n  const { height, width } = hf.getSheetDimensions(sheetId);\n  let newTbodyHTML = '';\n\n  for (let row = 0; row < height; row++) {\n    for (let col = 0; col < width; col++) {\n      const cellAddress = { sheet: sheetId, col, row };\n      const cellHasFormula = hf.doesCellHaveFormula(cellAddress);\n      const showFormula = calculated || !cellHasFormula;\n      let cellValue = '';\n\n      if (!hf.isCellEmpty(cellAddress) && showFormula) {\n        cellValue = hf.getCellValue(cellAddress);\n      } else {\n        cellValue = hf.getCellFormula(cellAddress);\n      }\n\n      newTbodyHTML += `<td class=\"${\n        cellHasFormula ? updatedCellClass : ''\n      }\"><span>\n      ${cellValue}\n      </span></td>`;\n    }\n\n    newTbodyHTML += '</tr>';\n  }\n\n  tbodyDOM.innerHTML = newTbodyHTML;\n}\n\n/**\n * Replace formulas with their results.\n */\nfunction runCalculations() {\n  renderTable(true);\n}\n\n/**\n * Replace the values in the table with initial data.\n */\nfunction resetTable() {\n  renderTable();\n}\n\n/**\n * Bind the events to the buttons.\n */\nfunction bindEvents() {\n  const runButton = document.querySelector('.example #run');\n  const resetButton = document.querySelector('.example #reset');\n\n  runButton.addEventListener('click', () => {\n    runCalculations();\n  });\n\n  resetButton.addEventListener('click', () => {\n    resetTable();\n  });\n}\n\nconst ANIMATION_ENABLED = true;\n\n// Bind the button events.\nbindEvents();\n\n// Render the table.\nrenderTable();\n")]),e._v(" "),t("input",{attrs:{type:"hidden",name:"project[title]",value:"hyperformula-demo"}}),e._v(" "),t("input",{attrs:{type:"hidden",name:"project[dependencies]",value:'{"hyperformula":"latest", "moment": "latest"}'}}),e._v(" "),t("input",{attrs:{type:"hidden",name:"project[template]",value:"typescript"}}),e._v(" "),t("div",{staticClass:"js-stackblitz-link"},[t("button",{attrs:{type:"submit"}},[t("svg",{staticClass:"icon outbound",attrs:{xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",focusable:"false",width:"10.43",height:"15",preserveAspectRatio:"xMidYMid",viewBox:"0 0 256 368"}},[t("path",{attrs:{fill:"currentColor",d:"M109.586 217.013H0L200.34 0l-53.926 150.233H256L55.645 367.246l53.927-150.233z"}})]),e._v("\n        Open in Stackblitz\n      ")])])])]),e._v(" "),t("div"),t("div")])}),[],!1,null,null,null);t.default=s.exports}}]);