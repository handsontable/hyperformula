(window.webpackJsonp=window.webpackJsonp||[]).push([[77],{436:function(t,n,e){"use strict";e.r(n);var a=e(25),s=Object(a.a)({},(function(){var t=this,n=t._self._c;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h1",{attrs:{id:"sorting-data"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#sorting-data"}},[t._v("#")]),t._v(" Sorting data")]),t._v(" "),n("p",[t._v("In HyperFormula, you can sort data by reordering rows and columns.")]),t._v(" "),n("h2",{attrs:{id:"sorting-data-in-hyperformula"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#sorting-data-in-hyperformula"}},[t._v("#")]),t._v(" Sorting data in HyperFormula")]),t._v(" "),n("p",[t._v("To sort data in HyperFormula, you reorder rows (or columns), by providing your preferred permutation of row (or column) indexes.")]),t._v(" "),n("p",[t._v("You can implement any sorting algorithm that returns an array of row or column indexes.")]),t._v(" "),n("h2",{attrs:{id:"sorting-rows"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#sorting-rows"}},[t._v("#")]),t._v(" Sorting rows")]),t._v(" "),n("p",[t._v("To sort rows, use the "),n("RouterLink",{attrs:{to:"/api/classes/hyperformula.html#isitpossibletosetroworder"}},[n("code",[t._v("isItPossibleToSetRowOrder")])]),t._v(" and "),n("RouterLink",{attrs:{to:"/api/classes/hyperformula.html#setroworder"}},[n("code",[t._v("setRowOrder")])]),t._v(" methods.")],1),t._v(" "),n("h3",{attrs:{id:"step-1-choose-a-new-row-order"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#step-1-choose-a-new-row-order"}},[t._v("#")]),t._v(" Step 1: Choose a new row order")]),t._v(" "),n("p",[t._v("Choose your required permutation of row indexes.")]),t._v(" "),n("p",[t._v("For example, if you want to swap the first row with the third row, set the order to "),n("code",[t._v("[2, 1, 0]")]),t._v(" instead of "),n("code",[t._v("[0, 1, 2]")]),t._v(":")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// a HyperFormula instance with example data")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" hfInstance "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" HyperFormula"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("buildFromArray")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// we'll set the row order to [2, 1, 0] in the next steps")]),t._v("\n")])])]),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),n("p",[t._v("The "),n("RouterLink",{attrs:{to:"/api/classes/hyperformula.html#setroworder"}},[n("code",[t._v("setRowOrder")])]),t._v(" method accepts an array of numbers, so you can implement any function that returns an array with your required row order.")],1)]),t._v(" "),n("h3",{attrs:{id:"step-2-check-if-the-new-row-order-can-be-applied"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#step-2-check-if-the-new-row-order-can-be-applied"}},[t._v("#")]),t._v(" Step 2: Check if the new row order can be applied")]),t._v(" "),n("p",[t._v("Before you change the row order, check if your specified row number permutation can actually be applied.")]),t._v(" "),n("p",[t._v("Thanks to the "),n("RouterLink",{attrs:{to:"/guide/basic-operations.html#isitpossibleto-methods"}},[n("code",[t._v("isItPossibleTo*")]),t._v(" methods")]),t._v(", you can check if an operation is allowed, and display an error message if it's not.")],1),t._v(" "),n("p",[t._v("Use the "),n("RouterLink",{attrs:{to:"/api/classes/hyperformula.html#isitpossibletosetroworder"}},[n("code",[t._v("isItPossibleToSetRowOrder")])]),t._v(" method:")],1),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" hfInstance "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" HyperFormula"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("buildFromArray")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// a variable to carry the user message")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" messageUsedInUI"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// check if your permutation can be applied")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" isRowOrderOk "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" hfInstance"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("isItPossibleToSetRowOrder")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// display an error message")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("isRowOrderOk"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  messageUsedInUI "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Sorry, you cannot sort rows in this way.'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("h3",{attrs:{id:"step-3-set-the-new-row-order"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#step-3-set-the-new-row-order"}},[t._v("#")]),t._v(" Step 3: Set the new row order")]),t._v(" "),n("p",[t._v("If your specified row number permutation is valid, change the row order:")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" hfInstance "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" HyperFormula"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("buildFromArray")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" messageUsedInUI"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" isRowOrderOk "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" hfInstance"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("isItPossibleToSetRowOrder")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("isRowOrderOk"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  messageUsedInUI "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Sorry, you cannot sort rows in this way.'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// set the new row order")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("setRowOrder")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// rows 0 and 2 swap places")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// returns:")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// [{")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//   address: { sheet: 0, col: 0, row: 2 },")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//   newValue: 1,")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// },")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// {")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//   address: { sheet: 0, col: 1, row: 2 },")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//   newValue: null,")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// },")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// {")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//   address: { sheet: 0, col: 0, row: 0 },")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//   newValue: 4,")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// },")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// {")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//   address: { sheet: 0, col: 1, row: 0 },")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//   newValue: 5,")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// }]")]),t._v("\n")])])]),n("h2",{attrs:{id:"sorting-columns"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#sorting-columns"}},[t._v("#")]),t._v(" Sorting columns")]),t._v(" "),n("p",[t._v("To sort columns, use the "),n("RouterLink",{attrs:{to:"/api/classes/hyperformula.html#isitpossibletosetcolumnorder"}},[n("code",[t._v("isItPossibleToSetColumnOrder")])]),t._v(" and "),n("RouterLink",{attrs:{to:"/api/classes/hyperformula.html#setcolumnorder"}},[n("code",[t._v("setColumnOrder")])]),t._v(" methods.")],1),t._v(" "),n("h3",{attrs:{id:"step-1-choose-a-new-column-order"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#step-1-choose-a-new-column-order"}},[t._v("#")]),t._v(" Step 1: Choose a new column order")]),t._v(" "),n("p",[t._v("Choose your required permutation of column indexes.")]),t._v(" "),n("p",[t._v("For example, if you want to swap the first column with the third column, set the order to "),n("code",[t._v("[2, 1, 0]")]),t._v(" instead of "),n("code",[t._v("[0, 1, 2]")]),t._v(":")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// a HyperFormula instance with example data")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" hfInstance "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" HyperFormula"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("buildFromArray")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// we'll set the column order to [2, 1, 0] in the next steps")]),t._v("\n")])])]),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),n("p",[t._v("The "),n("RouterLink",{attrs:{to:"/api/classes/hyperformula.html#setcolumnorder"}},[n("code",[t._v("setColumnOrder")])]),t._v(" method accepts an array of numbers, so you can implement any function that returns an array with your required column order.")],1)]),t._v(" "),n("h3",{attrs:{id:"step-2-check-if-the-new-column-order-can-be-applied"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#step-2-check-if-the-new-column-order-can-be-applied"}},[t._v("#")]),t._v(" Step 2: Check if the new column order can be applied")]),t._v(" "),n("p",[t._v("Before you change the column order, check if your specified column number permutation can actually be applied.")]),t._v(" "),n("p",[t._v("Thanks to the "),n("RouterLink",{attrs:{to:"/guide/basic-operations.html#isitpossibleto-methods"}},[n("code",[t._v("isItPossibleTo*")]),t._v(" methods")]),t._v(", you can check if an operation is allowed, and display an error message if it's not.")],1),t._v(" "),n("p",[t._v("Use the "),n("RouterLink",{attrs:{to:"/api/classes/hyperformula.html#isitpossibletosetcolumnorder"}},[n("code",[t._v("isItPossibleToSetColumnOrder")])]),t._v(" method:")],1),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" hfInstance "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" HyperFormula"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("buildFromArray")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// a variable to carry the user message")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" messageUsedInUI"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// check if your permutation can be applied")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" isColumnOrderOk "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" hfInstance"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("isItPossibleToSetColumnOrder")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// display an error message")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("isColumnOrderOk"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  messageUsedInUI "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Sorry, you cannot sort columns in this way.'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("h3",{attrs:{id:"step-3-set-the-new-column-order"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#step-3-set-the-new-column-order"}},[t._v("#")]),t._v(" Step 3: Set the new column order")]),t._v(" "),n("p",[t._v("If your specified column number permutation is valid, change the column order:")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" hfInstance "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" HyperFormula"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("buildFromArray")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" messageUsedInUI"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" isColumnOrderOk "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" hfInstance"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("isItPossibleToSetColumnOrder")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("isColumnOrderOk"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  messageUsedInUI "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Sorry, you cannot sort columns in this way.'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// set the new column order")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("setColumnOrder")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// columns 0 and 2 swap places")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//returns:")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// [{")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//   address: { sheet: 0, col: 2, row: 0 },")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//   newValue: 1,")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// },")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// {")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//   address: { sheet: 0, col: 2, row: 1 },")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//   newValue: 5,")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// },")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// {")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//   address: { sheet: 0, col: 0, row: 0 },")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//   newValue: 4,")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// },")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// {")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//   address: { sheet: 0, col: 0, row: 1 },")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//   newValue: null,")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// }]")]),t._v("\n")])])]),n("h2",{attrs:{id:"data-sorting-demo"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#data-sorting-demo"}},[t._v("#")]),t._v(" Data sorting demo")]),t._v(" "),n("p",[t._v("The demo below shows how to sort rows in ascending and descending order, based on the results (calculated values) of the cells in the second column.")]),t._v(" "),n("div",{staticClass:"example-container"},[n("style",{pre:!0},[t._v("/* general */\n.example {\n  color: #606c76;\n  font-family: sans-serif;\n  font-size: 14px;\n  font-weight: 400;\n  letter-spacing: .01em;\n  line-height: 1.6;\n  -webkit-box-sizing: border-box;\n  box-sizing: border-box;\n}\n\n.example *,\n.example *::before,\n.example *::after {\n  -webkit-box-sizing: border-box;\n  box-sizing: border-box;\n}\n\n/* buttons */\n\n.example button {\n  border: 0.1em solid #1c49e4;\n  border-radius: .3em;\n  color: #fff;\n  cursor: pointer;\n  display: inline-block;\n  font-size: .85em;\n  font-family: inherit;\n  font-weight: 700;\n  height: 3em;\n  letter-spacing: .1em;\n  line-height: 3em;\n  padding: 0 3em;\n  text-align: center;\n  text-decoration: none;\n  text-transform: uppercase;\n  white-space: nowrap;\n  margin-bottom: 20px;\n  background-color: #1c49e4;\n}\n\n.example button:hover {\n  background-color: #2350ea;\n}\n\n.example button.outline {\n  background-color: transparent;\n  color: #1c49e4;\n}\n\n/* labels */\n\n.example label {\n  display: inline-block;\n  margin-left: 5px;\n}\n\n/* inputs */\n\n.example input:not([type='checkbox']), .example select, .example textarea, .example fieldset {\n  margin-bottom: 1.5em;\n  border: 0.1em solid #d1d1d1;\n  border-radius: .4em;\n  height: 3.8em;\n  width: 12em;\n  padding: 0 .5em;\n}\n\n.example input:focus,\n.example select:focus {\n  outline: none;\n  border-color: #1c49e4;\n}\n\n/* message */\n\n.example .message-box {\n  border: 1px solid #1c49e433;\n  background-color: #1c49e405;\n  border-radius: 0.2em;\n  padding: 10px;\n}\n\n.example .message-box span {\n  animation-name: cell-appear;\n  animation-duration: 0.2s;\n  margin: 0;\n}\n\n/* table */\n\n.example table {\n  table-layout: fixed;\n  border-spacing: 0;\n  overflow-x: auto;\n  text-align: left;\n  width: 100%;\n  counter-reset: row-counter col-counter;\n}\n\n.example table tr:nth-child(2n) {\n  background-color: #f6f8fa;\n}\n\n.example table tr td,\n.example table tr th {\n  overflow: hidden;\n  text-overflow: ellipsis;\n  border-bottom: 0.1em solid #e1e1e1;\n  padding: 0 1em;\n  height: 3.5em;\n}\n\n/* table: header row */\n\n.example table thead tr th span::before {\n  display: inline-block;\n  width: 20px;\n}\n\n.example table.spreadsheet thead tr th span::before {\n  content: counter(col-counter, upper-alpha);\n}\n\n.example table.spreadsheet thead tr th {\n  counter-increment: col-counter;\n}\n\n/* table: first column */\n\n.example table tbody tr td:first-child {\n  text-align: center;\n  padding: 0;\n}\n\n.example table thead tr th:first-child {\n  padding-left: 40px;\n}\n\n.example table tbody tr td:first-child span {\n  width: 100%;\n  display: inline-block;\n  text-align: left;\n  padding-left: 15px;\n  margin-left: 0;\n}\n\n.example table tbody tr td:first-child span::before {\n  content: counter(row-counter);\n  display: inline-block;\n  width: 20px;\n  position: relative;\n  left: -10px;\n}\n\n.example table tbody tr {\n  counter-increment: row-counter;\n}\n\n/* table: summary row */\n\n.example table tbody tr.summary {\n  font-weight: 600;\n}\n\n/* updated-cell animation */\n\n.example table tr td.updated-cell span {\n  animation-name: cell-appear;\n  animation-duration: 0.6s;\n}\n\n@keyframes cell-appear {\n  from {\n    opacity: 0;\n  }\n  to {\n    opacity: 1;\n  }\n}\n")]),t._v(" "),n("div",{pre:!0},[n("div",{pre:!0,attrs:{"data-preset-type":"hot","data-example-id":"example1"}},[n("div",{pre:!0,attrs:{class:"example"}},[n("table",[n("colgroup",[n("col",{pre:!0,attrs:{style:"width:50%"}}),t._v(" "),n("col",{pre:!0,attrs:{style:"width:50%"}})]),t._v(" "),n("thead",[n("tr",[n("th",[t._v("Name")]),t._v(" "),n("th",[t._v("\n        Score "),n("button",{pre:!0,attrs:{id:"asc",class:"button arrow",style:"width: 20px; height: 20px; line-height: 0; padding: 10px 6px;"}},[t._v("↑")]),t._v(" "),n("button",{pre:!0,attrs:{id:"desc",class:"button arrow",style:"width: 20px; height: 20px; line-height: 0; padding: 10px 6px;"}},[t._v("↓")])])])]),t._v(" "),n("tbody")])])])]),t._v(" "),n("ScriptLoader",{attrs:{code:"%22use%20strict%22;%0A%0A/**%0A%20*%20Initial%20table%20data.%0A%20*/%0Avar%20tableData%20=%20%5B%5B'Greg%20Black',%20'100'%5D,%20%5B'Anne%20Carpenter',%20'=SUM(100,100)'%5D,%20%5B'Natalie%20Dem',%20'500'%5D,%20%5B'John%20Sieg',%20'50'%5D,%20%5B'Chris%20Aklips',%20'20'%5D,%20%5B'Bart%20Hoopoe',%20'700'%5D,%20%5B'Chris%20Site',%20'80'%5D,%20%5B'Agnes%20Whitey',%20'90'%5D%5D;%0A%0A//%20Create%20an%20empty%20HyperFormula%20instance.%0Avar%20hf%20=%20HyperFormula.buildEmpty(%7B%0A%20%20licenseKey:%20'gpl-v3'%0A%7D);%0A%0A//%20Add%20a%20new%20sheet%20and%20get%20its%20id.%0Avar%20sheetName%20=%20hf.addSheet('main');%0Avar%20sheetId%20=%20hf.getSheetId(sheetName);%0A%0A//%20Fill%20the%20HyperFormula%20sheet%20with%20data.%0Ahf.setCellContents(%7B%0A%20%20row:%200,%0A%20%20col:%200,%0A%20%20sheet:%20sheetId%0A%7D,%20tableData);%0A%0A/**%0A%20*%20Sort%20the%20HF's%20dataset.%0A%20*%0A%20*%20@param%20%7Bboolean%7D%20ascending%20%60true%60%20if%20sorting%20in%20ascending%20order,%20%60false%60%20otherwise.%0A%20*%20@param%20%7BFunction%7D%20callback%20The%20callback%20function.%0A%20*/%0Afunction%20sort(ascending,%20callback)%20%7B%0A%20%20var%20rowCount%20=%20hf.getSheetDimensions(sheetId).height;%0A%20%20var%20colValues%20=%20%5B%5D;%0A%20%20var%20newOrder%20=%20null;%0A%20%20var%20newOrderMapping%20=%20%5B%5D;%0A%20%20for%20(var%20rowIndex%20=%200;%20rowIndex%20%3C%20rowCount;%20rowIndex++)%20%7B%0A%20%20%20%20colValues.push(%7B%0A%20%20%20%20%20%20rowIndex:%20rowIndex,%0A%20%20%20%20%20%20value:%20hf.getCellValue(%7B%0A%20%20%20%20%20%20%20%20sheet:%20sheetId,%0A%20%20%20%20%20%20%20%20col:%201,%0A%20%20%20%20%20%20%20%20row:%20rowIndex%0A%20%20%20%20%20%20%7D)%0A%20%20%20%20%7D);%0A%20%20%7D%0A%20%20colValues.sort(function%20(objA,%20objB)%20%7B%0A%20%20%20%20var%20delta%20=%20objA.value%20-%20objB.value;%0A%20%20%20%20return%20ascending%20?%20delta%20:%20-delta;%0A%20%20%7D);%0A%20%20newOrder%20=%20colValues.map(function%20(el)%20%7B%0A%20%20%20%20return%20el.rowIndex;%0A%20%20%7D);%0A%20%20newOrder.forEach(function%20(orderIndex,%20arrIndex)%20%7B%0A%20%20%20%20newOrderMapping%5BorderIndex%5D%20=%20arrIndex;%0A%20%20%7D);%0A%20%20hf.setRowOrder(sheetId,%20newOrderMapping);%0A%20%20callback();%0A%7D%0A%0A/**%0A%20*%20Fill%20the%20HTML%20table%20with%20data.%0A%20*%0A%20*%20@param%20%7Bboolean%7D%20calculated%20%60true%60%20if%20it%20should%20render%20calculated%20values,%20%60false%60%20otherwise.%0A%20*/%0Afunction%20renderTable()%20%7B%0A%20%20var%20calculated%20=%20arguments.length%20%3E%200%20&&%20arguments%5B0%5D%20!==%20undefined%20?%20arguments%5B0%5D%20:%20false;%0A%20%20var%20tbodyDOM%20=%20document.querySelector('.example%20tbody');%0A%20%20var%20updatedCellClass%20=%20ANIMATION_ENABLED%20?%20'updated-cell'%20:%20'';%0A%20%20var%20_hf$getSheetDimension%20=%20hf.getSheetDimensions(sheetId),%0A%20%20%20%20height%20=%20_hf$getSheetDimension.height,%0A%20%20%20%20width%20=%20_hf$getSheetDimension.width;%0A%20%20var%20newTbodyHTML%20=%20'';%0A%20%20for%20(var%20row%20=%200;%20row%20%3C%20height;%20row++)%20%7B%0A%20%20%20%20for%20(var%20col%20=%200;%20col%20%3C%20width;%20col++)%20%7B%0A%20%20%20%20%20%20var%20cellAddress%20=%20%7B%0A%20%20%20%20%20%20%20%20sheet:%20sheetId,%0A%20%20%20%20%20%20%20%20col:%20col,%0A%20%20%20%20%20%20%20%20row:%20row%0A%20%20%20%20%20%20%7D;%0A%20%20%20%20%20%20var%20cellHasFormula%20=%20hf.doesCellHaveFormula(cellAddress);%0A%20%20%20%20%20%20var%20showFormula%20=%20calculated%20%7C%7C%20!cellHasFormula;%0A%20%20%20%20%20%20var%20cellValue%20=%20'';%0A%20%20%20%20%20%20if%20(!hf.isCellEmpty(cellAddress)%20&&%20showFormula)%20%7B%0A%20%20%20%20%20%20%20%20cellValue%20=%20hf.getCellValue(cellAddress);%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20cellValue%20=%20hf.getCellFormula(cellAddress);%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20newTbodyHTML%20+=%20%22%3Ctd%20class=%5C%22%22.concat(cellHasFormula%20?%20updatedCellClass%20:%20'',%20%22%5C%22%3E%3Cspan%3E%5Cn%20%20%20%20%20%20%22).concat(cellValue,%20%22%5Cn%20%20%20%20%20%20%3C/span%3E%3C/td%3E%22);%0A%20%20%20%20%7D%0A%20%20%20%20newTbodyHTML%20+=%20'%3C/tr%3E';%0A%20%20%7D%0A%20%20tbodyDOM.innerHTML%20=%20newTbodyHTML;%0A%7D%0Avar%20doSortASC%20=%20function%20doSortASC()%20%7B%0A%20%20sort(true,%20function%20()%20%7B%0A%20%20%20%20renderTable(true);%0A%20%20%7D);%0A%7D;%0Avar%20doSortDESC%20=%20function%20doSortDESC()%20%7B%0A%20%20sort(false,%20function%20()%20%7B%0A%20%20%20%20renderTable(true);%0A%20%20%7D);%0A%7D;%0A%0A/**%0A%20*%20Bind%20the%20events%20to%20the%20buttons.%0A%20*/%0Afunction%20bindEvents()%20%7B%0A%20%20var%20ascSort%20=%20document.querySelector('.example%20#asc');%0A%20%20var%20descSort%20=%20document.querySelector('.example%20#desc');%0A%20%20ascSort.addEventListener('click',%20function%20()%20%7B%0A%20%20%20%20doSortASC();%0A%20%20%7D);%0A%20%20descSort.addEventListener('click',%20function%20()%20%7B%0A%20%20%20%20doSortDESC();%0A%20%20%7D);%0A%7D%0Avar%20ANIMATION_ENABLED%20=%20true;%0A%0A//%20Bind%20the%20button%20events.%0AbindEvents();%0A//%20Render%20the%20table.%0ArenderTable();"}})],1),t._v(" "),n("div",{staticClass:"example-controls"},[n("form",{staticClass:"form-stackblitz-external",attrs:{action:"https://stackblitz.com/run",method:"post",target:"_blank"}},[n("textarea",{pre:!0,attrs:{class:"hidden",name:"project[files][package.json]",readOnly:""}},[t._v('{\n  "name": "hyperformula-demo",\n  "version": "1.0.0",\n  "main": "index.html",\n  "dependencies": {\n    "hyperformula": "latest",\n    "moment": "latest"\n  }\n}')]),t._v(" "),n("textarea",{pre:!0,attrs:{class:"hidden",name:"project[files][index.html]",readOnly:""}},[t._v('<!DOCTYPE html>\n<html>\n  <head>\n    <meta charset="utf-8" />\n    <meta name="viewport" content="width=device-width, initial-scale=1.0" />\n    <title>HyperFormula demo</title>\n  </head>\n\n  <body>\n    <div class="example">\n  <table>\n    <colgroup>\n      <col style="width:50%" />\n      <col style="width:50%" />\n    </colgroup>\n    <thead>\n    <tr>\n      <th>Name</th>\n      <th>\n        Score <button id="asc" class="button arrow" style="width: 20px; height: 20px; line-height: 0; padding: 10px 6px;">↑</button>\n        <button id="desc" class="button arrow" style="width: 20px; height: 20px; line-height: 0; padding: 10px 6px;">↓</button>\n      </th>\n    </tr>\n    </thead>\n    <tbody></tbody>\n  </table>\n</div>\n\n  </body>\n</html>')]),t._v(" "),n("textarea",{pre:!0,attrs:{class:"hidden",name:"project[files][styles.css]",readOnly:""}},[t._v("/* general */\n.example {\n  color: #606c76;\n  font-family: sans-serif;\n  font-size: 14px;\n  font-weight: 400;\n  letter-spacing: .01em;\n  line-height: 1.6;\n  -webkit-box-sizing: border-box;\n  box-sizing: border-box;\n}\n\n.example *,\n.example *::before,\n.example *::after {\n  -webkit-box-sizing: border-box;\n  box-sizing: border-box;\n}\n\n/* buttons */\n\n.example button {\n  border: 0.1em solid #1c49e4;\n  border-radius: .3em;\n  color: #fff;\n  cursor: pointer;\n  display: inline-block;\n  font-size: .85em;\n  font-family: inherit;\n  font-weight: 700;\n  height: 3em;\n  letter-spacing: .1em;\n  line-height: 3em;\n  padding: 0 3em;\n  text-align: center;\n  text-decoration: none;\n  text-transform: uppercase;\n  white-space: nowrap;\n  margin-bottom: 20px;\n  background-color: #1c49e4;\n}\n\n.example button:hover {\n  background-color: #2350ea;\n}\n\n.example button.outline {\n  background-color: transparent;\n  color: #1c49e4;\n}\n\n/* labels */\n\n.example label {\n  display: inline-block;\n  margin-left: 5px;\n}\n\n/* inputs */\n\n.example input:not([type='checkbox']), .example select, .example textarea, .example fieldset {\n  margin-bottom: 1.5em;\n  border: 0.1em solid #d1d1d1;\n  border-radius: .4em;\n  height: 3.8em;\n  width: 12em;\n  padding: 0 .5em;\n}\n\n.example input:focus,\n.example select:focus {\n  outline: none;\n  border-color: #1c49e4;\n}\n\n/* message */\n\n.example .message-box {\n  border: 1px solid #1c49e433;\n  background-color: #1c49e405;\n  border-radius: 0.2em;\n  padding: 10px;\n}\n\n.example .message-box span {\n  animation-name: cell-appear;\n  animation-duration: 0.2s;\n  margin: 0;\n}\n\n/* table */\n\n.example table {\n  table-layout: fixed;\n  border-spacing: 0;\n  overflow-x: auto;\n  text-align: left;\n  width: 100%;\n  counter-reset: row-counter col-counter;\n}\n\n.example table tr:nth-child(2n) {\n  background-color: #f6f8fa;\n}\n\n.example table tr td,\n.example table tr th {\n  overflow: hidden;\n  text-overflow: ellipsis;\n  border-bottom: 0.1em solid #e1e1e1;\n  padding: 0 1em;\n  height: 3.5em;\n}\n\n/* table: header row */\n\n.example table thead tr th span::before {\n  display: inline-block;\n  width: 20px;\n}\n\n.example table.spreadsheet thead tr th span::before {\n  content: counter(col-counter, upper-alpha);\n}\n\n.example table.spreadsheet thead tr th {\n  counter-increment: col-counter;\n}\n\n/* table: first column */\n\n.example table tbody tr td:first-child {\n  text-align: center;\n  padding: 0;\n}\n\n.example table thead tr th:first-child {\n  padding-left: 40px;\n}\n\n.example table tbody tr td:first-child span {\n  width: 100%;\n  display: inline-block;\n  text-align: left;\n  padding-left: 15px;\n  margin-left: 0;\n}\n\n.example table tbody tr td:first-child span::before {\n  content: counter(row-counter);\n  display: inline-block;\n  width: 20px;\n  position: relative;\n  left: -10px;\n}\n\n.example table tbody tr {\n  counter-increment: row-counter;\n}\n\n/* table: summary row */\n\n.example table tbody tr.summary {\n  font-weight: 600;\n}\n\n/* updated-cell animation */\n\n.example table tr td.updated-cell span {\n  animation-name: cell-appear;\n  animation-duration: 0.6s;\n}\n\n@keyframes cell-appear {\n  from {\n    opacity: 0;\n  }\n  to {\n    opacity: 1;\n  }\n}\n")]),t._v(" "),n("textarea",{pre:!0,attrs:{class:"hidden",name:"project[files][index.ts]",readOnly:""}},[t._v("import './styles.css'\nimport HyperFormula from 'hyperformula';\n\nconsole.log(\n  `%c Using HyperFormula ${HyperFormula.version}`,\n  'color: blue; font-weight: bold',\n);\n\n/**\n * Initial table data.\n */\nconst tableData = [\n  ['Greg Black', '100'],\n  ['Anne Carpenter', '=SUM(100,100)'],\n  ['Natalie Dem', '500'],\n  ['John Sieg', '50'],\n  ['Chris Aklips', '20'],\n  ['Bart Hoopoe', '700'],\n  ['Chris Site', '80'],\n  ['Agnes Whitey', '90'],\n];\n\n// Create an empty HyperFormula instance.\nconst hf = HyperFormula.buildEmpty({\n  licenseKey: 'gpl-v3',\n});\n\n// Add a new sheet and get its id.\nconst sheetName = hf.addSheet('main');\nconst sheetId = hf.getSheetId(sheetName);\n\n// Fill the HyperFormula sheet with data.\nhf.setCellContents(\n  {\n    row: 0,\n    col: 0,\n    sheet: sheetId,\n  },\n  tableData,\n);\n\n/**\n * Sort the HF's dataset.\n *\n * @param {boolean} ascending `true` if sorting in ascending order, `false` otherwise.\n * @param {Function} callback The callback function.\n */\nfunction sort(ascending, callback) {\n  const rowCount = hf.getSheetDimensions(sheetId).height;\n  const colValues = [];\n  let newOrder = null;\n  const newOrderMapping = [];\n\n  for (let rowIndex = 0; rowIndex < rowCount; rowIndex++) {\n    colValues.push({\n      rowIndex,\n      value: hf.getCellValue({\n        sheet: sheetId,\n        col: 1,\n        row: rowIndex,\n      }),\n    });\n  }\n\n  colValues.sort((objA, objB) => {\n    const delta = objA.value - objB.value;\n\n    return ascending ? delta : -delta;\n  });\n\n  newOrder = colValues.map((el) => el.rowIndex);\n\n  newOrder.forEach((orderIndex, arrIndex) => {\n    newOrderMapping[orderIndex] = arrIndex;\n  });\n\n  hf.setRowOrder(sheetId, newOrderMapping);\n\n  callback();\n}\n\n/**\n * Fill the HTML table with data.\n *\n * @param {boolean} calculated `true` if it should render calculated values, `false` otherwise.\n */\nfunction renderTable(calculated = false) {\n  const tbodyDOM = document.querySelector('.example tbody');\n  const updatedCellClass = ANIMATION_ENABLED ? 'updated-cell' : '';\n  const { height, width } = hf.getSheetDimensions(sheetId);\n  let newTbodyHTML = '';\n\n  for (let row = 0; row < height; row++) {\n    for (let col = 0; col < width; col++) {\n      const cellAddress = { sheet: sheetId, col, row };\n      const cellHasFormula = hf.doesCellHaveFormula(cellAddress);\n      const showFormula = calculated || !cellHasFormula;\n      let cellValue = '';\n\n      if (!hf.isCellEmpty(cellAddress) && showFormula) {\n        cellValue = hf.getCellValue(cellAddress);\n      } else {\n        cellValue = hf.getCellFormula(cellAddress);\n      }\n\n      newTbodyHTML += `<td class=\"${\n        cellHasFormula ? updatedCellClass : ''\n      }\"><span>\n      ${cellValue}\n      </span></td>`;\n    }\n\n    newTbodyHTML += '</tr>';\n  }\n\n  tbodyDOM.innerHTML = newTbodyHTML;\n}\n\nconst doSortASC = () => {\n  sort(true, () => {\n    renderTable(true);\n  });\n};\n\nconst doSortDESC = () => {\n  sort(false, () => {\n    renderTable(true);\n  });\n};\n\n/**\n * Bind the events to the buttons.\n */\nfunction bindEvents() {\n  const ascSort = document.querySelector('.example #asc');\n  const descSort = document.querySelector('.example #desc');\n\n  ascSort.addEventListener('click', () => {\n    doSortASC();\n  });\n\n  descSort.addEventListener('click', () => {\n    doSortDESC();\n  });\n}\n\nconst ANIMATION_ENABLED = true;\n\n// Bind the button events.\nbindEvents();\n\n// Render the table.\nrenderTable();\n")]),t._v(" "),n("input",{attrs:{type:"hidden",name:"project[title]",value:"hyperformula-demo"}}),t._v(" "),n("input",{attrs:{type:"hidden",name:"project[dependencies]",value:'{"hyperformula":"latest", "moment": "latest"}'}}),t._v(" "),n("input",{attrs:{type:"hidden",name:"project[template]",value:"typescript"}}),t._v(" "),n("div",{staticClass:"js-stackblitz-link"},[n("button",{attrs:{type:"submit"}},[n("svg",{staticClass:"icon outbound",attrs:{xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",focusable:"false",width:"10.43",height:"15",preserveAspectRatio:"xMidYMid",viewBox:"0 0 256 368"}},[n("path",{attrs:{fill:"currentColor",d:"M109.586 217.013H0L200.34 0l-53.926 150.233H256L55.645 367.246l53.927-150.233z"}})]),t._v("\n        Open in Stackblitz\n      ")])])])]),t._v(" "),n("div"),n("div")])}),[],!1,null,null,null);n.default=s.exports}}]);