<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Batch operations | HyperFormula (v2.7.0)</title>
    <meta name="generator" content="VuePress 1.9.10">
    <script>
      (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
      new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
      })(window,document,'script','dataLayer','GTM-N59TZXR');
    </script>
    <script>
        window.sentryOnLoad = function () {
          Sentry.init({
            integrations: [
              // If you use a bundle with performance monitoring enabled, add the BrowserTracing integration
              new Sentry.BrowserTracing(),
              // If you use a bundle with session replay enabled, add the SessionReplay integration
              new Sentry.Replay({
                maskAllText: false,
                blockAllMedia: false,
              }),   
            ],
          });
        };
    </script>
    <script id="Sentry.io" src="https://js.sentry-cdn.com/50617701901516ce348cb7b252564a60.min.js" crossorigin="anonymous"></script>
    <link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png">
    <link rel="icon" sizes="32x32" type="image/png" href="/favicon/favicon-32x32.png">
    <link rel="icon" sizes="16x16" type="image/png" href="/favicon/favicon-16x16.png">
    <link rel="manifest" href="/favicon/site.webmanifest">
    <link rel="mask-icon" color="#ffffff" href="/favicon/safari-pinned-tab.svg">
    <meta name="description" content="HyperFormula is an open-source, high-performance calculation engine for spreadsheets and web applications.">
    <meta name="google-site-verification" content="MZpSOa8SNvFLRRGwUQpYVZ78kIHQoPVdVbafHhJ_d4Q">
    <link rel="preload" href="/assets/css/0.styles.1c8a208f.css" as="style"><link rel="preload" href="/assets/js/app.bc94ff67.js" as="script"><link rel="preload" href="/assets/js/2.41e4d318.js" as="script"><link rel="preload" href="/assets/js/1.47b64d8b.js" as="script"><link rel="preload" href="/assets/js/38.464afe70.js" as="script"><link rel="prefetch" href="/assets/js/11.3076e705.js"><link rel="prefetch" href="/assets/js/12.4379d8a8.js"><link rel="prefetch" href="/assets/js/13.5c3588e2.js"><link rel="prefetch" href="/assets/js/14.35a95fd5.js"><link rel="prefetch" href="/assets/js/15.7a9c53e4.js"><link rel="prefetch" href="/assets/js/16.e1d3bb5c.js"><link rel="prefetch" href="/assets/js/17.c2ea0a37.js"><link rel="prefetch" href="/assets/js/18.0602b0e2.js"><link rel="prefetch" href="/assets/js/19.d5ecdc39.js"><link rel="prefetch" href="/assets/js/20.d1175753.js"><link rel="prefetch" href="/assets/js/21.928a62cd.js"><link rel="prefetch" href="/assets/js/22.454880a0.js"><link rel="prefetch" href="/assets/js/23.13c30346.js"><link rel="prefetch" href="/assets/js/24.c21aeeeb.js"><link rel="prefetch" href="/assets/js/25.f6eb2894.js"><link rel="prefetch" href="/assets/js/26.cf0ff61e.js"><link rel="prefetch" href="/assets/js/27.1eb07f4b.js"><link rel="prefetch" href="/assets/js/28.a6b42c2e.js"><link rel="prefetch" href="/assets/js/29.bff45b76.js"><link rel="prefetch" href="/assets/js/3.70d64052.js"><link rel="prefetch" href="/assets/js/30.70774167.js"><link rel="prefetch" href="/assets/js/31.4842ae45.js"><link rel="prefetch" href="/assets/js/32.3fb72d16.js"><link rel="prefetch" href="/assets/js/33.d6c827f6.js"><link rel="prefetch" href="/assets/js/34.e78b98bf.js"><link rel="prefetch" href="/assets/js/35.2ba8f1de.js"><link rel="prefetch" href="/assets/js/36.d2174e4f.js"><link rel="prefetch" href="/assets/js/37.a71973b7.js"><link rel="prefetch" href="/assets/js/39.b3f3fab4.js"><link rel="prefetch" href="/assets/js/4.6a3d4c1d.js"><link rel="prefetch" href="/assets/js/40.c7c31d0b.js"><link rel="prefetch" href="/assets/js/41.e875b384.js"><link rel="prefetch" href="/assets/js/42.2f924bff.js"><link rel="prefetch" href="/assets/js/43.18b61786.js"><link rel="prefetch" href="/assets/js/44.9d686178.js"><link rel="prefetch" href="/assets/js/45.7ff8ed2d.js"><link rel="prefetch" href="/assets/js/46.f2c1cd66.js"><link rel="prefetch" href="/assets/js/47.bb2946d5.js"><link rel="prefetch" href="/assets/js/48.0b99222a.js"><link rel="prefetch" href="/assets/js/49.4f1be892.js"><link rel="prefetch" href="/assets/js/5.1784ad06.js"><link rel="prefetch" href="/assets/js/50.a373e841.js"><link rel="prefetch" href="/assets/js/51.c86ed915.js"><link rel="prefetch" href="/assets/js/52.71b4d388.js"><link rel="prefetch" href="/assets/js/53.fff0fdfc.js"><link rel="prefetch" href="/assets/js/54.0f1b03cf.js"><link rel="prefetch" href="/assets/js/55.33186257.js"><link rel="prefetch" href="/assets/js/56.073b63a2.js"><link rel="prefetch" href="/assets/js/57.d68070b8.js"><link rel="prefetch" href="/assets/js/58.b81b9346.js"><link rel="prefetch" href="/assets/js/59.87cbf7b7.js"><link rel="prefetch" href="/assets/js/6.9a592832.js"><link rel="prefetch" href="/assets/js/60.f0b88f75.js"><link rel="prefetch" href="/assets/js/61.82c62269.js"><link rel="prefetch" href="/assets/js/62.77b1d9e4.js"><link rel="prefetch" href="/assets/js/63.2af032cd.js"><link rel="prefetch" href="/assets/js/64.96d8be26.js"><link rel="prefetch" href="/assets/js/65.4c8d33c5.js"><link rel="prefetch" href="/assets/js/66.715c0b5c.js"><link rel="prefetch" href="/assets/js/67.cb024ca8.js"><link rel="prefetch" href="/assets/js/68.e69c4b73.js"><link rel="prefetch" href="/assets/js/69.9f71d49c.js"><link rel="prefetch" href="/assets/js/7.55d12f77.js"><link rel="prefetch" href="/assets/js/70.db7c195e.js"><link rel="prefetch" href="/assets/js/71.09e74e94.js"><link rel="prefetch" href="/assets/js/72.7f186870.js"><link rel="prefetch" href="/assets/js/73.eb2226cd.js"><link rel="prefetch" href="/assets/js/74.17f5f9a5.js"><link rel="prefetch" href="/assets/js/75.06b4898a.js"><link rel="prefetch" href="/assets/js/76.2c0816b0.js"><link rel="prefetch" href="/assets/js/77.366a49ba.js"><link rel="prefetch" href="/assets/js/78.a8184c60.js"><link rel="prefetch" href="/assets/js/79.86ecc948.js"><link rel="prefetch" href="/assets/js/8.4e3bfa86.js"><link rel="prefetch" href="/assets/js/80.dffc6861.js"><link rel="prefetch" href="/assets/js/81.28f5c3c1.js"><link rel="prefetch" href="/assets/js/82.33e64525.js"><link rel="prefetch" href="/assets/js/83.2eb93489.js"><link rel="prefetch" href="/assets/js/84.82bb9bfb.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.f8620926.js">
    <link rel="stylesheet" href="/assets/css/0.styles.1c8a208f.css">
</head>
<body>
<!-- Google Tag Manager element -->
<iframe src='https://www.googletagmanager.com/ns.html?id=GTM-N59TZXR' height="0" width="0" style="display:none;visibility:hidden">
</iframe>
<div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logo.png" alt="HyperFormula (v2.7.0)" class="logo"> <span class="site-name can-hide">HyperFormula (v2.7.0)</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Guide
</a></div><div class="nav-item"><a href="/api/" class="nav-link">
  API Reference
</a></div> <a href="https://github.com/handsontable/hyperformula" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Guide
</a></div><div class="nav-item"><a href="/api/" class="nav-link">
  API Reference
</a></div> <a href="https://github.com/handsontable/hyperformula" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Introduction</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/" aria-current="page" class="sidebar-link">Welcome</a></li><li><a href="/guide/demo.html" class="sidebar-link">Demo</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Overview</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guide/supported-browsers.html" class="sidebar-link">Supported browsers</a></li><li><a href="/guide/dependencies.html" class="sidebar-link">Dependencies</a></li><li><a href="/guide/licensing.html" class="sidebar-link">Licensing</a></li><li><a href="/guide/support.html" class="sidebar-link">Support</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Getting started</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guide/client-side-installation.html" class="sidebar-link">Client-side installation</a></li><li><a href="/guide/server-side-installation.html" class="sidebar-link">Server-side installation</a></li><li><a href="/guide/basic-usage.html" class="sidebar-link">Basic usage</a></li><li><a href="/guide/advanced-usage.html" class="sidebar-link">Advanced usage</a></li><li><a href="/guide/configuration-options.html" class="sidebar-link">Configuration options</a></li><li><a href="/guide/license-key.html" class="sidebar-link">License key</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Framework integration</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guide/integration-with-react.html" class="sidebar-link">Integration with React</a></li><li><a href="/guide/integration-with-vue.html" class="sidebar-link">Integration with Vue</a></li><li><a href="/guide/integration-with-angular.html" class="sidebar-link">Integration with Angular</a></li><li><a href="/guide/integration-with-svelte.html" class="sidebar-link">Integration with Svelte</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Data operations</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guide/basic-operations.html" class="sidebar-link">Basic operations</a></li><li><a href="/guide/batch-operations.html" aria-current="page" class="active sidebar-link">Batch operations</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guide/batch-operations.html#how-to-batch" class="sidebar-link">How to batch</a></li><li class="sidebar-sub-header"><a href="/guide/batch-operations.html#when-to-batch" class="sidebar-link">When to batch</a></li><li class="sidebar-sub-header"><a href="/guide/batch-operations.html#what-you-can-t-batch" class="sidebar-link">What you can't batch</a></li><li class="sidebar-sub-header"><a href="/guide/batch-operations.html#demo" class="sidebar-link">Demo</a></li></ul></li><li><a href="/guide/clipboard-operations.html" class="sidebar-link">Clipboard operations</a></li><li><a href="/guide/undo-redo.html" class="sidebar-link">Undo-redo</a></li><li><a href="/guide/sorting-data.html" class="sidebar-link">Sorting data</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Formulas</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guide/specifications-and-limits.html" class="sidebar-link">Specifications and limits</a></li><li><a href="/guide/cell-references.html" class="sidebar-link">Cell references</a></li><li><a href="/guide/types-of-values.html" class="sidebar-link">Types of values</a></li><li><a href="/guide/types-of-errors.html" class="sidebar-link">Types of errors</a></li><li><a href="/guide/types-of-operators.html" class="sidebar-link">Types of operators</a></li><li><a href="/guide/order-of-precendece.html" class="sidebar-link">Order of precedence</a></li><li><a href="/guide/built-in-functions.html" class="sidebar-link">Built-in functions</a></li><li><a href="/guide/volatile-functions.html" class="sidebar-link">Volatile functions</a></li><li><a href="/guide/named-expressions.html" class="sidebar-link">Named expressions</a></li><li><a href="/guide/arrays.html" class="sidebar-link">Array formulas</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Internationalization</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guide/i18n-features.html" class="sidebar-link">Internationalization features</a></li><li><a href="/guide/localizing-functions.html" class="sidebar-link">Localizing functions</a></li><li><a href="/guide/date-and-time-handling.html" class="sidebar-link">Date and time handling</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Compatibility</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guide/compatibility-with-microsoft-excel.html" class="sidebar-link">Compatibility with Microsoft Excel</a></li><li><a href="/guide/compatibility-with-google-sheets.html" class="sidebar-link">Compatibility with Google Sheets</a></li><li><a href="/guide/list-of-differences.html" class="sidebar-link">Runtime differences with Microsoft Excel and Google Sheets</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Advanced topics</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guide/key-concepts.html" class="sidebar-link">Key concepts</a></li><li><a href="/guide/dependency-graph.html" class="sidebar-link">Dependency graph</a></li><li><a href="/guide/building.html" class="sidebar-link">Building &amp; testing</a></li><li><a href="/guide/custom-functions.html" class="sidebar-link">Custom functions</a></li><li><a href="/guide/performance.html" class="sidebar-link">Performance</a></li><li><a href="/guide/known-limitations.html" class="sidebar-link">Known limitations</a></li><li><a href="/guide/file-import.html" class="sidebar-link">File import</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Upgrade and migration</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guide/release-notes.html" class="sidebar-link">Release notes</a></li><li><a href="/guide/migration-from-0.6-to-1.0.html" class="sidebar-link">Migrating from 0.6 to 1.0</a></li><li><a href="/guide/migration-from-1.0-to-2.0.html" class="sidebar-link">Migrating from 1.x to 2.0</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Miscellaneous</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guide/contributing.html" class="sidebar-link">Contributing</a></li><li><a href="/guide/code-of-conduct.html" class="sidebar-link">Code of conduct</a></li><li><a href="/guide/branding.html" class="sidebar-link">Branding</a></li><li><a href="/guide/contact.html" class="sidebar-link">Contact</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="batch-operations"><a href="#batch-operations" class="header-anchor">#</a> Batch operations</h1> <p>HyperFormula offers a built-in feature for doing batch operations.
It allows you to combine multiple data modification actions into a single operation.</p> <p>In some cases, batch operations can result in better performance,
especially when your app requires doing a large number of operations.</p> <h2 id="how-to-batch"><a href="#how-to-batch" class="header-anchor">#</a> How to batch</h2> <h3 id="using-the-batch-method"><a href="#using-the-batch-method" class="header-anchor">#</a> Using the <a href="/api/classes/hyperformula.html#batch"><code>batch</code></a> method</h3> <p>You can use the <a href="/api/classes/hyperformula.html#batch"><code>batch</code></a> method to batch operations. This method accepts
just one parameter: a callback function that stacks the selected
operations into one. It performs the cumulative operation at the end.</p> <p>This method returns a list of cells whose values were affected by this
operation together with their absolute addresses and new values.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> hfInstance <span class="token operator">=</span> HyperFormula<span class="token punctuation">.</span><span class="token function">buildFromSheets</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">MySheet1</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token punctuation">[</span><span class="token string">'1'</span><span class="token punctuation">]</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">MySheet2</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token punctuation">[</span><span class="token string">'10'</span><span class="token punctuation">]</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// multiple operations in a single callback will trigger evaluation only once</span>
<span class="token comment">// and only one set of changes will be returned as a combined result of all</span>
<span class="token comment">// the operations that were triggered within the callback</span>
<span class="token keyword">const</span> changes <span class="token operator">=</span> hfInstance<span class="token punctuation">.</span><span class="token function">batch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  hfInstance<span class="token punctuation">.</span><span class="token function">setCellContents</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">col</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token literal-property property">row</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token literal-property property">sheet</span><span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'=B1'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  hfInstance<span class="token punctuation">.</span><span class="token function">setCellContents</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">col</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token literal-property property">row</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token literal-property property">sheet</span><span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'=A1'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  
  <span class="token comment">// and numerous others</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="using-the-suspendevaluation-and-resumeevaluation-methods"><a href="#using-the-suspendevaluation-and-resumeevaluation-methods" class="header-anchor">#</a> Using the <a href="/api/classes/hyperformula.html#suspendevaluation"><code>suspendEvaluation</code></a> and <a href="/api/classes/hyperformula.html#resumeevaluation"><code>resumeEvaluation</code></a> methods</h3> <p>The same result can be achieved by suspending and resuming the
evaluation.</p> <p>To do that you need to explicitly suspend the evaluation, then do the
operations one by one, and then resume the evaluation.</p> <p>This method returns a list of cells which values were affected by the
operation together with their absolute addresses and new values.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> hfInstance <span class="token operator">=</span> HyperFormula<span class="token punctuation">.</span><span class="token function">buildFromSheets</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">MySheet1</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token punctuation">[</span><span class="token string">'1'</span><span class="token punctuation">]</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">MySheet2</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token punctuation">[</span><span class="token string">'10'</span><span class="token punctuation">]</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// suspend the evaluation</span>
hfInstance<span class="token punctuation">.</span><span class="token function">suspendEvaluation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// perform operations</span>
hfInstance<span class="token punctuation">.</span><span class="token function">setCellContents</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">col</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token literal-property property">row</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token literal-property property">sheet</span><span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'=B1'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
hfInstance<span class="token punctuation">.</span><span class="token function">setSheetContent</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'50'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'60'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// resume the evaluation</span>
<span class="token keyword">const</span> changes <span class="token operator">=</span> hfInstance<span class="token punctuation">.</span><span class="token function">resumeEvaluation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>You can resume the evaluation by calling the <a href="/api/classes/hyperformula.html#resumeevaluation"><code>resumeEvaluation</code></a> method
which triggers the recalculation. Just like in the case of the <a href="/api/classes/hyperformula.html#batch"><code>batch</code></a>
method, it returns a list of cells which values changed after the
operation, together with their absolute addresses, and new values.</p> <h3 id="checking-the-evaluation-suspension-state"><a href="#checking-the-evaluation-suspension-state" class="header-anchor">#</a> Checking the evaluation suspension state</h3> <p>When you need to check if the evaluation is suspended you can
call the <a href="/api/classes/hyperformula.html#isevaluationsuspended"><code>isEvaluationSuspended</code></a> method.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> hfInstance <span class="token operator">=</span> HyperFormula<span class="token punctuation">.</span><span class="token function">buildEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// suspend the evaluation</span>
hfInstance<span class="token punctuation">.</span><span class="token function">suspendEvaluation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// check if the evaluation is suspended</span>
<span class="token comment">// this method returns a simple boolean value</span>
<span class="token keyword">const</span> isEvaluationSuspended <span class="token operator">=</span> hfInstance<span class="token punctuation">.</span><span class="token function">isEvaluationSuspended</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// resume evaluation if needed</span>
hfInstance<span class="token punctuation">.</span><span class="token function">resumeEvaluation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="when-to-batch"><a href="#when-to-batch" class="header-anchor">#</a> When to batch</h2> <p>You can batch operations anytime you want to stack several actions into
one. However, if you want to see the most amazing benefits of this
feature, use batch operations when there are a lot of heavy methods.
This will result in better performance. The best candidates to
batch in this situation are the following methods:</p> <ul><li><code>clearSheet</code></li> <li><code>setSheetContent</code></li> <li><code>setCellContents</code></li> <li><code>addNamedExpression</code></li> <li><code>changeNamedExpression</code></li> <li><code>removeNamedExpression</code></li></ul> <p>These operations have an impact on calculation results and may affect
the performance.</p> <p>Batching can be useful when there is a need for multiple memory-consuming
operations. In this case, you should consider using it to achieve
better performance in the application you develop; it will result
in faster calculation across the whole HyperFormula instance.</p> <p>Batching can also be useful when you decide to use HyperFormula
on the <a href="server-side-installation">server-side</a>. Several operations
can be sent as a single one.</p> <h2 id="what-you-can-t-batch"><a href="#what-you-can-t-batch" class="header-anchor">#</a> What you can't batch</h2> <p>You can't batch read operations.</p> <p>Methods such as <a href="/api/classes/hyperformula.html#getcellvalue"><code>getCellValue</code></a>, <a href="/api/classes/hyperformula.html#getsheetserialized"><code>getSheetSerialized</code></a>, or <a href="/api/classes/hyperformula.html#getfillrangedata"><code>getFillRangeData</code></a> will result in an error when called inside a <a href="#using-the-batch-method">batch callback</a> or when the evaluation is <a href="#using-the-suspendevaluation-and-resumeevaluation-methods">suspended</a>.</p> <p>The <a href="/api/classes/hyperformula.html#paste">paste</a> method also can't be called when batching as it reads the contents of the copied cells.</p> <h2 id="demo"><a href="#demo" class="header-anchor">#</a> Demo</h2> <iframe src="https://stackblitz.com/github/handsontable/hyperformula-demos/tree/2.7.x/batch-operations?embed=1&amp;file=src/hyperformulaConfig.js&amp;hideNavigation=1&amp;view=preview&amp;v=20%2F06%2F2024%2010%3A19%3A30" style="width:100%;height:590px;border:0;border-radius:4px;overflow:hidden;"></iframe></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/handsontable/hyperformula/edit/master/docs/guide/batch-operations.md" target="_blank" rel="noopener noreferrer">Help us improve this page</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/guide/basic-operations.html" class="prev">
        Basic operations
      </a></span> <span class="next"><a href="/guide/clipboard-operations.html">
        Clipboard operations
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
<script src="/assets/js/app.bc94ff67.js" defer></script><script src="/assets/js/2.41e4d318.js" defer></script><script src="/assets/js/1.47b64d8b.js" defer></script><script src="/assets/js/38.464afe70.js" defer></script>
</body>
</html>