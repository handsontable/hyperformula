<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Named expressions | HyperFormula (v2.7.1)</title>
    <meta name="generator" content="VuePress 1.9.10">
    <script src="https://cdn.jsdelivr.net/npm/hyperformula/dist/hyperformula.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/hyperformula@2.7.1/dist/languages/enUS.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/hyperformula@2.7.1/dist/languages/frFR.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/moment/moment.min.js"></script>
    <script>
      (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
      new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
      })(window,document,'script','dataLayer','GTM-N59TZXR');
    </script>
    <script>
        window.sentryOnLoad = function () {
          Sentry.init({
            integrations: [
              // If you use a bundle with performance monitoring enabled, add the BrowserTracing integration
              new Sentry.BrowserTracing(),
              // If you use a bundle with session replay enabled, add the SessionReplay integration
              new Sentry.Replay({
                maskAllText: false,
                blockAllMedia: false,
              }),   
            ],
          });
        };
    </script>
    <script id="Sentry.io" src="https://js.sentry-cdn.com/50617701901516ce348cb7b252564a60.min.js" crossorigin="anonymous"></script>
    <link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png">
    <link rel="icon" sizes="32x32" type="image/png" href="/favicon/favicon-32x32.png">
    <link rel="icon" sizes="16x16" type="image/png" href="/favicon/favicon-16x16.png">
    <link rel="manifest" href="/favicon/site.webmanifest">
    <link rel="mask-icon" color="#ffffff" href="/favicon/safari-pinned-tab.svg">
    <meta name="description" content="HyperFormula is an open-source, high-performance calculation engine for spreadsheets and web applications.">
    <meta name="google-site-verification" content="MZpSOa8SNvFLRRGwUQpYVZ78kIHQoPVdVbafHhJ_d4Q">
    <link rel="preload" href="/assets/css/0.styles.4697ef37.css" as="style"><link rel="preload" href="/assets/js/app.069dfc70.js" as="script"><link rel="preload" href="/assets/js/2.351f39b2.js" as="script"><link rel="preload" href="/assets/js/1.5b588322.js" as="script"><link rel="preload" href="/assets/js/71.ffe652db.js" as="script"><link rel="preload" href="/assets/js/25.628ab8b7.js" as="script"><link rel="prefetch" href="/assets/js/11.019d5f3e.js"><link rel="prefetch" href="/assets/js/12.fd895246.js"><link rel="prefetch" href="/assets/js/13.500599f9.js"><link rel="prefetch" href="/assets/js/14.eee11ab6.js"><link rel="prefetch" href="/assets/js/15.862b1485.js"><link rel="prefetch" href="/assets/js/16.c6045874.js"><link rel="prefetch" href="/assets/js/17.f0987bd7.js"><link rel="prefetch" href="/assets/js/18.e327e1af.js"><link rel="prefetch" href="/assets/js/19.ce19b5b3.js"><link rel="prefetch" href="/assets/js/20.e88d9e93.js"><link rel="prefetch" href="/assets/js/21.5d58ad33.js"><link rel="prefetch" href="/assets/js/22.18e65e2c.js"><link rel="prefetch" href="/assets/js/23.7becfb43.js"><link rel="prefetch" href="/assets/js/24.ee551fdd.js"><link rel="prefetch" href="/assets/js/26.33555da8.js"><link rel="prefetch" href="/assets/js/27.de80e3de.js"><link rel="prefetch" href="/assets/js/28.f3abda06.js"><link rel="prefetch" href="/assets/js/29.075370e1.js"><link rel="prefetch" href="/assets/js/3.ed99d57d.js"><link rel="prefetch" href="/assets/js/30.af33c46d.js"><link rel="prefetch" href="/assets/js/31.3330a9a3.js"><link rel="prefetch" href="/assets/js/32.34008073.js"><link rel="prefetch" href="/assets/js/33.9a0a7a6b.js"><link rel="prefetch" href="/assets/js/34.db7d122b.js"><link rel="prefetch" href="/assets/js/35.0e1c1717.js"><link rel="prefetch" href="/assets/js/36.d29aca7d.js"><link rel="prefetch" href="/assets/js/37.df8cb8ca.js"><link rel="prefetch" href="/assets/js/38.ac7e1c09.js"><link rel="prefetch" href="/assets/js/39.b0ae52ec.js"><link rel="prefetch" href="/assets/js/4.d3630ce9.js"><link rel="prefetch" href="/assets/js/40.9dfe8118.js"><link rel="prefetch" href="/assets/js/41.6e5165b5.js"><link rel="prefetch" href="/assets/js/42.680c435f.js"><link rel="prefetch" href="/assets/js/43.65698538.js"><link rel="prefetch" href="/assets/js/44.059ab648.js"><link rel="prefetch" href="/assets/js/45.9f58e0da.js"><link rel="prefetch" href="/assets/js/46.c666a6cf.js"><link rel="prefetch" href="/assets/js/47.cc6a25c4.js"><link rel="prefetch" href="/assets/js/48.fc1d2d64.js"><link rel="prefetch" href="/assets/js/49.0ea1a358.js"><link rel="prefetch" href="/assets/js/5.a8958dd7.js"><link rel="prefetch" href="/assets/js/50.6059034f.js"><link rel="prefetch" href="/assets/js/51.7c50d3d8.js"><link rel="prefetch" href="/assets/js/52.ba02d89e.js"><link rel="prefetch" href="/assets/js/53.49e389dd.js"><link rel="prefetch" href="/assets/js/54.adffe78b.js"><link rel="prefetch" href="/assets/js/55.5687157f.js"><link rel="prefetch" href="/assets/js/56.4a0ca4b6.js"><link rel="prefetch" href="/assets/js/57.f51c7286.js"><link rel="prefetch" href="/assets/js/58.3cd59511.js"><link rel="prefetch" href="/assets/js/59.0c1fc556.js"><link rel="prefetch" href="/assets/js/6.9ec9a725.js"><link rel="prefetch" href="/assets/js/60.9a66a7a3.js"><link rel="prefetch" href="/assets/js/61.674288b0.js"><link rel="prefetch" href="/assets/js/62.1f888d6e.js"><link rel="prefetch" href="/assets/js/63.0c602e11.js"><link rel="prefetch" href="/assets/js/64.7afe8604.js"><link rel="prefetch" href="/assets/js/65.eeb5fb63.js"><link rel="prefetch" href="/assets/js/66.5b929165.js"><link rel="prefetch" href="/assets/js/67.9706e192.js"><link rel="prefetch" href="/assets/js/68.34064fbd.js"><link rel="prefetch" href="/assets/js/69.1209b460.js"><link rel="prefetch" href="/assets/js/7.2e673d2c.js"><link rel="prefetch" href="/assets/js/70.8960674b.js"><link rel="prefetch" href="/assets/js/72.350f1ba5.js"><link rel="prefetch" href="/assets/js/73.c5715921.js"><link rel="prefetch" href="/assets/js/74.7fc17af8.js"><link rel="prefetch" href="/assets/js/75.b6404f7e.js"><link rel="prefetch" href="/assets/js/76.faa45821.js"><link rel="prefetch" href="/assets/js/77.2514b48e.js"><link rel="prefetch" href="/assets/js/78.cc63a2dd.js"><link rel="prefetch" href="/assets/js/79.6d51a957.js"><link rel="prefetch" href="/assets/js/8.b41cc13f.js"><link rel="prefetch" href="/assets/js/80.956f1e4c.js"><link rel="prefetch" href="/assets/js/81.77876438.js"><link rel="prefetch" href="/assets/js/82.cc050297.js"><link rel="prefetch" href="/assets/js/83.0d9024fd.js"><link rel="prefetch" href="/assets/js/84.e0d65e80.js"><link rel="prefetch" href="/assets/js/85.8ee90586.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.fd489898.js">
    <link rel="stylesheet" href="/assets/css/0.styles.4697ef37.css">
</head>
<body>
<!-- Google Tag Manager element -->
<iframe src='https://www.googletagmanager.com/ns.html?id=GTM-N59TZXR' height="0" width="0" style="display:none;visibility:hidden">
</iframe>
<div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logo.png" alt="HyperFormula (v2.7.1)" class="logo"> <span class="site-name can-hide">HyperFormula (v2.7.1)</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Guide
</a></div><div class="nav-item"><a href="/api/" class="nav-link">
  API Reference
</a></div> <a href="https://github.com/handsontable/hyperformula" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Guide
</a></div><div class="nav-item"><a href="/api/" class="nav-link">
  API Reference
</a></div> <a href="https://github.com/handsontable/hyperformula" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Introduction</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/" aria-current="page" class="sidebar-link">Welcome</a></li><li><a href="/guide/demo.html" class="sidebar-link">Demo</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Overview</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guide/supported-browsers.html" class="sidebar-link">Supported browsers</a></li><li><a href="/guide/dependencies.html" class="sidebar-link">Dependencies</a></li><li><a href="/guide/licensing.html" class="sidebar-link">Licensing</a></li><li><a href="/guide/support.html" class="sidebar-link">Support</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Getting started</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guide/client-side-installation.html" class="sidebar-link">Client-side installation</a></li><li><a href="/guide/server-side-installation.html" class="sidebar-link">Server-side installation</a></li><li><a href="/guide/basic-usage.html" class="sidebar-link">Basic usage</a></li><li><a href="/guide/advanced-usage.html" class="sidebar-link">Advanced usage</a></li><li><a href="/guide/configuration-options.html" class="sidebar-link">Configuration options</a></li><li><a href="/guide/license-key.html" class="sidebar-link">License key</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Framework integration</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guide/integration-with-react.html" class="sidebar-link">Integration with React</a></li><li><a href="/guide/integration-with-vue.html" class="sidebar-link">Integration with Vue</a></li><li><a href="/guide/integration-with-angular.html" class="sidebar-link">Integration with Angular</a></li><li><a href="/guide/integration-with-svelte.html" class="sidebar-link">Integration with Svelte</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Data operations</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guide/basic-operations.html" class="sidebar-link">Basic operations</a></li><li><a href="/guide/batch-operations.html" class="sidebar-link">Batch operations</a></li><li><a href="/guide/clipboard-operations.html" class="sidebar-link">Clipboard operations</a></li><li><a href="/guide/undo-redo.html" class="sidebar-link">Undo-redo</a></li><li><a href="/guide/sorting-data.html" class="sidebar-link">Sorting data</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Formulas</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guide/specifications-and-limits.html" class="sidebar-link">Specifications and limits</a></li><li><a href="/guide/cell-references.html" class="sidebar-link">Cell references</a></li><li><a href="/guide/types-of-values.html" class="sidebar-link">Types of values</a></li><li><a href="/guide/types-of-errors.html" class="sidebar-link">Types of errors</a></li><li><a href="/guide/types-of-operators.html" class="sidebar-link">Types of operators</a></li><li><a href="/guide/order-of-precendece.html" class="sidebar-link">Order of precedence</a></li><li><a href="/guide/built-in-functions.html" class="sidebar-link">Built-in functions</a></li><li><a href="/guide/volatile-functions.html" class="sidebar-link">Volatile functions</a></li><li><a href="/guide/named-expressions.html" aria-current="page" class="active sidebar-link">Named expressions</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guide/named-expressions.html#examples" class="sidebar-link">Examples</a></li><li class="sidebar-sub-header"><a href="/guide/named-expressions.html#naming-rules" class="sidebar-link">Naming rules</a></li><li class="sidebar-sub-header"><a href="/guide/named-expressions.html#available-methods" class="sidebar-link">Available methods</a></li><li class="sidebar-sub-header"><a href="/guide/named-expressions.html#handling-errors" class="sidebar-link">Handling errors</a></li><li class="sidebar-sub-header"><a href="/guide/named-expressions.html#demo" class="sidebar-link">Demo</a></li></ul></li><li><a href="/guide/arrays.html" class="sidebar-link">Array formulas</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Internationalization</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guide/i18n-features.html" class="sidebar-link">Internationalization features</a></li><li><a href="/guide/localizing-functions.html" class="sidebar-link">Localizing functions</a></li><li><a href="/guide/date-and-time-handling.html" class="sidebar-link">Date and time handling</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Compatibility</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guide/compatibility-with-microsoft-excel.html" class="sidebar-link">Compatibility with Microsoft Excel</a></li><li><a href="/guide/compatibility-with-google-sheets.html" class="sidebar-link">Compatibility with Google Sheets</a></li><li><a href="/guide/list-of-differences.html" class="sidebar-link">Runtime differences with Microsoft Excel and Google Sheets</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Advanced topics</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guide/key-concepts.html" class="sidebar-link">Key concepts</a></li><li><a href="/guide/dependency-graph.html" class="sidebar-link">Dependency graph</a></li><li><a href="/guide/building.html" class="sidebar-link">Building &amp; testing</a></li><li><a href="/guide/custom-functions.html" class="sidebar-link">Custom functions</a></li><li><a href="/guide/performance.html" class="sidebar-link">Performance</a></li><li><a href="/guide/known-limitations.html" class="sidebar-link">Known limitations</a></li><li><a href="/guide/file-import.html" class="sidebar-link">File import</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Upgrade and migration</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guide/release-notes.html" class="sidebar-link">Release notes</a></li><li><a href="/guide/migration-from-0.6-to-1.0.html" class="sidebar-link">Migrating from 0.6 to 1.0</a></li><li><a href="/guide/migration-from-1.0-to-2.0.html" class="sidebar-link">Migrating from 1.x to 2.0</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Miscellaneous</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guide/contributing.html" class="sidebar-link">Contributing</a></li><li><a href="/guide/code-of-conduct.html" class="sidebar-link">Code of conduct</a></li><li><a href="/guide/branding.html" class="sidebar-link">Branding</a></li><li><a href="/guide/contact.html" class="sidebar-link">Contact</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="named-expressions"><a href="#named-expressions" class="header-anchor">#</a> Named expressions</h1> <p>An expression can be assigned a human-friendly name. Thanks to this you can
refer to that name anywhere across the workbook. Names are especially useful
when you use some references repeatedly. In this case, names simplify the
formulas and reduce the risk of making a mistake. Such a worksheet is also
easier to maintain.</p> <p>You can name a formula, string, number, or any other type of data.</p> <p>By default, references in named expressions are absolute. Most people use
absolute references in spreadsheet software like Excel without even knowing
about it. Very few know that references can be relative too. Unfortunately,
HyperFormula doesn't support relative references inside named expressions at the
moment.</p> <p>Dynamic ranges are supported through functions such as INDEX and OFFSET.</p> <p>Named ranges can overlap each other, e.g., it is possible to define the names as
follows:</p> <ul><li>rangeOne: Sheet1!$A$1:$D$10</li> <li>rangeTwo: Sheet1!$A$1:$E$1</li></ul> <h2 id="examples"><a href="#examples" class="header-anchor">#</a> Examples</h2> <table><thead><tr><th style="text-align:left;">Type</th> <th style="text-align:left;">Custom name</th> <th style="text-align:left;">Example expression</th></tr></thead> <tbody><tr><td style="text-align:left;">Named cell</td> <td style="text-align:left;">myCell</td> <td style="text-align:left;">=Sheet1!$A$1</td></tr> <tr><td style="text-align:left;">Named range of cells</td> <td style="text-align:left;">myRange</td> <td style="text-align:left;">=Sheet1!$A$1:$D$10</td></tr> <tr><td style="text-align:left;">Named constant (number)</td> <td style="text-align:left;">myNumber</td> <td style="text-align:left;">=10</td></tr> <tr><td style="text-align:left;">Named constant (string)</td> <td style="text-align:left;">myText</td> <td style="text-align:left;">=&quot;One Small Step for Man&quot;</td></tr> <tr><td style="text-align:left;">Named formula</td> <td style="text-align:left;">myFormula</td> <td style="text-align:left;">=SUM(Sheet1!$A$1:$D$10)</td></tr></tbody></table> <h2 id="naming-rules"><a href="#naming-rules" class="header-anchor">#</a> Naming rules</h2> <p>Expression names are case-insensitive, and they:</p> <ul><li>Must start with a Unicode letter or with an underscore (<code>_</code>).</li> <li>Can contain only Unicode letters, numbers, underscores, and periods (<code>.</code>).</li> <li>Can't be the same as any possible reference in the A1 notation (for example,
<code>Q4</code> or <code>YEAR2023</code>).</li> <li>Can't be the same as any possible reference in the R1C1 notation (for example,
<code>R4C5</code>, <code>RC</code> or <code>R0C</code>).</li> <li>Must be unique within a given scope.</li></ul> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>Expression names must be unique within a given scope, but you can override a
global named-expression with a local one. For example:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// `MyRevenue` has to be unique within the global scope</span>
hfInstance<span class="token punctuation">.</span><span class="token function">addNamedExpression</span><span class="token punctuation">(</span><span class="token string">'MyRevenue'</span><span class="token punctuation">,</span> <span class="token string">'=SUM(100+10)'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// but you can still use `MyRevenue` within the local scope of Sheet2 (sheetId = 1)</span>
hfInstance<span class="token punctuation">.</span><span class="token function">addNamedExpression</span><span class="token punctuation">(</span><span class="token string">'MyRevenue'</span><span class="token punctuation">,</span> <span class="token string">'=Sheet2!$A$1+100'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div> <p>For examples of valid and invalid expression names, see the following table:</p> <table><thead><tr><th style="text-align:left;">Name</th> <th style="text-align:left;">Validity</th></tr></thead> <tbody><tr><td style="text-align:left;">my Revenue</td> <td style="text-align:left;">Invalid</td></tr> <tr><td style="text-align:left;">myRevenue</td> <td style="text-align:left;">Valid</td></tr> <tr><td style="text-align:left;">quarter1</td> <td style="text-align:left;">Invalid</td></tr> <tr><td style="text-align:left;">quarter_1</td> <td style="text-align:left;">Valid</td></tr> <tr><td style="text-align:left;">1stQuarter</td> <td style="text-align:left;">Invalid</td></tr> <tr><td style="text-align:left;">_1stQuarter</td> <td style="text-align:left;">Valid</td></tr> <tr><td style="text-align:left;">.NET</td> <td style="text-align:left;">Invalid</td></tr> <tr><td style="text-align:left;">ASP.NET</td> <td style="text-align:left;">Valid</td></tr> <tr><td style="text-align:left;">A1</td> <td style="text-align:left;">Invalid</td></tr> <tr><td style="text-align:left;">$A$1</td> <td style="text-align:left;">Invalid</td></tr> <tr><td style="text-align:left;">RC</td> <td style="text-align:left;">Invalid</td></tr></tbody></table> <h2 id="available-methods"><a href="#available-methods" class="header-anchor">#</a> Available methods</h2> <p>These are the basic methods that can be used to add and manipulate named
expressions, including the creation and handling of named ranges. The full list
of methods is available in the <a href="../api">API reference</a>.</p> <h3 id="adding-a-named-expression"><a href="#adding-a-named-expression" class="header-anchor">#</a> Adding a named expression</h3> <p>You can add a named expression by using the <code>addNamedExpression</code> method. It
accepts name for the expression, the expression as a raw cell content, and
optionally the scope. If you do not define the scope it will be set to global,
meaning the expression name will be valid for the whole workbook. If you want to
add many of them, it is advised to do so in a <a href="/guide/batch-operations.html">batch</a>.
This method returns <a href="/guide/basic-operations.html#changes-array">an array of changed cells</a>.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// add 'prettyName' expression to the local scope of 'Sheet1' (sheetId = 0)</span>
<span class="token keyword">const</span> changes <span class="token operator">=</span> hfInstance<span class="token punctuation">.</span><span class="token function">addNamedExpression</span><span class="token punctuation">(</span>
  <span class="token string">'prettyName'</span><span class="token punctuation">,</span>
  <span class="token string">'=Sheet1!$A$1+100'</span><span class="token punctuation">,</span>
  <span class="token number">0</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="changing-a-named-expression"><a href="#changing-a-named-expression" class="header-anchor">#</a> Changing a named expression</h3> <p>You can change a named expression by using the <code>changeNamedExpression</code> method.
Select the name of an expression to change and pass it as the first parameter,
then define the new expression as raw cell content and optionally add the scope.
If you do not define the scope it will be set to global, meaning the expression
will be valid for the whole workbook. If you want to change many of them, it is
advised to do so in a <a href="/guide/batch-operations.html">batch</a>.
This method returns <a href="/guide/basic-operations.html#changes-array">an array of changed cells</a>.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// change the named expression</span>
<span class="token keyword">const</span> changes <span class="token operator">=</span> hfInstance<span class="token punctuation">.</span><span class="token function">changeNamedExpression</span><span class="token punctuation">(</span>
  <span class="token string">'prettyName'</span><span class="token punctuation">,</span>
  <span class="token string">'=Sheet1!$A$1+200'</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="removing-a-named-expression"><a href="#removing-a-named-expression" class="header-anchor">#</a> Removing a named expression</h3> <p>You can remove a named expression by using the <code>removeNamedExpression</code> method.
Select the name of an expression to remove and pass it as the first parameter
and optionally define the scope. If you do not define the scope it will be
understood as global, meaning, the whole workbook.
This method returns <a href="/guide/basic-operations.html#changes-array">an array of changed cells</a>.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// remove 'prettyName' expression from 'Sheet1' (sheetId=0)</span>
<span class="token keyword">const</span> changes <span class="token operator">=</span> hfInstance<span class="token punctuation">.</span><span class="token function">removeNamedExpression</span><span class="token punctuation">(</span><span class="token string">'prettyName'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="listing-all-named-expressions"><a href="#listing-all-named-expressions" class="header-anchor">#</a> Listing all named expressions</h3> <p>You can retrieve a whole list of named expressions by using the
<code>listNamedExpressions</code> method. It requires no parameters and returns all named
expressions as an array of strings.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// get all named-expression names</span>
<span class="token keyword">const</span> listOfExpressions <span class="token operator">=</span> hfInstance<span class="token punctuation">.</span><span class="token function">listNamedExpressions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="handling-errors"><a href="#handling-errors" class="header-anchor">#</a> Handling errors</h2> <p>Operations on named expressions throw errors when something goes wrong. These
errors can be <a href="/guide/basic-operations.html#handling-an-error">handled</a> to provide a good
user experience in the application. It is also possible to check the
availability of operations using <code>isItPossibleTo*</code> methods, which are also
described in <a href="/guide/basic-operations.html#isitpossibleto-methods">that section</a>.</p> <h2 id="demo"><a href="#demo" class="header-anchor">#</a> Demo</h2> <div class="example-container"><style>/* general */
.example {
  color: #606c76;
  font-family: sans-serif;
  font-size: 14px;
  font-weight: 300;
  letter-spacing: .01em;
  line-height: 1.6;
  -webkit-box-sizing: border-box;
  box-sizing: border-box;
}

.example *,
.example *::before,
.example *::after {
  -webkit-box-sizing: border-box;
  box-sizing: border-box;
}

/* buttons */

.example button {
  border: 0.1em solid #1c49e4;
  border-radius: .3em;
  color: #fff;
  cursor: pointer;
  display: inline-block;
  font-size: .85em;
  font-family: inherit;
  font-weight: 700;
  height: 3em;
  letter-spacing: .1em;
  line-height: 3em;
  padding: 0 3em;
  text-align: center;
  text-decoration: none;
  text-transform: uppercase;
  white-space: nowrap;
  margin-bottom: 20px;
  background-color: #1c49e4;
}

.example button:hover {
  background-color: #2350ea;
}

.example button.outline {
  background-color: transparent;
  color: #1c49e4;
}

/* labels */

.example label {
  display: inline-block;
  margin-left: 5px;
}

/* inputs */

.example input:not([type='checkbox']), .example select, .example textarea, .example fieldset {
  margin-bottom: 1.5em;
  border: 0.1em solid #d1d1d1;
  border-radius: .4em;
  height: 3.8em;
  width: 12em;
  padding: 0 .5em;
}

.example input:focus,
.example select:focus {
  outline: none;
  border-color: #1c49e4;
}

/* message */

.example .message-box {
  border: 1px solid #1c49e433;
  background-color: #1c49e405;
  border-radius: 0.2em;
  padding: 10px;
}

.example .message-box span {
  animation-name: cell-appear;
  animation-duration: 0.2s;
  margin: 0;
}

/* table */

.example table {
  table-layout: fixed;
  border-spacing: 0;
  overflow-x: auto;
  text-align: left;
  width: 100%;
  counter-reset: row-counter col-counter;
}

.example table tr:nth-child(2n) {
  background-color: #f6f8fa;
}

.example table tr td,
.example table tr th {
  overflow: hidden;
  text-overflow: ellipsis;
  border-bottom: 0.1em solid #e1e1e1;
  padding: 0 1em;
  height: 3.5em;
}

/* table: header row */

.example table thead tr th span::before {
  display: inline-block;
  width: 20px;
}

.example table.spreadsheet thead tr th span::before {
  content: counter(col-counter, upper-alpha);
}

.example table.spreadsheet thead tr th {
  counter-increment: col-counter;
}

/* table: first column */

.example table tbody tr td:first-child {
  text-align: center;
  padding: 0;
}

.example table thead tr th:first-child {
  padding-left: 40px;
}

.example table tbody tr td:first-child span {
  width: 100%;
  display: inline-block;
  text-align: left;
  padding-left: 15px;
  margin-left: 0;
}

.example table tbody tr td:first-child span::before {
  content: counter(row-counter);
  display: inline-block;
  width: 20px;
  position: relative;
  left: -10px;
}

.example table tbody tr {
  counter-increment: row-counter;
}

/* table: summary row */

.example table tbody tr.summary {
  font-weight: 600;
}

/* updated-cell animation */

.example table tr td.updated-cell span {
  animation-name: cell-appear;
  animation-duration: 0.6s;
}

@keyframes cell-appear {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}
</style> <div><div data-preset-type="hot" data-example-id="example1"><div class="example"><button id="run" class="button run">
    Run calculations
  </button> <button id="reset" class="button button-outline reset">
    Reset
  </button> <table><thead><tr><th>A</th> <th>B</th> <th>C</th> <th>D</th></tr></thead> <tbody></tbody></table></div></div></div> <div></div></div> <div class="example-controls"><form action="https://stackblitz.com/run" method="post" target="_blank" class="form-stackblitz-external"><textarea class="hidden" name="project[files][package.json]" readOnly="">{
  &quot;name&quot;: &quot;hyperformula-demo&quot;,
  &quot;version&quot;: &quot;1.0.0&quot;,
  &quot;main&quot;: &quot;index.html&quot;,
  &quot;dependencies&quot;: {
    &quot;hyperformula&quot;: &quot;latest&quot;,
    &quot;moment&quot;: &quot;latest&quot;
  }
}</textarea> <textarea class="hidden" name="project[files][index.html]" readOnly="">&lt;!DOCTYPE html&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;meta charset=&quot;utf-8&quot; /&gt;
    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot; /&gt;
    &lt;title&gt;HyperFormula demo&lt;/title&gt;
  &lt;/head&gt;

  &lt;body&gt;
    &lt;div class=&quot;example&quot;&gt;
  &lt;button id=&quot;run&quot; class=&quot;button run&quot;&gt;
    Run calculations
  &lt;/button&gt;
  &lt;button id=&quot;reset&quot; class=&quot;button button-outline reset&quot;&gt;
    Reset
  &lt;/button&gt;
  &lt;table&gt;
    &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;A&lt;/th&gt;
      &lt;th&gt;B&lt;/th&gt;
      &lt;th&gt;C&lt;/th&gt;
      &lt;th&gt;D&lt;/th&gt;
    &lt;/tr&gt;
    &lt;/thead&gt;
    &lt;tbody&gt;&lt;/tbody&gt;
  &lt;/table&gt;
&lt;/div&gt;

  &lt;/body&gt;
&lt;/html&gt;</textarea> <textarea class="hidden" name="project[files][styles.css]" readOnly="">/* general */
.example {
  color: #606c76;
  font-family: sans-serif;
  font-size: 14px;
  font-weight: 300;
  letter-spacing: .01em;
  line-height: 1.6;
  -webkit-box-sizing: border-box;
  box-sizing: border-box;
}

.example *,
.example *::before,
.example *::after {
  -webkit-box-sizing: border-box;
  box-sizing: border-box;
}

/* buttons */

.example button {
  border: 0.1em solid #1c49e4;
  border-radius: .3em;
  color: #fff;
  cursor: pointer;
  display: inline-block;
  font-size: .85em;
  font-family: inherit;
  font-weight: 700;
  height: 3em;
  letter-spacing: .1em;
  line-height: 3em;
  padding: 0 3em;
  text-align: center;
  text-decoration: none;
  text-transform: uppercase;
  white-space: nowrap;
  margin-bottom: 20px;
  background-color: #1c49e4;
}

.example button:hover {
  background-color: #2350ea;
}

.example button.outline {
  background-color: transparent;
  color: #1c49e4;
}

/* labels */

.example label {
  display: inline-block;
  margin-left: 5px;
}

/* inputs */

.example input:not([type='checkbox']), .example select, .example textarea, .example fieldset {
  margin-bottom: 1.5em;
  border: 0.1em solid #d1d1d1;
  border-radius: .4em;
  height: 3.8em;
  width: 12em;
  padding: 0 .5em;
}

.example input:focus,
.example select:focus {
  outline: none;
  border-color: #1c49e4;
}

/* message */

.example .message-box {
  border: 1px solid #1c49e433;
  background-color: #1c49e405;
  border-radius: 0.2em;
  padding: 10px;
}

.example .message-box span {
  animation-name: cell-appear;
  animation-duration: 0.2s;
  margin: 0;
}

/* table */

.example table {
  table-layout: fixed;
  border-spacing: 0;
  overflow-x: auto;
  text-align: left;
  width: 100%;
  counter-reset: row-counter col-counter;
}

.example table tr:nth-child(2n) {
  background-color: #f6f8fa;
}

.example table tr td,
.example table tr th {
  overflow: hidden;
  text-overflow: ellipsis;
  border-bottom: 0.1em solid #e1e1e1;
  padding: 0 1em;
  height: 3.5em;
}

/* table: header row */

.example table thead tr th span::before {
  display: inline-block;
  width: 20px;
}

.example table.spreadsheet thead tr th span::before {
  content: counter(col-counter, upper-alpha);
}

.example table.spreadsheet thead tr th {
  counter-increment: col-counter;
}

/* table: first column */

.example table tbody tr td:first-child {
  text-align: center;
  padding: 0;
}

.example table thead tr th:first-child {
  padding-left: 40px;
}

.example table tbody tr td:first-child span {
  width: 100%;
  display: inline-block;
  text-align: left;
  padding-left: 15px;
  margin-left: 0;
}

.example table tbody tr td:first-child span::before {
  content: counter(row-counter);
  display: inline-block;
  width: 20px;
  position: relative;
  left: -10px;
}

.example table tbody tr {
  counter-increment: row-counter;
}

/* table: summary row */

.example table tbody tr.summary {
  font-weight: 600;
}

/* updated-cell animation */

.example table tr td.updated-cell span {
  animation-name: cell-appear;
  animation-duration: 0.6s;
}

@keyframes cell-appear {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}
</textarea> <textarea class="hidden" name="project[files][index.ts]" readOnly="">import './styles.css'
import HyperFormula from 'hyperformula';

console.log(
  `%c Using HyperFormula ${HyperFormula.version}`,
  'color: blue; font-weight: bold'
);

/**
 * Initial table data.
 */
const tableData = [
  [10, 20, 20, 30],
  [50, 60, 70, 80],
  [90, 100, 110, 120],
  ['=myOneCell', '=myTwoCells', '=myOneColumn', '=myTwoColumns'],
  ['=myFormula+myNumber+34', '=myText', '=myOneRow', '=myTwoRows'],
];

// Create an empty HyperFormula instance.
const hf = HyperFormula.buildEmpty({
  licenseKey: 'gpl-v3',
});

// Add a new sheet and get its id.
const sheetName = hf.addSheet('main');
const sheetId = hf.getSheetId(sheetName);

// Fill the HyperFormula sheet with data.
hf.setCellContents(
  {
    row: 0,
    col: 0,
    sheet: sheetId,
  },
  tableData
);

// Add named expressions
hf.addNamedExpression('myOneCell', '=main!$A$1');
hf.addNamedExpression('myTwoCells', '=SUM(main!$A$1, main!$A$2)');
hf.addNamedExpression('myOneColumn', '=SUM(main!$A$1:main!$A$3)');
hf.addNamedExpression('myTwoColumns', '=SUM(main!$A$1:main!$B$3)');
hf.addNamedExpression('myOneRow', '=SUM(main!$A$1:main!$D$1)');
hf.addNamedExpression('myTwoRows', '=SUM(main!$A$1:main!$D$2)');
hf.addNamedExpression('myFormula', '=SUM(0, 1, 1, 2, 3, 5, 8, 13)');
hf.addNamedExpression('myNumber', '=21');
hf.addNamedExpression('myText', 'Apollo 11');

/**
 * Fill the HTML table with data.
 *
 * @param {boolean} calculated `true` if it should render calculated values, `false` otherwise.
 */
function renderTable(calculated = false) {
  const tbodyDOM = document.querySelector('.example tbody');
  const updatedCellClass = ANIMATION_ENABLED ? 'updated-cell' : '';

  const { height, width } = hf.getSheetDimensions(sheetId);
  let newTbodyHTML = '';

  for (let row = 0; row &lt; height; row++) {
    for (let col = 0; col &lt; width; col++) {
      const cellAddress = { sheet: sheetId, col, row };
      const cellHasFormula = hf.doesCellHaveFormula(cellAddress);
      const showFormula = calculated || !cellHasFormula;
      let cellValue = '';

      if (!hf.isCellEmpty(cellAddress) &amp;&amp; showFormula) {
        cellValue = hf.getCellValue(cellAddress);
      } else {
        cellValue = hf.getCellFormula(cellAddress);
      }

      newTbodyHTML += `&lt;td class=&quot;${
        cellHasFormula ? updatedCellClass : ''
      }&quot;&gt;&lt;span&gt;
      ${cellValue}
      &lt;/span&gt;&lt;/td&gt;`;
    }

    newTbodyHTML += '&lt;/tr&gt;';
  }

  tbodyDOM.innerHTML = newTbodyHTML;
}

/**
 * Replace formulas with their results.
 */
function runCalculations() {
  renderTable(true);
}

/**
 * Replace the values in the table with initial data.
 */
function resetTable() {
  renderTable();
}

/**
 * Bind the events to the buttons.
 */
function bindEvents() {
  const runButton = document.querySelector('.example #run');
  const resetButton = document.querySelector('.example #reset');

  runButton.addEventListener('click', () =&gt; {
    runCalculations();
  });

  resetButton.addEventListener('click', () =&gt; {
    resetTable();
  });
}

const ANIMATION_ENABLED = true;

// Bind the button events.
bindEvents();

// Render the table.
renderTable();
</textarea> <input type="hidden" name="project[title]" value="hyperformula-demo"> <input type="hidden" name="project[dependencies]" value="{&quot;hyperformula&quot;:&quot;latest&quot;, &quot;moment&quot;: &quot;latest&quot;}"> <input type="hidden" name="project[template]" value="typescript"> <div class="js-stackblitz-link"><button type="submit"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" width="10.43" height="15" preserveAspectRatio="xMidYMid" viewBox="0 0 256 368" class="icon outbound"><path fill="currentColor" d="M109.586 217.013H0L200.34 0l-53.926 150.233H256L55.645 367.246l53.927-150.233z"></path></svg>
        Open in Stackblitz
      </button></div></form></div> <div></div><div></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/handsontable/hyperformula/edit/master/docs/guide/named-expressions.md" target="_blank" rel="noopener noreferrer">Help us improve this page</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/guide/volatile-functions.html" class="prev">
        Volatile functions
      </a></span> <span class="next"><a href="/guide/arrays.html">
        Array formulas
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
<script src="/assets/js/app.069dfc70.js" defer></script><script src="/assets/js/2.351f39b2.js" defer></script><script src="/assets/js/1.5b588322.js" defer></script><script src="/assets/js/71.ffe652db.js" defer></script><script src="/assets/js/25.628ab8b7.js" defer></script>
</body>
</html>